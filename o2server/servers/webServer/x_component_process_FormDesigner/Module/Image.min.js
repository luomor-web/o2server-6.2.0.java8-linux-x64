MWF.xApplication.process.FormDesigner.Module=MWF.xApplication.process.FormDesigner.Module||{},MWF.xDesktop.requireApp("process.FormDesigner","Module.$Element",null,!1),MWF.xApplication.process.FormDesigner.Module.Image=MWF.FCImage=new Class({Extends:MWF.FC$Element,Implements:[Options,Events],options:{style:"default",propertyPath:"../x_component_process_FormDesigner/Module/Image/image.html"},initialize:function(s,e){this.setOptions(e),this.path="../x_component_process_FormDesigner/Module/Image/",this.cssPath="../x_component_process_FormDesigner/Module/Image/"+this.options.style+"/css.wcss",this._loadCss(),this.moduleType="element",this.moduleName="image",this.form=s,this.container=null,this.containerNode=null},_createMoveNode:function(){this.moveNode=new Element("img",{MWFType:"image",id:this.json.id,src:this.json.src||this.path+this.options.style+"/icon/image1.png",styles:this.css.moduleNodeMove,events:{selectstart:function(){return!1}}}).inject(this.form.container)},_getCopyNode:function(){return this.copyNode||this._createCopyNode(),this.copyNode.setStyle("display","inline-block"),this.copyNode},_setEditStyle_custom:function(s){if("src"==s)if(this.json.src){var e=this.json.src.imageSrc;this.node.src=e,this.setPropertiesOrStyles("styles")}else this.node.set("src",this.path+this.options.style+"/icon/image1.png");if("srcfile"==s){var t=this.json.srcfile;if("none"===t&&(this.json.srcfile="",t=""),t)if("object"===typeOf(t)){var o=MWF.xDesktop.getProcessFileUr(t.id,t.application);try{this.node.set("src",o)}catch(s){}}else{var i=MWF.Actions.getHost("x_processplatform_assemble_surface"),r=MWF.Actions.get("x_processplatform_assemble_surface").action.actions.readFile.uri;t=i+"/x_processplatform_assemble_surface"+(r=(r=r.replace("{flag}",t)).replace("{applicationFlag}",this.form.json.application));try{this.node.set("src",t)}catch(s){}}else this.json.properties.src?this._setEditStyle_custom("properties"):this.json.src?this._setEditStyle_custom("src"):this.node.set("src",this.path+this.options.style+"/icon/image1.png")}"properties"==s&&this._setNodeProperty()},_setNodeProperty:function(){if(-1==this.form.moduleList.indexOf(this)&&this.form.moduleList.push(this),-1==this.form.moduleNodeList.indexOf(this.node)&&this.form.moduleNodeList.push(this.node),-1==this.form.moduleElementNodeList.indexOf(this.node)&&this.form.moduleElementNodeList.push(this.node),this.node.store("module",this),"object"===typeOf(this.json.src)){var s=MWF.xDesktop.getImageSrc(this.json.src.imageId);this.node.set("src",s)}if(this.json.properties&&this.json.properties.src){var e=this.json.properties.src;if(-1!=e.indexOf("x_processplatform_assemble_surface")||-1!=e.indexOf("x_portal_assemble_surface")){var t=MWF.Actions.getHost("x_processplatform_assemble_surface"),o=MWF.Actions.getHost("x_portal_assemble_surface");-1!==e.indexOf("/x_processplatform_assemble_surface")?e=e.replace("/x_processplatform_assemble_surface",t+"/x_processplatform_assemble_surface"):-1!==e.indexOf("x_processplatform_assemble_surface")&&(e=e.replace("x_processplatform_assemble_surface",t+"/x_processplatform_assemble_surface")),-1!==e.indexOf("/x_portal_assemble_surface")?e=e.replace("/x_portal_assemble_surface",o+"/x_portal_assemble_surface"):-1!==e.indexOf("x_portal_assemble_surface")&&(e=e.replace("x_portal_assemble_surface",o+"/x_portal_assemble_surface")),e=o2.filterUrl(e)}e?this.node.set("src",e):this.json.srcfile&&"none"!=this.json.srcfile?this._setEditStyle_custom("srcfile"):this.json.src?this._setEditStyle_custom("src"):this.node.set("src",this.path+this.options.style+"/icon/image1.png")}else this.json.srcfile&&"none"!=this.json.srcfile?this._setEditStyle_custom("srcfile"):this.json.src?this._setEditStyle_custom("src"):this.node.set("src",this.path+this.options.style+"/icon/image1.png")}});