MWF.xApplication.process.FormDesigner.Module=MWF.xApplication.process.FormDesigner.Module||{},MWF.xDesktop.requireApp("process.FormDesigner","Module.View",null,!1),MWF.xApplication.process.FormDesigner.Module.Statement=MWF.FCStatement=new Class({Extends:MWF.FCView,options:{style:"default",propertyPath:"../x_component_process_FormDesigner/Module/Statement/statement.html"},initialize:function(e,t){this.setOptions(t),this.path="../x_component_process_FormDesigner/Module/Statement/",this.cssPath="../x_component_process_FormDesigner/Module/Statement/"+this.options.style+"/css.wcss",this.imagePath_default="../x_component_query_ViewDesigner/$Statement/",this.imagePath_custom="../x_component_process_FormDesigner/Module/Actionbar/",this._loadCss(),this.moduleType="element",this.moduleName="statement",this.form=e,this.container=null,this.containerNode=null},_createMoveNode:function(){this.moveNode=new Element("div",{MWFType:"statement",id:this.json.id,styles:this.css.moduleNodeMove,events:{selectstart:function(){return!1}}}).inject(this.form.container)},_createNode:function(){this.node=this.moveNode.clone(!0,!0),this.node.setStyles(this.css.moduleNode),this.node.set("id",this.json.id),this.node.addEvent("selectstart",(function(){return!1})),this.iconNode=new Element("div",{styles:this.css.iconNode}).inject(this.node),new Element("div",{styles:this.css.iconNodeIcon}).inject(this.iconNode),new Element("div",{styles:this.css.iconNodeText,text:"Statement"}).inject(this.iconNode),this.iconNode.addEvent("click",function(){this._checkView()}.bind(this))},_createViewNode:function(e){this.viewNode||(this.viewNode=new Element("div",{styles:this.css.viewNode}).inject(this.node)),this.actionbarNode||(this.actionbarNode=new Element("div.actionbarNode",{}).inject(this.viewNode,"top")),this.node.setStyle("background","transparent"),this.viewTable=new Element("table",{styles:this.css.viewTitleTableNode,border:"0px",cellPadding:"0",cellSpacing:"0"}).inject(this.viewNode),this.viewLine=new Element("tr",{styles:this.css.viewTitleLineNode}).inject(this.viewTable),"no"!=this.json.select&&(this.viewSelectCell=new Element("td",{styles:this.css.viewTitleCellNode}).inject(this.viewLine),this.viewSelectCell.setStyle("width","10px")),MWF.Actions.get("x_query_assemble_designer").getStatement(this.json.queryStatement.id,function(t){var i=JSON.decode(t.data.view||"");i&&i.data&&(this.viewData=i,"show"===this.json.actionbar&&(this.actionbarList=[],this._showActionbar()),(i.data?i.data.selectEntryList||i.data.selectList:[]).each(function(e){if(!e.hideColumn)new Element("td",{styles:this.css.viewTitleCellNode,text:e.displayName}).inject(this.viewLine)}.bind(this)),e&&e())}.bind(this)),this._setViewNodeTitle()},_checkView:function(e){this.json.queryStatement&&"none"!=this.json.queryStatement?(this.iconNode.setStyle("display","none"),this.viewNode&&this.viewNode.destroy(),this.viewNode=null,this._createViewNode(function(){e&&e()}.bind(this)),this.property&&this.property.viewFilter&&this.property.viewFilter.resetStatementData(this.json.queryStatement.id)):(this.iconNode.setStyle("display","block"),this.viewNode&&this.viewNode.destroy(),this.node.setStyles(this.css.moduleNode),e&&e(),this.property&&this.property.viewFilter&&this.property.viewFilter.resetStatementData())},_setEditStyle:function(e,t,i){if("queryStatement"==e&&this.json[e]!=i&&this._checkView(),"select"==e&&this._checkSelect(),"isTitle"==e&&this._checkTitle(),"titleStyles"==e&&this._setTitleStyles(),"name"==e){var s=this.json.name||this.json.id,n=this.json.type.substr(this.json.type.lastIndexOf("$")+1,this.json.type.length);this.treeNode.setText("<"+n+"> "+s)}if("id"==e){if(!this.json.name){n=this.json.type.substr(this.json.type.lastIndexOf("$")+1,this.json.type.length);this.treeNode.setText("<"+n+"> "+this.json.id)}this.treeNode.setTitle(this.json.id),this.node.set("id",this.json.id)}"actionbar"==e&&("show"===this.json.actionbar?this._showActionbar():this._hideActionbar()),this._setEditStyle_custom(e,t,i)}});