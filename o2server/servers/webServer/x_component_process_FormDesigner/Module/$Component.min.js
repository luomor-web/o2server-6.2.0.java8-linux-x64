MWF.xApplication.process.FormDesigner.Module=MWF.xApplication.process.FormDesigner.Module||{},MWF.xDesktop.requireApp("process.FormDesigner","Module.$Module",null,!1),MWF.xApplication.process.FormDesigner.Module.$Component=MWF.FC$Component=new Class({Extends:MWF.FC$Module,Implements:[Options,Events],_setNodeProperty:function(){this.node.store("module",this),-1==this.form.moduleList.indexOf(this)&&this.form.moduleList.push(this),-1==this.form.moduleNodeList.indexOf(this.node)&&this.form.moduleNodeList.push(this.node),-1==this.form.moduleComponentNodeList.indexOf(this.node)&&this.form.moduleComponentNodeList.push(this.node)},_initModule:function(){this.initialized||("yes"!==this.json.initialized&&this.setStyleTemplate(),this.setPropertiesOrStyles("styles"),this.setPropertiesOrStyles("properties"),this._getContainers(),this._getElements(),this._setNodeProperty(),this.form.isSubform||this._createIconAction(),this._setNodeEvent(),this.initialized=!0,this.json.initialized="yes")},_getElements:function(){},_getContainers:function(){},destroy:function(){this.containers.each((function(e){e.destroy()})),this.elements.each((function(e){e._deleteModule()})),this._deleteModule()},_deleteModule:function(){this.form.moduleList.erase(this),this.form.moduleNodeList.erase(this.node),this.form.moduleElementNodeList.erase(this.node),this.form.scriptDesigner&&this.form.scriptDesigner.removeModule(this.json),this.property&&this.property.destroy(),this.node.destroy(),this.actionArea.destroy(),delete this.form.json.moduleList[this.json.id],this.json=null,delete this.json,this.treeNode.destroy(),o2.release(this)},_dragIn:function(e){if(e.onDragModule=this,e.inContainer=null,e.parentContainer=this.parentContainer,e.nextModule=this,this.node.setStyles({border:"1px solid #ffa200"}),e.controlMode)e.copyNode&&e.copyNode.hide();else{var t=e._getCopyNode(this);t.show(),t.inject(this.node,"before")}},_setControlModeNode:function(){this.controlMode?this.copyNode&&this.copyNode.hide():this.onDragModule&&this.onDragModule._dragIn(this)},_dragOut:function(e){e.inContainer=null,e.parentContainer=null,e.nextModule=null,this.node.setStyles(this.css.moduleNode),this.setCustomStyles(),e._getCopyNode().setStyle("display","none")},_dragDrop:function(e,t){(t||!new Event(event).control)&&(this.node.setStyles(this.css.moduleNode),this.setCustomStyles())},copy:function(e){this.copyTo().move(e)},copyClearContainer:function(){var e=[];return this.containers.each(function(t){for(var o=new Element("div"),i=t.node.getFirst();i;){var s=i.getNext();i.inject(o),i=s}e.push(o)}.bind(this)),e},copyRecoverContainer:function(e){this.containers.each(function(t,o){for(var i=e[o],s=i.getFirst();s;){var n=s.getNext();s.inject(t.node),s=n}i.destroy()}.bind(this)),delete e},copyTo:function(e){e||(e=this.form);var t=this.copyClearContainer(),o=this.node.clone(!0),i=Object.clone(this.json);o.inject(e.node);var s=this.moduleName.capitalize(),n="page"==this.form.moduleType?"PC":"FC",r=new MWF[n+s](this.form);return i.id=r._getNewId(),o.set("id",i.id),this.form.json.moduleList[i.id]=i,this.form.scriptDesigner&&this.form.scriptDesigner.createModuleScript(i),this.copyComponentJsonData(o,i.id),r.load(i,o,e),this.copyRecoverContainer(t),this.containers.each((function(e,t){e._getSubModule().each((function(e){"container"==e.moduleType&&e.copySubModule(r.containers[t]),"element"==e.moduleType&&e.copyTo(r.containers[t]),"component"==e.moduleType&&e.copyTo(r.containers[t])}))})),r},parseModules:function(){}});