MWF.xDesktop.requireApp("Setting","Document",null,!1),MWF.xApplication.Setting.MobileConnectDocument=new Class({Extends:MWF.xApplication.Setting.Document,load:function(){this.node=new Element("div",{styles:{overflow:"hidden","padding-bottom":"80px"}}).inject(this.contentAreaNode),this.titleName=new Element("div",{styles:this.explorer.css.explorerContentTitleNode}).inject(this.node),this.titleName.set("text",this.lp.mobile_connectSetting);var e=!1;this.actions.collectConnected(function(t){e=t.data.value}.bind(this),function(t){e=!1}.bind(this),!1),this.mobileO2CloudConnectInput=new MWF.xApplication.Setting.Document.Button(this.explorer,this.node,{lp:{title:this.lp.mobile_connectO2Cloud,infor:this.mobile_connectO2Cloud_infor,action:this.lp.mobile_connectO2Cloud_action},value:e?this.lp.mobile_connectO2Cloud_success:this.lp.mobile_connectO2Cloud_error,itemTitle:e?this.lp.mobile_connectO2Cloud_success:this.lp.mobile_connectO2Cloud_error,icon:e?"cloud.png":"cloud_error.png",action:function(e){layout.desktop.openApplication(e,"Collect")}.bind(this)}),this.mobileHttpProtocolInput=new MWF.xApplication.Setting.Document.Select(this.explorer,this.node,{lp:{title:this.lp.mobile_httpProtocol,infor:this.lp.mobile_httpProtocol_infor},data:{key:"proxyData",valueKey:"httpProtocol"},value:this.explorer.proxyData.httpProtocol,options:[{value:"http",text:"http"},{value:"https",text:"https"}]}),this.mobileCenterInput=new MWF.xApplication.Setting.Document.List(this.explorer,this.node,{lp:{title:this.lp.mobile_center,infor:this.lp.mobile_center_infor,editAction:this.lp.mobile_center_action},data:{key:"proxyData",valueKey:"center",notEmpty:!1},value:this.explorer.proxyData.center,itemTitle:"{proxyHost}:{proxyPort}",icon:"center.png"}),this.mobileWebInput=new MWF.xApplication.Setting.Document.List(this.explorer,this.node,{lp:{title:this.lp.mobile_web,infor:this.lp.mobile_web_infor,editAction:this.lp.mobile_web_action},data:{key:"proxyData",valueKey:"web",notEmpty:!1},value:this.explorer.proxyData.web,itemTitle:"{proxyHost}:{proxyPort}",icon:"webserver.png"}),this.mobileApplicationInput=new MWF.xApplication.Setting.Document.List(this.explorer,this.node,{lp:{title:this.lp.mobile_application,infor:this.lp.mobile_application_infor,editAction:this.lp.mobile_application_action},data:{key:"proxyData",valueKey:"applicationList",notEmpty:!1},value:this.explorer.proxyData.applicationList,itemTitle:"{proxyHost}:{proxyPort}",readonly:["node"],icon:"server.png"})}}),MWF.xApplication.Setting.MobileModuleDocument=new Class({Extends:MWF.xApplication.Setting.Document,load:function(){this.node=new Element("div",{styles:{overflow:"hidden","padding-bottom":"80px"}}).inject(this.contentAreaNode),this.titleName=new Element("div",{styles:this.explorer.css.explorerContentTitleNode}).inject(this.node),this.titleName.set("text",this.lp.mobile_moduleSetting);var e=[{value:"",text:this.lp.mobile_index_defalue}];this.explorer.portalData.portalList&&this.explorer.portalData.portalList.length&&this.explorer.portalData.portalList.each(function(t){e.push({value:t.id,text:t.name})}.bind(this)),this.mobileIndexInput=new MWF.xApplication.Setting.Document.Select(this.explorer,this.node,{lp:{title:this.lp.mobile_index,infor:this.lp.mobile_index_infor},data:{key:"nativeData",valueKey:"indexPortal"},value:this.explorer.nativeData.indexPortal,options:e});var t=this.lp.mobile_module_simple_mode,i=this.lp.mobile_module_simple_mode_infor;new MWF.xApplication.Setting.Document.Check(this.explorer,this.node,{lp:{title:t,infor:i},data:{key:"nativeData",valueKey:"simpleMode",notEmpty:!1},value:this.explorer.nativeData.simpleMode}),this.explorer.nativeData.nativeAppList.each(function(e,t){var i=this.lp.mobile_module.replace("{name}",e.name),n=this.lp.mobile_module_infor.replace("{name}",e.name);new MWF.xApplication.Setting.Document.Check(this.explorer,this.node,{lp:{title:i,infor:n},data:{key:"nativeData",valueKey:"nativeAppList."+t+".enable",notEmpty:!1},value:e.enable})}.bind(this))}}),MWF.xApplication.Setting.AppPackOnlineDocument=new Class({Extends:MWF.xApplication.Setting.Document,load:function(){this.contentAreaNode.loadAll({css:["../x_component_Setting/$Main/default/apppack/index.css"],html:["../x_component_Setting/$Main/default/apppack/index.html"]},{bind:{lp:this.lp,data:{}},module:this},function(){this.node=this.apppackBoxNode,this.checkConnectAppPackServer()}.bind(this))},checkConnectAppPackServer:function(){o2.Actions.load("x_program_center").AppPackAction.connect(function(e){if(e&&e.data){var t=e.data;1001===t.status?(this.token=t.token,this.packServerUrl=t.packServerUrl,this.apppackErrorMsgNode.setStyles({display:"none"}),this.loadAppPackInfo()):1===t.status?this.showErrorMsg(this.lp.mobile_apppack_message_o2cloud_not_enable):2===t.status?this.showErrorMsg(this.lp.mobile_apppack_message_o2cloud_not_login):3===t.status&&this.showErrorMsg(this.lp.mobile_apppack_message_apppack_server_login_fail)}else this.showErrorMsg(this.lp.mobile_apppack_message_check_connect_fail)}.bind(this))},loadAppPackInfo:function(){this.showLoading(),o2.Actions.load("x_program_center").AppPackAction.packInfo(this.token,function(e){this.hiddenLoading(),e&&"success"===e.type?(this.packInfo=e.data,this.showPackInfoDetail()):(console.log("查询打包信息失败。。。"),this.loadConfigProxy())}.bind(this),function(e){console.log("错误拉，没有找到打包信息！"),console.log(e),this.hiddenLoading(),this.loadConfigProxy()}.bind(this))},showLoading:function(){this.packLoadingNode&&this.hiddenLoading(),this.packLoadingNode=new Element("div",{class:"pack-loading"}).inject(this.apppackBoxNode),new Element("div",{text:"Loading......"}).inject(this.packLoadingNode)},hiddenLoading:function(){this.packLoadingNode&&(this.packLoadingNode.destroy(),this.packLoadingNode=null)},showErrorMsg:function(e){this.apppackErrorMsgNode.set("text",e),this.apppackErrorMsgNode.setStyles({display:""})},showForm:function(){this.apppackShowBodyNode.setStyles({display:"none"}),this.apppackFormBodyNode.setStyles({display:""}),this.apppackBtnNode.addEvents({click:function(e){this.submitPack()}.bind(this)})},showPackInfoDetail:function(){if(this.packInfo){this.apppackAppNameShowNode.set("text",this.packInfo.appName),this.apppackProtocolShowNode.set("text",this.packInfo.o2ServerProtocol),this.apppackHostShowNode.set("text",this.packInfo.o2ServerHost),this.apppackPortShowNode.set("text",this.packInfo.o2ServerPort),this.apppackContextShowNode.set("text",this.packInfo.o2ServerContext),this.apppackLogoShowImgNode.set("src",this.packServerUrl+this.packInfo.appLogoPath+"?token="+this.token);var e="";"0"===this.packInfo.packStatus?(e=this.lp.mobile_apppack_status_order_inline,this.apppackStatusRefreshNode.setStyles({display:""}),this.apppackStatusRefreshNode.addEvents({click:function(e){this.loadAppPackInfo()}.bind(this)}),this.apppackReInputBtnNode.setStyles({display:"none"}),this.apppackRePackBtnNode.setStyles({display:"none"})):"1"===this.packInfo.packStatus?(e=this.lp.mobile_apppack_status_packing,this.apppackStatusRefreshNode.setStyles({display:""}),this.apppackStatusRefreshNode.addEvents({click:function(e){this.loadAppPackInfo()}.bind(this)}),this.apppackReInputBtnNode.setStyles({display:"none"}),this.apppackRePackBtnNode.setStyles({display:"none"})):"2"===this.packInfo.packStatus&&(e=this.lp.mobile_apppack_status_pack_end,this.apppackStatusRefreshNode.setStyles({display:"none"}),this.apppackReInputBtnNode.setStyles({display:""}),this.apppackReInputBtnNode.addEvents({click:function(e){this.reInput()}.bind(this)}),this.apppackRePackBtnNode.setStyles({display:""}),this.apppackRePackBtnNode.addEvents({click:function(e){this.reSubmitPack()}.bind(this)})),this.apppackStatusShowNode.set("text",e),this.packInfo.apkPath?(this.apppackDownloadLinkNode.set("href",this.packServerUrl+this.packInfo.apkPath+"?token="+this.token),this.apppackDownloadShowNode.setStyles({display:""})):this.apppackDownloadShowNode.setStyles({display:"none"}),this.apppackShowBodyNode.setStyles({display:""}),this.apppackFormBodyNode.setStyles({display:"none"})}},reInput:function(){this.packInfo&&(this.apppackProtocolInputNode.set("value",this.packInfo.o2ServerProtocol),this.apppackHostInputNode.set("value",this.packInfo.o2ServerHost),this.apppackPortInputNode.set("value",this.packInfo.o2ServerPort),this.apppackContextInputNode.set("value",this.packInfo.o2ServerContext),this.apppackAppNameInputNode.set("value",this.packInfo.appName)),this.showForm()},loadConfigProxy:function(){o2.Actions.load("x_program_center").ConfigAction.getProxy(function(e){if(this.hiddenLoading(),e&&e.data){var t=e.data;t.httpProtocol?this.apppackProtocolInputNode.set("value",t.httpProtocol):this.apppackProtocolInputNode.set("value","http"),t.center?(t.center.proxyHost&&this.apppackHostInputNode.set("value",t.center.proxyHost),t.center.proxyPort?this.apppackPortInputNode.set("value",t.center.proxyPort):this.apppackPortInputNode.set("value","20030")):this.apppackPortInputNode.set("value","20030")}this.apppackContextInputNode.set("value","/x_program_center"),this.showForm()}.bind(this))},reSubmitPack:function(){this.confirm(this.lp.alert,this.lp.mobile_apppack_message_alert_submit,function(){this.showLoading(),o2.Actions.load("x_program_center").AppPackAction.androidPackReStart(this.token,function(e){console.log(e),this.hiddenLoading(),e.data&&e.data.value?this.loadAppPackInfo():this.app.notice(e.message,"error",this.contentAreaNode)}.bind(this),function(e){this.hiddenLoading(),console.log(e),this.app.notice(e,"error",this.contentAreaNode)}.bind(this))}.bind(this))},submitPack:function(){var e=this.apppackAppNameInputNode.get("value");if(e&&""!==e)if(e.length>6)this.app.notice(this.lp.mobile_apppack_message_appname_len_max_6,"error",this.contentAreaNode);else{var t=this.apppackLogoInputNode.files;if(t.length){var i=t.item(0);if(".png"===i.name.substring(i.name.lastIndexOf(".")).toLowerCase()){var n=this.apppackProtocolInputNode.get("value");if(n&&""!==n)if("http"===n||"https"===n){var o=this.apppackHostInputNode.get("value");if(o&&""!==o){var s=this.apppackPortInputNode.get("value");if(s&&""!==s){var a=this.apppackContextInputNode.get("value");a&&""!==a?this.confirm(this.lp.alert,this.lp.mobile_apppack_message_alert_submit,function(){this.showLoading();var t=new FormData;t.append("file",i),t.append("fileName",i.name),t.append("appName",e),t.append("o2ServerProtocol",n),t.append("o2ServerHost",o),t.append("o2ServerPort",s),t.append("o2ServerContext",a),t.append("token",this.token),o2.Actions.load("x_program_center").AppPackAction.androidPackStart(t,"{}",function(e){console.log(e),this.hiddenLoading(),e.data&&e.data.value?this.loadAppPackInfo():this.app.notice(e.message,"error",this.contentAreaNode)}.bind(this),function(e){this.hiddenLoading(),console.log(e),this.app.notice(e,"error",this.contentAreaNode)}.bind(this))}.bind(this)):this.app.notice(this.lp.mobile_apppack_message_context_not_empty,"error",this.contentAreaNode)}else this.app.notice(this.lp.mobile_apppack_message_port_not_empty,"error",this.contentAreaNode)}else this.app.notice(this.lp.mobile_apppack_message_host_not_empty,"error",this.contentAreaNode)}else this.app.notice(this.lp.mobile_apppack_message_portocol_http_https,"error",this.contentAreaNode);else this.app.notice(this.lp.mobile_apppack_message_portocol_not_empty,"error",this.contentAreaNode)}else this.app.notice(this.lp.mobile_apppack_message_app_logo_need_png,"error",this.contentAreaNode)}else this.app.notice(this.lp.mobile_apppack_message_app_logo_not_empty,"error",this.contentAreaNode)}else this.app.notice(this.lp.mobile_apppack_message_appname_not_empty,"error",this.contentAreaNode)},confirm:function(e,t,i){var n=this.app.content.getSize(),o=(n.x-600)/2,s=(n.y-110)/2;MWF.require("MWF.xDesktop.Dialog",function(){new MWF.xDesktop.Dialog({title:e,style:"settingStyle",top:s,left:o,width:600,height:110,text:t,maskNode:this.app.content,container:this.app.content,buttonList:[{text:this.lp.ok,action:function(){i&&i(),this.close()}},{text:this.lp.cancel,action:function(){this.close()}}]}).show()}.bind(this))}}),MWF.xApplication.Setting.MPWeixinMenuSettingDocument=new Class({Extends:MWF.xApplication.Setting.Document,load:function(){this.contentAreaNode.loadAll({css:["../x_component_Setting/$Main/default/mpweixin/mpweixin.css"],html:["../x_component_Setting/$Main/default/mpweixin/menu.html"]},{bind:{lp:this.lp,data:{}},module:this},function(){this.node=this.mpwxMenuNode,this.initMenuData(),this.loadMenu(),this.loadPublishBtn()}.bind(this))},initMenuData:function(){this.menuList||(this.menuList=this.explorer.mpweixinListData||[]);var e=null;for(let t=0;t<this.menuList.length;t++){const i=this.menuList[t];i.type&&"subscribe"===i.type&&(e=i)}e&&this.menuList.erase(e)},loadPublishBtn:function(){this.mpwxPublishBtnNode.addEvents({click:function(){this.menuList&&this.menuList.length>0&&this.confirm(this.lp.alert,this.lp.mobile_mpweixin_menu_msg_publish_2_wxmp,function(){o2.Actions.load("x_program_center").MPWeixinAction.menuCreate2Weixin(function(e){this.app.notice(this.lp.mobile_mpweixin_menu_msg_publish_success,"success",this.contentAreaNode)}.bind(this))}.bind(this))}.bind(this)})},loadMenu:function(){if(this.mpwxMenuListNode.empty(),this.menuList&&this.menuList.length>0){this.showSubId||(this.showSubId=this.menuList[0].id),this.currentMenuId||(this.currentMenuId=this.menuList[0].id);for(let e=0;e<this.menuList.length;e++){const t=this.menuList[e];this.firstLevelMenu(t)}}this.firstLevelAddButton()},firstLevelAddButton:function(){var e=new Element("li",{class:"js_addMenuBox pre_menu_item grid_item no_extra"}).inject(this.mpwxMenuListNode);new Element("a",{class:"pre_menu_link js_addL1Btn",href:"javascript:void(0);"}).inject(e),new Element("i",{class:"icon14_menu_add"}).inject(e),e.addEvents({click:function(){this.createNewFirstMenuMock()}.bind(this)})},firstLevelMenu:function(e){var t=e.sub_button,i="jsMenu pre_menu_item grid_item jslevel1 ui-sortable ui-sortable-disabled size1of3";this.currentMenuId&&this.currentMenuId===e.id&&(i="jsMenu pre_menu_item grid_item jslevel1 ui-sortable ui-sortable-disabled size1of3 current");var n=new Element("li",{class:i}).inject(this.mpwxMenuListNode),o=new Element("a",{class:"pre_menu_link",href:"javascript:void(0);"}).inject(n);new Element("span",{class:"js_l1Title",text:e.name}).inject(o),n.addEvents({click:function(){this.clickMenu(e.id,e)}.bind(this)});var s=new Element("div",{class:"sub_pre_menu_box js_l2TitleBox"}).inject(n),a=new Element("ul",{class:"sub_pre_menu_list"}).inject(s);if((!t||t.length<5)&&this.secondLevelAddButton(e,a),t&&t.length>0){t.sort((function(e,t){var i=e.order.toLowerCase(),n=t.order.toLowerCase();return i<n?1:i>n?-1:0}));for(let i=0;i<t.length;i++){const n=t[i];this.secondLevelMenu(n,a,e)}}new Element("i",{class:"arrow arrow_out"}).inject(s),new Element("i",{class:"arrow arrow_in"}).inject(s),this.showSubId&&this.showSubId===e.id?s.setStyles({display:""}):s.setStyles({display:"none"})},secondLevelAddButton:function(e,t){var i=new Element("li",{class:"js_addMenuBox"}).inject(t),n=new Element("a",{class:"jsSubView js_addL2Btn",href:"javascript:void(0);"}).inject(i),o=new Element("span",{class:"sub_pre_menu_inner js_sub_pre_menu_inner"}).inject(n);new Element("i",{class:"icon14_menu_add"}).inject(o),i.addEvents({click:function(t){console.log("点击了新增，属于 "+e.name),this.createNewSubMenuMock(e),t.stopPropagation()}.bind(this)})},secondLevelMenu:function(e,t,i){var n="jslevel2";this.currentMenuId&&this.currentMenuId===e.id&&(n="jslevel2 current");var o=new Element("li",{class:n}).inject(t),s=new Element("a",{class:"jsSubView",href:"javascript:void(0);"}).inject(o),a=new Element("span",{class:"sub_pre_menu_inner js_sub_pre_menu_inner"}).inject(s);new Element("i",{class:"icon20_common sort_gray"}).inject(a),new Element("span",{class:"js_l2Title",text:e.name}).inject(a),o.addEvents({click:function(t){this.clickMenu(i.id,e),t.stopPropagation()}.bind(this)})},menuRightBoxCreate:function(e){this.mpwxMenuFormHeaderNode.empty(),new Element("h4",{class:"global_info",text:e.name}).inject(this.mpwxMenuFormHeaderNode);var t=new Element("div",{class:"global_extra"}).inject(this.mpwxMenuFormHeaderNode);new Element("a",{href:"javascript:void(0);",text:this.lp.mobile_mpweixin_menu_deleteBtnName_label}).inject(t).addEvents({click:function(t){this.deleteAction(e),t.stopPropagation()}.bind(this)}),new MWF.xApplication.Setting.MPWeixinMenuSettingDocument.MenuForm(this,this.mpwxMenuFormNode,e)},clickMenu:function(e,t){this.showSubId=e,this.currentMenuId=t.id,this.menuRightBoxCreate(t),this.loadMenu()},createNewSubMenuMock:function(e){let t=e.sub_button;if(t&&t.length>=5)return void this.app.notice(this.lp.mobile_mpweixin_menu_msg_sub_max_len,"error",this.contentAreaNode);if(e.id.startsWith("mock_"))return void this.app.notice(this.lp.mobile_mpweixin_menu_msg_parent_no_save,"error",this.contentAreaNode);let i="000001";if(t&&t.length>0){let e=t[0].order;const n=parseInt(e);if(!isNaN(n)){let e=""+(n+1);for(let t=e.length;t<6;t=e.length)e="0"+e;i=e}}let n={id:"mock_"+o2.uuid(),name:this.lp.mobile_mpweixin_menu_default_new_name,parentId:e.id,type:"click",order:i};t?e.sub_button.push(n):e.sub_button=[n];for(let t=0;t<this.menuList.length;t++){this.menuList[t].id===e.id&&(this.menuList[t]=e)}this.clickMenu(e.id,n)},createNewFirstMenuMock:function(){if(this.menuList&&this.menuList.length>=3)return void this.app.notice(this.lp.mobile_mpweixin_menu_msg_first_max_len,"error",this.contentAreaNode);let e="000001";if(this.menuList&&this.menuList.length>0){let t=this.menuList[this.menuList.length-1].order;console.log("最大的order "+t);const i=parseInt(t);if(!isNaN(i)){let t=""+(i+1);for(let e=t.length;e<6;e=t.length)t="0"+t;e=t}console.log("最大的order "+i)}let t={id:"mock_"+o2.uuid(),name:this.lp.mobile_mpweixin_menu_default_new_name,type:"click",order:e};this.menuList?this.menuList.push(t):this.menuList=[t],this.clickMenu(t.id,t)},setMenuData(e){if(this.menuList&&this.menuList.length>0){for(let i=0;i<this.menuList.length;i++){const n=this.menuList[i];if(n.id===e.id){this.menuList[i]=e;break}var t=!1;if(n.sub_button&&n.sub_button.length>0)for(let i=0;i<n.sub_button.length;i++){n.sub_button[i].id===e.id&&(t=!0,n.sub_button[i]=e)}if(t){this.menuList[i]=n;break}}this.loadMenu()}},deleteAction:function(e){e.id&&(e.id.startsWith("mock_")?(console.log("没有保存到数据库的数据 直接删除就行。"),this.removeDataUI(e)):this.confirm(this.lp.alert,this.lp.mobile_mpweixin_menu_delete_alert_msg,function(){o2.Actions.load("x_program_center").MPWeixinAction.menuDelete(e.id,function(t){this.removeDataUI(e),this.app.notice(this.lp.mobile_mpweixin_menu_delete_success,"success",this.contentAreaNode)}.bind(this))}.bind(this)))},removeDataUI:function(e){if(this.mpwxMenuFormHeaderNode.empty(),this.mpwxMenuFormNode.empty(),this.showSubId=null,this.currentMenuId=null,this.menuList&&this.menuList.length>0){for(let i=0;i<this.menuList.length;i++){const n=this.menuList[i];if(n.id===e.id){this.menuList.erase(e),console.log("删除成功。。。。。上级");break}var t=!1;if(n.sub_button&&n.sub_button.length>0)for(let i=0;i<n.sub_button.length;i++){n.sub_button[i].id===e.id&&(t=!0,n.sub_button.erase(e),console.log("删除成功。。。。子级。"))}if(t){this.menuList[i]=n;break}}this.loadMenu()}},confirm:function(e,t,i){var n=this.app.content.getSize(),o=(n.x-600)/2,s=(n.y-110)/2;MWF.require("MWF.xDesktop.Dialog",function(){new MWF.xDesktop.Dialog({title:e,style:"settingStyle",top:s,left:o,width:600,height:110,text:t,maskNode:this.app.content,container:this.app.content,buttonList:[{text:this.lp.ok,action:function(){i&&i(),this.close()}},{text:this.lp.cancel,action:function(){this.close()}}]}).show()}.bind(this))}}),MWF.xApplication.Setting.MPWeixinMenuSettingDocument.MenuForm=new Class({Implements:[Options,Events],initialize:function(e,t,i,n){this.setOptions(n),this.menuApp=e,this.explorer=e.explorer,this.app=this.explorer.app,this.lp=this.app.lp,this.contentAreaNode=t,this.actions=this.app.actions,this.css=this.app.css,this.menu=i,this.load()},load:function(){this.contentAreaNode.empty(),this.nameInputCreate(),this.orderInputCreate(),this.menu.sub_button&&this.menu.sub_button.length>0?this.haSubMenus=!0:(this.haSubMenus=!1,this.typeRadioCreate()),this.saveButtonCreate()},nameInputCreate:function(){this.nameInputBoxNode=new Element("div",{class:"frm_control_group js_setNameBox"}).inject(this.contentAreaNode);var e=new Element("label",{class:"frm_label"}).inject(this.nameInputBoxNode);new Element("strong",{class:"title js_menuTitle",text:this.lp.mobile_mpweixin_menu_form_name_label}).inject(e);var t=new Element("div",{class:"frm_controls"}).inject(this.nameInputBoxNode),i=new Element("span",{class:"frm_input_box with_counter counter_in append"}).inject(t);this.nameInputNode=new Element("input",{class:"frm_input js_menu_name",type:"text",value:this.menu.name}).inject(i),this.nameInputTipsNode=new Element("p",{class:"frm_tips js_titleNolTips",text:this.lp.mobile_mpweixin_menu_form_name_tips}).inject(t),this.nameInputErrorTipsNode=new Element("p",{class:"frm_msg fail js_titleEorTips dn",text:this.lp.mobile_mpweixin_menu_form_name_error}).inject(t)},orderInputCreate:function(){this.orderInputBoxNode=new Element("div",{class:"frm_control_group js_setNameBox"}).inject(this.contentAreaNode);var e=new Element("label",{class:"frm_label"}).inject(this.orderInputBoxNode);new Element("strong",{class:"title js_menuTitle",text:this.lp.mobile_mpweixin_menu_form_order_label}).inject(e);var t=new Element("div",{class:"frm_controls"}).inject(this.orderInputBoxNode),i=new Element("span",{class:"frm_input_box with_counter counter_in append"}).inject(t);this.orderInputNode=new Element("input",{class:"frm_input js_menu_name",type:"text",value:this.menu.order}).inject(i),this.orderInputTipsNode=new Element("p",{class:"frm_tips js_titleNolTips",text:this.lp.mobile_mpweixin_menu_form_order_tips}).inject(t),this.orderInputErrorTipsNode=new Element("p",{class:"frm_msg fail js_titleEorTips dn",text:this.lp.mobile_mpweixin_menu_form_order_error}).inject(t)},typeRadioCreate:function(){this.typeRadioBoxNode=new Element("div",{class:"frm_control_group"}).inject(this.contentAreaNode);var e=new Element("label",{class:"frm_label"}).inject(this.typeRadioBoxNode);new Element("strong",{class:"title js_menuContent",text:this.lp.mobile_mpweixin_menu_form_radio_label}).inject(e);var t=new Element("div",{class:"frm_controls frm_vertical_pt"}).inject(this.typeRadioBoxNode);this.msgTypeRadioBoxNode=new Element("label",{class:"frm_radio_label js_radio_sendMsg"}).inject(t),new Element("i",{class:"icon_radio"}).inject(this.msgTypeRadioBoxNode),new Element("span",{class:"lbl_content",text:this.lp.mobile_mpweixin_menu_form_radio_type_msg}).inject(this.msgTypeRadioBoxNode),new Element("input",{class:"frm_radio",type:"radio"}).inject(this.msgTypeRadioBoxNode),this.msgTypeRadioBoxNode.addEvents({click:function(){this.changeMenuType("click")}.bind(this)}),this.urlTypeRadioBoxNode=new Element("label",{class:"frm_radio_label js_radio_sendMsg"}).inject(t),new Element("i",{class:"icon_radio"}).inject(this.urlTypeRadioBoxNode),new Element("span",{class:"lbl_content",text:this.lp.mobile_mpweixin_menu_form_radio_type_url}).inject(this.urlTypeRadioBoxNode),new Element("input",{class:"frm_radio",type:"radio"}).inject(this.urlTypeRadioBoxNode),this.urlTypeRadioBoxNode.addEvents({click:function(){this.changeMenuType("view")}.bind(this)}),this.miniprogramTypeRadioBoxNode=new Element("label",{class:"frm_radio_label js_radio_sendMsg"}).inject(t),new Element("i",{class:"icon_radio"}).inject(this.miniprogramTypeRadioBoxNode),new Element("span",{class:"lbl_content",text:this.lp.mobile_mpweixin_menu_form_radio_type_miniprogram}).inject(this.miniprogramTypeRadioBoxNode),new Element("input",{class:"frm_radio",type:"radio"}).inject(this.miniprogramTypeRadioBoxNode),this.miniprogramTypeRadioBoxNode.addEvents({click:function(){this.changeMenuType("miniprogram")}.bind(this)}),this.typeContentCreate(),this.changeMenuType(this.menu.type)},saveButtonCreate:function(){var e=new Element("div",{class:"btn-box"}).inject(this.contentAreaNode);this.submitButtonNode=new Element("span",{class:"btn btn_input btn_primary"}).inject(e),new Element("button",{text:this.lp.save}).inject(this.submitButtonNode),this.submitButtonNode.addEvents({click:function(){this.submitAction()}.bind(this)})},typeContentCreate:function(){var e=new Element("div",{class:"menu_content_container"}).inject(this.contentAreaNode);this.msgContentCreate(e),this.urlContentCreate(e),this.miniprogramContentCreate(e)},msgContentCreate:function(e){this.msgTypeContentNode=new Element("div",{class:"menu_content dn"}).inject(e),new Element("p",{class:"menu_content_tips tips_global js_url_tips",text:this.lp.mobile_mpweixin_menu_form_type_msg_tips}).inject(this.msgTypeContentNode);var t=new Element("div",{class:"frm_control_group js_setNameBox"}).inject(this.msgTypeContentNode);new Element("label",{class:"frm_label",text:this.lp.mobile_mpweixin_menu_form_type_msg_label}).inject(t);var i=new Element("div",{class:"frm_controls"}).inject(t),n=new Element("span",{class:"frm_textarea_box with_counter counter_in append"}).inject(i);this.msgTypeContentInputNode=new Element("textarea",{class:"frm_textarea js_menu_name",value:this.menu.content}).inject(n)},urlContentCreate:function(e){this.urlTypeContentNode=new Element("div",{class:"menu_content dn"}).inject(e),new Element("p",{class:"menu_content_tips tips_global js_url_tips",text:this.lp.mobile_mpweixin_menu_form_type_url_tips}).inject(this.urlTypeContentNode);var t=new Element("div",{class:"frm_control_group js_setNameBox"}).inject(this.urlTypeContentNode);new Element("label",{class:"frm_label",text:this.lp.mobile_mpweixin_menu_form_type_url_label}).inject(t);var i=new Element("div",{class:"frm_controls"}).inject(t),n=new Element("span",{class:"frm_input_box with_counter counter_in append"}).inject(i);this.urlTypeContentInputNode=new Element("input",{class:"frm_input js_menu_name",type:"text",value:this.menu.url}).inject(n)},miniprogramContentCreate:function(e){this.miniprogramTypeContentNode=new Element("div",{class:"menu_content dn"}).inject(e),new Element("p",{class:"menu_content_tips tips_global js_url_tips",text:this.lp.mobile_mpweixin_menu_form_type_miniprogram_tips}).inject(this.miniprogramTypeContentNode);var t=new Element("div",{class:"frm_control_group js_setNameBox"}).inject(this.miniprogramTypeContentNode);new Element("label",{class:"frm_label",text:this.lp.mobile_mpweixin_menu_form_type_miniprogram_appid_label}).inject(t);var i=new Element("div",{class:"frm_controls"}).inject(t),n=new Element("span",{class:"frm_input_box with_counter counter_in append"}).inject(i);this.miniprogramTypeAppIdContentInputNode=new Element("input",{class:"frm_input js_menu_name",type:"text",value:this.menu.appid,placeholder:this.lp.mobile_mpweixin_menu_form_type_miniprogram_appid_placeholder}).inject(n);var o=new Element("div",{class:"frm_control_group js_setNameBox"}).inject(this.miniprogramTypeContentNode);new Element("label",{class:"frm_label",text:this.lp.mobile_mpweixin_menu_form_type_miniprogram_path_label}).inject(o);var s=new Element("div",{class:"frm_controls"}).inject(o),a=new Element("span",{class:"frm_input_box with_counter counter_in append"}).inject(s);this.miniprogramTypePathContentInputNode=new Element("input",{class:"frm_input js_menu_name",type:"text",value:this.menu.pagepath,placeholder:this.lp.mobile_mpweixin_menu_form_type_miniprogram_path_placeholder}).inject(a);var p=new Element("div",{class:"frm_control_group js_setNameBox"}).inject(this.miniprogramTypeContentNode);new Element("label",{class:"frm_label",text:this.lp.mobile_mpweixin_menu_form_type_miniprogram_url_label}).inject(p);var l=new Element("div",{class:"frm_controls"}).inject(p),r=new Element("span",{class:"frm_input_box with_counter counter_in append"}).inject(l);this.miniprogramTypeUrlContentInputNode=new Element("input",{class:"frm_input js_menu_name",type:"text",value:this.menu.url,placeholder:this.lp.mobile_mpweixin_menu_form_type_miniprogram_url_placeholder}).inject(r)},changeMenuType:function(e){e?(this.menu.type=e,"view"===e?(this.msgTypeRadioBoxNode.removeClass("selected"),this.msgTypeContentNode.addClass("dn"),this.urlTypeRadioBoxNode.addClass("selected"),this.urlTypeContentNode.removeClass("dn"),this.miniprogramTypeRadioBoxNode.removeClass("selected"),this.miniprogramTypeContentNode.addClass("dn")):"miniprogram"===e?(this.msgTypeRadioBoxNode.removeClass("selected"),this.msgTypeContentNode.addClass("dn"),this.urlTypeRadioBoxNode.removeClass("selected"),this.urlTypeContentNode.addClass("dn"),this.miniprogramTypeRadioBoxNode.addClass("selected"),this.miniprogramTypeContentNode.removeClass("dn")):(this.msgTypeRadioBoxNode.addClass("selected"),this.msgTypeContentNode.removeClass("dn"),this.urlTypeRadioBoxNode.removeClass("selected"),this.urlTypeContentNode.addClass("dn"),this.miniprogramTypeRadioBoxNode.removeClass("selected"),this.miniprogramTypeContentNode.addClass("dn"))):(this.msgTypeRadioBoxNode.addClass("selected"),this.msgTypeContentNode.removeClass("dn"),this.urlTypeRadioBoxNode.removeClass("selected"),this.urlTypeContentNode.addClass("dn"),this.miniprogramTypeRadioBoxNode.removeClass("selected"),this.miniprogramTypeContentNode.addClass("dn"))},submitAction:function(){var e=this.nameInputNode.get("value");if(e&&""!==e)if(e.length>4)this.app.notice(this.lp.mobile_mpweixin_menu_form_name_error_max_len,"error",this.menuApp.contentAreaNode);else{var t=this.orderInputNode.get("value");if(t&&""!==t){if(!1!==/^[\d]+$/.test(t))if(t.length>6)this.app.notice(this.lp.mobile_mpweixin_menu_form_order_error_max_len,"error",this.menuApp.contentAreaNode);else{if(this.menu.name=e,this.menu.order=t,this.haSubMenus&&!0===this.haSubMenus)console.log("存在子菜单菜单");else{var i=this.menu.type;if("view"===i){if(!(o=this.urlTypeContentInputNode.get("value"))||""===o)return void this.app.notice(this.lp.mobile_mpweixin_menu_form_type_url_error_empty,"error",this.menuApp.contentAreaNode);this.menu.url=o,this.menu.id.startsWith("mock_")&&delete this.menu.id}else if("miniprogram"===i){var n=this.miniprogramTypeAppIdContentInputNode.get("value");if(!n||""===n)return void this.app.notice(this.lp.mobile_mpweixin_menu_form_type_miniprogram_appid_error_empty,"error",this.menuApp.contentAreaNode);var o,s=this.miniprogramTypePathContentInputNode.get("value");if(!s||""===s)return void this.app.notice(this.lp.mobile_mpweixin_menu_form_type_miniprogram_path_error_empty,"error",this.menuApp.contentAreaNode);if(!(o=this.miniprogramTypeUrlContentInputNode.get("value"))||""===o)return void this.app.notice(this.lp.mobile_mpweixin_menu_form_type_miniprogram_url_error_empty,"error",this.menuApp.contentAreaNode);this.menu.appid=n,this.menu.pagepath=s,this.menu.url=o,this.menu.id.startsWith("mock_")&&delete this.menu.id}else{var a=this.msgTypeContentInputNode.get("value");if(!a||""===a)return void this.app.notice(this.lp.mobile_mpweixin_menu_form_type_msg_error_empty,"error",this.menuApp.contentAreaNode);this.menu.content=a,this.menu.id.startsWith("mock_")&&(this.menu.key=this.menu.id,delete this.menu.id)}}this.menu.id?o2.Actions.load("x_program_center").MPWeixinAction.menuUpdate(this.menu.id,this.menu,function(e){this.menuApp.setMenuData(this.menu),this.app.notice(this.lp.mobile_mpweixin_menu_save_success,"success",this.menuApp.contentAreaNode)}.bind(this)):o2.Actions.load("x_program_center").MPWeixinAction.menuAdd(this.menu,function(e){this.menu.id=e.data.id,this.menuApp.setMenuData(this.menu),this.app.notice(this.lp.mobile_mpweixin_menu_save_success,"success",this.menuApp.contentAreaNode)}.bind(this))}else this.app.notice(this.lp.mobile_mpweixin_menu_form_order_error_not_number,"error",this.menuApp.contentAreaNode)}else this.app.notice(this.lp.mobile_mpweixin_menu_form_order_error_empty,"error",this.menuApp.contentAreaNode)}else this.app.notice(this.lp.mobile_mpweixin_menu_form_name_error_empty,"error",this.menuApp.contentAreaNode)}}),MWF.xApplication.Setting.MobileStyleDocument=new Class({Extends:MWF.xApplication.Setting.Document,load:function(){this.node=new Element("div",{styles:{overflow:"hidden","padding-bottom":"80px"}}).inject(this.contentAreaNode),this.titleName=new Element("div",{styles:this.explorer.css.explorerContentTitleNode}).inject(this.node),this.titleName.set("text",this.lp.mobile_styleSetting),this.explorer.imagesData.images.each(function(e,t){var i=this.lp.mobile_style_imgs[e.name],n=this.lp.mobile_style.replace("{name}",i),o=this.lp.mobile_style_infor.replace("{name}",i);new MWF.xApplication.Setting.Document.Image(this.explorer,this.node,{lp:{title:n,infor:""},data:{key:"imagesData",valueKey:"applicationList",notEmpty:!1},value:e,itemTitle:o,iconData:e.value})}.bind(this))}});