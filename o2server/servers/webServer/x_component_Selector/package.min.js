MWF.xApplication.Selector=MWF.xApplication.Selector||{},o2.xApplication.Selector.package=MWF.O2Selector=new Class({Implements:[Options],options:{count:0,type:"person",title:"",groups:[],roles:[],units:[],unitType:"",values:[],exclude:[],categoryType:"unit",dutyUnitLevelBy:"duty"},initialize:function(t,e,i){if(MWF.xApplication.Selector.LP||MWF.xDesktop.requireApp("Selector","lp."+MWF.language,null,!1),this.loading=!0,e.title||(e.title=MWF.xApplication.Selector.LP.multiSelectTitle),this.setOptions(e),this.container=t,this.options.types&&"array"===typeOf(this.options.types)&&this.options.types.length>0)MWF.xDesktop.requireApp("Selector","MultipleSelector",function(){this.selector=new MWF.xApplication.Selector.MultipleSelector(this.container,this.options),!0!==i&&this.selector.load(),this.loading=!1}.bind(this));else{var o="string"===typeOf(this.options.type)?this.options.type.capitalize():this.options.type;o&&("unit"===o.toLowerCase()&&this.options.unitType?MWF.xDesktop.requireApp("Selector","UnitWithType",function(){this.selector=new MWF.xApplication.Selector.UnitWithType(this.container,e),!0!==i&&this.selector.load(),this.loading=!1}.bind(this)):"identity"===o.toLowerCase()&&this.options.dutys&&this.options.dutys.length&&"duty"===this.options.categoryType.toLowerCase()?MWF.xDesktop.requireApp("Selector","IdentityWidthDuty",function(){this.selector=new MWF.xApplication.Selector.IdentityWidthDuty(this.container,e),!0!==i&&this.selector.load(),this.loading=!1}.bind(this)):"identity"===o.toLowerCase()&&this.options.dutys&&this.options.dutys.length?MWF.xDesktop.requireApp("Selector","IdentityWidthDutyCategoryByUnit",function(){this.selector=new MWF.xApplication.Selector.IdentityWidthDutyCategoryByUnit(this.container,e),!0!==i&&this.selector.load(),this.loading=!1}.bind(this)):MWF.xDesktop.requireApp("Selector",o,function(){this.selector=new MWF.xApplication.Selector[o](this.container,e),!0!==i&&this.selector.load(),this.loading=!1}.bind(this)))}}}),MWF.O2SelectorFilter=new Class({Implements:[Options],options:{count:0,type:"person",title:"Select Person",groups:[],roles:[],units:[],unitType:"",values:[]},initialize:function(t,e){if(this.setOptions(e),this.value=t,this.options.types&&"array"===typeOf(this.options.types)&&this.options.types.length>0)MWF.xDesktop.requireApp("Selector","MultipleSelector",function(){this.selectFilter=new MWF.xApplication.Selector.MultipleSelector.Filter(this.container,this.options)}.bind(this),!1);else{var i="string"===typeOf(this.options.type)?this.options.type.capitalize():this.options.type;i&&("unit"===i.toLowerCase()&&this.options.unitType?MWF.xDesktop.requireApp("Selector","UnitWithType",function(){this.selector=new MWF.xApplication.Selector.UnitWithType.Filter(this.container,e),this.selector.load()}.bind(this)):"identity"===i.toLowerCase()&&this.options.dutys&&this.options.dutys.length&&"duty"===this.options.categoryType.toLowerCase()?MWF.xDesktop.requireApp("Selector","IdentityWidthDuty",function(){this.selectFilter=new MWF.xApplication.Selector.IdentityWidthDuty.Filter(this.value,e)}.bind(this),!1):"identity"===i.toLowerCase()&&this.options.dutys&&this.options.dutys.length?MWF.xDesktop.requireApp("Selector","IdentityWidthDutyCategoryByUnit",function(){this.selectFilter=new MWF.xApplication.Selector.IdentityWidthDutyCategoryByUnit.Filter(this.value,e)}.bind(this)):MWF.xDesktop.requireApp("Selector",i,function(){this.selectFilter=new MWF.xApplication.Selector[i].Filter(this.value,e)}.bind(this),!1))}},filter:function(t,e){return this.selectFilter.filter(t,e)}}),function(){var t=function(t,e){var i,o=(i="string"===typeOf(t)?(t={id:t}).id:t.distinguishedName||t.name||t.id).length;switch(i.substring(o-1,o)){case"U":new o2.widget.O2Unit(t,e,{style:"xform"});break;case"I":new o2.widget.O2Identity(t,e,{style:"xform"});break;case"G":new o2.widget.O2Group(t,e,{style:"xform"});break;case"P":new o2.widget.O2Person(t,e,{style:"xform"});break;case"R":new o2.widget.O2Role(t,e,{style:"xform"})}};Element.prototype.setSelectPerson=function(e,i){i.types&&(i.type=""),i.onComplete=function(e){o2.require("o2.widget.O2Identity",function(){i.values=[],this.empty(),e.each(function(e){i.values.push(e.data),t(e.data,this),i.selectItem&&i.selectItem(e)}.bind(this)),this.store("data-value",i.values)}.bind(this))}.bind(this),i.values&&i.values.each(function(e){this.store("data-value",i.values),t(e,this)}.bind(this)),this.addEvent("click",function(){var t=this.getZIndex();i.zIndex=t+1,new MWF.O2Selector(e,i)}.bind(this))}}();