MWF.APPWD=MWF.xApplication.portal.WidgetDesigner,MWF.APPWD.options={multitask:!0,executable:!1},MWF.xDesktop.requireApp("portal.PageDesigner","lp."+MWF.language,null,!1),MWF.xDesktop.requireApp("portal.PageDesigner","",null,!1),MWF.xApplication.portal.WidgetDesigner.Main=new Class({Extends:MWF.xApplication.portal.PageDesigner.Main,Implements:[Options,Events],options:{style:"default",template:"page.json",templateId:"",name:"portal.WidgetDesigner",icon:"icon.png",title:MWF.APPWD.LP.title,appTitle:MWF.APPWD.LP.title,id:"",actions:null,category:null,processData:null},getPageTemplate:function(t,e){this.actions.getWidgetTemplate(t,function(t){e&&e(t)}.bind(this))},getPage:function(t,e){this.actions.getWidget(t,function(t){e&&e(t)}.bind(this))},loadPage:function(){this.getPageData(function(){this.pcPage=new MWF.PCPage(this,this.designNode,{propertyPath:"../x_component_portal_WidgetDesigner/Module/Page/page.html",onPostLoad:function(){this.fireEvent("postWidgetLoad")}.bind(this)}),this.pcPage.load(this.pageData),this.page=this.pcPage}.bind(this))},setCategorySelect:function(t){t&&(new Element("option",{value:"$newCategory",text:this.lp.newCategory}).inject(t),this.actions.listWidgetTemplateCategory(function(e){e.data.each(function(e){new Element("option",{value:e.name,text:e.name}).inject(t)}.bind(this))}.bind(this)))},_savePage:function(t,e,i,a,n){this.actions.saveWidget(t,e,i,function(t){a(t)}.bind(this),function(t,e,i){n(t,e,i)}.bind(this))},addPageTemplate:function(t,e,i,a,n){this.actions.addWidgetTemplate(t,e,i,function(t){a&&a(t)}.bind(this),function(t,e,i){n&&n(t,e,i)}.bind(this))},loadNewPageData:function(t){var e="../x_component_portal_PageDesigner/Module/Page/template/"+this.options.template;MWF.getJSON(e,{onSuccess:function(e){this.pageData=e.pcData,this.pageData.id="",this.pageData.isNewPage=!0,this.pageData.json.name=MWF.APPWD.LP.newPage,this.pageMobileData=e.mobileData,this.pageMobileData.id="",this.pageMobileData.isNewPage=!0,t&&t()}.bind(this),onerror:function(t){this.notice(t,"error")}.bind(this),onRequestFailure:function(t){this.notice(t.responseText,"error")}.bind(this)})},previewPage:function(){this.savePage();var t="../x_desktop/portal.html?id="+this.application.id+"&widget="+this.page.json.id;window.open(o2.filterUrl(t))}});