MWF.xDesktop.requireApp("process.Xform","$Module",null,!1),MWF.xApplication.process.Xform.Image=MWF.APPImage=new Class({Extends:MWF.APP$Module,_loadUserInterface:function(){if(this.json.properties&&this.json.properties.src){var e=this.json.properties.src;if(-1!=e.indexOf("x_processplatform_assemble_surface")||-1!=e.indexOf("x_portal_assemble_surface")||-1!=e.indexOf("x_cms_assemble_control")){var s=MWF.Actions.getHost("x_processplatform_assemble_surface"),r=MWF.Actions.getHost("x_portal_assemble_surface"),a=MWF.Actions.getHost("x_cms_assemble_control");-1!==e.indexOf("/x_processplatform_assemble_surface")?e=e.replace("/x_processplatform_assemble_surface",s+"/x_processplatform_assemble_surface"):-1!==e.indexOf("x_processplatform_assemble_surface")&&(e=e.replace("x_processplatform_assemble_surface",s+"/x_processplatform_assemble_surface")),-1!==e.indexOf("/x_portal_assemble_surface")?e=e.replace("/x_portal_assemble_surface",r+"/x_portal_assemble_surface"):-1!==e.indexOf("x_portal_assemble_surface")&&(e=e.replace("x_portal_assemble_surface",r+"/x_portal_assemble_surface")),-1!==e.indexOf("/x_cms_assemble_control")?e=e.replace("/x_cms_assemble_control",a+"/x_cms_assemble_control"):-1!==e.indexOf("x_cms_assemble_control")&&(e=e.replace("x_cms_assemble_control",a+"/x_cms_assemble_control")),e=o2.filterUrl(e)}try{this.node.set("src",e)}catch(e){}}else if(this.json.srcfile&&"none"!=this.json.srcfile)if(e=this.json.srcfile,"object"===typeOf(e)){var o=e.portal?MWF.xDesktop.getPortalFileUr(e.id,e.portal):MWF.xDesktop.getProcessFileUr(e.id,e.application);o=o2.filterUrl(o),this.node.set("src",o)}else{var l=MWF.Actions.getHost("x_portal_assemble_surface"),t=MWF.Actions.get("x_portal_assemble_surface").action.actions.readFile.uri;e=l+"/x_portal_assemble_surface"+(t=(t=t.replace("{flag}",e)).replace("{applicationFlag}",this.form.json.application)),e=o2.filterUrl(e),this.node.set("src",e)}else if("object"==typeOf(this.json.src)){var c=MWF.xDesktop.getImageSrc(this.json.src.imageId);this.node.set("src",c)}},reset:function(){this._loadUserInterface()}});