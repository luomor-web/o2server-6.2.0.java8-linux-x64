MWF.xApplication.AppMarketV2.RecommendContent=new Class({Implements:[Options,Events],options:{view:"recommendContent.html"},initialize:function(t,e,n){this.setOptions(n),this.app=t,this.container=e,this.viewPath=this.app.path+this.app.options.style+"/"+this.options.view,this.load()},load:function(){this.container.loadHtml(this.viewPath,{bind:{lp:this.app.lp},module:this},function(){this.loadRecommend(function(){this.fireEvent("load")}.bind(this))}.bind(this))},loadRecommend:function(t){this.isLoading||(this.topRecommendContentV?this.topRecommendContentV.load():this.topRecommendContentV=new MWF.xApplication.AppMarketV2.RecommendContent.Recommend(this,{onLoad:function(){t&&t()}}))}}),MWF.xApplication.AppMarketV2.RecommendContent.Recommend=new Class({Implements:[Options,Events],options:{type:"recommend"},initialize:function(t,e){this.setOptions(e),this.content=t,this.app=this.content.app,this.actions=this.app.actions,this.container=this.content.container,this.page=1,this.pageSize=3,this.querydata={orderBy:"recommend",isAsc:"true"},this.load()},load:function(){this.loadItemsRes()},loadItemsRes:function(){this.actions.MarketAction.listPaging(this.page,this.pageSize,this.querydata,function(t){t.data&&t.data.length?this.loadItems(t.data):this.emptyLoadContent(),this.fireEvent("load")}.bind(this))},reload:function(){this.content.isLoading||this.loadItemsRes()},emptyLoadContent:function(){this.container.empty(),this.container.removeClass("o2_homepage_area_content_loading").removeClass("icon_loading"),this.content.noItemNode=new Element("div.o2_appMarket_content_empty_node",{text:this.app.lp.noRecommend}).inject(this.container);var t=(this.content.contentHeight-this.content.noItemNode.getSize().y)/2;this.content.noItemNode.setStyle("margin-top",t+"px"),this.content.isLoading=!1},loadItems:function(t){t.each(function(t,e){this.loadItem(t,e)}.bind(this))},loadItem:function(t,e){var n,i;0==e&&(n=this.content.recommendBiggestPic,apptext=this.content.recommendBiggestTitle,i=this.content.leftCoverNode),1==e&&(n=this.content.recommendRightTopPic,apptext=this.content.recommendRightTopTitle,i=this.content.rightTopCoverNode),2==e&&(n=this.content.recommendRightBottomPic,apptext=this.content.recommendRightBottomTitle,i=this.content.rightBottomCoverNode),this.actions.MarketAction.getCoverPic(t.id,function(t){t.data&&t.data.value&&n.setStyle("background-image","url(data:image/png;base64,"+t.data.value+")")}.bind(this)),apptext.set("text",t.name);var o=this;i.store("data",t),i.addEvents({mouseover:function(){},mouseout:function(){},click:function(t){var e=this.retrieve("data");e&&o.open(t,e)}})},open:function(t,e){var n={};n.appid=e.id,n.appname=e.name,layout.openApplication(t,"AppMarketV2.Application",n)}});