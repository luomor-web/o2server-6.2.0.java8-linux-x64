MWF.xDesktop.requireApp("cms.ColumnManager","package",null,!1),MWF.xApplication.cms.ColumnManager.RestActions=new Class({initialize:function(s){this.actions=s,this.designAddress=""},listApplicationAddress:function(s,e){var t=this.actions.listAddress;t=this.actions.slotHost+t;var i=new MWF.xApplication.cms.ColumnManager.RestActions.Callback(s,e);MWF.getJSON(t,i)},getDesignAddress:function(s,e){this.designAddress="http://xa01.zoneland.net:9080/x_processplatform_core_designer",s&&s.apply()},request:function(s,e,t,i){this.designAddress?this["_"+t](s,e,i):this.getDesignAddress(function(n){this["_"+t](s,e,i)}.bind(this),e)},_getId:function(s,e,t){var i=this.designAddress+this.actions.getId;i=i.replace(/{count}/g,t);var n=new MWF.xApplication.cms.ColumnManager.RestActions.Callback(s,e);MWF.getJSON(i,n)},getId:function(s,e,t){this.request(e,t,"getId",s)},getUUID:function(){this.designAddress||this.getDesignAddress();var s=this.designAddress+this.actions.getId;s=s.replace(/{count}/g,"1");var e="",t=new MWF.xApplication.cms.ColumnManager.RestActions.Callback((function(s){e=s.data[0].id}),null);return MWF.getJSON(s,t,!1),e},_listFormCategory:function(s,e,t){var i=this.designAddress+this.actions.listFormCategory;i=(i=i.replace(/{id}/g,t.lastId?t.lastId:"(0)")).replace(/{count}/g,t.count?t.count:"20");var n=new MWF.xApplication.cms.ColumnManager.RestActions.Callback(s,e);MWF.getJSON(i,n)},listFormCategory:function(s,e,t,i){this.request(t,i,"listFormCategory",{lastId:s,count:e})},_listProcessCategory:function(s,e,t){var i=this.designAddress+this.actions.listProcessCategory;i=(i=i.replace(/{id}/g,t.lastId?t.lastId:"(0)")).replace(/{count}/g,t.count?t.count:"20");var n=new MWF.xApplication.cms.ColumnManager.RestActions.Callback(s,e);MWF.getJSON(i,n)},listProcessCategory:function(s,e,t,i){this.request(t,i,"listProcessCategory",{lastId:s,count:e})},_listForm:function(s,e,t){var i=this.designAddress+this.actions.listForm;i=(i=(i=i.replace(/{cid}/g,t.category)).replace(/{id}/g,t.last?t.last:"(0)")).replace(/{count}/g,t.count?t.count:"20");var n=new MWF.xApplication.cms.ColumnManager.RestActions.Callback(s,e);MWF.getJSON(i,n)},listForm:function(s,e,t,i,n){this.request(i,n,"listForm",{category:s,last:e,count:t})},_listProcess:function(s,e,t){var i=this.designAddress+this.actions.listProcess;i=(i=(i=i.replace(/{cid}/g,t.category)).replace(/{id}/g,t.last?t.last:"(0)")).replace(/{count}/g,t.count?t.count:"20");var n=new MWF.xApplication.cms.ColumnManager.RestActions.Callback(s,e);MWF.getJSON(i,n)},listProcess:function(s,e,t,i,n){this.request(i,n,"listProcess",{category:s,last:e,count:t})},_getForm:function(s,e,t){var i=this.designAddress+this.actions.getForm;i=i.replace(/{id}/g,t);var n=new MWF.xApplication.cms.ColumnManager.RestActions.Callback(s,e);MWF.getJSON(i,n)},getForm:function(s,e,t){this.request(e,t,"getForm",s)},_getProcess:function(s,e,t){var i=this.designAddress+this.actions.getProcess;i=i.replace(/{id}/g,t);var n=new MWF.xApplication.cms.ColumnManager.RestActions.Callback(s,e);MWF.getJSON(i,n)},getProcess:function(s,e,t){this.request(e,t,"getProcess",s)},_getProcessCategory:function(s,e,t){var i=this.designAddress+this.actions.getProcessCategory;i=i.replace(/{id}/g,t);var n=new MWF.xApplication.cms.ColumnManager.RestActions.Callback(s,e);MWF.getJSON(i,n)},getProcessCategory:function(s,e,t){this.request(e,t,"getProcessCategory",s)},_getFormCategory:function(s,e,t){var i=this.designAddress+this.actions.getFormCategory;i=i.replace(/{id}/g,t);var n=new MWF.xApplication.cms.ColumnManager.RestActions.Callback(s,e);MWF.getJSON(i,n)},getFormCategory:function(s,e,t){this.request(e,t,"getFormCategory",s)},saveProcessCategory:function(s,e,t){this.designAddress?s.id?this.updateProcessCategory(s,e,t):this.addProcessCategory(s,e,t):this.getDesignAddress(function(i){s.id?this.updateProcessCategory(s,e,t):this.addProcessCategory(s,e,t)}.bind(this),t)},updateProcessCategory:function(s,e,t){var i=this.designAddress+this.actions.updataProcessCategory;i=i.replace(/{id}/g,s.id);var n=new MWF.xApplication.cms.ColumnManager.RestActions.Callback(e,t);MWF.restful("PUT",i,JSON.encode(s),n)},addProcessCategory:function(s,e,t){this.getId(1,function(i){s.id=i.data[0].id;var n=this.designAddress+this.actions.addProcessCategory,o=new MWF.xApplication.cms.ColumnManager.RestActions.Callback(e,t);MWF.restful("POST",n,JSON.encode(s),o)}.bind(this))},saveProcess:function(s,e,t){this.designAddress?s.isNewProcess?this.addProcess(s,e,t):this.updateProcess(s,e,t):this.getDesignAddress(function(i){s.isNewProcess?this.addProcess(s,e,t):this.updateProcess(s,e,t)}.bind(this),t)},addProcess:function(s,e,t){var i=this.designAddress+this.actions.addProcess;i=i.replace(/{id}/g,s.categoryId);var n=new MWF.xApplication.cms.ColumnManager.RestActions.Callback(e,t);MWF.restful("POST",i,JSON.encode(s),n)},updateProcess:function(s,e,t){var i=this.designAddress+this.actions.updataProcess;i=i.replace(/{id}/g,s.id);var n=new MWF.xApplication.cms.ColumnManager.RestActions.Callback(e,t);MWF.restful("PUT",i,JSON.encode(s),n)},_deleteProcess:function(s,e,t){var i=this.designAddress+this.actions.removeProcess;i=i.replace(/{id}/g,t);var n=new MWF.xApplication.cms.ColumnManager.RestActions.Callback(s,e);MWF.restful("DELETE",i,"",n)},deleteProcess:function(s,e,t){this.request(e,t,"deleteProcess",s)},saveFormCategory:function(s,e,t){this.designAddress?s.id?this.updateFormCategory(s,e,t):this.addFormCategory(s,e,t):this.getDesignAddress(function(i){s.id?this.updateFormCategory(s,e,t):this.addFormCategory(s,e,t)}.bind(this),t)},updateFormCategory:function(s,e,t){var i=this.designAddress+this.actions.updataFormCategory;i=i.replace(/{id}/g,s.id);var n=new MWF.xApplication.cms.ColumnManager.RestActions.Callback(e,t);MWF.restful("PUT",i,JSON.encode(s),n)},addFormCategory:function(s,e,t){this.getId(1,function(i){s.id=i.data[0].id;var n=this.designAddress+this.actions.addFormCategory,o=new MWF.xApplication.cms.ColumnManager.RestActions.Callback(e,t);MWF.restful("POST",n,JSON.encode(s),o)}.bind(this))},saveForm:function(s,e,t){this.designAddress?s.isNewForm?this.addForm(s,e,t):this.updateForm(s,e,t):this.getDesignAddress(function(i){s.isNewForm?this.addForm(s,e,t):this.updateForm(s,e,t)}.bind(this),t)},updateForm:function(s,e,t){var i=this.designAddress+this.actions.updataForm;i=i.replace(/{id}/g,s.json.id);var n=new MWF.xApplication.cms.ColumnManager.RestActions.Callback(e,t),o=MWF.encodeJsonString(JSON.encode(s)),a='{"id":"'+s.json.id+'", "data":"'+o+'", "name":"'+s.json.name+'", "alias":"'+s.json.name+'", "description":"'+s.json.description+'", "formCategory": "'+s.json.formCategory+'"}';MWF.restful("PUT",i,a,n)},addForm:function(s,e,t){var i=this.designAddress+this.actions.addForm;i=i.replace(/{id}/g,s.json.categoryId);var n=new MWF.xApplication.cms.ColumnManager.RestActions.Callback(e,t),o=MWF.encodeJsonString(JSON.encode(s)),a='{"id":"'+s.json.id+'", "data": "'+o+'", "name":"'+s.json.name+'", "alias":"'+s.json.name+'", "description":"'+s.json.description+'", "formCategory": "'+s.json.formCategory+'"}';MWF.restful("POST",i,a,n)},_deleteForm:function(s,e,t){var i=this.designAddress+this.actions.removeForm;i=i.replace(/{id}/g,t);var n=new MWF.xApplication.cms.ColumnManager.RestActions.Callback(s,e);MWF.restful("DELETE",i,"",n)},deleteForm:function(s,e,t){this.request(e,t,"deleteForm",s)}}),MWF.xApplication.cms.ColumnManager.RestActions.Callback=new Class({initialize:function(s,e,t,i){this.success=s,this.failure=e,this.appendSuccess=t,this.appendFailure=i},onSuccess:function(s,e){switch(s.type){case"success":this.appendSuccess&&this.appendSuccess(s),this.success&&this.success(s);break;case"warn":MWF.xDesktop.notice("info",{x:"right",y:"top"},s.errorMessage.join("\n")),this.appendSuccess&&this.appendSuccess(s),this.success&&this.success(s);break;case"error":this.doError(null,e,s.message)}},onRequestFailure:function(s){this.doError(s,"","")},onFailure:function(s){this.doError(s,"","")},onError:function(s,e){this.doError(null,s,e)},doError:function(s,e,t){if(this.appendFailure&&this.appendFailure(s,e,t),this.failure&&this.failure(s,e,t),!this.failure&&!this.appendFailure){var i=t;s&&(i=s.responseText),MWF.xDesktop.notice("error",{x:"right",y:"top"},"request json error: "+i)}}});