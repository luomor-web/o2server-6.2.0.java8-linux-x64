MWF.xApplication.query=MWF.xApplication.query||{},MWF.xApplication.query.StatementDesigner=MWF.xApplication.query.StatementDesigner||{},MWF.APPDSMD||(MWF.APPDSMD=MWF.xApplication.query.StatementDesigner),MWF.xApplication.query.StatementDesigner.widget=MWF.xApplication.query.StatementDesigner.widget||{},MWF.APPDSMD.LP||MWF.xDesktop.requireApp("query.StatementDesigner","lp."+MWF.language,null,!1),MWF.xApplication.query.StatementDesigner.widget.ViewFilter=new Class({Implements:[Options,Events],Extends:MWF.widget.Common,options:{style:"default",type:"identity",withForm:!1,names:[]},initialize:function(t,e,i,a){this.setOptions(a),this.node=$(t),this.app=e,this.filtrData=i,this.path="../x_component_query_StatementDesigner/widget/$ViewFilter/",this.cssPath="../x_component_query_StatementDesigner/widget/$ViewFilter/"+this.options.style+"/css.wcss",this._loadCss(),this.items=[],this.load()},load:function(t){var e=function(){this.getInputNodes(),this.createActionNode(),this.loadData()}.bind(this);this.app.statement&&this.app.statement.data?(this.statementData=this.app.statement.data,e()):this.options.statementId?o2.Actions.load("x_query_assemble_designer").StatementAction.get(this.options.statementId,function(t){this.statementData=t.data,e()}.bind(this)):e()},loadData:function(){this.filtrData.parameterData&&this.filtrData.parameterData.length&&this.parameterListAreaNode&&this.filtrData.parameterData.each(function(t){t.type="parameter",this.items.push(new MWF.xApplication.query.StatementDesigner.widget.ViewFilter.ItemParameter(this,t))}.bind(this)),this.filtrData.filtrData&&this.filtrData.filtrData.length&&this.filterListAreaNode&&this.filtrData.filtrData.each(function(t){t.type="filter",this.items.push(new MWF.xApplication.query.StatementDesigner.widget.ViewFilter.ItemFilter(this,t))}.bind(this)),this.filtrData.customData&&this.filtrData.customData.length&&this.customFilterListAreaNode&&this.filtrData.customData.each(function(t){t.type="custom",this.items.push(new MWF.xApplication.query.StatementDesigner.widget.ViewFilter.ItemCustom(this,t))}.bind(this))},createScriptArea:function(t){this.scriptValueArea=t;var e=t.get("title");MWF.require("MWF.widget.ScriptArea",function(){this.scriptArea=new MWF.widget.ScriptArea(t,{title:e,maxObj:this.app.formContentNode||this.app.pageContentNode,onChange:function(){this.scriptData=this.scriptArea.toJson()}.bind(this),onSave:function(){}.bind(this),style:"formula"});var i=this.scriptData?this.scriptData.code:"";this.scriptArea.load(i)}.bind(this))},createParameterValueScriptArea:function(t){var e=t.get("title");MWF.require("MWF.widget.ScriptArea",function(){this.parameterValueScriptArea=new MWF.widget.ScriptArea(t,{title:e,isload:!0,isbind:!1,maxObj:this.app.formContentNode||this.app.pageContentNode,onChange:function(){this.parameterValueScriptData=this.parameterValueScriptArea.toJson()}.bind(this),onSave:function(){}.bind(this),style:"formula"});var i=this.parameterValueScriptData?this.parameterValueScriptData.code:"";this.parameterValueScriptArea.load(i)}.bind(this))},createCustomFilterValueScriptArea:function(t){var e=t.get("title");MWF.require("MWF.widget.ScriptArea",function(){this.customFilterValueScriptArea=new MWF.widget.ScriptArea(t,{title:e,isload:!0,isbind:!1,maxObj:this.app.formContentNode||this.app.pageContentNode,onChange:function(){this.customFilterValueScriptData=this.customFilterValueScriptArea.toJson()}.bind(this),onSave:function(){}.bind(this),style:"formula"});var i=this.customFilterValueScriptData?this.customFilterValueScriptData.code:"";this.customFilterValueScriptArea.load(i)}.bind(this))},getInputNodes:function(){this.inputAreaNode=this.node.getElement(".inputAreaNode_vf"),this.actionAreaNode=this.node.getElement(".actionAreaNode_vf"),this.actionAreaNode.setStyles(this.css.actionAreaNode),this.filterListAreaNode=this.node.getElement(".filterListAreaNode_vf"),this.parameterListAreaNode=this.node.getElement(".parameterListAreaNode_vf"),this.customFilterListAreaNode=this.node.getElement(".customFilterListAreaNode_vf"),this.restrictViewFilterTable=this.node.getElement(".restrictViewFilterTable_vf");var t=this.node.getElement(".MWFFilterFormulaArea");if(t&&this.createScriptArea(t),this.titleInput=this.inputAreaNode.getElement(".titleInput_vf"),this.pathInput=this.inputAreaNode.getElement(".pathInput_vf"),this.pathInputSelect=this.inputAreaNode.getElement(".pathInputSelect_vf"),this.parameterInput=this.inputAreaNode.getElement(".parameterInput_vf"),this.datatypeInput=this.inputAreaNode.getElement(".datatypeInput_vf"),this.restrictParameterInput=this.inputAreaNode.getElement(".restrictParameterInput_vf"),this.restrictFilterInput=this.inputAreaNode.getElement(".restrictFilterInput_vf"),this.customFilterInput=this.inputAreaNode.getElement(".customFilterInput_vf"),this.comparisonInput=this.inputAreaNode.getElement(".comparisonInput_vf"),this.valueTextInput=this.inputAreaNode.getElement(".valueTextInput_vf"),this.valueNumberInput=this.inputAreaNode.getElement(".valueNumberInput_vf"),this.valueDatetimeInput=this.inputAreaNode.getElement(".valueDatetimeInput_vf"),this.valueBooleanInput=this.inputAreaNode.getElement(".valueBooleanInput_vf"),this.valueDateInput=this.inputAreaNode.getElement(".valueDateInput_vf"),this.valueTimeInput=this.inputAreaNode.getElement(".valueTimeInput_vf"),this.app.statement&&this.app.statement.view){var e=this.app.statement.view.data.id;this.parameterValueType=this.inputAreaNode.getElements("[name='"+e+"viewParameterValueType']"),this.parameterValueScriptDiv=this.inputAreaNode.getElement("#"+e+"viewParameterValueScriptDiv"),this.parameterValueScript=this.inputAreaNode.getElement("[name='"+e+"viewParameterValueScript']"),this.parameterValueScript&&this.createParameterValueScriptArea(this.parameterValueScript),this.customFilterValueTypes=this.inputAreaNode.getElements("[name='"+e+"viewCustomFilterValueType']"),this.customFilterValueScriptDiv=this.inputAreaNode.getElement("#"+e+"viewCustomFilterValueScriptDiv"),this.customFilterValueScript=this.inputAreaNode.getElement("[name='"+e+"viewCustomFilterValueScript']"),this.customFilterValueScript&&this.createCustomFilterValueScriptArea(this.customFilterValueScript)}MWF.require("MWF.widget.Calendar",function(){this.calendar=new MWF.widget.Calendar(this.valueDatetimeInput,{style:"xform",isTime:!0,secondEnable:!0,target:this.app.content,format:"db",onComplate:function(){this.node.getElement("#"+id+"viewParameterDateFormulaSelector").getElements("input").set("checked",!1)}.bind(this)}),new MWF.widget.Calendar(this.valueDateInput,{style:"xform",isTime:!1,target:this.app.content,format:"%Y-%m-%d"}),new MWF.widget.Calendar(this.valueTimeInput,{style:"xform",timeOnly:!0,secondEnable:!0,target:this.app.content,format:"%H:%M:%S"})}.bind(this)),this.datatypeInput.addEvent("change",function(){this.switchInputDisplay()}.bind(this)),this.valueTextInput.addEvent("keydown",function(t){13==t.code&&this.modifyOrAddFilterItem()}.bind(this)),this.valueNumberInput.addEvent("keydown",function(t){13==t.code&&this.modifyOrAddFilterItem()}.bind(this)),this.pathInputSelect.addEvent("change",function(t){var e=t.target.options[t.target.selectedIndex];if(this.verificationNode&&this.verificationNode.destroy(),this.statementData){e.retrieve("type");var i=this.statementData,a=e.retrieve("field");if(a){if(this.titleInput.set("value",(a.description||a.name).replace(/\./g,"")),a.name){var s=this.pathInput.get("value");if(s.indexOf(".")>-1)s=s.split(".")[0]+"."+a.name;else{var n,r=e.retrieve("tableName");if(i.data.indexOf(r)>-1){var o=i.data.split(r)[1].trim();o.indexOf(" ")&&(n=o.split(" ")[0])}s=n?n+"."+a.name:a.name}this.pathInput.set("value",s)}if(a.type){var l;switch((a.type||"string").toLowerCase()){case"string":case"stringList":case"stringLob":case"stringMap":l="textValue";break;case"integer":case"long":case"double":case"integerList":case"longList":case"doubleList":l="numberValue";break;case"dateTime":case"date":l="dateTimeValue";break;case"time":l="timeValue";break;case"boolean":case"booleanList":l="booleanValue";break;default:l="textValue"}for(var u=0;u<this.datatypeInput.options.length;u++)if(this.datatypeInput.options[u].value===l){this.datatypeInput.options[u].set("selected",!0),this.switchInputDisplay(),this.datatypeInput.onchange&&this.datatypeInput.onchange();break}}}else this.titleInput.set("value",""),this.pathInput.set("value",""),this.datatypeInput.options[0].set("selected",!0),this.switchInputDisplay(),this.datatypeInput.onchange&&this.datatypeInput.onchange()}}.bind(this)),this.setPathInputSelectOptions()},setPathInputSelectOptions:function(){if(this.pathInputSelect.empty(),this.statementData){var t=this.statementData,e=function(e){o2.Actions.load("x_query_assemble_designer").QueryAction.getEntityProperties("dynamic"===t.entityCategory?t.table:t.entityClassName,t.entityCategory,function(i){var a=this.pathInput.get("value").split("."),s=a[1]?a[1]:a[0],n=new Element("option",{text:"",value:""}).inject(this.pathInputSelect);n.store("type",t.entityCategory),n.store("tableName",e),(i.data||[]).each(function(i){var a=new Element("option",{text:i.name+(i.description?"-"+i.description:""),value:i.name,selected:i.name===s}).inject(this.pathInputSelect);a.store("field",i),a.store("type",t.entityCategory),a.store("tableName",e)}.bind(this))}.bind(this))}.bind(this);"dynamic"===t.entityCategory?t.table&&o2.Actions.load("x_query_assemble_designer").TableAction.get(t.table,(function(t){e(t.data.name)})):e(t.entityClassName.split(".").getLast())}},resetStatementData:function(t,e){t&&"none"!==t?(this.options.statementId=t,o2.Actions.load("x_query_assemble_designer").StatementAction.get(t,function(t){this.statementData=t.data,this.setPathInputSelectOptions(),e&&e()}.bind(this))):(this.options.statementId="",this.statementData=null,this.setPathInputSelectOptions(),e&&e())},switchInputDisplay:function(){var t=this.datatypeInput.options[this.datatypeInput.selectedIndex].value;if(!this.options.withForm){var e="";this.app.statement&&this.app.statement.view&&(e=this.app.statement.view.data.id);var i={textValue:{selectorArea:"#"+e+"viewParameterTextFormulaSelector",input:this.valueTextInput},datetimeValue:{selectorArea:"#"+e+"viewParameterDateFormulaSelector",input:this.valueDatetimeInput},dateTimeValue:{selectorArea:"#"+e+"viewParameterDateFormulaSelector",input:this.valueDatetimeInput},dateValue:{selectorArea:"#"+e+"viewParameterDateOnlyFormulaSelector",input:this.valueDateInput},timeValue:{selectorArea:"#"+e+"viewParameterTimeOnlyFormulaSelector",input:this.valueTimeInput},numberValue:{input:this.valueNumberInput},booleanValue:{input:this.valueBooleanInput}},a=["#"+e+"viewParameterTextFormulaSelector","#"+e+"viewParameterDateFormulaSelector","#"+e+"viewParameterDateOnlyFormulaSelector","#"+e+"viewParameterTimeOnlyFormulaSelector"],s=[this.valueTextInput,this.valueDatetimeInput,this.valueDateInput,this.valueTimeInput,this.valueNumberInput,this.valueBooleanInput];a.each(function(t){var e=this.inputAreaNode.getElement(t);e&&e.setStyle("display","none")}.bind(this)),s.each(function(t){t.setStyle("display","none")}.bind(this));var n=i[t];if(n){if(n.selectorArea){var r=this.inputAreaNode.getElement(n.selectorArea);r&&r.setStyle("display","block")}n.input&&n.input.setStyle("display","block")}}if(this.comparisonInput){var o={textValue:["equals","notEquals","greaterThan","greaterThanOrEqualTo","lessThan","lessThanOrEqualTo","like","notLike"],numberValue:["equals","notEquals","greaterThan","greaterThanOrEqualTo","lessThan","lessThanOrEqualTo"],dateTimeValue:["equals","notEquals","greaterThan","greaterThanOrEqualTo","lessThan","lessThanOrEqualTo"],dateValue:["equals","notEquals","greaterThan","greaterThanOrEqualTo","lessThan","lessThanOrEqualTo"],timeValue:["equals","notEquals","greaterThan","greaterThanOrEqualTo","lessThan","lessThanOrEqualTo"],booleanValue:["equals","notEquals"]}[t],l=this.comparisonInput.options,u=l[this.comparisonInput.selectedIndex].value;if(!this.originalComparisonOptions){this.originalComparisonOptions=[];for(var h=0;h<l.length;h++)this.originalComparisonOptions.push({text:l[h].text,value:l[h].value})}for(;this.comparisonInput.options&&this.comparisonInput.options.length;)this.comparisonInput.options[0].destroy();for(h=0;h<this.originalComparisonOptions.length;h++){var p=this.originalComparisonOptions[h];if(o.contains(p.value)){var c=new Element("option",{text:p.text,value:p.value}).inject(this.comparisonInput);p.value===u&&(c.selected=!0)}}}},createActionNode:function(){this.actionNode=new Element("div",{styles:this.css.actionNode}).inject(this.actionAreaNode),this.actionNode.addEvent("click",function(){this.modifyOrAddFilterItem()}.bind(this))},modifyOrAddFilterItem:function(){var t,e;this.currentItem?t=this.modifyFilterItem():this.restrictFilterInput&&this.restrictFilterInput.checked?(t=this.addFilterItem(),e="filter"):this.restrictParameterInput&&this.restrictParameterInput.checked?(t=this.addParameterItem(),e="parameter"):(t=this.addCustomFilterItem(),e="custom"),t&&this.setData({logic:"and",path:"",parameter:"",title:"",type:e,comparison:"equals",formatType:"textValue",value:"",otherValue:"",code:""})},modifyFilterItem:function(){var t=this.getInputData();if(this.restrictFilterInput&&this.restrictFilterInput.checked){if(this.verificationDataWithForm(t))return this.currentItem.reload(t),this.currentItem.unSelected(),this.fireEvent("change"),!0}else if(this.restrictParameterInput&&this.restrictParameterInput.checked){if(this.verificationData(t))return this.currentItem.reload(t),this.currentItem.unSelected(),this.fireEvent("change"),!0}else if(this.verificationDataCustom(t))return this.currentItem.reload(t),this.currentItem.unSelected(),this.fireEvent("change"),!0;return!1},addParameterItem:function(){var t=this.getInputData();return!!this.verificationData(t)&&(this.items.push(new MWF.xApplication.query.StatementDesigner.widget.ViewFilter.ItemParameter(this,t)),this.fireEvent("change"),!0)},addCustomFilterItem:function(){var t=this.getInputData();return!!this.verificationDataCustom(t)&&(this.items.push(new MWF.xApplication.query.StatementDesigner.widget.ViewFilter.ItemCustom(this,t)),this.fireEvent("change"),!0)},addFilterItem:function(){var t=this.getInputData();return!!this.verificationDataWithForm(t)&&(this.items.push(new MWF.xApplication.query.StatementDesigner.widget.ViewFilter.ItemFilter(this,t)),this.fireEvent("change"),!0)},verificationData:function(t){return!(this.parameterInput&&!t.parameter)||(this.verificationNode=new Element("div",{styles:this.css.verificationNode}).inject(this.inputAreaNode),new Element("div",{styles:this.css.verificationTextNode,text:MWF.APPDSMD.LP.mastInputParameter}).inject(this.verificationNode),this.parameterInput.focus(),this.parameterInput.setStyle("background-color","#fbe8e8"),this.parameterInput.addEvents({keydown:function(){this.verificationNode&&(this.verificationNode.destroy(),this.verificationNode=null,this.parameterInput.setStyle("background-color","#FFF"))}.bind(this),click:function(){this.verificationNode&&(this.verificationNode.destroy(),this.verificationNode=null)}.bind(this)}),!1)},verificationDataCustom:function(t){if(!t.title)return this.verificationNode=new Element("div",{styles:this.css.verificationNode}).inject(this.inputAreaNode),new Element("div",{styles:this.css.verificationTextNode,text:MWF.APPDSMD.LP.mastInputTitle}).inject(this.verificationNode),this.titleInput.focus(),this.titleInput.setStyle("background-color","#fbe8e8"),this.titleInput.addEvents({keydown:function(){this.verificationNode&&(this.verificationNode.destroy(),this.verificationNode=null,this.titleInput.setStyle("background-color","#FFF"))}.bind(this),click:function(){this.verificationNode&&(this.verificationNode.destroy(),this.verificationNode=null)}.bind(this)}),!1;if(!t.path||t.path.indexOf(".")<1){this.verificationNode=new Element("div",{styles:this.css.verificationNode}).inject(this.inputAreaNode);var e=t.path?MWF.APPDSMD.LP.pathExecption:MWF.APPDSMD.LP.mastInputPath;return new Element("div",{styles:this.css.verificationTextNode,text:e}).inject(this.verificationNode),this.pathInput.focus(),this.pathInput.setStyle("background-color","#fbe8e8"),this.pathInput.addEvents({keydown:function(){this.verificationNode&&(this.verificationNode.destroy(),this.verificationNode=null,this.pathInput.setStyle("background-color","#FFF"))}.bind(this),click:function(){this.verificationNode&&(this.verificationNode.destroy(),this.verificationNode=null)}.bind(this)}),!1}return!0},verificationDataWithForm:function(t){if(!t.path||t.path.indexOf(".")<1){this.verificationNode=new Element("div",{styles:this.css.verificationNode}).inject(this.inputAreaNode);var e=t.path?MWF.APPDSMD.LP.pathExecption:MWF.APPDSMD.LP.mastInputPath;return new Element("div",{styles:this.css.verificationTextNode,text:e}).inject(this.verificationNode),this.pathInput.focus(),this.pathInput.setStyle("background-color","#fbe8e8"),this.pathInput.addEvents({keydown:function(){this.verificationNode&&(this.verificationNode.destroy(),this.verificationNode=null,this.pathInput.setStyle("background-color","#FFF"))}.bind(this),click:function(){this.verificationNode&&(this.verificationNode.destroy(),this.verificationNode=null)}.bind(this)}),!1}return!0},getInputData:function(){var t=this.pathInput.get("value"),e=this.parameterInput?this.parameterInput.get("value"):"",i=this.titleInput.get("value"),a="custom";this.restrictFilterInput&&this.restrictFilterInput.checked&&(a="filter"),this.restrictParameterInput&&this.restrictParameterInput.checked&&(a="parameter"),this.customFilterInput.checked&&(a="custom");var s="";this.comparisonInput&&(s=this.comparisonInput.options[this.comparisonInput.selectedIndex].value);var n=this.datatypeInput.options[this.datatypeInput.selectedIndex].value,r="";switch(n){case"textValue":r=this.valueTextInput.get("value")||"";break;case"numberValue":r=this.valueNumberInput.get("value").toFloat();break;case"datetimeValue":case"dateTimeValue":r=this.valueDatetimeInput.get("value")||"";break;case"dateValue":r=this.valueDateInput.get("value")||"";break;case"timeValue":r=this.valueTimeInput.get("value")||"";break;case"booleanValue":r="true"==(r=this.valueBooleanInput.options[this.valueBooleanInput.selectedIndex].value)}if("filter"===a)return{path:t,title:i,type:a,comparison:s,formatType:n,value:r,otherValue:"",code:this.scriptData};if("parameter"===a)return this.parameterValueType.each((function(t){t.get("checked")&&(o=t.get("value"))})),{parameter:e,title:i,type:a,formatType:n,value:r,code:this.scriptData,valueType:o,valueScript:this.parameterValueScriptData};var o="";return this.customFilterValueTypes.each((function(t){t.get("checked")&&(o=t.get("value"))})),{path:t,title:i,type:a,formatType:n,value:r,otherValue:"",code:this.scriptData,valueType:o,valueScript:this.customFilterValueScriptData}},setData:function(t){if(this.titleInput&&this.titleInput.set("value",t.title),this.pathInput&&this.pathInput.set("value",t.path),this.parameterInput&&this.parameterInput.set("value",t.parameter),this.comparisonInput)for(var e=0;e<this.comparisonInput.options.length;e++)if(this.comparisonInput.options[e].value===t.comparison){this.comparisonInput.options[e].set("selected",!0);break}for(e=0;e<this.datatypeInput.options.length;e++)if(this.datatypeInput.options[e].value===t.formatType){this.datatypeInput.options[e].set("selected",!0);break}var i=this.pathInput.get("value").split("."),a=i[1]?i[1]:i[0],s=!0;for(e=0;e<this.pathInputSelect.options.length;e++)if(this.pathInputSelect.options[e].value===a){this.pathInputSelect.options[e].set("selected",!0),s=!1;break}s&&this.pathInputSelect.options.length&&this.pathInputSelect.options[0].set("selected",!0),this.scriptData=t.code;try{this.scriptArea&&this.scriptArea.editor&&this.scriptArea.editor.setValue(this.scriptData.code)}catch(t){}if("parameter"===t.type)switch(t.formatType){case"textValue":this.valueTextInput.set("value",t.value);break;case"numberValue":this.valueNumberInput.set("value",t.value);break;case"datetimeValue":case"dateTimeValue":this.valueDatetimeInput.set("value",t.value);break;case"dateValue":this.valueDateInput.set("value",t.value);break;case"timeValue":this.valueTimeInput.set("value",t.value);break;case"booleanValue":for(e=0;e<this.valueBooleanInput.options.length;e++){var n=this.valueBooleanInput.options[e].value;if((n="true"==n)===t.value){this.valueBooleanInput.options[e].set("selected",!0);break}}}"custom"===t.type&&(this.customFilterValueTypes.each((function(e){t.valueType?t.valueType===e.get("value")&&e.set("checked",!0):"input"===e.get("value")&&e.set("checked",!0)})),this.customFilterValueScriptArea&&(t.valueType&&"input"!==t.valueType?(this.customFilterValueScriptDiv.show(),this.customFilterValueScriptData=t.valueScript,this.customFilterValueScriptArea.editor.setValue(t.valueScript?t.valueScript.code:"")):(this.customFilterValueScriptDiv.hide(),this.customFilterValueScriptData="",this.customFilterValueScriptArea.editor.setValue("")))),"parameter"===t.type&&(this.parameterValueType.each((function(e){t.valueType?t.valueType===e.get("value")&&e.set("checked",!0):"input"===e.get("value")&&e.set("checked",!0)})),this.parameterValueScriptArea&&(t.valueType&&"input"!==t.valueType?(this.parameterValueScriptDiv.show(),this.parameterValueScriptData=t.valueScript,this.parameterValueScriptArea.editor.setValue(t.valueScript?t.valueScript.code:"")):(this.parameterValueScriptDiv.hide(),this.parameterValueScriptData="",this.parameterValueScriptArea.editor.setValue("")))),this.switchInputDisplay(),this.datatypeInput.onchange&&this.datatypeInput.onchange()},deleteItem:function(t){this.currentItem==t&&t.unSelected(),this.items.erase(t),t.node.destroy(),MWF.release(t),this.fireEvent("change")},getData:function(){var t=[],e=[],i=[];return this.items.each(function(a){"custom"===a.data.type?e.push(a.data):"filter"===a.data.type?i.push(a.data):t.push(a.data)}.bind(this)),{parameterData:t,customData:e,filterData:i}}}),MWF.xApplication.query.StatementDesigner.widget.ViewFilter.ItemParameter=new Class({Implements:[Events],initialize:function(t,e){this.filter=t,this.data=e,this.container=this.filter.parameterListAreaNode,this.css=this.filter.css,this.app=this.filter.app,this.load()},load:function(){this.node=new Element("div",{styles:this.css.itemNode}).inject(this.container),this.deleteNode=new Element("div",{styles:this.css.itemDeleteNode}).inject(this.node),this.contentNode=new Element("div",{styles:this.css.itemContentNode}).inject(this.node),this.contentNode.set("text",this.getText()),this.contentNode.addEvent("click",function(){this.selected()}.bind(this)),this.deleteNode.addEvent("click",function(t){this.deleteItem(t)}.bind(this))},getText:function(){MWF.APPDSMD.LP.filter;return"numberValue"===this.data.formatType?this.data.title+" "+this.data.parameter+" "+this.data.value:this.data.title+" "+this.data.parameter+' "'+this.data.value+'"'},reload:function(t){this.data=t,this.contentNode.set("text",this.getText())},selected:function(){this.filter.verificationNode&&(this.filter.verificationNode.destroy(),this.filter.verificationNode=null,this.filter.parameterInput.setStyle("background-color","#FFF")),this.filter.restrictParameterInput.set("checked",!0),this.filter.restrictParameterInput.click(),this.filter.currentItem&&this.filter.currentItem.unSelected(),this.node.setStyles(this.css.itemNode_current),this.filter.currentItem=this,this.filter.setData(this.data)},unSelected:function(){this.node.setStyles(this.css.itemNode),this.filter.currentItem=null},deleteItem:function(t){var e=this;this.filter.app.confirm("warn",t,MWF.APPDSMD.LP.delete_filterItem_title,MWF.APPDSMD.LP.delete_filterItem,300,120,(function(){e.destroy(),this.close()}),(function(){this.close()}))},destroy:function(){this.filter.deleteItem(this)}}),MWF.xApplication.query.StatementDesigner.widget.ViewFilter.ItemCustom=new Class({Extends:MWF.xApplication.query.StatementDesigner.widget.ViewFilter.ItemParameter,initialize:function(t,e){this.filter=t,this.data=e,this.container=this.filter.customFilterListAreaNode,this.css=this.filter.css,this.app=this.filter.app,this.load()},selected:function(){this.filter.verificationNode&&(this.filter.verificationNode.destroy(),this.filter.verificationNode=null,this.filter.pathInput.setStyle("background-color","#FFF")),this.filter.customFilterInput.set("checked",!0),this.filter.customFilterInput.click(),this.filter.currentItem&&this.filter.currentItem.unSelected(),this.node.setStyles(this.css.itemNode_current),this.filter.currentItem=this,this.filter.setData(this.data)},getText:function(){MWF.APPDSMD.LP.filter;return this.data.title+"("+this.data.path+")"}}),MWF.xApplication.query.StatementDesigner.widget.ViewFilter.ItemFilter=new Class({Extends:MWF.xApplication.query.StatementDesigner.widget.ViewFilter.ItemParameter,initialize:function(t,e){this.filter=t,this.data=e,this.container=this.filter.filterListAreaNode,this.css=this.filter.css,this.app=this.filter.app,this.load()},selected:function(){this.filter.verificationNode&&(this.filter.verificationNode.destroy(),this.filter.verificationNode=null,this.filter.pathInput.setStyle("background-color","#FFF")),this.filter.restrictFilterInput.set("checked",!0),this.filter.restrictFilterInput.click(),this.filter.currentItem&&this.filter.currentItem.unSelected(),this.node.setStyles(this.css.itemNode_current),this.filter.currentItem=this,this.filter.setData(this.data)},getText:function(){MWF.APPDSMD.LP.filter;return this.data.title+"("+this.data.path+")"}});