{"version":3,"sources":["base.js","base_loader.js"],"names":["layout","window","desktop","type","locate","location","protocol","inBrowser","session","debugger","href","toString","indexOf","anonymous","o2","xApplication","xDesktop","requireApp","module","clazz","callback","async","readys","addReady","i","arguments","length","typeOf","isReady","apply","push","_openWork","options","o2android","openO2Work","workId","title","docTitle","workCompletedId","_openWorkAndroid","webkit","messageHandlers","postMessage","work","workCompleted","_openWorkIOS","redirectlink","URI","getData","encodeURIComponent","pathname","search","docurl","toURI","draft","JSON","stringify","setData","job","jobid","jobId","filterUrl","_openWorkHTML","_openApplicationMobile","appNames","statusObj","par","encode","openO2CmsDocument","documentId","docId","_openDocument","openO2CmsApplication","columnId","_openCms","openO2Meeting","_openMeeting","openO2Calendar","_openCalendar","tab","navi","toLowerCase","openO2WorkSpace","_openTaskCenter","uri","optionsStr","statusStr","openApplication","e","taskitem","notCurrent","substring","url","replace","a","Element","target","click","destroy","app","mobile","$openWithSelf","open","_openApplicationPC","appPath","split","appName","clazzName","baseObject","each","path","Object","clone","Common","bind","this","language","onFailure","_requireApp","appNamespace","appId","apps","setCurrent","event","status","widget","UUID","createTaskItem","isLoadApplication","load","appArr","appCurrentList","currentApp","mask","document","getElementById","_createNewApplication","refreshApp","recordStatus","_uri","port","get","u","node","$","body","m_status","option","topWindow","opener","openBrowserApp","openBrowserStatus","openBrowserOption","getFormDesignerStyle","formDesignerStyle","MWF","UD","json","data","styles","decode","style","implement","makeLnk","addEvent","d","addEvents","loadingNode","loadeds","size","getSize","_closeLoadingNode","_loadProgressBar","complete","setStyles","width","x","setTimeout","p","_setLayoutService","service","center","serviceAddressList","centerServer","_getDistribute","config","app_protocol","configMapping","host","hostname","mapping","servers","getServiceAddress","_load","tokenName","Cookie","dispose","domain","test","write","sessionPromise","Promise","resolve","reject","Actions","getAuthentication","languageName","lp","reload","xhr","text","error","then","user","token","name","roleList","yqwx","openLoginQywx","openLogin","shift","_loadApp","content","empty","authentication","Authentication","onLogin","loadLogin","fade","console","log","action","RestActions","getActions","actionCallback","actions","sso","method","invoke","parameter","code","success","failure","n","id","set","configLoaded","lpLoaded","commonLoaded","isDebugger","isMobile","loadModuls","require","onSuccess","onEvery","LP","getJSON"],"mappings":"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","file":"base.min.js","sourcesContent":["layout = window.layout || {};\nlayout.desktop = layout;\nlayout.desktop.type = \"app\";\nvar locate = window.location;\nlayout.protocol = locate.protocol;\nlayout.inBrowser = true;\nlayout.session = layout.session || {};\nlayout.debugger = (locate.href.toString().indexOf(\"debugger\") !== -1);\nlayout.anonymous = (locate.href.toString().indexOf(\"anonymous\") !== -1);\no2.xApplication = o2.xApplication || {};\n\no2.xDesktop = o2.xDesktop || {};\no2.xDesktop.requireApp = function (module, clazz, callback, async) {\n    o2.requireApp(module, clazz, callback, async);\n};\n\n(function (layout) {\n    layout.readys = [];\n    layout.addReady = function () {\n        for (var i = 0; i < arguments.length; i++) {\n            if (o2.typeOf(arguments[i]) === \"function\"){\n                if (layout.isReady){\n                    arguments[i].apply(window);\n                }else{\n                    layout.readys.push(arguments[i]);\n                }\n            }\n        }\n    };\n    var _requireApp = function (appNames, callback, clazzName) {\n        var appPath = appNames.split(\".\");\n        var baseObject = o2.xApplication;\n        appPath.each(function (path, i) {\n            if (i < (appPath.length - 1)) {\n                baseObject[path] = baseObject[path] || {};\n            } else {\n                baseObject[path] = baseObject[path] || { \"options\": Object.clone(o2.xApplication.Common.options) };\n            }\n            baseObject = baseObject[path];\n        }.bind(this));\n        if (!baseObject.options) baseObject.options = Object.clone(o2.xApplication.Common.options);\n\n        var _lpLoaded = false;\n\n        o2.xDesktop.requireApp(appNames, \"lp.\" + o2.language, {\n            \"onFailure\": function () {\n                o2.xDesktop.requireApp(appNames, \"lp.zh-cn\", null, false);\n            }.bind(this)\n        }, false);\n\n        o2.xDesktop.requireApp(appNames, clazzName, function () {\n            if (callback) callback(baseObject);\n        });\n    };\n    var _createNewApplication = function (e, appNamespace, appName, options, statusObj, inBrowser, taskitem, notCurrent) {\n        if (options) { options.event = e; } else { options = { \"event\": e }; }\n        var app = new appNamespace[\"Main\"](layout.desktop, options);\n        app.desktop = layout.desktop;\n        app.status = statusObj;\n        app.inBrowser = !!(inBrowser || layout.inBrowser);\n\n        if (layout.desktop.type === \"layout\") {\n            app.appId = (options.appId) ? options.appId : ((appNamespace.options.multitask) ? appName + \"-\" + (new o2.widget.UUID()) : appName);\n            app.options.appId = app.appId;\n\n            if (layout.desktop.createTaskItem){\n                if (!taskitem) taskitem = layout.desktop.createTaskItem(app);\n                app.taskitem = taskitem;\n                app.taskitem.app = app;\n            }\n\n            app.isLoadApplication = true;\n            app.load(!notCurrent);\n\n            if (!layout.desktop.apps) layout.desktop.apps = {};\n            if (layout.desktop.apps[app.appId]) {\n                var tmpApp = layout.desktop.apps[app.appId];\n\n            } else {\n                layout.desktop.apps[app.appId] = app;\n            }\n\n            layout.desktop.appArr.push(app);\n            layout.desktop.appCurrentList.push(app);\n            if (!notCurrent) layout.desktop.currentApp = app;\n        } else {\n            app.load(true);\n            layout.app = app;\n        }\n\n        var mask = document.getElementById(\"appContentMask\");\n        if (mask) mask.destroy();\n    };\n\n    var _openWorkAndroid = function (options) {\n        if (window.o2android && window.o2android.openO2Work) {\n            if (options.workId) {\n                window.o2android.openO2Work(options.workId, \"\", options.title || options.docTitle || \"\");\n            } else if (options.workCompletedId) {\n                window.o2android.openO2Work(\"\", options.workCompletedId, options.title || options.docTitle || \"\");\n            }\n            return true;\n        }\n        return false;\n    };\n    var _openWorkIOS = function (options) {\n        if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.openO2Work) {\n            if (options.workId) {\n                window.webkit.messageHandlers.openO2Work.postMessage({\n                    \"work\": options.workId,\n                    \"workCompleted\": \"\",\n                    \"title\": options.title || options.docTitle || \"\"\n                });\n            } else if (options.workCompletedId) {\n                window.webkit.messageHandlers.openO2Work.postMessage({\n                    \"work\": \"\",\n                    \"workCompleted\": options.workCompletedId,\n                    \"title\": options.title || options.docTitle || \"\"\n                });\n            }\n            return true;\n        }\n        return false;\n    };\n    var _openWorkHTML = function (options) {\n        var uri = new URI(window.location.href);\n        var redirectlink = uri.getData(\"redirectlink\");\n        if (!redirectlink) {\n            redirectlink = encodeURIComponent(locate.pathname + locate.search);\n        } else {\n            redirectlink = encodeURIComponent(redirectlink);\n        }\n        var docurl = \"../x_desktop/workmobilewithaction.html\".toURI();\n        if (options.draft){\n            var par = \"draft=\"+encodeURIComponent(JSON.stringify(options.draft));\n            docurl = \"../x_desktop/workmobilewithaction.html?\" + par;\n        }else{\n            docurl = docurl.setData(options).toString();\n        }\n        var job = (options.jobid || options.jobId || options.job);\n        if (job) docurl += ((docurl.indexOf(\"?\")!=-1) ? \"&\" : \"?\") + \"jobid=\"+job;\n        docurl += ((redirectlink) ? \"&redirectlink=\" + redirectlink : \"\");\n        docurl +=((layout.debugger) ? \"&debugger\" : \"\");\n\n        window.location = o2.filterUrl(docurl);\n    };\n    var _openWork = function (options) {\n        if (!_openWorkAndroid(options)) if (!_openWorkIOS(options)) _openWorkHTML(options);\n    };\n    var _openDocument = function (appNames, options, statusObj) {\n        var title = typeOf(options) === \"object\" ? (options.docTitle || options.title) : \"\";\n        title = title || \"\";\n        var par = \"app=\" + encodeURIComponent(appNames) + \"&status=\" + encodeURIComponent((statusObj) ? JSON.encode(statusObj) : \"\") + \"&option=\" + encodeURIComponent((options) ? JSON.encode(options) : \"\");\n        if (window.o2android && window.o2android.openO2CmsDocument) {\n            window.o2android.openO2CmsDocument(options.documentId, title);\n        } else if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.openO2CmsDocument) {\n            window.webkit.messageHandlers.openO2CmsDocument.postMessage({ \"docId\": options.documentId, \"docTitle\": title });\n        } else {\n            window.location = o2.filterUrl(\"../x_desktop/appMobile.html?\" + par + ((layout.debugger) ? \"&debugger\" : \"\"));\n        }\n    };\n    var _openCms = function (appNames, options, statusObj) {\n        var par = \"app=\" + encodeURIComponent(appNames) + \"&status=\" + encodeURIComponent((statusObj) ? JSON.encode(statusObj) : \"\") + \"&option=\" + encodeURIComponent((options) ? JSON.encode(options) : \"\");\n        if (window.o2android && window.o2android.openO2CmsApplication) {\n            window.o2android.openO2CmsApplication(options.columnId, options.title || \"\");\n        } else if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.openO2CmsApplication) {\n            window.webkit.messageHandlers.openO2CmsApplication.postMessage(options.columnId);\n        } else {\n            window.location = o2.filterUrl(\"../x_desktop/appMobile.html?\" + par + ((layout.debugger) ? \"&debugger\" : \"\"));\n        }\n    };\n    var _openMeeting = function (appNames, options, statusObj) {\n        var par = \"app=\" + encodeURIComponent(appNames) + \"&status=\" + encodeURIComponent((statusObj) ? JSON.encode(statusObj) : \"\") + \"&option=\" + encodeURIComponent((options) ? JSON.encode(options) : \"\");\n        if (window.o2android && window.o2android.openO2Meeting) {\n            window.o2android.openO2Meeting(\"\");\n        } else if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.openO2Meeting) {\n            window.webkit.messageHandlers.openO2Meeting.postMessage(\"\");\n        } else {\n            window.location = o2.filterUrl(\"../x_desktop/appMobile.html?\" + par + ((layout.debugger) ? \"&debugger\" : \"\"));\n        }\n    };\n\n    var _openCalendar = function (appNames, options, statusObj) {\n        var par = \"app=\" + encodeURIComponent(appNames) + \"&status=\" + encodeURIComponent((statusObj) ? JSON.encode(statusObj) : \"\") + \"&option=\" + encodeURIComponent((options) ? JSON.encode(options) : \"\");\n        if (window.o2android && window.o2android.openO2Calendar) {\n            window.o2android.openO2Calendar(\"\");\n        } else if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.openO2Calendar) {\n            window.webkit.messageHandlers.openO2Calendar.postMessage(\"\");\n        } else {\n            window.location = o2.filterUrl(\"../x_desktop/appMobile.html?\" + par + ((layout.debugger) ? \"&debugger\" : \"\"));\n        }\n    };\n    var _openTaskCenter = function (appNames, options, statusObj) {\n        var par = \"app=\" + encodeURIComponent(appNames) + \"&status=\" + encodeURIComponent((statusObj) ? JSON.encode(statusObj) : \"\") + \"&option=\" + encodeURIComponent((options) ? JSON.encode(options) : \"\");\n        var tab = ((options && options.navi) ? options.navi : \"task\").toLowerCase();\n        if (tab === \"done\") tab = \"taskCompleted\";\n        if (tab === \"readed\") tab = \"readCompleted\";\n\n        if (window.o2android && window.o2android.openO2WorkSpace) {\n            window.o2android.openO2WorkSpace(tab);\n        } else if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.openO2WorkSpace) {\n            window.webkit.messageHandlers.openO2WorkSpace.postMessage(tab);\n        } else {\n            window.location = o2.filterUrl(\"../x_desktop/appMobile.html?\" + par + ((layout.debugger) ? \"&debugger\" : \"\"));\n        }\n    };\n\n    var _openApplicationMobile = function (appNames, options, statusObj) {\n        switch (appNames) {\n            case \"process.Work\":\n                _openWork(options);\n                break;\n            case \"cms.Document\":\n                _openDocument(appNames, options, statusObj);\n                break;\n            case \"cms.Module\":\n                _openCms(appNames, options, statusObj);\n                break;\n            case \"Meeting\":\n                _openMeeting(appNames, options, statusObj);\n                break;\n            case \"Calendar\":\n                _openCalendar(appNames, options, statusObj);\n                break;\n            case \"process.TaskCenter\":\n                _openTaskCenter(appNames, options, statusObj);\n                break;\n            default:\n                var uri = new URI(window.location.href);\n                var optionsStr = uri.getData(\"option\");\n                var statusStr = uri.getData(\"status\");\n                window.location = o2.filterUrl(\"../x_desktop/appMobile.html?app=\" + appNames + \"&option=\" + (optionsStr || \"\") + \"&status=\" + (statusStr || \"\") + ((layout.debugger) ? \"&debugger\" : \"\"));\n        }\n    };\n\n    var _openWindow = function(url, par){\n        var a = new Element(\"a\", {\n            \"href\": url,\n            \"target\": par\n        });\n        a.click();\n        a.destroy();\n    };\n    var _openApplicationPC = function (appNames, options, statusObj) {\n        if (options) delete options.docTitle;\n        var par = \"app=\" + encodeURIComponent(appNames) + \"&status=\" + encodeURIComponent((statusObj) ? JSON.encode(statusObj) : \"\") + \"&option=\" + encodeURIComponent((options) ? JSON.encode(options) : \"\");\n        switch (appNames) {\n            case \"process.Work\":\n                var url = \"../x_desktop/work.html\".toURI();\n                if (options.draft){\n                    url = \"../x_desktop/app.html?\" + par;\n                }else{\n                    url = url.setData(options).toString();\n                }\n                var job = (options.jobid || options.jobId || options.job);\n                if (job) url += ((url.indexOf(\"?\")!=-1) ? \"&\" : \"?\") + \"jobid=\"+job;\n                url +=((layout.debugger) ? \"&debugger\" : \"\");\n\n                if (layout.app.$openWithSelf) {\n                    return window.location = o2.filterUrl(url);\n                } else {\n                    return window.open(o2.filterUrl(url), par);\n                }\n                break;\n            case \"cms.Document\":\n                // _openDocument(appNames, options, statusObj);\n                var url = \"../x_desktop/cmsdoc.html\".toURI();\n                url = url.setData(options).toString();\n                url +=((layout.debugger) ? \"&debugger\" : \"\");\n                if (layout.app.$openWithSelf) {\n                    return window.location = o2.filterUrl(url);\n                } else {\n                    return window.open(o2.filterUrl(url), par);\n                }\n                break;\n            // case \"cms.Module\":\n            //     _openCms(appNames, options, statusObj);\n            //     break;\n            // case \"Meeting\":\n            //     _openMeeting(appNames, options, statusObj);\n            //     break;\n            // case \"Calendar\":\n            //     _openCalendar(appNames, options, statusObj);\n            //     break;\n            // case \"process.TaskCenter\":\n            //     _openTaskCenter(appNames, options, statusObj);\n            //     break;\n            default:\n                if (layout.app.$openWithSelf) {\n                    return window.location = o2.filterUrl(\"../x_desktop/app.html?\" + par + ((layout.debugger) ? \"&debugger\" : \"\"));\n                } else {\n                    return window.open(o2.filterUrl(\"../x_desktop/app.html?\" + par + ((layout.debugger) ? \"&debugger\" : \"\")), par);\n                }\n        }\n    };\n\n    layout.openApplication = function (e, appNames, options, statusObj, inBrowser, taskitem, notCurrent) {\n        if (appNames.substring(0, 4) === \"@url\") {\n            var url = appNames.replace(/\\@url\\:/i, \"\");\n            var a = new Element(\"a\", { \"href\": url, \"target\": \"_blank\" });\n            a.click();\n            a.destroy();\n            a = null;\n            return true;\n        }\n\n        if (layout.app) {\n            if (layout.mobile) {\n                _openApplicationMobile(appNames, options, statusObj);\n            } else {\n                return _openApplicationPC(appNames, options, statusObj);\n            }\n        } else {\n            var appPath = appNames.split(\".\");\n            var appName = appPath[appPath.length - 1];\n            _requireApp(appNames, function (appNamespace) {\n                var appId = (options && options.appId) ? options.appId : ((appNamespace.options.multitask) ? \"\" : appName);\n\n                if (appId && layout.desktop.apps && layout.desktop.apps[appId]) {\n                    layout.desktop.apps[appId].setCurrent();\n                } else {\n                    if (options) options.appId = appId;\n                    _createNewApplication(e, appNamespace, appName, (options || { \"appId\": appId }), statusObj, inBrowser, taskitem, notCurrent);\n                }\n            }.bind(this));\n        }\n    };\n\n    layout.refreshApp = function (app) {\n        var status = app.recordStatus();\n\n        var _uri = new URI(window.location.href);\n        var appNames = _uri.getData(\"app\");\n        var optionsStr = _uri.getData(\"option\");\n        var statusStr = _uri.getData(\"status\");\n        if (status) statusStr = JSON.encode(status);\n\n        var port = _uri.get(\"port\");\n        var u = _uri.get(\"scheme\") + \"://\" + _uri.get(\"host\") + ((port && port!=\"80\") ? \":\" + port + \"/\" : \"\") + _uri.get(\"directory\") + _uri.get(\"file\") + \"?app=\" + encodeURIComponent(appNames) + \"&status=\" + encodeURIComponent(statusStr) + \"&option=\" + encodeURIComponent((optionsStr) ? JSON.encode(optionsStr) : \"\") + ((layout.debugger) ? \"&debugger\" : \"\");\n        u = o2.filterUrl(u);\n        window.location = u;\n    };\n\n    layout.load = function (appNames, options, statusObj) {\n        layout.apps = [];\n        layout.node = $(\"layout\") || $(\"appContent\") || document.body;\n        var appName = appNames, m_status = statusObj, option = options;\n\n        var topWindow = window.opener;\n        if (topWindow) {\n            try {\n                if (!appName) appName = topWindow.layout.desktop.openBrowserApp;\n                if (!m_status) m_status = topWindow.layout.desktop.openBrowserStatus;\n                if (!option) option = topWindow.layout.desktop.openBrowserOption;\n            } catch (e) { }\n        }\n        layout.openApplication(null, appName, option || {}, m_status);\n    };\n\n    layout.getFormDesignerStyle = function(callback){\n        if (!this.formDesignerStyle){\n            this.formDesignerStyle = \"default\";\n            MWF.UD.getData(\"formDesignerStyle\", function(json) {\n                if (json.data) {\n                    var styles = JSON.decode(json.data);\n                    this.formDesignerStyle = styles.style;\n                }\n                if (callback) callback();\n            }.bind(this));\n        }else{\n            if (callback) callback();\n        }\n    }\n\n})(layout);\n\n","o2.addReady(function () {\n     //兼容方法\n    if (window.Element){\n        Element.implement({\n            \"makeLnk\": function (options) { }\n        });\n    }\n    layout.desktop.addEvent = function (type, e, d) {\n        window.addEvent(type, e, d);\n    };\n    layout.desktop.addEvents = function (e) {\n        window.addEvents(e);\n    };\n\n    var loadingNode = (window.$) ? $(\"loaddingArea\") : null;\n    var loadeds = 0;\n    var loadCount = 4;\n    var size = (window.document && document.body) ? document.body.getSize() : null;\n    var _closeLoadingNode = function () {\n        if (loadingNode) {\n            loadingNode.destroy();\n            loadingNode = null;\n        }\n    };\n    var _loadProgressBar = function (complete) {\n        if (loadingNode) {\n            if (complete) {\n                loadingNode.setStyles({ \"width\": \"\" + size.x + \"px\" });\n                //loadingNode.set('morph', {duration: 100}).morph({\"width\": \"\"+size.x+\"px\"});\n                window.setTimeout(_closeLoadingNode, 500);\n            } else {\n                loadeds++;\n                var p = (loadeds / loadCount) * size.x;\n                loadingNode.setStyles({ \"width\": \"\" + p + \"px\" });\n                //loadingNode.set('morph', {duration: 100}).morph({\"width\": \"\"+p+\"px\"});\n                if (loadeds >= loadCount) window.setTimeout(_closeLoadingNode, 500);\n            }\n        }\n    };\n\n    var _setLayoutService = function(service, center){\n        layout.serviceAddressList = service;\n        layout.centerServer = center;\n        layout.desktop.serviceAddressList = service;\n        layout.desktop.centerServer = center;\n    };\n    var _getDistribute = function (callback) {\n\n        if (layout.config.app_protocol === \"auto\") {\n            layout.config.app_protocol = window.location.protocol;\n        }\n\n        if (layout.config.configMapping && (layout.config.configMapping[window.location.host] || layout.config.configMapping[window.location.hostname])){\n            var mapping = layout.config.configMapping[window.location.host] || layout.config.configMapping[window.location.hostname];\n            if (mapping.servers){\n                layout.serviceAddressList = mapping.servers;\n                layout.desktop.serviceAddressList = mapping.servers;\n                if (mapping.center) center = (o2.typeOf(mapping.center)===\"array\") ? mapping.center[0] : mapping.center;\n                layout.centerServer = center;\n                layout.desktop.centerServer = center;\n                if (callback) callback();\n            }else{\n                if (mapping.center) layout.config.center = (o2.typeOf(mapping.center)===\"array\") ? mapping.center : [mapping.center];\n                o2.xDesktop.getServiceAddress(layout.config, function (service, center) {\n                    _setLayoutService(service, center);\n                    _loadProgressBar();\n                    if (callback) callback();\n                }.bind(this));\n            }\n        }else{\n            o2.xDesktop.getServiceAddress(layout.config, function (service, center) {\n                _setLayoutService(service, center);\n                _loadProgressBar();\n                if (callback) callback();\n            }.bind(this));\n        }\n\n    };\n\n    var _load = function () {\n        var _loadApp = function (json) {\n            //用户已经登录\n            if (json){\n                layout.user = json.data;\n                layout.session = layout.session || {};\n                layout.session.user = json.data;\n                layout.session.token = json.data.token;\n                layout.desktop.session = layout.session;\n            }\n\n            _loadProgressBar(true);\n            layout.isReady = true;\n            while (layout.readys && layout.readys.length) {\n                layout.readys.shift().apply(window);\n            }\n        };\n\n        // 是否ip\n        var _isIp = function(ip) {\n            var reg = /^(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])$/\n            return reg.test(ip);\n        };\n        \n\n        //修改支持x-token\n        var uri = new URI(window.location.href);\n        var options = uri.get(\"data\");\n        if (options[o2.tokenName]) {\n            // 删除\n            Cookie.dispose(o2.tokenName);\n            // 写入\n            var host = window.location.host; // 域名 \n            var domain = null;\n            if (_isIp(host)) {\n                domain = host;\n            }else {\n                if (host.indexOf(\".\") > 0) {\n                    domain = host.substring(host.indexOf(\".\")); // 上级域名 如 .o2oa.net\n                }\n            }\n            if (domain) {\n                Cookie.write(o2.tokenName, options[o2.tokenName], {domain: domain, path:\"/\"});\n            }else {\n                Cookie.write(o2.tokenName, options[o2.tokenName]);\n            }\n        }\n\n        layout.sessionPromise = new Promise(function(resolve, reject){\n            o2.Actions.get(\"x_organization_assemble_authentication\").getAuthentication(function (json) {\n                if (json.data.language && (json.data.language !== o2.languageName)){\n                    o2.language = json.data.language.toLowerCase();\n                    o2.languageName = json.data.language;\n                    var lp = \"../x_desktop/js/base_lp_\" + o2.language +((o2.session.isDebugger) ? \"\" : \".min\")+ \".js\";\n                    o2.load(lp, {\"reload\": true}, function(){\n                        if (resolve) resolve(json.data);\n                    });\n                }else{\n                    if (resolve) resolve(json.data);\n                }\n            }.bind(this), function (xhr, text, error) {\n                if (reject) reject({\"xhr\": xhr, \"text\": text, \"error\": error});\n            }.bind(this));\n        });\n\n        layout.sessionPromise.then(function(data){\n            //已经登录\n            layout.user = data;\n            layout.session = layout.session || {};\n            layout.session.user = data;\n            layout.session.token = data.token;\n            layout.desktop.session = layout.session;\n            //_loadApp();\n        }, function(){\n            //允许匿名访问\n            if (layout.anonymous) {\n                var data = { name: \"anonymous\", roleList: [] };\n                layout.user = data;\n                layout.session = layout.session || {};\n                layout.session.user = data;\n                layout.session.token = data.token;\n                layout.desktop.session = layout.session;\n                //_loadApp();\n            } else {\n                _loadProgressBar(true);\n                if (layout.yqwx) {\n                    layout.openLoginQywx();\n                } else {\n                    layout.openLogin();\n                }\n            }\n        });\n        _loadApp();\n\n        layout.openLogin = function () {\n            layout.desktop.type = \"app\";\n            layout.app = null;\n            var content = $(\"appContent\") || $(\"layout\");\n            if (content) content.empty();\n            layout.authentication = new o2.xDesktop.Authentication({\n                \"style\": \"flat\",\n                \"onLogin\": _load.bind(layout)\n            });\n            layout.authentication.loadLogin(document.body);\n            var loadingNode = $(\"browser_loading\");\n            if (loadingNode) loadingNode.fade(\"out\");\n        };\n\n        layout.openLoginQywx = function () {\n            console.log(\"开始login。。。。。。。。。。。。。\");\n            var uri = locate.href.toURI();\n\n            console.log(\"执行单点。。。。。。。。。。\");\n            var action = new MWF.xDesktop.Actions.RestActions(\"\", \"x_organization_assemble_authentication\", \"\");\n            action.getActions = function (actionCallback) {\n                this.actions = { \"sso\": { \"uri\": \"/jaxrs/qiyeweixin/code/{code}\", \"method\": \"GET\" } };\n                if (actionCallback) actionCallback();\n            };\n            action.invoke({\n                \"name\": \"sso\", \"async\": true, \"parameter\": { \"code\": uri.getData(\"code\") }, \"success\": function (json) {\n                    console.log(\"单点成功。\");\n                    console.log(json);\n                    //基础数据。。。。\n                    layout.session.user = json.data;\n                    //\n                    _load();\n\n                }.bind(this), \"failure\": function (xhr, text, error) {\n                    var n = document.getElementById(\"loaddingArea\");\n                    if (n) { n.destroy(); }\n                    document.id(\"layout\").set(\"html\", \"<div>企业微信单点异常！</div>\");\n                }.bind(this)\n            });\n        };\n    };\n\n    //异步载入必要模块\n    layout.config = null;\n    var configLoaded = false;\n    var lpLoaded = false;\n    var commonLoaded = false;\n    //var lp = o2.session.path + \"/lp/\" + o2.language + \".js\";\n    var lp = \"../x_desktop/js/base_lp_\" + o2.language +((o2.session.isDebugger) ? \"\" : \".min\")+ \".js\";\n\n    if (o2.session.isDebugger && (o2.session.isMobile || layout.mobile)) o2.load(\"../o2_lib/eruda/eruda.js\");\n    var loadModuls = function () {\n        _loadProgressBar();\n        lpLoaded = true;\n\n        var modules = [\"o2.xDesktop.$all\"];\n        o2.require(modules, {\n            \"onSuccess\": function () {\n                commonLoaded = true;\n                if (configLoaded && commonLoaded && lpLoaded) _getDistribute(function () { _load(); });\n            },\n            \"onEvery\": function () {\n                _loadProgressBar();\n            }\n        });\n    };\n\n    if (!o2.LP){\n        o2.load(lp, loadModuls);\n    }else{\n        loadModuls();\n    }\n\n    o2.getJSON(\"../x_desktop/res/config/config.json\", function (config) {\n        _loadProgressBar();\n        layout.config = config;\n        o2.tokenName = config.tokenName || \"x-token\";\n        configLoaded = true;\n        if (configLoaded && commonLoaded && lpLoaded) _getDistribute(function () { _load(); });\n    });\n});\n"]}