layout.addReady((function(){!function(t){var e=new URI(window.location.href).get("data");!function(){t.apps=[],t.node=$("layout")||$("appContent")||document.body;var i="process.Work",o=null,r=e,n=window.opener;if(n)try{i||(i=n.layout.desktop.openBrowserApp),o||(o=n.layout.desktop.openBrowserStatus),r||(r=n.layout.desktop.openBrowserOption)}catch(t){}if(!e.job||e.workid||e.draftid||e.draft)e.draft&&(e.draft=JSON.parse(e.draft)),t.openApplication(null,i,r||{},o);else{var d=null;if(o2.Actions.get("x_processplatform_assemble_surface").listWorkByJob(e.job,function(t){t.data&&(d=t.data)}.bind(this),null,!1),d){var p=d.workList.length+d.workCompletedList.length;if(p)if(p>1&&e.choice){t.node.empty(),t.node.setStyle("background","#f1f1f1");var l=new Element("div",{styles:{"font-size":"18px","text-align":"center","font-weight":"bold",margin:"auto",height:"30px",width:"90%","max-width":"600px",padding:"40px 0px 20px 20px"},text:o2.LP.widget.choiceWork}).inject(t.node);l=new Element("div",{styles:{margin:"auto",padding:"0px 20px",width:"90%","max-width":"600px"}}).inject(t.node);d.workList.each(function(n){var d=new Element("div",{styles:{background:"#ffffff","border-radius":"10px",clear:"both","margin-bottom":"10px",height:"40px",padding:"10px 10px"}}).inject(l),p="<div style='height: 40px; width: 40px; float: left; background: url(../x_component_process_Xform/$Form/default/icon/work.png) no-repeat center center'></div><div style='height: 40px; width: 40px; float: right'><div class='MWFAction' style='height: 20px; width: 40px; margin-top: 10px; border: 1px solid #999999; border-radius: 5px;text-align: center; cursor: pointer'>"+o2.LP.widget.open+"</div></div><div style='height: 20px; line-height: 20px; margin: 0px 40px'>"+n.title+"</div><div style='margin: 0px 40px'><div style='color:#999999; float: left; margin-right: 10px'>"+n.activityName+"</div><div style='color:#999999; float: left; margin-right: 10px'>"+n.activityArrivedTime+"</div><div style='color:#999999; float: left; margin-right: 10px'>"+(n.manualTaskIdentityText||"")+"</div></div>";d.set("html",p);var a=d.getElement(".MWFAction");a.store("work",n),a.addEvent("click",function(n){var d=n.target.retrieve("work");e.workId=d.id,t.node.empty(),t.openApplication(null,i,r||{},o)}.bind(this))}.bind(this)),d.workCompletedList.each(function(n){var d=new Element("div",{styles:{background:"#ffffff","border-radius":"10px",clear:"both","margin-bottom":"10px",height:"40px",padding:"10px 10px"}}).inject(l),p="<div style='height: 40px; width: 40px; float: left; background: url(../x_component_process_Xform/$Form/default/icon/work.png) no-repeat center center'></div><div style='height: 40px; width: 40px; float: right'><div class='MWFAction' style='height: 20px; width: 40px; margin-top: 10px; border: 1px solid #999999; border-radius: 5px;text-align: center; cursor: pointer'>"+o2.LP.widget.open+"</div></div><div style='height: 20px; line-height: 20px; margin: 0px 40px'>"+n.title+"</div><div style='margin: 0px 40px'><div style='color:#999999; float: left; margin-right: 10px'>+o2.LP.widget.workcompleted+</div><div style='color:#999999; float: left; margin-right: 10px'>"+n.completedTime+"</div>";d.set("html",p);var a=d.getElement(".MWFAction");a.store("work",n),a.addEvent("click",function(n){var d=n.target.retrieve("work");e.workCompletedId=d.id,t.node.empty(),t.openApplication(null,i,r||{},o)}.bind(this))}.bind(this))}else d.workList.length?e.workId=d.workList[0].id:e.workCompletedId=d.workCompletedList[0].id,t.openApplication(null,i,r||{},o)}}}()}(layout)}));