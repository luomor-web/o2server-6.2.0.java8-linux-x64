var resources={getEntityManagerContainer:function(){return{}},getContext:function(){return{}},getApplications:function(){return{}},getOrganization:function(){return{group:function(){return{}},identity:function(){return{}},person:function(){return{}},personAttribute:function(){return{}},role:function(){return{}},unit:function(){return{}},unitAttribute:function(){return{}},unitDuty:function(){return{}}}},getWebservicesClient:function(){return{}}},effectivePerson=this.effectivePerson={};bind=this;var library={version:"4.0",defineProperties:Object.defineProperties||function(t,i){return t},typeOf:function(t){if(null==t)return"null";if(null!=t.$family)return t.$family();if(t.constructor==Array)return"array";if(t.nodeName){if(1==t.nodeType)return"element";if(3==t.nodeType)return/\S/.test(t.nodeValue)?"textnode":"whitespace"}else if("number"==typeof t.length&&t.callee)return"arguments";return typeof t},JSONDecode:function(string,secure){return string&&"string"==library.typeOf(string)?eval("("+string+")"):null},JSONEncode:function(t){switch(t&&t.toJSON&&(t=t.toJSON()),library.typeOf(t)){case"string":return'"'+t.replace(/[\x00-\x1f\\"]/g,escape)+'"';case"array":for(var i=[],e=0;e<t.length;e++){(n=library.JSONEncode(t[e]))&&i.push(n)}return"["+i+"]";case"object":case"hash":i=[];for(key in t){var n;(n=library.JSONEncode(t[key]))&&i.push(library.JSONEncode(key)+":"+n)}return"{"+i+"}";case"number":case"boolean":return""+t;case"null":return"null"}return null}};if(function(){var t={indexOf:{value:function(t,i){for(var e=this.length>>>0,n=i<0?Math.max(0,e+i):i||0;n<e;n++)if(this[n]===t)return n;return-1}}};library.defineProperties(Array.prototype,t)}(),bind.entityManager=resources.getEntityManagerContainer(),bind.context=resources.getContext(),bind.applications=resources.getApplications(),bind.organization=resources.getOrganization(),bind.service=resources.getWebservicesClient(),bind.requestText=this.requestText||null,bind.request=this.request||null,this.effectivePerson&&(bind.currentPerson=bind.effectivePerson=effectivePerson),this.parameters&&(bind.parameters=JSON.parse(this.parameters)),this.customResponse){var _response={customResponse:this.customResponse||"",seeOther:function(t){customResponse.seeOther(t)},temporaryRedirect:function(t){customResponse.temporaryRedirect(t)},setBody:function(t,i){var e=t;"object"==typeOf(t)&&(e=JSON.stringify(t)),customResponse.setBody(e,i||"")}};bind.response=_response}var _define=function(t,i,e){var n=!0;!1===e&&(n=!1);var r={};r[t]={value:i,configurable:n},library.defineProperties(bind,r)},restfulAcpplication=resources.getApplications(),_Action=function(t,i){this.actions=i,this.root=t;var e=function(t,i,e){var n=this;return function(){var r,a,o,s=i.length-1,u=arguments.length,c=arguments,l={};return"function"===typeOf(c[0])?(s=-1,r=u>++s?c[s]:null,a=u>++s?c[s]:null,i.each((function(t,i){l[t]=u>++s?c[s]:null})),!t.method||"post"!==t.method.toLowerCase()&&"put"!==t.method.toLowerCase()||(o=u>++s?c[s]:null)):(i.each((function(t,i){l[t]=u>i?c[i]:null})),!t.method||"post"!==t.method.toLowerCase()&&"put"!==t.method.toLowerCase()||(o=u>++s?c[s]:null),r=u>++s?c[s]:null,a=u>++s?c[s]:null),n.invoke({name:e,data:o,parameter:l,success:r,failure:a})}},n=function(t,i){var n=t.uri,r=new RegExp("{.+?}","g"),a=n.match(r),o=[];a&&(o=a.map((function(t){return t.substring(1,t.length-1)}))),this[i]=e.call(this,t,o,i)};Object.keys(this.actions).forEach((function(t){var i=this.actions[t];i.uri&&(this[t]||n.call(this,i,t))}),this),this.invoke=function(t){if(this.actions[t.name]){var i=this.actions[t.name].uri,e=this.actions[t.name].method||"get";t.parameter&&Object.keys(t.parameter).forEach((function(e){var n=t.parameter[e];i=i.replace("{"+e+"}",n)}));var n=null;try{switch(e.toLowerCase()){case"get":n=bind.applications.getQuery(this.root,i);break;case"post":n=bind.applications.postQuery(this.root,i,JSON.stringify(t.data));break;case"put":n=bind.applications.putQuery(this.root,i,JSON.stringify(t.data));break;case"delete":n=bind.applications.deleteQuery(this.root,i);break;default:n=bind.applications.getQuery(this.root,i)}if(n&&"success"===n.getType().toString()){var r=JSON.parse(n.toString());t.success&&t.success(r)}else t.failure&&t.failure(n?JSON.parse(n.toString()):null);return n}catch(i){t.failure&&t.failure(i)}}}},_Actions={loadedActions:{},load:function(t){if(this.loadedActions[t])return this.loadedActions[t];var i=bind.applications.describeApi(t),e=JSON.parse(i.toString());if(e&&e.jaxrs){var n={};return e.jaxrs.each(function(i){if(i.methods&&i.methods.length){var e={};i.methods.each(function(t){var i={uri:"/"+t.uri};t.method&&(i.method=t.method),t.enctype&&(i.enctype=t.enctype),e[t.name]=i}.bind(this)),n[i.name]=new bind.Action(t,e)}}.bind(this)),this.loadedActions[t]=n,n}return null}};bind.Actions=_Actions;var _processActions=new _Action("x_processplatform_assemble_surface",{getDictionary:{uri:"/jaxrs/applicationdict/{applicationDict}/application/{applicationFlag}"},getDictRoot:{uri:"/jaxrs/applicationdict/{applicationDict}/application/{application}/data"},getDictData:{uri:"/jaxrs/applicationdict/{applicationDict}/application/{application}/{path}/data"},setDictData:{uri:"/jaxrs/applicationdict/{applicationDict}/application/{application}/{path}/data",method:"PUT"},addDictData:{uri:"/jaxrs/applicationdict/{applicationDict}/application/{application}/{path}/data",method:"POST"},deleteDictData:{uri:"/jaxrs/applicationdict/{applicationDict}/application/{application}/{path}/data",method:"DELETE"},getScript:{uri:"/jaxrs/script/{flag}/application/{applicationFlag}",method:"POST"}}),_cmsActions=new _Action("x_cms_assemble_control",{getDictionary:{uri:"/jaxrs/design/appdict/{appDictId}"},getDictRoot:{uri:"/jaxrs/surface/appdict/{appDictId}/appInfo/{appId}/data"},getDictData:{uri:"/jaxrs/surface/appdict/{appDictId}/appInfo/{appId}/{path}/data"},setDictData:{uri:"/jaxrs/surface/appdict/{appDictId}/appInfo/{appId}/{path}/data",method:"PUT"},addDictData:{uri:"/jaxrs/surface/appdict/{appDictId}/appInfo/{appId}/{path}/data",method:"POST"},deleteDictData:{uri:"/jaxrs/surface/appdict/{appDictId}/appInfo/{appId}/{path}/data",method:"DELETE"},getDictRootAnonymous:{uri:"/jaxrs/anonymous/surface/appdict/{appDictId}/appInfo/{appId}/data"},getDictDataAnonymous:{uri:"/jaxrs/anonymous/surface/appdict/{appDictId}/appInfo/{appId}/{path}/data"},getScript:{uri:"/jaxrs/script/{flag}/appInfo/{appInfoFlag}",method:"POST"}}),_portalActions=new _Action("x_portal_assemble_surface",{getScript:{uri:"/jaxrs/script/portal/{portal}/name/{ }",method:"POST"}}),_exec=function(code,_self){var returnValue;_self||(_self=this);try{var f=eval("(function(){return function(){\n"+code+"\n}})();");returnValue=f.apply(_self)}catch(t){console.log("exec",new Error("exec script error")),console.log(t)}return returnValue},includedScripts=this.includedScripts||{};this.includedScripts=includedScripts;var _include=function(t,i){var e=t;"string"==typeOf(e)&&(e={name:e});var n=e.name,r=e.type&&e.application?e.type:"process",a=e.application;if(!n||!r||!a)return console.log("include",new Error("can not find script. missing script name or application")),!1;if(includedScripts[a]||(includedScripts[a]=[]),includedScripts[a].indexOf(n)>-1)i&&i.apply(this);else{var o;switch(r){case"portal":_portalActions.getScript(a,n,{importedList:includedScripts[a]},function(t){t.data&&(includedScripts[a]=includedScripts[a].concat(t.data.importedList),o=t.data)}.bind(this));break;case"process":_processActions.getScript(n,a,{importedList:includedScripts[a]},function(t){t.data&&(includedScripts[a]=includedScripts[a].concat(t.data.importedList),o=t.data)}.bind(this));break;case"cms":_cmsActions.getScript(n,a,{importedList:includedScripts[a]},function(t){t.data&&(includedScripts[a]=includedScripts[a].concat(t.data.importedList),o=t.data)}.bind(this))}includedScripts[a].push(n),o&&o.text&&(bind.exec(o.text,this),i&&i.apply(this))}},_createDict=function(t){return function(i){var e=i;"string"==typeOf(e)&&(e={name:e});this.name=e.name;var n=e.type&&e.application?e.type:"process",r=e.application||t,a=e.enableAnonymous||!1;if("cms"==n)var o=bind.cmsActions;else o=bind.processActions;var s=function(t){return t.split(/\./g).map((function(t){return encodeURIComponent(t)})).join("/")};this.get=function(t,i,e){var u=null;if(t){var c=s(t);o[a&&"cms"==n?"getDictDataAnonymous":"getDictData"](encodeURIComponent(this.name),r,c,(function(t){u=t.data,i&&i(t.data)}),(function(t,i,n){e&&e(t,i,n)}))}else o[a&&"cms"==n?"getDictRootAnonymous":"getDictRoot"](encodeURIComponent(this.name),r,(function(t){u=t.data,i&&i(t.data)}),(function(t,i,n){e&&e(t,i,n)}),!1);return u},this.set=function(t,i,e,n){var a=s(t);o.setDictData(encodeURIComponent(this.name),r,a,i,(function(t){e&&e(t.data)}),(function(t,i,e){n&&n(t,i,e)}),!1,!1)},this.add=function(t,i,e,n){var a=s(t);o.addDictData(encodeURIComponent(this.name),r,a,i,(function(t){e&&e(t.data)}),(function(t,i,e){n&&n(t,i,e)}),!1,!1)},this.delete=function(t,i,e){var n=s(t);o.deleteDictData(encodeURIComponent(this.name),r,n,(function(t){i&&i(t.data)}),(function(t,i,n){e&&e(t,i,n)}),!1,!1)},this.destory=this.delete}},getNameFlag=function(t){var i=library.typeOf(t);if("array"===i){var e=[];return t.forEach((function(t){e.push("object"===library.typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t)})),e}return["object"===i?t.distinguishedName||t.id||t.unique||t.name:t]},_org={oGroup:this.organization.group(),oIdentity:this.organization.identity(),oPerson:this.organization.person(),oPersonAttribute:this.organization.personAttribute(),oRole:this.organization.role(),oUnit:this.organization.unit(),oUnitAttribute:this.organization.unitAttribute(),oUnitDuty:this.organization.unitDuty(),group:function(){return this.oGroup},identity:function(){return this.oIdentity},person:function(){return this.oPerson},personAttribute:function(){return this.oPersonAttribute},role:function(){return this.oRole},unit:function(){return this.oUnit},unitAttribute:function(){return this.oUnitAttribute},unitDuty:function(){return this.oUnitDuty},getObject:function(t,i){var e=[];if(!i||!i.length)return null;for(var n=0;n<i.length;n++){var r=t.getObject(i[n]);r&&e.push(JSON.parse(r.toString()))}return e},getGroup:function(t){var i=this.oGroup.listObject(getNameFlag(t)),e=i&&i.length?JSON.parse(i.toString()):null;return e&&1===e.length?e[0]:e},listSubGroup:function(t,i){var e=null;return e=i?this.oGroup.listWithGroupSubNested(getNameFlag(t)):this.oGroup.listWithGroupSubDirect(getNameFlag(t)),this.getObject(this.oGroup,e)},listSupGroup:function(t,i){var e=null;return e=i?this.oGroup.listWithGroupSupNested(getNameFlag(t)):this.oGroup.listWithGroupSupDirect(getNameFlag(t)),this.getObject(this.oGroup,e)},listGroupWithPerson:function(t){var i=this.oGroup.listWithPerson(getNameFlag(t));return this.getObject(this.oGroup,i)},groupHasRole:function(t,i){return nameFlag="object"===library.typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t,this.oGroup.hasRole(nameFlag,getNameFlag(i))},getRole:function(t){var i=this.oRole.listObject(getNameFlag(t)),e=i&&i.length?JSON.parse(i.toString()):null;return e&&1===e.length?e[0]:e},listRoleWithPerson:function(t){var i=this.oRole.listWithPerson(getNameFlag(t));return this.getObject(this.oRole,i)},personHasRole:function(t,i){return nameFlag="object"===library.typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t,this.oPerson.hasRole(nameFlag,getNameFlag(i))},getPerson:function(t){var i=this.oPerson.listObject(getNameFlag(t)),e=i&&i.length?JSON.parse(i.toString()):null;return e&&1===e.length?e[0]:e},listSubPerson:function(t,i){var e=null;return e=i?this.oPerson.listWithPersonSubNested(getNameFlag(t)):this.oPerson.listWithPersonSubDirect(getNameFlag(t)),this.getObject(this.oPerson,e)},listSupPerson:function(t,i){var e=null;return e=i?this.oPerson.listWithPersonSupNested(getNameFlag(t)):this.oPerson.listWithPersonSupDirect(getNameFlag(t)),this.getObject(this.oPerson,e)},listPersonWithGroup:function(t){var i=this.oPerson.listWithGroup(getNameFlag(t));return this.getObject(this.oPerson,i)},listPersonWithRole:function(t){var i=this.oPerson.listWithRole(getNameFlag(t));return this.getObject(this.oPerson,i)},listPersonWithIdentity:function(t){var i=this.oPerson.listWithIdentity(getNameFlag(t));return this.getObject(this.oPerson,i)},getPersonWithIdentity:function(t){var i=this.oPerson.listWithIdentity(getNameFlag(t)),e=this.getObject(this.oPerson,i);return e&&e.length?e[0]:null},listPersonWithUnit:function(t,i){var e=null;return e=i?this.oPerson.listWithUnitSubNested(getNameFlag(t)):this.oPerson.listWithUnitSubDirect(getNameFlag(t)),this.getObject(this.oPerson,e)},appendPersonAttribute:function(t,i,e){var n="object"===library.typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t;return this.oPersonAttribute.appendWithPersonWithName(n,i,e)},setPersonAttribute:function(t,i,e){var n="object"===library.typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t;return this.oPersonAttribute.setWithPersonWithName(n,i,e)},getPersonAttribute:function(t,i){var e="object"===library.typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t,n=this.oPersonAttribute.listAttributeWithPersonWithName(e,i),r=[];if(n&&n.length)for(var a=0;a<n.length;a++)r.push(n[a].toString());return r},listPersonAttributeName:function(t){for(var i=getNameFlag(t),e=[],n=0;n<i.length;n++){var r=this.oPersonAttribute.listNameWithPerson(i[n]);if(r&&r.length)for(var a=0;a<r.length;a++)-1==e.indexOf(r[a])&&e.push(r[a].toString())}return e},getIdentity:function(t){var i=this.oIdentity.listObject(getNameFlag(t)),e=i&&i.length?JSON.parse(i.toString()):null;return e&&1===e.length?e[0]:e},listIdentityWithPerson:function(t){var i=this.oIdentity.listWithPerson(getNameFlag(t));return this.getObject(this.oIdentity,i)},listIdentityWithUnit:function(t,i){var e=null;return e=i?this.oIdentity.listWithUnitSubNested(getNameFlag(t)):this.oIdentity.listWithUnitSubDirect(getNameFlag(t)),this.getObject(this.oIdentity,e)},getUnit:function(t){var i=this.oUnit.listObject(getNameFlag(t)),e=i&&i.length?JSON.parse(i.toString()):null;return e&&1===e.length?e[0]:e},listSubUnit:function(t,i){var e=null;return e=i?this.oUnit.listWithUnitSubNested(getNameFlag(t)):this.oUnit.listWithUnitSubDirect(getNameFlag(t)),this.getObject(this.oUnit,e)},listSupUnit:function(t,i){var e=null;return e=i?this.oUnit.listWithUnitSupNested(getNameFlag(t)):this.oUnit.listWithUnitSupDirect(getNameFlag(t)),this.getObject(this.oUnit,e)},getUnitByIdentity:function(t,i){var e,n="current";i&&("string"===library.typeOf(i)&&(n="type"),"number"===library.typeOf(i)&&(n="level"));var r=getNameFlag(t)[0];switch(n){case"current":e=this.oUnit.getWithIdentity(r);break;case"type":e=this.oUnit.getWithIdentityWithType(r,i);break;case"level":e=this.oUnit.getWithIdentityWithLevel(r,i)}var a=this.getObject(this.oUnit,[e]);return a&&1===a.length?a[0]:a},listAllSupUnitWithIdentity:function(t){var i=this.oUnit.listWithIdentitySupNested(getNameFlag(t));return this.getObject(this.oUnit,i)},listUnitWithPerson:function(t){var i=this.oUnit.listWithPerson(getNameFlag(t));return this.getObject(this.oUnit,i)},listAllSupUnitWithPerson:function(t){var i=this.oUnit.listWithPersonSupNested(getNameFlag(t));return this.getObject(this.oUnit,i)},listUnitWithAttribute:function(t,i){var e=this.oUnit.listWithUnitAttribute(t,i);return this.getObject(this.oUnit,e)},listUnitWithDuty:function(t,i){var e="object"===library.typeOf(i)?i.distinguishedName||i.id||i.unique||i.name:i,n=this.oUnit.listWithUnitDuty(t,e);return this.getObject(this.oUnit,n)},getDuty:function(t,i){var e="object"===library.typeOf(i)?i.distinguishedName||i.id||i.unique||i.name:i,n=this.oUnitDuty.listIdentityWithUnitWithName(e,t);return this.getObject(this.oIdentity,n)},listDutyNameWithIdentity:function(t){for(var i=getNameFlag(t),e=[],n=0;n<i.length;n++){var r=this.oUnitDuty.listNameWithIdentity(i[n]);if(r&&r.length)for(var a=0;a<r.length;a++)-1==e.indexOf(r[a])&&e.push(r[a].toString())}return e},listDutyNameWithUnit:function(t){for(var i=getNameFlag(t),e=[],n=0;n<i.length;n++){var r=this.oUnitDuty.listNameWithUnit(i[n]);if(r&&r.length)for(var a=0;a<r.length;a++)-1==e.indexOf(r[a])&&e.push(r[a].toString())}return e},listUnitAllDuty:function(t){for(var i=getNameFlag(t)[0],e=this.oUnitDuty.listNameWithUnit(i),n=[],r=0;r<e.length;r++)v=this.oUnitDuty.listIdentityWithUnitWithName(i,e[r]),n.push({name:e[r],identityList:this.getObject(this.oIdentity,v)});return n},appendUnitAttribute:function(t,i,e){var n="object"===library.typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t;return this.oUnitAttribute.appendWithUnitWithName(n,i,e)},setUnitAttribute:function(t,i,e){var n="object"===library.typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t;return this.oUnitAttribute.setWithUnitWithName(n,i,e)},getUnitAttribute:function(t,i){var e="object"===library.typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t,n=this.oUnitAttribute.listAttributeWithUnitWithName(e,i),r=[];if(n&&n.length)for(var a=0;a<n.length;a++)r.push(n[a].toString());return r},listUnitAttributeName:function(t){for(var i=getNameFlag(t),e=[],n=0;n<i.length;n++){var r=this.oUnitAttribute.listNameWithUnit(i[n]);if(r&&r.length)for(var a=0;a<r.length;a++)-1==e.indexOf(r[a])&&e.push(r[a])}return e},listUnitAllAttribute:function(t){for(var i=getNameFlag(t)[0],e=this.oUnitAttribute.listNameWithUnit(i),n=[],r=0;r<e.length;r++)v=this.getUnitAttribute(i,e[r]),n.push({name:e[r],valueList:v});return n}};print=function(t,i){},bind.print=print,bind.org=_org,bind.library=library,bind.define=_define,bind.Action=_Action,bind.Actions=_Actions,bind.processActions=_processActions,bind.cmsActions=_cmsActions,bind.portalActions=_portalActions,bind.exec=_exec,bind.include=_include,bind.Dict=_createDict();