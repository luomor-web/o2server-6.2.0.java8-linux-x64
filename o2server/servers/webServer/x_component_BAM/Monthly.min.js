MWF.xApplication.BAM.monthly=MWF.xApplication.BAM.monthly||{},MWF.xApplication.BAM.Monthly=new Class({Implements:[Options,Events],options:{style:"default"},initialize:function(t,e,i){this.setOptions(i),this.app=t,this.css=this.app.css,this.lp=this.app.lp,this.container=$(e),this.actions=this.app.actions,this.initData(),this.load()},initData:function(){this.categoryDataLoaded=!1,this.organizationDataLoaded=!1,this.overviewDataLoaded=!1},load:function(){this.loadMonthlyLayout()},loadMonthlyLayout:function(){this.tabAreaNode=new Element("div",{styles:this.css.monthTabAreaNode}).inject(this.container),this.contentAreaNode=new Element("div",{styles:this.css.monthContentAreaNode}).inject(this.container),this.createTab()},createTab:function(){this.tabAreaNode.set("html","<table border='0' cellpadding='0' cellSpacing='0' align='center'><tr><td></td><td></td><td></td><td></td><td></td><td></td></tr></table>"),this.table=this.tabAreaNode.getElement("table");var t=this.tabAreaNode.getElements("td");this.table.setStyles(this.css.monthTabTableNode),t.setStyles(this.css.monthTabCellNode),t[0].setStyle("border-left","0px"),this.taskTabItem=this.createTabItemNode(this.lp.monthly.task,"task",t[0]),this.taskCompletedTabItem=this.createTabItemNode(this.lp.monthly.taskCompleted,"taskCompleted",t[1]),this.workTabItem=this.createTabItemNode(this.lp.monthly.work,"work",t[2]),this.workCompletedTabItem=this.createTabItemNode(this.lp.monthly.workCompleted,"workCompleted",t[3]),this.taskExpiredTabItem=this.createTabItemNode(this.lp.monthly.taskExpired,"taskExpired",t[4]),this.workExpiredTabItem=this.createTabItemNode(this.lp.monthly.workExpired,"workExpired",t[5]),this.taskTabItem.addEvent("click",this.changeToTask.bind(this)),this.taskCompletedTabItem.addEvent("click",this.changeToTaskCompleted.bind(this)),this.workTabItem.addEvent("click",this.changeToWork.bind(this)),this.workCompletedTabItem.addEvent("click",this.changeToWorkCompleted.bind(this)),this.taskExpiredTabItem.addEvent("click",this.changeToTaskExpired.bind(this)),this.workExpiredTabItem.addEvent("click",this.changeToWorkExpired.bind(this)),this.taskTabItem.click()},createTabItemNode:function(t,e,i){var n=new Element("div",{styles:this.css.monthTabItemNode}).inject(i);return n.store("icon",e),new Element("div",{styles:this.css.monthTabItemIconNode}).inject(n).setStyle("background-image","url(../x_component_BAM/$Main/"+this.app.options.style+"/monthly/"+e+".png)"),new Element("div",{styles:this.css.monthTabItemTextNode}).inject(n).set("text",t),n},changeToTask:function(){this.setCurrentTabItem(0),this.loadContent("task"),this.taskCompletedContent&&this.taskCompletedContent.hide(),this.workContent&&this.workContent.hide(),this.workCompletedContent&&this.workCompletedContent.hide(),this.taskExpiredContent&&this.taskExpiredContent.hide(),this.workExpiredContent&&this.workExpiredContent.hide()},changeToTaskCompleted:function(){this.setCurrentTabItem(1),this.loadContent("taskCompleted"),this.taskContent&&this.taskContent.hide(),this.workContent&&this.workContent.hide(),this.workCompletedContent&&this.workCompletedContent.hide(),this.taskExpiredContent&&this.taskExpiredContent.hide(),this.workExpiredContent&&this.workExpiredContent.hide()},changeToWork:function(){this.setCurrentTabItem(2),this.loadContent("work"),this.taskContent&&this.taskContent.hide(),this.taskCompletedContent&&this.taskCompletedContent.hide(),this.workCompletedContent&&this.workCompletedContent.hide(),this.taskExpiredContent&&this.taskExpiredContent.hide(),this.workExpiredContent&&this.workExpiredContent.hide()},changeToWorkCompleted:function(){this.setCurrentTabItem(3),this.loadContent("workCompleted"),this.taskContent&&this.taskContent.hide(),this.taskCompletedContent&&this.taskCompletedContent.hide(),this.workContent&&this.workContent.hide(),this.taskExpiredContent&&this.taskExpiredContent.hide(),this.workExpiredContent&&this.workExpiredContent.hide()},changeToTaskExpired:function(){this.setCurrentTabItem(4),this.loadContent("taskExpired"),this.taskContent&&this.taskContent.hide(),this.taskCompletedContent&&this.taskCompletedContent.hide(),this.workContent&&this.workContent.hide(),this.workCompletedContent&&this.workCompletedContent.hide(),this.workExpiredContent&&this.workExpiredContent.hide()},changeToWorkExpired:function(){this.setCurrentTabItem(5),this.loadContent("workExpired"),this.taskContent&&this.taskContent.hide(),this.taskCompletedContent&&this.taskCompletedContent.hide(),this.workContent&&this.workContent.hide(),this.workCompletedContent&&this.workCompletedContent.hide(),this.taskExpiredContent&&this.taskExpiredContent.hide()},setCurrentTabItem:function(t){this.table.getElements("td").each(function(e,i){if(i==t){var n=e.getFirst("div"),o=n.retrieve("icon");n.setStyles(this.css.monthTabItemNode_current),n.getFirst("div").setStyle("background-image","url(../x_component_BAM/$Main/"+this.app.options.style+"/monthly/"+o+"_current.png)")}else{var s=e.getFirst("div"),h=s.retrieve("icon");s.setStyles(this.css.monthTabItemNode),s.getFirst("div").setStyle("background-image","url(../x_component_BAM/$Main/"+this.app.options.style+"/monthly/"+h+".png)")}}.bind(this))},loadContent:function(t){var e="Monthly"+t.capitalize()+"Content";this[t+"Content"]?this[t+"Content"].show():MWF.xDesktop.requireApp("BAM","monthly.MonthlyContent",function(){this[t+"Content"]=new MWF.xApplication.BAM.monthly[e](this,this.contentAreaNode,{onLoaded:function(){this.fireEvent("loaded")}.bind(this)})}.bind(this))},destroy:function(){this.container.empty(),MWF.release(this)}});