o2.widget=o2.widget||{},o2.widget.MWFRaphael=MWFRaphael={load:function(a){window.Raphael?a&&a():!window.Raphael&&"function"==typeof require&&define.amd?require(["../o2_lib/raphael/raphael.js"],function(t){window.Raphael=t,this.expandRaphael(),a&&a()}.bind(this)):COMMON.AjaxModule.load("raphael",function(){this.expandRaphael(),a&&a()}.bind(this),!0,!0)},expandRaphael:function(){Raphael.fn.diamond=function(a,t,h,n,e,r){return MWFRaphael.diamond.call(this,a,t,h,n,e,r)},Raphael.fn.rectPath=function(a,t,h,n,e){return MWFRaphael.rectPath.call(this,a,t,h,n,e)},Raphael.fn.circlePath=function(a,t,h){return MWFRaphael.circlePath.call(this,a,t,h)},Raphael.fn.arrow=function(a,t,h,n,e){return MWFRaphael.arrow.call(this,a,t,h,n,e)}},rectPath:function(a,t,h,n,e){var r=MWFRaphael.getRectPath(a,t,h,n,e);return this.path(r)},getRectPath:function(a,t,h,n,e){a=a.toFloat(),t=t.toFloat(),h=h.toFloat(),n=n.toFloat();var r={x:a+h-(e=e.toFloat()),y:t+n-e},i=n-e-e,M=h-e-e,o=Raphael.parsePathString(MWFRaphael.getArcPath(r.x,r.y,e)),s=r.x,l=r.y,p=Raphael.transformPath(o,"r-90,"+s+","+l+"T0,-"+i);l-=i;var c=Raphael.transformPath(p,"r-90,"+s+","+l+"T-"+M+",0");s-=M;var P=Raphael.transformPath(c,"r-90,"+s+","+l+"T0,"+i),u=a+h,R=t+n-e,f=a+h,g=t+e,d=Raphael.parsePathString("M"+u+","+R+"L"+f+","+g),x=a+h-e,F=t,y=a+e,I=t,v=Raphael.parsePathString("M"+x+","+F+"L"+y+","+I),m=Raphael.transformPath(d,"t-"+h+",0R180"),w=Raphael.transformPath(v,"t0,"+n+"R180");return""+o+d[1]+p[1]+v[1]+c[1]+m[1]+P[1]+w[1]+"Z"},circlePath:function(a,t,h){var n=MWFRaphael.getCirclePath(a,t,h);return this.path(n)},getArcPath:function(a,t,h){var n=a=a.toFloat(),e=(t=t.toFloat())+(h=h.toFloat()),r=e,i=a+h,M=a+h,o=t,s=Math.sqrt(h*h/2);return"M"+n+","+e+"C"+(n+s-.125*n-.375*i-.125*M)/.375+","+r+" "+i+","+(o+s-.125*e-.375*r-.125*o)/.375+" "+M+","+o},getCirclePath:function(a,t,h){var n=MWFRaphael.getArcPath(a,t,h),e=Raphael.transformPath(n,"R-90,"+a+","+t),r=Raphael.transformPath(e,"R-90,"+a+","+t),i=Raphael.transformPath(r,"R-90,"+a+","+t);return n+e[1]+r[1]+i[1]+"z"},diamond:function(a,t,h,n,e,r){var i=MWFRaphael.getDiamondPath(a,t,h,n,e,r);return this.path(i)},getDiamondPath:function(a,t,h,n,e,r){var i=a,M=t+n/2,o=a+h/2,s=t,l=a+h,p=t+n/2,c=a+h/2,P=t+n,u=MWFRaphael.getMinus(h/2,n/2,e),R=MWFRaphael.getMinus(h/2,n/2,r),f=i+u.x,g=M+u.y,d=c-R.x,x=P-R.y,F=c+R.x,y=P-R.y,I=l-u.x,v=p+u.y,m=l-u.x,w=p-u.y,W=o+R.x,q=s+R.y,A=o-R.x,L=s+R.y,D=i+u.x,C=M-u.y;return path="M"+D+","+C,path+="Q"+i+","+M+","+f+","+g,path+="L"+d+","+x,path+="Q"+c+","+P+","+F+","+y,path+="L"+I+","+v,path+="Q"+l+","+p+","+m+","+w,path+="L"+W+","+q,path+="Q"+o+","+s+","+A+","+L,path+="Z",path},getMinus:function(a,t,h){var n=h/90*(t/(Math.sqrt(a*a+t*t)/90));return{x:Math.sqrt(h*h-n*n),y:n}},getPointDistance:function(a,t){var h=Math.abs(a.x-t.x),n=Math.abs(a.y-t.y);return Math.sqrt(h*h+n*n)},getAngles:function(a,t,h){var n=(t*t+h*h-a*a)/(2*t*h),e=(a*a+h*h-t*t)/(2*a*h),r=(a*a+t*t-h*h)/(2*a*t);return{A:Math.acos(n),B:Math.acos(e),C:Math.acos(r)}},getMinDistance:function(a,t,h){var n=this.getPointDistance(a,t),e=this.getPointDistance(a,h),r=this.getPointDistance(t,h),i=this.getAngles(n,e,r),M=(i.A,i.B),o=(i.C,n*Math.sin(M)),s=Math.sqrt(n*n-o*o),l=h.x-t.x,p=(h.y-t.y)*(1/r)*s,c=l*(1/r)*s;return{h:o,p:{x:t.x+c,y:t.y+p}}},arrow:function(a,t,h,n,e){var r=MWFRaphael.getArrowPath(a,t,h,n,e);return this.path(r)},getArrowPath:function(a,t,h,n,e){var r=t.x,i=t.y,M=a.x,o=a.y,s=r-M,l=i-o;if(0==s&&0==l)return"";var p=l/Math.sqrt(s*s+l*l)*h,c=s/Math.sqrt(s*s+l*l)*h,P=Math.asin(l/Math.sqrt(s*s+l*l))/Math.PI*180,u=Math.asin(s/Math.sqrt(s*s+l*l))/Math.PI*180;if(s<=0&l<=0)var R=Math.sin((270-(P-e))*(Math.PI/180))*n,f=Math.sin((P-e)*(Math.PI/180))*n,g=Math.sin((270-(u-e))*(Math.PI/180))*n,d=Math.sin((u-e)*(Math.PI/180))*n;else if(s>0&l<0)R=Math.sin((90-(P+e))*(Math.PI/180))*n,f=Math.sin((P+e)*(Math.PI/180))*n,g=Math.sin((P-e)*(Math.PI/180))*n,d=Math.sin((u-e)*(Math.PI/180))*n;else if(s<0&l>0)R=Math.sin((u+e)*(Math.PI/180))*n,f=Math.sin((P+e)*(Math.PI/180))*n,g=Math.sin((90-(u-e))*(Math.PI/180))*n,d=Math.sin((u-e)*(Math.PI/180))*n;else R=Math.sin((90-(P-e))*(Math.PI/180))*n,f=Math.sin((P-e)*(Math.PI/180))*n,g=Math.sin((90-(u-e))*(Math.PI/180))*n,d=Math.sin((u-e)*(Math.PI/180))*n;return"M"+(c=s-c+M)+","+(p=l-p+o)+"L"+(R=s-R+M)+","+(f=l-f+o)+"L"+r+","+i+"L"+(d=s-d+M)+","+(g=l-g+o)+"Z"}};