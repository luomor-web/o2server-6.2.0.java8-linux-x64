o2.widget=o2.widget||{},o2.require("o2.xScript.Environment",null,!1),o2.widget.Macro=o2.Macro={swapSpace:{},expression:function(t,n){},runEvent:function(t,n,e){},exec:function(t,n){var e="o2.Macro.swapSpace.tmpMacroFunction = function (){\n"+t+"\n};";return Browser.exec(e),n||(n=window),o2.Macro.swapSpace.tmpMacroFunction.apply(n)}},o2.Macro.FormContext=new Class({macroFunction:null,environment:{},initialize:function(t){var n={form:t,forms:t.forms,all:t.all,data:t.businessData.data,work:t.businessData.work,taskList:t.businessData.taskList,control:t.businessData.control,activity:t.businessData.activity,task:t.businessData.task,workLogList:t.businessData.workLogList,attachmentList:t.businessData.attachmentList,status:t.businessData.status,target:null,event:null};this.environment=new o2.xScript.Environment(n)},setTarget:function(t){this.environment.target=t||null},setEvent:function(t){this.environment.event=t||null},exec:function(t,n){return this.setTarget(n),o2.Macro.exec(t,this.environment)},fire:function(t,n,e){return this.setTarget(n),this.setEvent(e),o2.Macro.exec(t,this.environment)}});