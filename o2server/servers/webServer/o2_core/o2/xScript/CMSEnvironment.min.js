MWF.xScript=MWF.xScript||{},MWF.xScript.CMSEnvironment=function(t){var n=t.data,i=t.form,o=t.forms;this.library=COMMON;this.setData=function(e){var n;this.data=(n=e,new MWF.xScript.CMSJSONData(n,(function(t,e,n){for(var i={getKey:function(){return e},getParent:function(){return n}};i&&!o[i.getKey()];)i=i.getParent();i&&i.getKey()&&o[i.getKey()]&&o[i.getKey()].resetData()}))),this.data.save=function(n){i.documentAction.saveData(function(t){n&&n()}.bind(this),null,t.document.id,e)}},this.setData(n),this.documentContext={getDocument:function(){return t.document},getControl:function(){return t.control},getAttachmentList:function(){return t.attachmentList}},this.Dict=MWF.xScript.createCMSDict(i.json.application);var r,a=null,u=function(){a||(MWF.require("MWF.xScript.Actions.UnitActions",null,!1),a=new MWF.xScript.Actions.UnitActions)},l=function(t){var e=typeOf(t);if("array"===e){var n=[];return t.each((function(t){n.push("object"===typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t)})),n}return["object"===e?t.distinguishedName||t.id||t.unique||t.name:t]};this.org={getGroup:function(t,e){u();var n={groupList:l(t)},i=null,o=a.listGroup(n,(function(t){return i=(i=t.data)&&1===i.length?i[0]:i,e&&"function"==o2.typeOf(e)?e(i):i}),null,!!e);return e?o:i},listSubGroup:function(t,e,n){u();var i,o={groupList:l(t)},r=null,s=function(t){return r=t.data,n&&"function"==o2.typeOf(n)?n(r):r};return i=e?a.listSubGroupNested(o,s,null,!!n):a.listSubGroupDirect(o,s,null,!!n),n?i:r},listSupGroup:function(t,e,n){u();var i={groupList:l(t)},o=null,r=function(t){return o=t.data,n&&"function"==o2.typeOf(n)?n(o):o};if(e)var s=a.listSupGroupNested(i,r,null,!!n);else s=a.listSupGroupDirect(i,r,null,!!n);return n?s:o},listGroupWithPerson:function(t,e){u();var n={personList:l(t)},i=null,o=a.listGroupWithPerson(n,(function(t){return i=t.data,e&&"function"==o2.typeOf(e)?e(i):i}),null,!!e);return e?o:i},groupHasRole:function(t,e,n){u(),nameFlag="object"===typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t;var i={group:nameFlag,roleList:l(e)},o=!1,r=a.groupHasRole(i,(function(t){return o=t.data.value,n&&"function"==o2.typeOf(n)?n(o):o}),null,!!n);return n?r:o},getRole:function(t,e){u();var n={roleList:l(t)},i=null,o=a.listRole(n,(function(t){return i=(i=t.data)&&1===i.length?i[0]:i,e&&"function"==o2.typeOf(e)?e(i):i}),null,!!e);return e?o:i},listRoleWithPerson:function(t,e){u();var n={personList:l(t)},i=null,o=a.listRoleWithPerson(n,(function(t){return i=t.data,e&&"function"==o2.typeOf(e)?e(i):i}),null,!!e);return e?o:i},personHasRole:function(t,e,n){u(),nameFlag="object"===typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t;var i={person:nameFlag,roleList:l(e)},o=!1,r=a.listRoleWithPerson(i,(function(t){return o=t.data.value,n&&"function"==o2.typeOf(n)?n(o):o}),null,!!n);return n?r:o},getPerson:function(t,e){u();var n={personList:l(t)},i=null,o=a.listPerson(n,(function(t){return i=(i=t.data)&&1===i.length?i[0]:i,e&&"function"==o2.typeOf(e)?e(i):i}),null,!!e);return e?o:i},listSubPerson:function(t,e,n){u();var i,o={personList:l(t)},r=null,s=function(t){return r=t.data,n&&"function"==o2.typeOf(n)?n(r):r};return i=e?a.listPersonSubNested(o,s,null,!!n):a.listPersonSubDirect(o,s,null,!!n),n?i:r},listSupPerson:function(t,e,n){u();var i,o={personList:l(t)},r=null,s=function(t){return r=t.data,n&&"function"==o2.typeOf(n)?n(r):r};return i=e?a.listPersonSupNested(o,s,null,!!n):a.listPersonSupDirect(o,s,null,!!n),n?i:r},listPersonWithGroup:function(t,e){u();var n={groupList:l(t)},i=null,o=a.listPersonWithGroup(n,(function(t){return i=t.data,e&&"function"==o2.typeOf(e)?e(i):i}),null,!!e);return e?o:i},listPersonWithRole:function(t,e){u();var n,i={roleList:l(t)},o=null;return n=a.listPersonWithRole(i,(function(t){return o=t.data,e&&"function"==o2.typeOf(e)?e(o):o}),null,!!e),e?n:o},listPersonWithIdentity:function(t,e){u();var n={identityList:l(t)},i=null,o=a.listPersonWithIdentity(n,(function(t){return i=t.data,e&&"function"==o2.typeOf(e)?e(i):i}),null,!!e);return e?o:i},getPersonWithIdentity:function(t,e){u();var n={identityList:l(t)},i=null,o=a.listPersonWithIdentity(n,(function(t){return i=(i=t.data)&&1===i.length?i[0]:i,e&&"function"==o2.typeOf(e)?e(i):i}),null,!!e);return e?o:i},listPersonWithUnit:function(t,e,n){u();var i,o={unitList:l(t)},r=null,s=function(t){return r=t.data,n&&"function"==o2.typeOf(n)?n(r):r};return i=e?a.listPersonWithUnitNested(o,s,null,!!n):a.listPersonWithUnitDirect(o,s,null,!!n),n?i:r},listPersonWithAttribute:function(t,e,n){u();var i={name:t,attribute:e},o=null,r=a.listPersonWithAttribute(i,(function(t){return o=t.data,n&&"function"==o2.typeOf(n)?n(o):o}),null,!!n);return n?r:o},listPersonNameWithAttribute:function(t,e,n){u();var i={name:t,attribute:e},o=null,r=a.listPersonWithAttributeValue(i,(function(t){return o=t.data.personList,n&&"function"==o2.typeOf(n)?n(o):o}),null,!!n);return n?r:o},appendPersonAttribute:function(t,e,n,i,o,r){u();var l={attributeList:n,name:e,person:"object"===typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t},s=null,c=a.appendPersonAttribute(l,(function(t){return s=t.data,r&&"function"==o2.typeOf(r)?r(s):s}),null,!!r);return r?c:s},setPersonAttribute:function(t,e,n,i,o,r){u();var l={attributeList:n,name:e,person:"object"===typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t},s=null,c=a.setPersonAttribute(l,(function(t){return s=t.data,r&&"function"==o2.typeOf(r)?r(s):s}),null,!!r);return r?c:s},getPersonAttribute:function(t,e,n){u();var i={name:e,person:"object"===typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t},o=null,r=a.getPersonAttribute(i,(function(t){return o=t.data.attributeList,n&&"function"==o2.typeOf(n)?n(o):o}),null,!!n);return n?r:o},listPersonAttributeName:function(t,e){u();var n={personList:l(t)},i=null,o=a.listPersonAttributeName(n,(function(t){return i=t.data.nameList,e&&"function"==o2.typeOf(e)?e(i):i}),null,!!e);return e?o:i},listPersonAllAttribute:function(t,e){u();var n={personList:l(t)},i=null,o=a.listPersonAllAttribute(n,(function(t){return i=t.data,e&&"function"==o2.typeOf(e)?e(i):i}),null,!!e);return e?o:i},getIdentity:function(t,e){u();var n={identityList:l(t)},i=null,o=a.listIdentity(n,(function(t){return i=(i=t.data)&&1===i.length?i[0]:i,e&&"function"==o2.typeOf(e)?e(i):i}),null,!!e);return e?o:i},listIdentityWithPerson:function(t,e){u();var n={personList:l(t)},i=null,o=a.listIdentityWithPerson(n,(function(t){return i=t.data,e&&"function"==o2.typeOf(e)?e(i):i}),null,!!e);return e?o:i},listIdentityWithUnit:function(t,e,n){u();var i={unitList:l(t)},o=null,r=a[e?"listIdentityWithUnitNested":"listIdentityWithUnitDirect"](i,(function(t){return o=t.data,n&&"function"==o2.typeOf(n)?n(o):o}),null,!!n);return r.name="org",n?r:o},getUnit:function(t,e){u();var n={unitList:l(t)},i=null,o=a.listUnit(n,(function(t){return i=(i=t.data)&&1===i.length?i[0]:i,e&&"function"==o2.typeOf(e)?e(i):i}),null,!!e);return e?o:i},listSubUnit:function(t,e,n){u();var i,o={unitList:l(t)},r=null,s=function(t){return r=t.data,n&&"function"==o2.typeOf(n)?n(r):r};return i=e?a.listUnitSubNested(o,s,null,!!n):a.listUnitSubDirect(o,s,null,!!n),n?i:r},listSupUnit:function(t,e,n){u();var i,o={unitList:l(t)},r=null,s=function(t){return r=t.data,n&&"function"==o2.typeOf(n)?n(r):r};return i=e?a.listUnitSupNested(o,s,null,!!n):a.listUnitSupDirect(o,s,null,!!n),n?i:r},getUnitByIdentity:function(t,e,n){u();var i,o,r,s="current";switch(e&&("string"===typeOf(e)&&(s="type"),"number"===typeOf(e)&&(s="level")),s){case"current":var c={identityList:l(t)};o=function(t){return i=(i=t.data)&&1===i.length?i[0]:i,n&&"function"==o2.typeOf(n)?n(i):i},r=a.listUnitWithIdentity(c,o,null,!!n);break;case"type":c={identity:"object"===typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t,type:e};o=function(t){return i=t.data,n&&"function"==o2.typeOf(n)?n(i):i},r=a.getUnitWithIdentityAndType(c,o,null,!!n);break;case"level":c={identity:"object"===typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t,level:e};o=function(t){return i=(i=t.data)&&1===i.length?i[0]:i,n&&"function"==o2.typeOf(n)?n(i):i},r=a.getUnitWithIdentityAndLevel(c,o,null,!!n)}return n?r:i},listAllSupUnitWithIdentity:function(t,e){u();var n={identityList:l(t)},i=null,o=a.listUnitSupNestedWithIdentity(n,(function(t){return i=t.data,e&&"function"==o2.typeOf(e)?e(i):i}),null,!!e);return e?o:i},listUnitWithPerson:function(t,e){u();var n={personList:l(t)},i=null,o=a.listUnitWithPerson(n,(function(t){return i=t.data,e&&"function"==o2.typeOf(e)?e(i):i}),null,!!e);return e?o:i},listAllSupUnitWithPerson:function(t,e){u();var n={personList:l(t)},i=null,o=a.listUnitSupNestedWithPerson(n,(function(t){return i=t.data,e&&"function"==o2.typeOf(e)?e(i):i}),null,!!e);return e?o:i},listUnitWithAttribute:function(t,e,n){u();var i={name:t,attribute:e},o=null;return promise=a.listUnitWithAttribute(i,(function(t){return o=t.data,n&&"function"==o2.typeOf(n)?n(o):o}),null,!!n),n?promise:o},listUnitWithDuty:function(t,e,n){u();var i={name:t,identity:"object"===typeOf(e)?e.distinguishedName||e.id||e.unique||e.name:e},o=null,r=a.listUnitWithDuty(i,(function(t){return o=t.data,n&&"function"==o2.typeOf(n)?n(o):o}),null,!!n);return n?r:o},getDuty:function(t,e,n){u();var i={name:t,unit:"object"===typeOf(e)?e.distinguishedName||e.id||e.unique||e.name:e},o=null,r=a.getDuty(i,(function(t){return o=t.data,n&&"function"==o2.typeOf(n)?n(o):o}),null,!!n);return n?r:o},listDutyNameWithIdentity:function(t,e){u();var n={identityList:l(t)},i=null,o=a.listDutyNameWithIdentity(n,(function(t){return i=t.data.nameList,e&&"function"==o2.typeOf(e)?e(i):i}),null,!!e);return e?o:i},listDutyNameWithUnit:function(t,e){u();var n={unitList:l(t)},i=null,o=a.listDutyNameWithUnit(n,(function(t){return i=t.data.nameList,e&&"function"==o2.typeOf(e)?e(i):i}),null,!!e);return e?o:i},listUnitAllDuty:function(t,e){u();var n={unitList:l(t)},i=null,o=a.listUnitAllDuty(n,(function(t){return i=t.data,e&&"function"==o2.typeOf(e)?e(i):i}),null,!!e);return e?o:i},listTopUnit:function(t){var e=MWF.Actions.get("x_organization_assemble_control"),n=null,i=e.listTopUnit((function(e){return n=e.data,t&&"function"==o2.typeOf(t)?t(n):n}),null,!!t);return t?i:n},appendUnitAttribute:function(t,e,n,i,o,r){u();var l={attributeList:n,name:e,unit:"object"===typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t},s=null,c=a.appendUnitAttribute(l,(function(t){return s=t.data,r&&"function"==o2.typeOf(r)?r(s):s}),null,!!r);return r?c:s},setUnitAttribute:function(t,e,n,i,o,r){u();var l={attributeList:n,name:e,unit:"object"===typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t},s=null,c=a.setUnitAttribute(l,(function(t){return s=t.data,r&&"function"==o2.typeOf(r)?r(s):s}),null,!!r);return r?c:s},getUnitAttribute:function(t,e,n){u();var i={name:e,unit:"object"===typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t},o=null,r=a.getUnitAttribute(i,(function(t){return o=t.data.attributeList,n&&"function"==o2.typeOf(n)?n(o):o}),null,!!n);return n?r:o},listUnitAttributeName:function(t,e){u();var n={unitList:l(t)},i=null,o=a.listUnitAttributeName(n,(function(t){return i=t.data.nameList,e&&"function"==o2.typeOf(e)?e(i):i}),null,!!e);return e?o:i},listUnitAllAttribute:function(t,e){u();var n={unitList:l(t)},i=null,o=a.listUnitAllAttribute(n,(function(t){return i=t.data,e&&"function"==o2.typeOf(e)?e(i):i}),null,!!e);return e?o:i}},this.Action=(r=[],function(t,e){var n=r[t]||(r[t]=new MWF.xDesktop.Actions.RestActions("",t,""));n.getActions=function(t){this.actions||(this.actions={}),Object.merge(this.actions,e),t&&t()},this.invoke=function(t){n.invoke(t)}}),this.service={jaxwsClient:{},jaxrsClient:{}};var s=null;this.view={lookup:function(t,e,n){var i={filterList:t.filter||null};MWF.Actions.load("x_query_assemble_surface").ViewAction.executeWithQuery(t.view,t.application,i,(function(t){var n={grid:t.data.grid||t.data.groupGrid,groupGrid:t.data.groupGrid};e&&e(n)}),null,n)},lookupV1:function(t,e){!function(t){s?t&&t():MWF.require("MWF.xDesktop.Actions.RestActions",function(){(s=new MWF.xDesktop.Actions.RestActions("","x_cms_assemble_control","")).getActions=function(t){this.actions={lookup:{uri:"/jaxrs/queryview/flag/{view}/application/flag/{application}/execute",method:"PUT"},getView:{uri:"/jaxrs/queryview/flag/{view}/application/flag/{application}"}},t&&t()},t&&t()}.bind(this))}(function(){s.invoke({name:"lookup",async:!0,parameter:{view:t.view,application:t.application},success:function(t){var n={grid:t.data.grid,groupGrid:t.data.groupGrid};e&&e(n)}.bind(this)})}.bind(this))},select:function(t,e,n){if(t.view){var o={application:t.application||i.json.application,viewName:t.view||"",isTitle:!1===t.isTitle?"no":"yes",select:!1===t.isMulti?"single":"multi",filter:t.filter};n||(n={}),n.width=t.width,n.height=t.height,n.title=t.caption;var r=n.width||"700",a=n.height||"400";if(layout.mobile){var u=document.body.getSize();r=u.x,a=u.y,n.style="viewmobile"}r=r.toInt(),a=a.toInt();var l=((u=i.app.content.getSize()).x-r)/2,s=(u.y-a)/2;l<0&&(l=0),s<0&&(s=0),layout.mobile&&(l=20,s=0);var c=this;MWF.require("MWF.xDesktop.Dialog",function(){var t=new MWF.xDesktop.Dialog({title:n.title||"select view",style:n.style||"view",top:s,left:l-20,fromTop:s,fromLeft:l-20,width:r,height:a,html:"<div style='height: 100%;'></div>",maskNode:i.app.content,container:i.app.content,buttonList:[{text:MWF.LP.process.button.ok,action:function(){e&&e(c.view.getData()),this.close()}},{text:MWF.LP.process.button.cancel,action:function(){this.close()}}]});if(t.show(),layout.mobile){var u=t.node.getElement(".MWF_dialod_Action_back"),p=t.node.getElement(".MWF_dialod_Action_ok");u&&u.addEvent("click",function(e){t.close()}.bind(this)),p&&p.addEvent("click",function(n){e&&e(this.view.getData()),t.close()}.bind(this))}MWF.xDesktop.requireApp("query.Query","Viewer",function(){this.view=new MWF.xApplication.query.Query.Viewer(t.content.getFirst(),o,{style:"select"},i.app,i.Macro)}.bind(this))}.bind(this))}}},this.statement={execute:function(t,e,n){var i=this.parseParameter(t.parameter),o={filterList:this.parseFilter(t.filter,i),parameter:i};MWF.Actions.load("x_query_assemble_surface").StatementAction.executeV2(t.name,t.mode||"data",t.page||1,t.pageSize||20,o,(function(t){e&&e(t)}),null,n)},parseFilter:function(t,e){if("array"!==typeOf(t))return[];var n=[];return(t||[]).each(function(t){var i=t.path.replace(/\./g,"_"),o=t.value;"like"===t.comparison||"notLike"===t.comparison?("%"!==o.substr(0,1)&&(o="%"+o),"%"!==o.substr(o.length-1,1)&&(o+="%"),e[i]=o):("dateTimeValue"===t.formatType||"datetimeValue"===t.formatType?o="{ts '"+o+"'}":"dateValue"===t.formatType?o="{d '"+o+"'}":"timeValue"===t.formatType&&(o="{t '"+o+"'}"),e[i]=o),t.value=i,n.push(t)}.bind(this)),n},parseParameter:function(t){if("object"!==typeOf(t))return{};var e={};for(var n in t){var i=t[n];"date"===typeOf(i)&&(i="{ts '"+i.format("db")+"'}"),e[n]=i}return e},select:function(t,e,n){if(t.name){var o={statementId:t.name||"",isTitle:!1===t.isTitle?"no":"yes",select:!1===t.isMulti?"single":"multi",filter:t.filter,parameter:t.parameter};n||(n={}),n.width=t.width,n.height=t.height,n.title=t.caption;var r=n.width||"700",a=n.height||"400";if(layout.mobile){var u=document.body.getSize();r=u.x,a=u.y,n.style="viewmobile"}r=r.toInt(),a=a.toInt();var l=((u=i.app.content.getSize()).x-r)/2,s=(u.y-a)/2;l<0&&(l=0),s<0&&(s=0),layout.mobile&&(l=20,s=0);var c=this;MWF.require("MWF.xDesktop.Dialog",function(){var t=new MWF.xDesktop.Dialog({title:n.title||"select statement view",style:n.style||"view",top:s,left:l-20,fromTop:s,fromLeft:l-20,width:r,height:a,html:"<div style='height: 100%;'></div>",maskNode:i.app.content,container:i.app.content,buttonList:[{text:MWF.LP.process.button.ok,action:function(){e&&e(c.statement.getData()),this.close()}},{text:MWF.LP.process.button.cancel,action:function(){this.close()}}]});if(t.show(),layout.mobile){var u=t.node.getElement(".MWF_dialod_Action_back"),p=t.node.getElement(".MWF_dialod_Action_ok");u&&u.addEvent("click",function(e){t.close()}.bind(this)),p&&p.addEvent("click",function(n){e&&e(this.statement.getData()),t.close()}.bind(this))}MWF.xDesktop.requireApp("query.Query","Statement",function(){this.statement=new MWF.xApplication.query.Query.Statement(t.content.getFirst(),o,{style:"select"},i.app,i.Macro)}.bind(this))}.bind(this))}}},this.importer={upload:function(t,e,n){MWF.xDesktop.requireApp("query.Query","Importer",function(){new MWF.xApplication.query.Query.Importer(i.app.content,t,{},i.app,i.Macro).load()}.bind(this))},downloadTemplate:function(t,e){MWF.xDesktop.requireApp("query.Query","Importer",function(){new MWF.xApplication.query.Query.Importer(i.app.content,t,{},i.app,i.Macro).downloadTemplate(e)}.bind(this))}};var c=[];this.include=function(t,e){var n=t;"string"==typeOf(n)&&(n={name:n});var o=n.name,r=n.type&&n.application?n.type:"cms",a=n.application||i.json.application,u=r+"-"+a+"-"+o;if(c.indexOf(u)>-1)e&&e.apply(this);else{var l;switch(r){case"portal":this.scriptActionPortal?l=this.scriptActionPortal:(MWF.require("MWF.xScript.Actions.PortalScriptActions",null,!1),l=this.scriptActionPortal=new MWF.xScript.Actions.PortalScriptActions);break;case"process":this.scriptActionProcess?l=this.scriptActionProcess:(MWF.require("MWF.xScript.Actions.ScriptActions",null,!1),l=this.scriptActionProcess=new MWF.xScript.Actions.ScriptActions);break;case"cms":this.scriptActionCMS?l=this.scriptActionCMS:(MWF.require("MWF.xScript.Actions.CMSScriptActions",null,!1),l=this.scriptActionCMS=new MWF.xScript.Actions.CMSScriptActions)}l.getScriptByName(a,o,c,function(t){t.data?(c.push(u),t.data.importedList.each((function(e){"portal"===r?(c.push(r+"-"+t.data.portal+"-"+e),t.data.portalName&&c.push(r+"-"+t.data.portalName+"-"+e),t.data.portalAlias&&c.push(r+"-"+t.data.portalAlias+"-"+e)):"cms"===r?(c.push(r+"-"+t.data.appId+"-"+e),t.data.appName&&c.push(r+"-"+t.data.appName+"-"+e),t.data.appAlias&&c.push(r+"-"+t.data.appAlias+"-"+e)):"process"===r&&(c.push(r+"-"+t.data.application+"-"+e),t.data.appName&&c.push(r+"-"+t.data.appName+"-"+e),t.data.appAlias&&c.push(r+"-"+t.data.appAlias+"-"+e))})),c=c.concat(t.data.importedList),MWF.CMSMacro.exec(t.data.text,this),e&&e.apply(this)):e&&e.apply(this)}.bind(this),null,!1)}},this.define=function(t,e,n){var i=!0;!1===n&&(i=!1);var o={};o[t]={value:e,configurable:i},MWF.defineProperties(this,o)}.bind(this),this.wait=function(){resolve={};var t=function(t){resolve.cb=t}.bind(this);return this.target.event_resolve=t,resolve},this.goon=function(){this.target.event_resolve=null},this.form={getInfor:function(){return t.formInfor},infor:t.formInfor,getApp:function(){return i.app},app:i.app,node:function(){return i.node},readonly:i.options.readonly,get:function(t){return i.all?i.all[t]:null},getField:function(t){return o[t]},getAction:function(){return i.documentAction},getData:function(){return new MWF.xScript.CMSJSONData(i.getData())},save:function(t){i.saveDocument(t)},close:function(){i.closeDocument()},publish:function(t){i.publishDocument(t)},confirm:function(t,n,o,r,a,u,l,s,c,p){if(arguments.length<=1||"string"===o2.typeOf(arguments[1])){var d=MWF.getCenter({x:r,y:a});e={event:{clientX:d.x,x:d.x,clientY:d.y,y:d.y}},i.confirm(t,e,n,o,r,a,u,l,s,c,p)}else e=arguments.length>1?arguments[1]:null,n=arguments.length>2?arguments[2]:null,o=arguments.length>3?arguments[3]:null,r=arguments.length>4?arguments[4]:null,a=arguments.length>5?arguments[5]:null,u=arguments.length>6?arguments[6]:null,l=arguments.length>7?arguments[7]:null,s=arguments.length>8?arguments[8]:null,c=arguments.length>9?arguments[9]:null,p=arguments.length>10?arguments[10]:null,i.confirm(t,e,n,o,r,a,u,l,s,c,p)},notice:function(t,e,n,o,r,a){i.notice(t,e,n,o,r,a)},addEvent:function(t,e){i.addEvent(t,e)},openWork:function(t,e,n,i){var o=i||{};return o.workId=t,o.workCompletedId=e,o.docTitle=n,o.appId="process.Work"+(o.workId||o.workCompletedId),layout.desktop.openApplication(this.event,"process.Work",o)},openJob:function(t,e,n){var o=null;if(o2.Actions.get("x_processplatform_assemble_surface").listWorkByJob(t,function(t){t.data&&(o=t.data)}.bind(this),null,!1),o){var r=o.workList.length+o.workCompletedList.length;if(r){if(!(r>1&&e)){if(o.workList.length){var a=o.workList[0];return this.openWork(a.id,null,a.title,n)}a=o.workCompletedList[0];return this.openWork(null,a.id,a.title,n)}var u=new Element("div",{styles:{padding:"20px",width:"500px"}}).inject(i.node);o.workList.each(function(t){var e=new Element("div",{styles:{background:"#ffffff","border-radius":"10px",clear:"both","margin-bottom":"10px",height:"40px",padding:"10px 10px"}}).inject(u),i="<div style='height: 40px; width: 40px; float: left; background: url(../x_component_process_Xform/$Form/default/icon/work.png) no-repeat center center'></div><div style='height: 40px; width: 40px; float: right'><div class='MWFAction' style='height: 20px; width: 40px; margin-top: 10px; border: 1px solid #999999; border-radius: 5px;text-align: center; cursor: pointer'>"+o2.LP.widget.open+"</div></div><div style='height: 20px; line-height: 20px; margin: 0px 40px'>"+t.title+"</div><div style='margin: 0px 40px'><div style='color:#999999; float: left; margin-right: 10px'>"+t.activityName+"</div><div style='color:#999999; float: left; margin-right: 10px'>"+t.activityArrivedTime+"</div><div style='color:#999999; float: left; margin-right: 10px'>"+(t.manualTaskIdentityText||"")+"</div></div>";e.set("html",i);var o=e.getElement(".MWFAction");o.store("work",t),o.addEvent("click",function(t){var e=t.target.retrieve("work");e&&this.openWork(e.id,null,e.title,n),s.close()}.bind(this))}.bind(this)),o.workCompletedList.each(function(t){var e=new Element("div",{styles:{background:"#ffffff","border-radius":"10px",clear:"both","margin-bottom":"10px",height:"40px",padding:"10px 10px"}}).inject(u),i="<div style='height: 40px; width: 40px; float: left; background: url(../x_component_process_Xform/$Form/default/icon/work.png) no-repeat center center'></div><div style='height: 40px; width: 40px; float: right'><div class='MWFAction' style='height: 20px; width: 40px; margin-top: 10px; border: 1px solid #999999; border-radius: 5px;text-align: center; cursor: pointer'>"+o2.LP.widget.open+"</div></div><div style='height: 20px; line-height: 20px; margin: 0px 40px'>"+t.title+"</div><div style='margin: 0px 40px'><div style='color:#999999; float: left; margin-right: 10px'>"+o2.LP.widget.workcompleted+"</div><div style='color:#999999; float: left; margin-right: 10px'>"+t.completedTime+"</div>";e.set("html",i);var o=e.getElement(".MWFAction");o.store("work",t),o.addEvent("click",function(t){var e=t.target.retrieve("work");e&&this.openWork(null,e.id,e.title,n),s.close()}.bind(this))}.bind(this));var l=u.getSize().y+20;l>600&&(l=600);var s=o2.DL.open({title:o2.LP.widget.choiceWork,style:"user",isResize:!1,content:u,buttonList:[{type:"cancel",text:o2.LP.widget.close,action:function(){s.close()}}]})}}},openDocument:function(t,e,n){var i=n||{};i.documentId=t,i.docTitle=e,layout.desktop.openApplication(this.event,"cms.Document",i)},openPortal:function(t,e,n){var i=MWF.Actions.get("x_portal_assemble_surface");i.getApplication(t,(function(t){t.data&&(e?i.getPageByName(e,t.data.id,(function(e){var i=e.data?e.data.id:"";layout.desktop.openApplication(null,"portal.Portal",{portalId:t.data.id,pageId:i,parameters:n,appId:n&&n.appId||"portal.Portal"+t.data.id+i})})):layout.desktop.openApplication(null,"portal.Portal",{portalId:t.data.id,parameters:n,appId:n&&n.appId||"portal.Portal"+t.data.id}))}))},openCMS:function(t){MWF.Actions.get("x_cms_assemble_control").getColumn(t,(function(t){t.data&&layout.desktop.openApplication(null,"cms.Module",{columnId:t.data.id,appId:"cms.Module"+t.data.id})}))},openProcess:function(t){MWF.Actions.get("x_processplatform_assemble_surface").getApplication(t,(function(t){t.data&&layout.desktop.openApplication(null,"process.Application",{id:t.data.id,appId:"process.Application"+t.data.id})}))},openApplication:function(t,e){layout.desktop.openApplication(null,t,e)},createDocument:function(t,e,n,o,r,a,u,l,s){var c,p,d=t;"object"==typeOf(t)&&(d=t.column,e=t.category,n=t.data,o=t.identity,r=t.callback,a=t.target,u=t.latest,l=t.selectColumnEnable,s=t.ignoreTitle,c=t.onAfterPublish,p=t.onPostPublish),a&&layout.app&&layout.app.inBrowser&&(layout.app.content.empty(),layout.app=null),MWF.xDesktop.requireApp("cms.Index","Newer",(function(){new MWF.xApplication.cms.Index.Newer(null,null,i.app,null,{documentData:n,identity:o,ignoreTitle:!0===s,ignoreDrafted:!1===u,selectColumnEnable:!e||!0===l,restrictToColumn:!!e&&!0!==l,categoryFlag:e,columnFlag:d,onStarted:function(t,e){r&&r()},onPostPublish:function(){p&&p()},onAfterPublish:function(){c&&c()}}).load()}))},startProcess:function(t,e,n,o,r,a,u){if(arguments.length>2)for(var l=2;l<arguments.length;l++)if("boolean"==typeOf(arguments[l])){a=arguments[l];break}a&&layout.app&&layout.app.inBrowser&&(layout.app.$openWithSelf=!0);MWF.Actions.get("x_processplatform_assemble_surface").getProcessByName(e,t,(function(t){t.data&&MWF.xDesktop.requireApp("process.TaskCenter","ProcessStarter",function(){new MWF.xApplication.process.TaskCenter.ProcessStarter(t.data,i.app,{workData:n,identity:o,latest:u,onStarted:function(t,e,n){if(t.work){var i={draft:t.work,appId:"process.Work"+(new o2.widget.UUID).toString(),desktopReload:!1};layout.desktop.openApplication(null,"process.Work",i)}else{var o=[];if(t.each(function(t){-1!=t.currentTaskIndex&&o.push(t.taskList[t.currentTaskIndex].work)}.bind(this)),1==o.length){i={workId:o[0],appId:o[0]};layout.desktop.openApplication(null,"process.Work",i)}}r&&r(t)}.bind(this)}).load()}.bind(this))}))}},this.target=t.target,this.event=t.event,this.status=t.status,this.session=layout.desktop.session,this.Actions=o2.Actions,this.query=function(t){if(t){var e=t.data||{};t.firstResult&&(e.firstResult=t.firstResult.toInt()),t.maxResults&&(e.maxResults=t.maxResults.toInt()),o2.Actions.get("x_query_assemble_surface").executeStatement(t.name,e,success,error,options.async)}},this.Table=MWF.xScript.createTable()},MWF.xScript.createTable=function(){return function(t){this.name=t,this.action=o2.Actions.get("x_query_assemble_surface"),this.listRowNext=function(t,e,n,i,o){this.action.listRowNext(this.name,t,e,n,i,o)},this.listRowPrev=function(t,e,n,i,o){this.action.listRowPrev(this.name,t,e,n,i,o)},this.listRowPrev=function(t,e,n,i,o){this.action.listRowPrev(this.name,t,e,n,i,o)},this.listRowSelectWhere=function(t,e,n,i){this.action.listRowSelectWhere(this.name,t,e,n,i)},this.listRowCountWhere=function(t,e,n,i){this.action.listRowCountWhere(this.name,t,e,n,i)},this.deleteRow=function(t,e,n,i){this.action.deleteRow(this.name,t,e,n,i)},this.deleteAllRow=function(t,e,n){this.action.deleteAllRow(this.name,t,e,n)},this.getRow=function(t,e,n,i){this.action.getRow(this.name,t,e,n,i)},this.insertRow=function(t,e,n,i){this.action.insertRow(this.name,t,e,n,i)},this.updateRow=function(t,e,n,i,o){this.action.updateRow(this.name,t,e,n,i,o)}}},MWF.xScript.CMSJSONData=function(t,e,n,i){var o=function(t,e,n,i){return function(){return-1===["array","object"].indexOf(typeOf(t[n]))?t[n]:new MWF.xScript.CMSJSONData(t[n],e,n,i)}},r=function(t,e,n,i){return function(o){t[n]=o,e&&e(t,n,i)}},a=typeOf(t);"object"!==a&&"array"!==a||function(){var a={};for(var u in t)a[u]={configurable:!0,enumerable:!0,get:o.apply(this,[t,e,u,this]),set:r.apply(this,[t,e,u,this])};a.length={get:function(){return Object.keys(t).length}},a.some={get:function(){return t.some}},MWF.defineProperties(this,a);var l={getKey:{value:function(){return n}},getParent:{value:function(){return i}},toString:{value:function(){return t.toString()}},add:{value:function(n,i,a){var u=!0,l=typeOf(t);if("array"===l){if(arguments.length<2?(t.push(n),i=n,n=t.length-1):n||0===n?u=!1:(t.push(i),n=t.length-1),u)(s={})[n]={configurable:!0,enumerable:!0,get:o.apply(this,[t,e,n,this]),set:r.apply(this,[t,e,n,this])},MWF.defineProperties(this,s);this[n]=i}else if("object"===l)if(this.hasOwnProperty(n))a&&(this[n]=i);else{var s;if(t[n]=i,u)(s={})[n]={configurable:!0,enumerable:!0,get:o.apply(this,[t,e,n,this]),set:r.apply(this,[t,e,n,this])},MWF.defineProperties(this,s);this[n]=i}return this[n]}},del:{value:function(e){return this.hasOwnProperty(e)?(delete t[e],delete this[e],this):null}}};MWF.defineProperties(this,l)}.apply(this)},MWF.xScript.dictLoaded||(MWF.xScript.dictLoaded={}),MWF.xScript.addDictToCache=function(t,e,n){e||(e="root"),0!==e.indexOf("root")&&(e="root."+e);var i=t.appType||"process",o=t.enableAnonymous||!1,r=[];t.application&&r.push(t.application),t.appId&&r.push(t.appId),t.appName&&r.push(t.appName),t.appAlias&&r.push(t.appAlias);var a=[];t.id&&a.push(t.id),t.name&&a.push(t.name),t.alias&&a.push(t.alias),(d={})[e]=n;for(var u=0;u<r.length;u++)for(var l=0;l<a.length;l++){var s=a[l]+i+r[u]+o;if(MWF.xScript.dictLoaded[s]){if(0===u&&0===l){MWF.xScript.setDictToCache(s,e,n);for(var c,p=e.split(/\./g),d=MWF.xScript.dictLoaded[s],f=0;f<p.length&&(c=0===f?p[0]:c+"."+p[f],!d[c]);f++);if(c){var h=c+".";Object.keys(d).each((function(t,e){0===t.indexOf(h)&&delete d[t]}))}}}else MWF.xScript.dictLoaded[s]=d}},MWF.xScript.getMatchedDict=function(t,e){e||(e="root"),0!==e.indexOf("root")&&(e="root."+e);var n=e.split(/\./g);if(MWF.xScript.dictLoaded[t]){for(var i,o,r=MWF.xScript.dictLoaded[t],a=Array.clone(n),u=0;u<n.length;u++)if(i=0===u?n[0]:i+"."+n[u],a.shift(),r[i]){o=r[i];break}return{dict:o,unmatchedPathList:a}}return{dict:null,unmatchedPathList:a}},MWF.xScript.insertDictToCache=function(t,e,n){if(MWF.xScript.dictLoaded[t]){var i=MWF.xScript.getMatchedDict(t,e),o=i.dict,r=i.unmatchedPathList;if(o){for(var a=0;a<r.length-1;a++)o[r[a]]||(o[r[a]]={}),o=o[r[a]];var u=r[r.length-1];o[u]?"array"===typeOf(o[u])&&o[u].push(n):o[u]=n}else MWF.xScript.dictLoaded[t][e]=n}else MWF.xScript.dictLoaded[t]={},MWF.xScript.dictLoaded[t][e]=n},MWF.xScript.setDictToCache=function(t,e,n){if(MWF.xScript.dictLoaded[t]){var i=MWF.xScript.getMatchedDict(t,e),o=i.dict,r=i.unmatchedPathList;if(o){for(var a=0;a<r.length-1;a++)o[r[a]]||(o[r[a]]={}),o=o[r[a]];o[r[r.length-1]]=n}else MWF.xScript.dictLoaded[t][e]=n}else MWF.xScript.dictLoaded[t]={},MWF.xScript.dictLoaded[t][e]=n},MWF.xScript.getDictFromCache=function(t,e){var n=MWF.xScript.getMatchedDict(t,e),i=n.dict,o=n.unmatchedPathList;if(i){for(var r=0;r<o.length;r++)if(!(i=i[o[r]]))return null;return i}return null},MWF.xScript.deleteDictToCache=function(t,e){var n=MWF.xScript.getMatchedDict(t,e),i=n.dict,o=n.unmatchedPathList;if(i){for(var r=0;r<o.length-1;r++)if(!(i=i[o[r]]))return;delete i[o[o.length-1]]}},MWF.xScript.createCMSDict=function(t){return function(e){var n=e;"string"==typeOf(n)&&(n={name:n});var i=this.name=n.name,o=n.type&&n.application?n.type:"cms",r=n.application||t,a=n.enableAnonymous||!1,u={appType:o,name:i,appId:r,enableAnonymous:a},l=i+o+r+a;if("cms"==o)var s=MWF.Actions.get("x_cms_assemble_control");else s=MWF.Actions.get("x_processplatform_assemble_surface");var c=function(t){return t.split(/\./g).map((function(t){return encodeURIComponent(t)})).join("/")};this.get=function(t,e,n,i,p){var d=null;if(!0===e&&(i=!0),!0===n&&(i=!0),!p){var f=MWF.xScript.getDictFromCache(l,t);if(f)return e&&"function"==o2.typeOf(e)&&e(f),i?Promise.resolve(f):f}var h,m=function(n){return d=n.data,MWF.xScript.addDictToCache(u,t,d),e&&"function"==o2.typeOf(e)&&(d=e(n.data)),d};if(t){var g=c(t);h=s[a&&"cms"==o?"getDictDataAnonymous":"getDictData"](encodeURIComponent(this.name),r,g,m,null,!!i,!1)}else h=s[a&&"cms"==o?"getDictRootAnonymous":"getDictRoot"](this.name,r,m,null,!!i,!1);return i?h:d},this.set=function(t,e,n,i){var o=c(t);return s.setDictData(encodeURIComponent(this.name),r,o,e,(function(i){if(MWF.xScript.setDictToCache(l,t,e),n)return n(i.data)}),(function(t,e,n){if(i)return i(t,e,n)}),!1,!1)},this.add=function(t,e,n,i){var o=c(t);return s.addDictData(encodeURIComponent(this.name),r,o,e,(function(i){if(MWF.xScript.insertDictToCache(l,t,e),n)return n(i.data)}),(function(t,e,n){if(i)return i(t,e,n)}),!1,!1)},this.delete=function(t,e,n){var i=c(t);return s.deleteDictData(encodeURIComponent(this.name),r,i,(function(n){if(MWF.xScript.deleteDictToCache(l,t),e)return e(n.data)}),(function(t,e,i){if(n)return n(t,e,i)}),!1,!1)},this.destory=this.delete}};