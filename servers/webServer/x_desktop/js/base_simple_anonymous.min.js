layout=window.layout||{},layout.desktop=layout;var locate=window.location;layout.protocol=locate.protocol,layout.inBrowser=!0,layout.session=layout.session||{},layout.debugger=-1!==locate.href.toString().indexOf("debugger"),layout.anonymous=-1!==locate.href.toString().indexOf("anonymous"),o2.xApplication=o2.xApplication||{},o2.xDesktop=o2.xDesktop||{},o2.xDesktop.requireApp=function(o,e,n,t){o2.requireApp(o,e,n,t)},o2.addReady((function(){var o=$("loaddingArea"),e=0,n=document.body.getSize(),t=function(){o&&(o.destroy(),o=null)},i=function(i){if(o)if(i)o.setStyles({width:n.x+"px"}),window.setTimeout(t,500);else{var d=++e/16*n.x;o.setStyles({width:d+"px"}),e>=16&&window.setTimeout(t,500)}};layout.config=null;var d=!1,a=!1,r=!1,p=o2.session.path+"/lp/"+o2.language+".js";o2.load(p,(function(){a=!0;o2.require(["o2.xDesktop.$all"],{onSuccess:function(){r=!0,d&&r&&a&&c((function(){l()}))},onEvery:function(){i()}})})),o2.getJSON("../x_desktop/res/config/config.json",(function(o){layout.config=o,(d=!0)&&r&&a&&c((function(){l()}))}));var s=function(o,e){layout.serviceAddressList=o,layout.centerServer=e,layout.desktop.serviceAddressList=o,layout.desktop.centerServer=e},c=function(o){if("auto"===layout.config.app_protocol&&(layout.config.app_protocol=window.location.protocol),layout.config.configMapping&&(layout.config.configMapping[window.location.host]||layout.config.configMapping[window.location.hostname])){var e=layout.config.configMapping[window.location.host]||layout.config.configMapping[window.location.hostname];e.servers?(layout.serviceAddressList=e.servers,layout.desktop.serviceAddressList=e.servers,e.center&&(center="array"===o2.typeOf(e.center)?e.center[0]:e.center),layout.centerServer=center,layout.desktop.centerServer=center,o&&o()):(e.center&&(layout.config.center="array"===o2.typeOf(e.center)?e.center:[e.center]),o2.xDesktop.getServiceAddress(layout.config,function(e,n){s(e,n),i(),o&&o()}.bind(this)))}else o2.xDesktop.getServiceAddress(layout.config,function(e,n){s(e,n),i(),o&&o()}.bind(this))},l=function(){!function(o){for(;layout.readys&&layout.readys.length;)layout.readys.shift().apply(window)}()}})),function(o){o.readys=[],o.addReady=function(){for(var e=0;e<arguments.length;e++)"function"===o2.typeOf(arguments[e])&&o.readys.push(arguments[e])};var e=function(e){(function(o){return!(!window.o2android||!window.o2android.openO2Work)&&(o.workId?window.o2android.openO2Work(o.workId,"",o.title||""):o.workCompletedId&&window.o2android.openO2Work("",o.workCompletedId,o.title||""),!0)})(e)||function(o){return!!(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.openO2Work)&&(o.workId?window.webkit.messageHandlers.openO2Work.postMessage({work:o.workId,workCompleted:"",title:o.title||""}):o.workCompletedId&&window.webkit.messageHandlers.openO2Work.postMessage({work:"",workCompleted:o.workCompletedId,title:o.title||""}),!0)}(e)||function(e){var n=new URI(window.location.href).getData("redirectlink");n=n?encodeURIComponent(n):encodeURIComponent(locate.pathname+locate.search),e.workId?window.location=o2.filterUrl("../x_desktop/workmobilewithaction.html?workid="+e.workId+(o.debugger?"&debugger":"")+"&redirectlink="+n):e.workCompletedId&&(window.location=o2.filterUrl("../x_desktop/workmobilewithaction.html?workcompletedid="+e.workCompletedId+(o.debugger?"&debugger":"")+"&redirectlink="+n))}(e)},n=function(n,t,i){switch(n){case"process.Work":e(t);break;case"cms.Document":!function(e,n,t){var i="object"===typeOf(n)?n.docTitle||n.title:"";i=i||"";var d="app="+encodeURIComponent(e)+"&status="+encodeURIComponent(t?JSON.encode(t):"")+"&option="+encodeURIComponent(n?JSON.encode(n):"");window.o2android&&window.o2android.openO2CmsDocument?window.o2android.openO2CmsDocument(n.documentId,i):window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.openO2CmsDocument?window.webkit.messageHandlers.openO2CmsDocument.postMessage({docId:n.documentId,docTitle:i}):window.location=o2.filterUrl("../x_desktop/appMobile.html?"+d+(o.debugger?"&debugger":""))}(n,t,i);break;case"cms.Module":!function(e,n,t){var i="app="+encodeURIComponent(e)+"&status="+encodeURIComponent(t?JSON.encode(t):"")+"&option="+encodeURIComponent(n?JSON.encode(n):"");window.o2android&&window.o2android.openO2CmsApplication?window.o2android.openO2CmsApplication(n.columnId,n.title||""):window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.openO2CmsApplication?window.webkit.messageHandlers.openO2CmsApplication.postMessage(n.columnId):window.location=o2.filterUrl("../x_desktop/appMobile.html?"+i+(o.debugger?"&debugger":""))}(n,t,i);break;case"Meeting":!function(e,n,t){var i="app="+encodeURIComponent(e)+"&status="+encodeURIComponent(t?JSON.encode(t):"")+"&option="+encodeURIComponent(n?JSON.encode(n):"");window.o2android&&window.o2android.openO2Meeting?window.o2android.openO2Meeting(""):window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.openO2Meeting?window.webkit.messageHandlers.openO2Meeting.postMessage(""):window.location=o2.filterUrl("../x_desktop/appMobile.html?"+i+(o.debugger?"&debugger":""))}(n,t,i);break;case"Calendar":!function(e,n,t){var i="app="+encodeURIComponent(e)+"&status="+encodeURIComponent(t?JSON.encode(t):"")+"&option="+encodeURIComponent(n?JSON.encode(n):"");window.o2android&&window.o2android.openO2Calendar?window.o2android.openO2Calendar(""):window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.openO2Calendar?window.webkit.messageHandlers.openO2Calendar.postMessage(""):window.location=o2.filterUrl("../x_desktop/appMobile.html?"+i+(o.debugger?"&debugger":""))}(n,t,i);break;case"process.TaskCenter":!function(e,n,t){var i="app="+encodeURIComponent(e)+"&status="+encodeURIComponent(t?JSON.encode(t):"")+"&option="+encodeURIComponent(n?JSON.encode(n):""),d=(n&&n.navi?n.navi:"task").toLowerCase();"done"===d&&(d="taskCompleted"),"readed"===d&&(d="readCompleted"),window.o2android&&window.o2android.openO2WorkSpace?window.o2android.openO2WorkSpace(d):window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.openO2WorkSpace?window.webkit.messageHandlers.openO2WorkSpace.postMessage(d):window.location=o2.filterUrl("../x_desktop/appMobile.html?"+i+(o.debugger?"&debugger":""))}(n,t,i);break;default:var d=new URI(window.location.href),a=d.getData("option"),r=d.getData("status");window.location=o2.filterUrl("../x_desktop/appMobile.html?app="+n+"&option="+(a||"")+"&status="+(r||"")+(o.debugger?"&debugger":""))}};o.openApplication=function(e,t,i,d){if(o.app){if(!o.mobile){var a="app="+encodeURIComponent(t)+"&status="+encodeURIComponent(d?JSON.encode(d):"")+"&option="+encodeURIComponent(i?JSON.encode(i):"");return o.app.$openWithSelf?window.location=o2.filterUrl("../x_desktop/app.html?"+a+(o.debugger?"&debugger":"")):window.open(o2.filterUrl("../x_desktop/app.html?"+a+(o.debugger?"&debugger":"")),a)}n(t,i,d)}else{var r=t.split("."),p=r[r.length-1];!function(o,e,n){var t=o.split("."),i=o2.xApplication;t.each(function(o,e){e<t.length-1?i[o]=i[o]||{}:i[o]=i[o]||{options:Object.clone(o2.xApplication.Common.options)},i=i[o]}.bind(this)),i.options||(i.options=Object.clone(o2.xApplication.Common.options));o2.xDesktop.requireApp(o,"lp."+o2.language,{failure:function(){o2.xDesktop.requireApp(o,"lp.zh-cn",null,!1)}.bind(this)},!1),o2.xDesktop.requireApp(o,n,(function(){e&&e(i)}))}(t,function(e){!function(e,n,t,i,d){var a=new n.Main(this,i);a.desktop=o,a.inBrowser=!0,a.status=d,a.load(!0);var r=t;i.appId?r=i.appId:n.options.multitask&&(r=r+"-"+new o2.widget.UUID),a.appId=r,o.app=a,o.desktop.currentApp=a;var p=document.getElementById("appContentMask");p&&p.destroy()}(0,e,p,i,d)}.bind(this))}},o.refreshApp=function(e){var n=e.recordStatus(),t=new URI(window.location.href),i=t.getData("app"),d=(t.getData("option"),t.getData("status"));n&&(d=JSON.encode(n));var a=t.get("port");window.location=t.get("scheme")+"://"+t.get("host")+(a?":"+a+"/":"")+t.get("directory ")+"?app="+encodeURIComponent(i)+"&status="+encodeURIComponent(d)+"&option="+encodeURIComponent(options?JSON.encode(options):"")+(o.debugger?"&debugger":"")},o.load=function(e,n,t){o.apps=[],o.node=$("layout");var i=e,d=t,a=n,r=window.opener;if(r)try{i||(i=r.layout.desktop.openBrowserApp),d||(d=r.layout.desktop.openBrowserStatus),a||(a=r.layout.desktop.openBrowserOption)}catch(o){}o.openApplication(null,i,a||{},d)}}(layout);