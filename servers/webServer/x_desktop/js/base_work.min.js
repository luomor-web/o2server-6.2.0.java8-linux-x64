layout={},o2.xApplication=o2.xApplication||{},o2.widget=o2.widget||{},o2.widget.css=o2.widget.css||{},o2.xDesktop=o2.xDesktop||{},o2.xDesktop.$all=!0,o2.xDesktop.Common=!0;var csskey=encodeURIComponent("../x_component_process_Work/$Main/default/css.wcss");o2.widget.css[csskey]={content:{width:"100%",height:"100%",overflow:"auto","background-color":"#FFF"},formNode:{"min-height":"100%","font-size":"14px",overflow:"hidden","background-color":"#FFF"},maskNode:{"background-color":"#666",opacity:.4,"z-index":100},processNode_from:{width:"480px","min-height":"280px",height:"auto","z-index":300,"background-color":"#FFF",overflow:"hidden",border:"3px solid #666","border-radius":"10px","box-shadow":"0px 0px 15px #666",opacity:1,position:"absolute"},processNode_Area:{height:"300px",width:"700px",padding:"10px","background-color":"#FFF",overflow:"hidden"},processNodeMobile_from:{width:"480px","min-height":"280px",height:"auto","z-index":3e3,"background-color":"#eeeeee",overflow:"hidden",border:"0px","border-radius":"0px","box-shadow":"0px",opacity:1,position:"absolute"},processNode:{width:"480px","min-height":"280px",height:"auto",opacity:1,overflow:"hidden"},processNodeMobile:{width:"480px","min-height":"280px",height:"auto",opacity:1,top:"0px",left:"0px",overflow:"hidden"},routeSelectorTile:{overflow:"hidden",height:"24px","line-height":"24px"},routeSelectorArea:{overflow:"hidden"},mobileActionBarNode:{"font-size":"16px",color:"#008BE6","text-align":"center","line-height":"40px",height:"40px",width:"100%",position:"absolute","background-color":"#ffffff",bottom:"0px"},mobileSaveActionNode:{height:"40px"},workListArea:{width:"90%","min-width":"300px","max-width":"600px",margin:"60px auto 0px auto",overflow:"hidden"},workListAreaTitle:{height:"60px",padding:"0px 10px",color:"#666666","font-size":"20px",overflow:"hidden"},workListContent:{margin:"10px auto 0px auto",overflow:"hidden"},workItemNode:{padding:"3px 10px",height:"60px","border-radius":"30px",border:"2px solid #cccccc","margin-bottom":"20px","background-color":"#ffffff",cursor:"pointer"},workItemNode_over:{border:"2px solid #4A90E2"},workItemTitleNode:{height:"27px","line-height":"27px",padding:"0px 10px",color:"#333333"},workItemInforNode:{height:"27px","line-height":"27px",padding:"0px 10px",color:"#999999","font-size":"12px"},workItemInforTitleNode:{color:"#333333","font-weight":"bold",float:"left","margin-right":"5px"},workItemInforContentNode:{float:"left","margin-right":"10px"},formNode_bg:{"background-color":"#f3f3f3"}};csskey=encodeURIComponent("../x_component_process_Xform/$Form/default/css.wcss");o2.widget.css[csskey]={container:{padding:"3px",overflow:"hidden","-webkit-user-select":"text","-moz-user-select":"text"},textfieldNode:{display:"inline-block"},personfieldIcon:{background:"url(../x_component_process_Xform/$Form/default/icon/selectperson.png) center center no-repeat",width:"18px",height:"18px",float:"right",cursor:"pointer"},orgfieldIcon:{background:"url(../x_component_process_Xform/$Form/default/icon/selectorg.png) center center no-repeat",width:"18px",height:"18px",float:"right"},orgIcon:{background:"url(../x_component_process_Xform/$Form/default/icon/selectperson.png) center center no-repeat",width:"18px",height:"18px",float:"right"},textFieldIcon:{background:"url(../x_component_process_Xform/$Form/default/icon/inputtext.png) center center no-repeat",width:"18px",height:"18px",float:"right"},numberIcon:{background:"url(../x_component_process_Xform/$Form/default/icon/number.png) center center no-repeat",width:"18px",height:"18px",float:"right"},calendarIcon:{background:"url(../x_component_process_Xform/$Form/default/icon/calendar.png) center center no-repeat",width:"18px",height:"18px",float:"right",cursor:"pointer"},selectIcon:{background:"url(../x_component_process_Xform/$Form/default/icon/pull.png) center center no-repeat",width:"18px",height:"18px",float:"right",cursor:"pointer"},descriptionNode:{color:"#bbb",cursor:"text",position:"absolute",top:"0px"},buttonStyles:{color:"#777","border-radius":"5px","border-top":"1px solid #ccc","border-left":"1px solid #ccc","border-right":"1px solid #ccc","border-bottom":"1px solid #ccc",overflow:"hidden",cursor:"pointer","-webkit-user-select":"none","-moz-user-select":"none",position:"static",top:"auto",left:"auto",opacity:1,height:"26px"},datagridTitle:{height:"28px",cursor:"pointer","line-height":"28px",overflow:"hidden",opacity:1,background:"#C3CEEA"},gridLineActionCell:{width:"40px"},gridMoveActionCell:{width:"5px"},addLineAction:{width:"20px",height:"20px",background:"url(../x_component_process_Xform/$Form/default/icon/addline.png) center center no-repeat",cursor:"pointer",float:"left"},delLineAction:{width:"20px",height:"20px",background:"url(../x_component_process_Xform/$Form/default/icon/delline.png) center center no-repeat",cursor:"pointer",float:"left"},completeLineAction:{width:"20px",height:"20px",background:"url(../x_component_process_Xform/$Form/default/icon/check.png) center center no-repeat",cursor:"pointer",float:"left"},moveLineAction:{width:"5px",height:"20px",background:"url(../x_component_process_Xform/$Form/default/icon/move.png) center center no-repeat",cursor:"move",float:"left"},datatableMoveLineAction:{width:"5px",color:"#aaa",cursor:"pointer",float:"left"},gridMoveLineDragNode:{opacity:.7,"z-index":3e4,"background-color":"#CCC",position:"absolute"},gridMoveLineDragNodeTr:{"background-color":"#e4f6e9"},logActivityNode:{overflow:"hidden",margin:"0px",border:"1px solid #CCC","background-color":"#FFF"},logActivityNode_record:{overflow:"hidden",margin:"0px",padding:"10px 0",border:"1px solid #CCC","background-color":"#FFF"},logActivityNode_even:{overflow:"hidden",border:"1px solid #CCC","background-color":"#FFF"},logActivityTitleNode:{height:"40px","line-height":"40px","background-color":"#f0f0f0","border-bottom":"1px solid #CCC","font-size":"12px",overflow:"hidden"},logActivityTitleNode_even:{height:"40px","line-height":"40px","background-color":"#f0f0f0","border-bottom":"1px solid #CCC","font-size":"12px",overflow:"hidden"},logActivityChildNode:{clear:"both",overflow:"hidden"},logActivityChildRecordNode:{clear:"both",overflow:"hidden","background-color":"#ffffff","min-height":"30px","line-height":"30px"},logActivityChildRecordNode_even:{clear:"both",overflow:"hidden","background-color":"#f6f6f6","min-height":"30px","line-height":"40px"},logActivityIconNode:{height:"40px",width:"30px","background-position":"center center","background-repeat":"no-repeat",float:"left"},logActivityFromNode:{height:"40px","line-height":"40px",float:"left","font-size":"14px"},logActivityArrowNode:{height:"40px",width:"30px","background-position":"center center","background-repeat":"no-repeat",float:"left"},logActivityArrivedNode:{height:"40px","line-height":"40px",float:"left","font-size":"14px"},logActivityReadActionNode:{height:"40px","line-height":"40px",float:"left",color:"#0000FF","margin-left":"20px",cursor:"pointer","font-size":"12px"},logActivityTimeNode:{height:"40px","line-height":"20px","margin-right":"5px",float:"right"},logTaskNode:{clear:"both",overflow:"hidden","line-height":"28px","font-size":"12px",background:"transparent"},logTaskNode_even:{overflow:"hidden","line-height":"28px","font-size":"12px",background:"#e7ecf6"},logTaskIconNode:{height:"28px",width:"28px","margin-left":"20px","background-position":"center center","background-repeat":"no-repeat",float:"left"},logTaskIconNode_record:{height:"28px",width:"28px","background-position":"center center","background-repeat":"no-repeat",float:"left"},logTaskTextNode:{"margin-right":"10px",overflow:"hidden"},logTaskFloatTextNode:{"margin-right":"10px",overflow:"hidden"},logReadTextNode:{margin:"5px 48px 5px 48px",overflow:"hidden","line-height":"18px","font-size":"12px"},logMediaIcon:{width:"20px",height:"28px","background-position":"center center","margin-left":"10px","background-repeat":"no-repeat",float:"left",cursor:"pointer"},logMediaOpinionContent:{background:"#ffffff",border:"1px solid #cccccc",float:"left",overflow:"hidden"},logMediaOpinionContentClose:{height:"20px",width:"20px",float:"right",background:"url(../x_component_process_Xform/$Form/default/icon/close.png) center center no-repeat",cursor:"pointer"},logMediaOpinionContentArea:{overflow:"hidden"},logTable:{"border-left":"1px solid #CCC","border-top":"1px solid #CCC"},logTableTr:{"background-color":"#edf3f9"},logTableIconTd:{width:"20px","background-position":"center center","background-repeat":"no-repeat","border-right":"0px solid #CCC","border-bottom":"1px solid #CCC"},logTableActivityTd:{"border-right":"1px solid #CCC","border-bottom":"1px solid #CCC"},logTableTaskTd:{"border-right":"1px solid #CCC","border-bottom":"1px solid #CCC","background-color":"#FFF"},logTableActivityNode:{"line-height":"28px","font-size":"14px","text-align":"center"},logTableActivityTimeNode:{"line-height":"20px","text-align":"center"},logTableTask:{"border-left":"1px solid #CCC","border-top":"1px solid #CCC","font-size":"12px"},logTableTaskTitleLine:{"text-align":"center","font-weight":"bold","background-color":"#edf3f9"},logTableTaskTitle:{"line-height":"28px","border-right":"1px solid #CCC","border-bottom":"1px solid #CCC"},logTableTaskLine:{"line-height":"28px","border-right":"1px solid #CCC","border-bottom":"1px solid #CCC",background:"#ffffff"},logTableTaskLine_even:{"line-height":"28px","border-right":"1px solid #CCC","border-bottom":"1px solid #CCC",background:"#f6f6f6"},logTableTaskLine_task:{"line-height":"28px","border-right":"1px solid #CCC","border-bottom":"1px solid #CCC",color:"red"},datagridTotalTr:{height:"20px",cursor:"pointer","line-height":"20px",overflow:"hidden",background:"#e1e6f3"},datagridTotalTd:{"font-weight":"bold"},mobileDatagridTable:{},gridTotalNode:{overflow:"hidden","margin-bottom":"10px"},gridTotalTitleNode:{height:"30px","text-align":"center","line-height":"30px","font-size":"14px","font-weight":"bold","background-color":"#C3CEEA","border-top":"1px solid #999","border-left":"1px solid #999","border-right":"1px solid #999"},gridMobileTableNode:{overflow:"hidden"},gridTotalTableNode:{overflow:"hidden"},gridMobileDeleteActionAreaNode:{color:"#FFF","text-align":"center",float:"right"},gridMobileDeleteActionNode:{background:"#cd0a0a",color:"#FFF","text-align":"center",height:"100%",width:"100%",float:"right"},gridMobileActionNode:{"margin-bottom":"10px",height:"30px","line-height":"30px",border:"1px solid #CCCCCC","border-radius":"5px","text-align":"center"},gridImpExpAreaNode:{display:"block"},gridImportActionStyles:{color:"#777","border-radius":"5px",border:"1px solid #ccc",cursor:"pointer",height:"26px",float:"left","line-height":"26px",padding:"0px 5px","background-color":"#efefef",margin:"5px"},gridExportActionStyles:{color:"#777","border-radius":"5px",border:"1px solid #ccc",cursor:"pointer",height:"26px",float:"left","line-height":"26px",padding:"0px 5px","background-color":"#efefef",margin:"5px"},mobileGridHelpNode:{width:"30px",height:"30px",background:"url(../x_component_process_Xform/$Form/default/icon/help.png) center center no-repeat",cursor:"pointer"},mobileDatagridActionNode:{width:"235px","text-align":"right",float:"right"},mobileDatagridDelActionNode:{width:"34px","margin-left":"10px",height:"28px","line-height":"28px",color:"#666","font-size":"16px","padding-left":"26px","padding-right":"5px",border:"1px solid #CCCCCC","border-radius":"3px",background:"url(../x_component_process_Xform/$Form/default/icon/del.png) 5px center no-repeat",float:"right",cursor:"pointer"},mobileDatagridEditActionNode:{width:"34px","margin-left":"10px",height:"28px","line-height":"28px",color:"#666","font-size":"16px","padding-left":"26px","padding-right":"5px",border:"1px solid #CCCCCC","border-radius":"3px",background:"url(../x_component_process_Xform/$Form/default/icon/edit.png) 5px center no-repeat",float:"right",cursor:"pointer"},mobileDatagridAddActionNode:{width:"34px","margin-left":"10px",height:"28px","line-height":"28px",color:"#666","font-size":"16px","padding-left":"26px","padding-right":"5px",border:"1px solid #CCCCCC","border-radius":"3px",background:"url(../x_component_process_Xform/$Form/default/icon/add.png) 5px center no-repeat",float:"right",cursor:"pointer"},mobileDatagridCancelActionNode:{width:"34px","margin-left":"10px",height:"28px","line-height":"28px",color:"#666","font-size":"16px","padding-left":"26px","padding-right":"5px",border:"1px solid #CCCCCC","border-radius":"3px",background:"url(../x_component_process_Xform/$Form/default/icon/del.png) 5px center no-repeat",float:"right",cursor:"pointer",display:"none"},mobileDatagridCompleteActionNode:{width:"34px","margin-left":"10px",height:"28px","line-height":"28px",color:"#666","font-size":"16px","padding-left":"26px","padding-right":"5px",border:"1px solid #CCCCCC","border-radius":"3px",background:"url(../x_component_process_Xform/$Form/default/icon/completed.png) 5px center no-repeat",float:"right",cursor:"pointer",display:"none"},mobileGridHelpContentNode:{"font-size":"14px",color:"#999"},officeSpacerNode:{width:"100%",position:"absolute",display:"none",opacity:"0"},officeAreaNode:{width:"100%","z-index":"100"},officeMenuNode:{height:"30px","background-color":"#2a579a"},officeMenuItemNode:{height:"22px","margin-top":"3px","margin-left":"5px",background:"transparent",border:"0px solid #DDDDDD",color:"#ffffff",cursor:"pointer",padding:"0px 5px","line-height":"30px","font-size":"14px",float:"left"},sidebar:{border:"1px solid #999999","border-radius":"8px",overflow:"hidden"},opinionSelectNode:{position:"absolute",border:"1px solid #cccccc","border-radius":"5px","min-width":"120px","max-height":"300px",padding:"5px 0px","background-color":"#ffffff",overflow:"auto"},opinionSelectOption:{padding:"3px 10px",cursor:"pointer"},inputOpinionMediaActionArea:{position:"relative",height:"25px","line-height":"25px",top:"-34px",float:"right",width:"160px","margin-right":"5px"},inputOpinionHandwritingAction:{float:"right",border:"1px solid #6681a5","border-radius":"3px",cursor:"pointer","padding-left":"24px","padding-right":"5px","margin-left":"5px",cursor:"pointer",background:"url(../x_component_process_Work/$Processor/default/write.png) no-repeat 5px center"},handwritingNode:{position:"absolute",background:"#ffffff",border:"2px solid #999","border-radius":"8px","box-shadow":"0px 0px 10px #666"},handwritingActionNode:{height:"30px","line-height":"30px",margin:"5px auto",width:"70%","min-width":"100px","border-radius":"5px","text-align":"center","background-color":"#6681a5",color:"#ffffff","font-size":"16px",cursor:"pointer"},inputOpinionAudioRecordAction:{float:"right",border:"1px solid #6681a5","border-radius":"3px",cursor:"pointer","padding-left":"24px","padding-right":"5px","margin-left":"5px",cursor:"pointer",background:"url(../x_component_process_Work/$Processor/default/audioRecord.png) no-repeat 5px center"},modelNode:{"border-radius":"3px",border:"1px solid #999999","box-shadow":"0px 0px 5px #666",padding:"5px","background-color":"#ffffff",position:"absolute"},modelNodeTitle:{height:"20px","line-height":"20px","font-weight":"bold",color:"#666666",float:"left"},modelItemNode:{height:"20px","line-height":"20px","font-size":"12px",color:"#a31515",float:"left",cursor:"pointer","margin-left":"10px"},modelNodeContent:{"margin-left":"10px"},attachmentPermissionNode:{overflow:"hidden",width:"500px",padding:"0px 40px"},attachmentPermissionNamesNode:{overflow:"hidden"},attachmentPermissionNamesTitleNode:{"font-size":"14px",color:"#666666",height:"30px","font-weight":"bold","line-height":"30px"},attachmentPermissionNamesAreaNode:{overflow:"hidden",padding:"0px",color:"#0000ff","margin-bottom":"20px"},attachmentPermissionAttNode:{height:"20px","line-height":"20px"},attachmentPermissionTitleNode:{"font-size":"14px",color:"#666666",height:"26px","line-height":"26px"},attachmentPermissionInputNode:{"min-height":"24px",overflow:"hidden","line-height":"24px",border:"1px solid #3C76B7","border-radius":"3px",cursor:"pointer","margin-bottom":"10px","background-color":"#ffffff"},attachmentOCRNode:{width:"500px",height:"450px",padding:"20px 20px 10px 20px"},attachmentOCRInputAreaNode:{height:"242px",border:"1px solid #999999","border-radius":"5px",padding:"5px","background-color":"#ffffff"},attachmentOCRInputNode:{height:"230px",width:"490px",border:"0px","font-size":"14px","font-family":"'Microsoft YaHei','Microsoft YaHei','SimSun','宋体'",overflow:"auto"},attachmentOCRImageAreaNode:{height:"190px","margin-bottom":"10px","text-align":"center"},attachmentOCRImageNode:{"max-height":"190px","max-height":"190px","max-width":"498px",margin:"auto"},empowerAreaNode:{padding:"0 30px","font-size":"14px",overflow:"hidden"},empowerSelectAllItemNode:{height:"40px","line-height":"40px","padding-left":"5px","font-size":"16px",width:"50px","margin-left":"30px",float:"left",overflow:"hidden",color:"inherit",cursor:"pointer",background:"url(../x_component_process_Xform/$Form/default/icon/rollback_uncheck.png) no-repeat left center"},empowerSelectAllItemNode_over:{color:"#3C76B7",background:"url(../x_component_process_Xform/$Form/default/icon/rollback_uncheck.png) no-repeat left center"},empowerSelectAllItemNode_selected:{color:"#3C76B7",background:"url(../x_component_process_Xform/$Form/default/icon/empower_check.png) no-repeat left center"},empowerItemOddNode:{float:"left",width:"250px",height:"20px","margin-bottom":"10px",padding:"10px",cursor:"pointer","background-color":"#ffffff","margin-right":"10px"},empowerItemEvenNode:{float:"left",width:"250px",height:"20px","margin-bottom":"10px",padding:"10px",cursor:"pointer","background-color":"#ffffff"},empowerItemOddNode_over:{"background-color":"#eaf1f9"},empowerItemEvenNode_over:{"background-color":"#eaf1f9"},empowerItemOddNode_selected:{"background-color":"#6196d1"},empowerItemEvenNode_selected:{"background-color":"#6196d1"},empowerItemIconNode:{height:"20px",width:"30px",float:"right",overflow:"hidden",background:"url(../x_component_process_Xform/$Form/default/icon/rollback_uncheck.png) no-repeat center center"},empowerItemIconNode_selected:{background:"url(../x_component_process_Xform/$Form/default/icon/rollback_check.png) no-repeat center center"},empowerItemContentNode:{height:"20px"},empowerItemTitleNode:{float:"left",height:"20px","margin-left":"5px","line-height":"20px","font-size":"14px",color:"#666666"},empowerItemTitleNode_selected:{color:"#ffffff"},empowerItemPersonNode:{float:"left","margin-left":"5px",height:"20px","line-height":"20px","font-size":"14px",color:"#0000ff"},empowerItemPersonNode_selected:{color:"#ffffff"},rollbackItemIconNode:{height:"46px",width:"30px",float:"right",overflow:"hidden",background:"url(../x_component_process_Xform/$Form/default/icon/rollback_uncheck.png) no-repeat center center"},rollbackItemIconNode_current:{background:"url(../x_component_process_Xform/$Form/default/icon/rollback_check.png) no-repeat center center"},rollbackItemContentNode:{"margin-right":"30px",height:"46px"},rollbackAreaNode:{padding:"0 30px","font-size":"14px",overflow:"hidden"},rollbackItemNode:{"min-height":"46px","margin-bottom":"10px",padding:"10px",cursor:"pointer","background-color":"#ffffff"},rollbackItemNode_over:{"background-color":"#eaf1f9"},rollbackItemNode_current:{"background-color":"#6196d1"},rollbackItemIconNode:{height:"46px",width:"30px",float:"right",overflow:"hidden",background:"url(../x_component_process_Xform/$Form/default/icon/rollback_uncheck.png) no-repeat center center"},rollbackItemIconNode_current:{background:"url(../x_component_process_Xform/$Form/default/icon/rollback_check.png) no-repeat center center"},rollbackItemContentNode:{"margin-right":"30px",height:"46px"},rollbackItemActivityNode:{height:"26px","line-height":"26px","font-weight":"bold",float:"left",color:"#000000","margin-right":"10px"},rollbackItemActivityNode_current:{color:"#ffffff"},rollbackItemTimeNode:{height:"26px","line-height":"26px",color:"#666666",float:"left"},rollbackItemTimeNode_current:{color:"#eeeeee"},rollbackItemTaskTitleNode:{float:"left",height:"20px","line-height":"20px","font-size":"12px",color:"#0000ff","font-weight":"bold"},rollbackItemTaskTitleNode_current:{color:"#ffffff"},rollbackItemTaskNode:{float:"left","margin-left":"5px",height:"20px","line-height":"20px","font-size":"12px",color:"#666666",float:"left"},rollbackItemTaskCheckNode:{float:"left"},rollbackItemTaskNode_current:{color:"#eeeeee"},officeRecoverItemNode:{height:"30px","line-height":"30px","margin-bottom":"10px",padding:"10px",cursor:"pointer",color:"#666666","font-weight":"bold","font-size":"14px","background-color":"#ffffff"},officeRecoverItemNode_over:{"background-color":"#eaf1f9"},officeRecoverItemNode_current:{color:"#ffffff","background-color":"#6196d1"},officeRecoverItemActionNode:{height:"30px",width:"50px",float:"right",overflow:"hidden",background:"url(../x_component_process_Xform/$Form/default/icon/open.png) no-repeat center center"},officeRecoverItemActionNode_current:{background:"url(../x_component_process_Xform/$Form/default/icon/open_current.png) no-repeat center center"},officeRecoverItemTitleNode:{"margin-right":"50px",height:"30px"},documentEditorNode:{background:"#f1f1f1",border:"1px solid #cccccc",overflow:"hidden",position:"relative"},documentEditorNode_page:{width:"15.6cm",height:"22.5cm",padding:"3.7cm 2.6cm 3.5cm 2.8cm",margin:"30px auto",border:"0px #D3D3D3 solid","border-radius":"5px",background:"#ffffff","box-shadow":"0 0 10px rgba(0, 0, 0, 0.1)","font-size":"16pt","font-family":"'仿宋', serif","line-height":"1.02cm","letter-spacing":"-0.01cm"},html5ActionButtonDingdingMore:{height:"3em",float:"left",margin:"0.5em 0","font-size":"1em",color:"#191F25","text-align":"center",background:"#ffffff","line-height":"3em"},html5ActionButtonDingdingNormal:{height:"3em",float:"left",margin:"0.5em 0","font-size":"1em",color:"#191F25","text-align":"center",background:"#ffffff","line-height":"3em","border-radius":"5px",border:"1px solid #dfdfdf"},html5ActionButtonDingdingPrimary:{height:"3em",float:"left",margin:"0.5em 0","font-size":"1em",color:"#ffffff","text-align":"center",background:"#3296FA","line-height":"3em","border-radius":"5px",border:"1px solid #3296FA"},html5ActionButtonDingdingDanger:{height:"3em",float:"left",margin:"0.5em 0","font-size":"1em",color:"#ffffff","text-align":"center",background:"#F25643","line-height":"3em","border-radius":"5px",border:"1px solid #F25643"},html5ActionButtonDingdingSplit:{width:"1em","background-color":"#ffffff",height:"3em",margin:"0.5em 0",float:"left"},html5ActionButton:{height:"100%",float:"left","font-size":"16px",color:"#fb4747","text-align":"center",background:"#ffffff","line-height":"50px"},html5ActionButtonSplit:{width:"1px","background-color":"#dfdfdf",height:"34px","margin-top":"8px",float:"left"},html5ActionOtherArea:{overflow:"hidden",background:"#ffffff",position:"absolute",left:"0",bottom:"50px","z-index":100,padding:"0px 20px","border-top":"1px solid #dfdfdf"},html5ActionOtherButton:{height:"50px","font-size":"16px","border-bottom":"1px solid #dfdfdf",color:"#068de7","text-align":"center","line-height":"50px"},html5ActionButton_over:{background:"#eeeeee"},html5ActionButton_up:{background:"#ffffff"},waitSplitPageNode:{width:"260px",height:"60px","line-height":"60px","background-color":"#333333",position:"absolute","font-size":"16px",color:"#ffffff","border-radius":"10px","text-align":"center",opacity:.9,"z-index":2e4,border:"1px solid #333333","box-shadow":"3px 3px 20px #333333"},attachmentOrderNode:{width:"700px",height:"600px",padding:"10px 10px 5px 10px"},attachmentOrderInforNode:{padding:"10px 20px 5px 20px",height:"30px","line-height":"30px",color:"#666666"},attachmentOrderAreaNode:{padding:"10px 10px 5px 10px","background-color":"#ffffff",height:"530px",overflow:"auto"},attachmentOrderItemNode:{"min-height":"30px",overflow:"auto","line-height":"30px",padding:"5px 0px","border-bottom":"1px solid #cccccc"},attachmentOrderItemIconNode:{width:"30px",height:"30px",float:"left",cursor:"move",background:"url(../x_component_process_Xform/$Form/default/icon/attOrder.png) no-repeat center center","background-size":"24px 24px"},attachmentOrderItemTextNode:{"margin-left":"30px","margin-right":"130px","min-height":"30px",padding:"0px 5px",color:"#666666"},attachmentOrderItemActionNode:{width:"130px",height:"30px",float:"right"},attachmentOrderItemActionUpNode:{border:"1px solid #999999","border-radius":"3px",height:"20px",width:"30px",float:"left","margin-left":"5px","margin-top":"4px","padding-left":"20px","line-height":"20px","font-size":"12px",cursor:"pointer",background:"url(../x_component_process_Xform/$Form/default/icon/moveup.png) no-repeat 3px center",color:"#999999"},attachmentOrderItemActionDownNode:{border:"1px solid #999999","border-radius":"3px",height:"20px",width:"30px",float:"left","margin-left":"5px","margin-top":"4px","padding-left":"20px","line-height":"20px","font-size":"12px",cursor:"pointer",background:"url(../x_component_process_Xform/$Form/default/icon/movedown.png) no-repeat 3px center",color:"#999999"},attachmentOrderFlagNode:{height:"2px","background-color":"#5c649c"}};csskey=encodeURIComponent("../o2_core/o2/widget/$Tab/mobileForm/css.wcss");o2.widget.css[csskey]={tabNodeContainer:{height:"40px",background:"#ffffff","border-top":"0px solid #CCC","border-bottom":"0px solid #CCC"},contentNodeContainer:{overflow:"hidden",clear:"both"},contentNodeArea:{overflow:"hidden",display:"none",opacity:0},tabNode:{position:"relative","margin-left":"2px","margin-right":"0px",float:"left",height:"40px",cursor:"pointer","min-width":"70px",background:"#ffffff",border:"0px"},tabTextNode:{color:"#666666","line-height":"40px","text-align":"center","margin-right":"4px","margin-top":"0px","margin-left":"4px","font-size":"14px"},tabCloseNode:{height:"24px",width:"20px",background:"url("+o2.session.path+"/widget/$Tab/default/close.gif) center center"},tabNodeCurrent:{position:"relative","margin-top":"0px","margin-left":"2px","margin-right":"0px",float:"left",height:"40px","min-width":"70px",background:"#ffffff","border-bottom":"2px solid #bf6364"},tabTextNodeCurrent:{color:"#fb4747","line-height":"40px","text-align":"center","margin-right":"4px","margin-left":"4px","font-size":"14px"},tabCloseNodeCurrent:{height:"30px",width:"20px",background:"url("+o2.session.path+"/widget/$Tab/default/close.gif) center center"}};csskey=encodeURIComponent("../o2_core/o2/widget/$Menu/tab/css.wcss");o2.widget.css[csskey]={borderNode:{border:"0px solid #666","background-color":"#666666",padding:"1px",overflow:"hidden",display:"none","z-index":"999",opacity:0,position:"absolute",float:"left","min-width":Browser.iecomp?"auto":"140px","border-radius":"3px","box-shadow":"0px 0px 10px #333",cursor:"default"},container:{"border-top":"1px solid #eeeeee","border-left":"1px solid #eeeeee","border-right":"1px solid #eeeeee","border-bottom":"1px solid #eeeeee","border-radius":"3px","background-color":"#eeeeee",padding:"3px",overflow:"hidden",cursor:"default"},menuItem:{"border-radius":"3px",display:"block",position:"static",height:"24px","line-height":"24px",border:"1px solid #eeeeee","background-color":"#eeeeee",cursor:"pointer",color:"#000","font-family":"Microsoft YaHei","font-size":"14px"},menuItemImgDiv:{display:"block",float:"left",width:"0px",height:"24px","text-align":"center"},menuItemImg:{height:"16px",width:"0px","margin-top":"4px","margin-left":"4px"},menuItemSeparator:{display:"block",float:"left",height:"24px",width:"0px","background-color":"#d7d7d7","border-right":"0px solid #d7d7d7",overflow:"hidden"},menuItemText:{display:"block",position:"static",height:"24px","margin-left":"10px","margin-right":"10px","line-height":"24px","font-size":"12px"},menuLine:{position:"static",display:"block",height:"1px",overflow:"hidden","margin-left":"0px","margin-top":"3px","margin-bottom":"3px","background-color":"#CCCCCC","border-bottom":"1px solid #FFFFFF"},menuItemDisable:{color:"#999"},menuOver:{border:"1px solid #999","background-color":"#aec0d7"},menuOut:{border:"1px solid #eeeeee","background-color":"#eeeeee"},menuDown:{border:"1px solid #000000","background-color":"#c6cde0"},menuUp:{border:"1px solid #999","background-color":"#aec0d7"},toolbarButtonDownNode:{display:"block",float:"left","padding-left":"2px","padding-right":"2px","padding-top":"0px",height:"18px",color:"#ff0000",cursor:"pointer"},menuItemSubmenuIcon:{"background-image":"url("+o2.session.path+"/widget/$Menu/desktopStyle/submenu.png)",height:"16px",width:"16px","margin-top":"4px",float:"right"}};csskey=encodeURIComponent("../o2_core/o2/widget/$Tab/form/css.wcss");o2.widget.css[csskey]={tabNodeContainer:{height:"30px",overflow:"hidden","border-bottom":"1px solid #999"},contentNodeContainer:{overflow:"hidden",clear:"both","line-height":"normal"},contentNodeArea:{overflow:"hidden",display:"none","background-color":"transparent",opacity:0},tabNode:{position:"static","margin-left":"2px","margin-top":"4px","margin-right":"0px",float:"left",height:"25px",cursor:"pointer","min-width":"80px",background:"url("+o2.session.path+"/widget/$Tab/default/tabAreaBg.gif) center center","border-top-left-radius":"5px","border-top-right-radius":"5px",border:"1px solid #999"},tabTextNode:{color:"#333333","font-weight":"bold","line-height":"26px","text-align":"center","margin-right":"8px","margin-top":"0px","margin-left":"8px"},tabCloseNode:{height:"30px",width:"20px",background:"url("+o2.session.path+"/widget/$Tab/default/close.gif) center center"},tabNodeCurrent:{position:"relative","margin-top":"0px","margin-left":"2px","margin-right":"0px",float:"left",height:"30px","min-width":"80px",background:"url("+o2.session.path+"/widget/$Tab/default/tabNodeCurrentBg.gif) center center","border-top-left-radius":"5px","border-top-right-radius":"5px","border-top":"1px solid #999","border-left":"1px solid #999","border-right":"1px solid #999","border-bottom":"0px solid #efefef"},tabTextNodeCurrent:{color:"#bf6364","font-weight":"bold","line-height":"30px","text-align":"center","margin-right":"8px","margin-left":"8px","margin-top":"2px"},tabCloseNodeCurrent:{height:"30px",width:"20px",background:"url("+o2.session.path+"/widget/$Tab/default/close.gif) center center"},tabNodeContainerRight:{width:"10px",height:"22px","margin-top":"3px",border:"1px solid #eeeeee","margin-right":"3px",float:"right",background:"url("+o2.session.path+"/widget/$Tab/script/down.png) center center no-repeat",cursor:"pointer"},tabNodeContainerRight_over:{border:"1px solid #cccccc"},tabNodeContainerLeft:{"margin-right":"15px",height:"30px"}};csskey=encodeURIComponent("../x_component_process_Xform/$Form/default/doc.wcss");o2.widget.css[csskey]={doc_toolbar:{height:"37px","border-bottom":"0px solid #cccccc"},doc_toolbar_node:{height:"29px","border-bottom":"1px solid #cccccc"},doc_toolbar_doublePage:{"line-height":"30px",color:"#0b82ff",cursor:"pointer",width:"60px","text-align":"center",float:"right"},doc_content:{"min-height":"30.7cm",overflow:"auto",padding:"0.3cm 0px"},doc_page:{width:"15.6cm","min-height":"22.5cm",padding:"3.7cm 2.6cm 3.5cm 2.8cm",margin:"0.2cm auto 0 auto",background:"#ffffff",overflow:"hidden"},doc_layout_page_content:{overflow:"hidden",width:"15.6cm","min-height":"22.5cm",position:"relative","font-size":"16pt","font-family":"'仿宋', serif","line-height":"1.02cm","letter-spacing":"-0.01cm"},doc_sidebar:{width:"30px",overflow:"hidden",position:"absolute"},doc_layout_copiesSecretPriority:{},doc_layout_copies:{},doc_layout_secret:{},doc_layout_priority:{},doc_layout_redHeader:{},doc_layout_filenoup:{},doc_layout_filenoup_fileno_td:{},doc_layout_filenoup_fileno:{},doc_layout_filenoup_signer_td:{},doc_layout_filenoup_signer_table:{},doc_layout_filenoup_signerTitle_td:{},doc_layout_filenoup_signer:{},doc_layout_filenoup_signerContent_td:{},doc_layout_filenoup_signerContent:{},doc_layout_fileno:{},doc_layout_redline:{},doc_layout_subject:{},doc_layout_mainSend:{},doc_layout_filetext:{},doc_layout_attachment:{},doc_layout_attachment_title_td:{},doc_layout_attachment_title:{},doc_layout_attachment_content_td:{},doc_layout_attachment_content:{},doc_layout_issuance:{},doc_layout_issuanceUnit:{},doc_layout_issuanceDate:{},doc_layout_annotation:{},doc_layout_edition:{},doc_layout_edition_copyto:{},doc_layout_edition_copyto_table:{},doc_layout_edition_copyto_title:{},doc_layout_edition_copyto_content:{},doc_layout_edition_issuance:{},doc_layout_edition_issuance_table:{},doc_layout_edition_issuance_unit:{},doc_layout_edition_issuance_date:{},historyAreaNode:{"background-color":"#ffffff","border-top":"0px solid #cccccc","border-left":"1px solid #cccccc","border-right":"0px solid #cccccc","border-bottom":"0px solid #cccccc","box-shadow":"3px 0px 10px #999999",padding:"0 0 20px 20px",position:"absolute",top:"0px",left:"0px",width:"340px"},historyAreaActionNode:{height:"20px"},historyAreaTitleNode:{height:"40px","line-height":"40px","font-size":"14px","text-align":"center","font-weight":"bold"},historyAreaContentNode:{overflow:"hidden"},historyItemNode:{width:"300px",padding:"10px 10px",cursor:"pointer",margin:"20px 20px 0 0",overflow:"hidden",border:"1px solid #cccccc","border-radius":"6px"},historyItemTitleNode:{height:"20px",color:"#333333","line-height":"20px",overflow:"hidden"},historyItemTimeNode:{height:"20px",color:"#999999","line-height":"20px","font-size":"12px",overflow:"hidden"},historyInforNode:{width:"300px",padding:"10px",overflow:"hidden",border:"1px solid #CCCCCC","border-radius":"5px","box-shadow":"2px 2px 5px #CCCCCC",position:"absolute",opacity:1},historyInforMobileNode:{width:"100%",padding:"10px",overflow:"hidden",border:"1px solid #CCCCCC","border-radius":"0px","box-shadow":"0px 0px 0px #CCCCCC",position:"absolute",bottom:"0px",opacity:1},historyListAreaNode:{width:"260px",float:"right","background-color":"#f3f3f3","border-left":"1px solid #cccccc","border-top":"1px solid #cccccc","border-bottom":"1px solid #cccccc",position:"absolute","z-index":"20000",right:"0px",top:"37px"},historyListTitleAreaNode:{height:"80px",padding:"10px 0px"},historyListTitleNode:{"font-weight":"bold","font-size":"14px",height:"40px","line-height":"40px",padding:"0px 10px"},historyListTitleInsertNode:{"font-size":"12px",height:"20px","line-height":"20px",padding:"0px 10px"},historyListTitleDeleteNode:{"font-size":"12px",height:"20px","line-height":"20px",padding:"0px 10px"},historyListContentAreaNode:{margin:"5px",border:"1px solid #cccccc","background-color":"#ffffff",overflow:"auto"},historyListItemNode:{"margin-bottom":"10px",overflow:"hidden",padding:"5px 10px",cursor:"pointer"},historyListItemPatchNode:{overflow:"hidden","margin-bottom":"10px"},historyListItemDiffsNode:{overflow:"hidden"},historyListItemActionNode:{height:"55px",width:"40px",float:"right","line-height":"55px",cursor:"pointer",color:"#0000FF"},historyListItemDiffNode:{overflow:"hidden",padding:"5px 10px",cursor:"pointer",border:"1px solid #ffffff","border-radius":"5px","background-color":"#ffffff"},historyListItemDiffNode_out:{border:"1px solid #ffffff"},fullScreen:{"min-height":"100%"},returnScreen:{top:"",left:"",width:"","min-height":"","z-index":""}};csskey=encodeURIComponent("../o2_core/o2/widget/$Toolbar/documentEdit/css.wcss");o2.widget.css[csskey]={container:{"background-color":"#f9f9f9","padding-top":"6px","padding-bottom":"1px","padding-left":"10px","padding-right":"2px","word-wrap":"normal","word-break":"keep-all",cursor:"pointer",overflow:"hidden",height:"30px",display:"block","font-size":"14px"},toolbarSeparator:{display:"block",float:"left","margin-bottom":"5px","margin-top":"3px",height:"18px",width:"1px","background-color":"#888888","border-right":"1px solid #FFFFFF",overflow:"hidden"},button:{display:"block",position:"static",float:"left",border:"1px solid #f9f9f9","background-color":"#f9f9f9",height:"24px","margin-right":"8px","padding-left":"2px","padding-right":"2px",cursor:"pointer",color:"#333333","border-radius":"0px"},buttonImgDiv:{display:"block",float:"left","padding-top":"4px","padding-bottom":"1px","padding-left":"1px","padding-right":"1px",cursor:"pointer"},buttonImg:{height:"16px",width:"16px",cursor:"pointer","margin-top":"0px"},buttonTextDiv:{display:"block",float:"left",height:"24px","padding-left":"2px","padding-right":"2px","line-height":"24px",cursor:"pointer"},buttonDisable:{color:"#999"},buttonImgDivDisable:{color:"#999"},buttonTextDivDisable:{color:"#999"},buttonOver:{"background-color":"#e7e7e7",color:"#333333"},buttonOut:{"background-color":"#f9f9f9",color:"#333333"},buttonDown:{"background-color":"#dddddd",color:"#333333"},buttonUp:{"background-color":"#e7e7e7",color:"#333333"},toolbarButtonDownNode:{display:"block",float:"left","padding-left":"2px","padding-right":"2px","padding-top":"3px",height:"18px",color:"#ff0000",cursor:"pointer"}};csskey=encodeURIComponent("../o2_core/o2/widget/$Toolbar/documentEdit_side/css.wcss");o2.widget.css[csskey]={container:{"background-color":"#f9f9f9",padding:"5px",width:"30px",overflow:"hidden",border:"1px solid #cccccc","border-radius":"3px",cursor:"pointer",overflow:"hidden",display:"block","font-size":"14px"},toolbarSeparator:{display:"block",float:"left","margin-bottom":"5px","margin-top":"3px",height:"18px",width:"1px","background-color":"#888888","border-right":"1px solid #FFFFFF",overflow:"hidden"},button:{display:"block",position:"static",border:"1px solid #f9f9f9","background-color":"#f9f9f9",cursor:"pointer",color:"#333333",padding:"3px 0px"},buttonImgDiv:{display:"block",cursor:"pointer"},buttonImg:{display:"block",margin:"auto",height:"16px",width:"16px",cursor:"pointer","margin-top":"0px"},buttonTextDiv:{display:"block",width:"20px",cursor:"pointer","text-align":"center","line-height":"16px",margin:"auto","margin-top":"3px","writing-mode":"vertical-lr"},buttonDisable:{color:"#999"},buttonImgDivDisable:{color:"#999"},buttonTextDivDisable:{color:"#999"},buttonOver:{"background-color":"#e7e7e7",color:"#333333"},buttonOut:{"background-color":"#f9f9f9",color:"#333333"},buttonDown:{"background-color":"#dddddd",color:"#333333"},buttonUp:{"background-color":"#e7e7e7",color:"#333333"},toolbarButtonDownNode:{display:"block",float:"left","padding-left":"2px","padding-right":"2px","padding-top":"3px",height:"18px",color:"#ff0000",cursor:"pointer"}},o2.widget=o2.widget||{},o2.widget.css=o2.widget.css||{},o2.widget.Common=new Class({Implements:[Options,Events],options:{},initialize:function(t){this.setOptions(t)},_loadCss:function(t){var e=encodeURIComponent(this.cssPath);!t&&o2.widget.css[e]?this.css=o2.widget.css[e]:(this.cssPath=-1!=this.cssPath.indexOf("?")?this.cssPath+"&v="+o2.version.v:this.cssPath+"?v="+o2.version.v,new Request.JSON({url:o2.filterUrl(this.cssPath),secure:!1,async:!1,method:"get",noCache:!1,onSuccess:function(t,i){this.css=t,o2.widget.css[e]=t}.bind(this),onError:function(t,e){alert(e+t)}}).send())},setLayoutStyle:function(t,e,i){(t||this.node).getElements(".GOES").each(function(t){var s=t.get("id"),o=this.css[s];o&&t.setStyles(o);var n=e.indexOf(s);-1!=n&&(this[i[n]]=t),t.removeProperty("id")}.bind(this))},setScrollBar:function(t,e,i,s){return e||(e="default"),i||(i={V:{x:0,y:0},H:{x:0,y:0}}),o2.require("o2.widget.ScrollBar",(function(){new o2.widget.ScrollBar(t,{style:e,offset:i}),s&&s()})),!1}}),o2.widget=o2.widget||{},o2.widget.Dialog=o2.DL=new Class({Implements:[Options,Events],Extends:o2.widget.Common,options:{style:"default",title:"dialog",width:"300",height:"150",contentWidth:null,contentHeight:null,top:"0",left:"0",fromTop:"0",fromLeft:"0",mark:!0,html:"",text:"",url:"",content:null,lp:null,isMax:!1,isClose:!1,isResize:!0,isMove:!0,isTitle:!0,buttons:null,buttonList:null,maskNode:null,transition:null,duration:200,container:null},initialize:function(t){this.setOptions(t),this.path=o2.session.path+"/widget/$Dialog/",this.cssPath=o2.session.path+"/widget/$Dialog/"+this.options.style+"/css.wcss",this._loadCss(),this.reStyle(),this.fireEvent("queryLoad"),this.getContentUrl(),new Request.HTML({url:this.contentUrl,method:"GET",async:!1,onSuccess:function(t,e,i,s){this.node=t[0],this.getDialogNode(),this.fireEvent("postLoad")}.bind(this),onFailure:function(t){alert(t)}}).send()},getContentUrl:function(){this.contentUrl=o2.session.path+"/widget/$Dialog/"+this.options.style+"/dialog.html"},reStyle:function(t){t&&this.setOptions(t),this.css.to.height=this.options.height+"px",this.css.to.width=this.options.width+"px",this.css.to.top=this.options.top+"px",this.css.to.left=this.options.left+"px",this.css.from.top=this.options.fromTop+"px",this.css.from.left=this.options.fromLeft+"px",this.node&&this.node.set("styles",this.css.from)},getParentSelect:function(t){for(var e="",i=t.getParent();!e&&i;){e=i.getStyle("-webkit-user-select");i=i.getParent()}return e},getDialogNode:function(){this.node.set("styles",this.css.from),this.node.inject(this.options.container||$(document.body)),this.node.addEvent("selectstart",function(t){var e=t.target.getStyle("-webkit-user-select");e||(e=this.getParentSelect(t.target)),e=e?e.toString().toLowerCase():"none";var i=t.target.tagName.toString().toLowerCase();"text"!=e&&"auto"!=e&&-1==["input","textarea"].indexOf(i)&&t.preventDefault()}.bind(this)),this.title=this.node.getElement(".MWF_dialod_title"),this.titleCenter=this.node.getElement(".MWF_dialod_title_center"),this.titleRefresh=this.node.getElement(".MWF_dialod_title_refresh"),this.titleText=this.node.getElement(".MWF_dialod_title_text"),this.titleAction=this.node.getElement(".MWF_dialod_title_action"),this.under=this.node.getElement(".MWF_dialod_under"),this.content=this.node.getElement(".MWF_dialod_content"),this.bottom=this.node.getElement(".MWF_dialod_bottom"),this.resizeNode=this.node.getElement(".MWF_dialod_bottom_resize"),this.button=this.node.getElement(".MWF_dialod_button"),this.options.isTitle||(this.title.destroy(),this.title=null,this.titleCenter=null,this.titleRefresh=null,this.titleText=null,this.titleAction=null),this.title&&this.title.setStyles(this.css.MWF_dialod_title),this.titleCenter&&this.titleCenter.setStyles(this.css.MWF_dialod_title_center),this.titleRefresh&&this.titleRefresh.setStyles(this.css.MWF_dialod_title_refresh),this.titleText&&this.titleText.setStyles(this.css.MWF_dialod_title_text),this.titleAction&&this.titleAction.setStyles(this.css.MWF_dialod_title_action),this.under&&this.under.setStyles(this.css.MWF_dialod_under),this.content&&this.content.setStyles(this.css.MWF_dialod_content),this.bottom&&this.bottom.setStyles(this.css.MWF_dialod_bottom),this.resizeNode&&this.resizeNode.setStyles(this.css.MWF_dialod_bottom_resize),this.button&&this.button.setStyles(this.css.MWF_dialod_button),this.title&&this.setTitleEvent(),this.titleRefresh&&this.setTitleRefreshNode(),this.content&&this.getContent(),this.titleAction&&this.getAction(),this.resizeNode&&this.setResizeNode(),this.content&&this.setContentSize()},setTitleRefreshNode:function(){this.titleRefresh.setStyles(this.css.titleRefresh),this.titleRefresh.set("title",o2.LP.widget.refresh)},setTitleEvent:function(){var t;layout.app&&(t=layout.app.content),layout.desktop.currentApp&&(t=layout.desktop.currentApp.content),this.containerDrag=new Drag.Move(this.node,{handle:this.title,container:this.options.container||this.markNode||t,snap:5})},setResizeNode:function(){this.options.isResize?this.resizeNode&&this.node.makeResizable({handle:this.resizeNode||this.bottom,limit:{x:[200,null],y:[150,null]},onDrag:function(){var t=this.node.getComputedSize();this.css.to.width=t.width,this.css.to.height=t.height,this.setContentSize(t.height,t.width),this.fireEvent("resize")}.bind(this),onComplete:function(){this.fireEvent("resizeCompleted")}.bind(this)}):this.resizeNode&&this.resizeNode.hide()},getAction:function(){this.options.isClose&&(this.closeAction=new Element("div",{styles:this.css.closeAction}).inject(this.titleAction),this.closeAction.addEvent("click",this.close.bind(this)))},getButton:function(){for(i in this.options.buttons)new Element("input",{type:"button",value:i,class:"mainColor_bg",styles:this.css.button,events:{click:this.options.buttons[i].bind(this)}}).inject(this.button);this.options.buttonList&&this.options.buttonList.each(function(t){var e=this.css.button;"ok"===t.type&&this.css.okButton&&(e=this.css.okButton),"cancel"===t.type&&this.css.cancelButton&&(e=this.css.cancelButton),t.styles&&(e=t.styles);new Element("input",{type:"button",value:t.text,title:t.title,class:"cancel"!==t.type?"mainColor_bg":"",styles:e,events:{click:function(e){t.action.call(this,this,e)}.bind(this)}}).inject(this.button)}.bind(this))},getContentSize:function(t,e){var i,s;t||(this.options.contentHeight?i=t=this.options.contentHeight.toFloat():t=this.options.height.toFloat()),e||(this.options.contentWidth?s=e=this.options.contentWidth.toFloat():e=this.options.width.toFloat());var o,n=0;if(this.title){var a=this.title.getSize().y,r=this.title.getStyle("padding-top").toFloat(),l=this.title.getStyle("padding-bottom").toFloat(),c=this.title.getStyle("margin-top").toFloat(),d=this.title.getStyle("margin-bottom").toFloat();n+=a+r+l+c+d}if(this.bottom){var h=this.bottom.getSize().y,u=this.bottom.getStyle("padding-top").toFloat(),p=this.bottom.getStyle("padding-bottom").toFloat(),m=this.bottom.getStyle("margin-top").toFloat(),f=this.bottom.getStyle("margin-bottom").toFloat();n+=h+u+p+m+f}if(this.button){var g=this.button.getSize().y,y=this.button.getStyle("padding-top").toFloat(),x=this.button.getStyle("padding-bottom").toFloat(),b=this.button.getStyle("margin-top").toFloat(),v=this.button.getStyle("margin-bottom").toFloat();n+=g+y+x+b+v}var w=this.content.getStyle("padding-top").toFloat(),S=this.content.getStyle("padding-bottom").toFloat(),A=this.content.getStyle("margin-top").toFloat(),N=this.content.getStyle("margin-bottom").toFloat();n+=w+S+A+N;var k=0;if(i?i=i+n+2:(t-=n)<0&&(k=(k=(this.options.container||$(document.body)).getSize().y)-n-10),o=this.content.getStyle("padding-left").toFloat()+this.content.getStyle("padding-right").toFloat()+this.content.getStyle("margin-left").toFloat()+this.content.getStyle("margin-right").toFloat(),s?s+=o:e-=o,i&&(this.options.height=i,this.options.contentHeight=null,this.options.fromTop=this.options.fromTop.toFloat()-n/2,this.options.top=this.options.top.toFloat()-n/2,this.css.to.height=i+"px",this.css.to.top=this.options.top+"px",this.css.from.top=this.options.fromTop+"px"),s&&(this.options.width=s,this.options.contentWidth=null,this.options.fromLeft=this.options.fromLeft.toFloat()-o/2,this.options.left=this.options.left.toFloat()-o/2,this.css.to.width=s+"px",this.css.to.left=this.options.left+"px",this.css.from.left=this.options.fromLeft+"px"),!t||t<0){this.content.setStyles({overflow:"hidden",height:"auto",width:e+"px"}),k&&this.content.setStyles({"max-height":k+"px"});var I=(t=this.content.getSize().y)+a+r+l+c+d;I=(I=(I=I+h+u+p+m+f)+g+y+x+b+v)+w+S+A+N,this.css.to.height=I}return{height:t+"px",width:e+"px"}},setContentSize:function(t,e){this.content.setStyles(this.getContentSize(t,e)),this.content.setStyle("width","auto")},reCenter:function(){var t=this.node.getSize(),e=$(document.body);layout.desktop.currentApp?e=layout.desktop.currentApp.content:this.options.container&&this.options.container.getSize().y<$(document.body).getSize().y&&(e=this.options.container);var i=o2.getCenter(t,e,e);i.y<0&&(i.y=0),this.options.top=i.y,this.options.left=i.x,this.css.to.top=this.options.top+"px",this.css.to.left=this.options.left+"px",this.node.setStyles({top:this.css.to.top,left:this.css.to.left})},getTitle:function(){this.titleText.set("text",this.options.title)},getContent:function(){this.content.setStyles(this.css.content),this.options.content?this.options.content.inject(this.content):this.options.url?(this.content.set("load",{method:"get",async:!1}),$(this.content).loadHtml(this.options.url,{bind:{lp:this.options.lp}})):this.options.html?this.content.set("html",this.options.html):this.options.text&&this.content.set("text",this.options.text)},show:function(){if(this.options.mark&&this._markShow(),this.morph||(this.morph=new Fx.Morph(this.node,{duration:this.options.duration,transition:this.options.transition})),this.fireEvent("queryShow")){this.node.setStyle("display","block");var t=this.node.getOffsetParent().getPosition(),e=this.css.to.height.toInt(),i=this.css.to.top.toInt();i+=t.y;var s=window.innerHeight.toInt();e+i>s&&((i=s-t.y-e-20)<0&&(i=0),this.css.to.top=i+"px"),this.morph.start(this.css.to).chain(function(){this.titleText&&this.getTitle(),this.button&&this.getButton(),this.fireEvent("postShow")}.bind(this))}},hide:function(){this.morph||(this.morph=new Fx.Morph(this.node,{duration:this.options.duration,transition:this.options.transition})),this.fireEvent("queryHide")&&(this.titleText&&this.titleText.set("text",""),this.button&&this.button.set("html",""),this.morph.start(this.css.from).chain(function(){this._markHide(),this.node.setStyle("display","none"),this.fireEvent("postHide")}.bind(this)))},close:function(){this.morph||(this.morph=new Fx.Morph(this.node,{duration:this.options.duration,transition:this.options.transition})),this.fireEvent("queryClose")&&this.morph.start(this.css.from).chain(function(){this._markHide(),this.node.destroy(),this.node=null,this.fireEvent("postClose")}.bind(this))},_markShow:function(){if(this.options.mark){if(!this.markNode){var t=o2.getMarkSize(this.options.maskNode);this.markNode=new Element("div",{styles:this.css.mark}).inject(this.options.container||$(document.body)),this.markNode.set("styles",{height:t.y,width:t.x})}this.markNode.setStyle("display","block")}},_markHide:function(){this.markNode&&(this.markNode.setStyle("display","none"),this.markNode.destroy(),this.markNode=null),this.markNode_up&&(this.markNode_up.setStyle("display","none"),this.markNode_up.destroy(),this.markNode_up=null)}}),o2.widget=o2.widget||{},o2.widget.UUID=new Class({initialize:function(){this.id=this.createUUID()},valueOf:function(){return this.id},toString:function(){return this.id},createUUID:function(){var t=new Date(1582,10,15,0,0,0,0),e=(new Date).getTime()-t.getTime();return this.getIntegerBits(e,0,31)+this.getIntegerBits(e,32,47)+(this.getIntegerBits(e,48,59)+"1")+this.getIntegerBits(this.rand(4095),0,7)+this.getIntegerBits(this.rand(4095),0,7)+(this.getIntegerBits(this.rand(8191),0,7)+this.getIntegerBits(this.rand(8191),8,15)+this.getIntegerBits(this.rand(8191),0,7)+this.getIntegerBits(this.rand(8191),8,15)+this.getIntegerBits(this.rand(8191),0,15))},getIntegerBits:function(t,e,i){var s=this.returnBase(t,16),o=new Array,n="",a=0;for(a=0;a<s.length;a++)o.push(s.substring(a,a+1));for(a=Math.floor(e/4);a<=Math.floor(i/4);a++)o[a]&&""!=o[a]?n+=o[a]:n+="0";return n},returnBase:function(t,e){return t.toString(e).toUpperCase()},rand:function(t){return Math.floor(Math.random()*(t+1))}}),o2.widget=o2.widget||{},o2.widget.Menu=new Class({Implements:[Options,Events],Extends:o2.widget.Common,options:{style:"default",event:"contextmenu",disable:!1,top:-1,left:-1,container:null},initialize:function(t,e){this.setOptions(e),this.items=[],this.path=o2.session.path+"/widget/$Menu/",this.cssPath=o2.session.path+"/widget/$Menu/"+this.options.style+"/css.wcss",this._loadCss(),this.target=$(t),this.target&&(this.target.onselectstart=function(){return!1}),this.target&&(this.target.oncontextmenu=function(){return!1}),this.pauseCount=0},pause:function(t){this.pauseCount=t},load:function(){this.fireEvent("queryLoad")&&(this.node=new Element("div.MWFMenu"),this.node.set("styles",this.css.container),this.options.event&&this.target&&this.target.addEvent(this.options.event,this.showIm.bind(this)),this.node.inject(this.options.container||this.target),this.hide=this.hideMenu.bind(this),this.fireEvent("postLoad"))},setItemWidth:function(){this.items.each(function(t){this.node.getStyle("padding-left").toInt(),this.node.getStyle("padding-right").toInt(),this.node.getStyle("border-left-width").toInt(),this.node.getStyle("border-right-width").toInt(),t.item.getStyle("border-left-width").toInt(),t.item.getStyle("border-right-width").toInt(),t.item.getStyle("margin-left").toInt()}.bind(this))},setPosition:function(t){var e,i;e=-1==this.options.top?t.page.y:this.options.top,i=-1==this.options.left?t.page.x:this.options.left;var s=this.node.getSize(),o=this.node.getOffsetParent(),n=o.getSize();i+s.x>n.x&&(i=i-s.x-5)<0&&(i=0);var a=o.getScroll().y.toFloat()||0;e+s.y>n.y+a&&(e=e-s.y-5)<0&&(e=0),this.node.setStyle("top",e),this.node.setStyle("left",i);var r=this.node.getSize();this.nodeFrame||this.createIframeNode(),this.nodeFrame.setStyles({top:e,left:i,width:r.x+"px",height:r.y+"px"})},showIm:function(t){this.options.disable||(this.hide=this.hideIm.bind(this),this.fireEvent("queryShow",[t])&&(this.tmpBodyOncontextmenu=document.body.oncontextmenu,document.body.oncontextmenu=function(){return!1},this.pauseCount<=0?(this.setItemWidth(),this.node.setStyles({display:"block",opacity:this.options.opacity||1}),this.nodeFrame||this.createIframeNode(),this.nodeFrame.setStyles({display:"block",opacity:0}),this.setPosition(t),$(document.body).removeEvent("mousedown",this.hide),$(document.body).addEvent("mousedown",this.hide),this.show=!0):this.pauseCount--,this.fireEvent("postShow",[t])))},hideIm:function(t){if(this.fireEvent("queryHide")){if($(document.body).removeEvent("mousedown",this.hide),this.node.set("styles",{display:"none",opacity:0}),this.nodeFrame&&this.nodeFrame.set("styles",{display:"none",opacity:0}),this.show=!1,document.body.oncontextmenu=this.tmpBodyOncontextmenu,this.tmpBodyOncontextmenu=null,t){for(var e=this;e.topMenu;)e=e.topMenu;e.hideIm()}else this.items.each((function(t){"menu"==t.type&&t.subMenu.hideIm()}));this.fireEvent("postHide")}},createIframeNode:function(){this.nodeFrame||(this.nodeFrame=new Element("iframe"),this.nodeFrame.setStyles({border:"0px","z-index":"998",margin:"0px",padding:"0px",position:"absolute",display:"none",opacity:0})),this.nodeFrame.inject(this.options.container||this.target)},showMenu:function(t){this.show||(this.pauseCount<=0?this.options.disable||(this.hide=this.hideMenu.bind(this),this.fireEvent("queryShow",[t])&&(this.tmpBodyOncontextmenu=document.body.oncontextmenu,document.body.oncontextmenu=function(){return!1},this.node.setStyle("display","block"),this.nodeFrame||this.createIframeNode(),this.nodeFrame.setStyle("display","block"),this.setItemWidth(),this.setPosition(t),this.morph||(this.morph=new Fx.Morph(this.node,{duration:100})),this.morph.start({opacity:this.options.opacity||1}).chain(function(){$(document).removeEvent("click",this.hide),$(document).addEvent("click",this.hide),$(document).removeEvent("mousedown",this.hide),$(document).addEvent("mousedown",this.hide),this.show=!0,this.fireEvent("postShow")}.bind(this)))):this.pauseCount--)},hideMenu:function(){$(document).removeEvent("click",this.hide),this.show&&(this.morph||(this.morph=new Fx.Morph(this.node,{duration:100})),this.fireEvent("queryHide")&&this.morph.start({opacity:0}).chain(function(){this.node.set("styles",{display:"none"}),this.nodeFrame.set("styles",{display:"none"}),this.show=!1,document.body.oncontextmenu=this.tmpBodyOncontextmenu,this.tmpBodyOncontextmenu=null,this.fireEvent("postHide")}.bind(this)))},clearItems:function(){this.items.each((function(t){t.remove()})),this.items=[]},addMenuItem:function(t,e,i,s,o){var n=new o2.widget.MenuItem(this,{text:t,event:e,action:i,img:s,disable:o});return n.load(),this.items.push(n),n},addMenuMenu:function(t,e,i,s){var o=new o2.widget.MenuMenu(this,i,{text:t,img:e,disable:s});return o.load(),this.items.push(o),o},addMenuLine:function(){var t=new o2.widget.MenuLine(this);t.load(),this.items.push(t)},_loadToolbarItemNode:function(){this.node.getChildren().each(function(t,e){var i=t.get("MWFnodetype");i&&("array"==typeOf(this[i])||(this[i]=[]),this[i].push(t))}.bind(this))},_loadMenuItems:function(){this._loadToolBarSeparator(this.MWFToolBarMenuItem),this._loadToolBarButton(this.MWFToolBarMenuLine),this._loadToolBarMenu(this.MWFToolBarMenuItem)},_loadToolBarSeparator:function(t){t&&t.each(function(t,e){t.set("styles",this.css.toolbarSeparator)}.bind(this))},_loadToolBarButton:function(t){t&&t.each(function(t,e){var i=new o2.widget.ToolbarButton(t,this);i.load(),i.buttonID&&(this.items[i.buttonID]=i),this.children.push(i),this.childrenButton.push(i)}.bind(this))},_loadToolBarMenu:function(t){t&&t.each(function(t,e){var i=new o2.widget.ToolbarMenu(t,this);i.load(),i.buttonID&&(this.items[i.buttonID]=i),this.children.push(i),this.childrenMenu.push(i)}.bind(this))}}),o2.widget.MenuItem=new Class({Implements:[Options],options:{text:"",event:"",action:null,img:"",disable:!1},initialize:function(t,e){this.setOptions(e),this.menu=t,this.type="item",this.createNode()},createNode:function(){this.item=new Element("div",{styles:this.menu.css.menuItem});var t=new Element("div",{styles:this.menu.css.menuItemImgDiv}).inject(this.item);this.options.img&&("url"==this.options.img.substr(0,3)?new Element("div",{styles:this.menu.css.menuItemImg}).inject(t).setStyles({"background-size":"cover","background-image":this.options.img}):new Element("img",{styles:this.menu.css.menuItemImg,src:this.options.img}).inject(t));new Element("div",{styles:this.menu.css.menuItemSeparator}).inject(this.item);this.text=new Element("div",{styles:this.menu.css.menuItemText,text:this.options.text}).inject(this.item),this.options.event&&this.item.addEvent(this.options.event,this.doAction.bind(this)),this.setDisable(this.options.disable)},setText:function(t){this.options.text=t;var e=this.item.getLast("div");e&&e.set("text",t)},load:function(){this.item.inject(this.menu.node),this._addButtonEvent()},setDisable:function(t){var e,i;if(this.options.disable!=t)if(this.options.disable=t,t){if(this.item.set("styles",this.menu.css.menuItemDisable),(e=this.item.getElement("img"))&&"data:"!=(i=e.get("src")).substr(0,5)){var s=i.lastIndexOf(".");srcLeft=i.substr(0,s),srcRight=i.substr(s,i.length-s),i=srcLeft+"_gray"+srcRight,e.set("src",i)}}else this.item.set("styles",this.menu.css.menuItem),(e=this.item.getElement("img"))&&"data:"!=(i=e.get("src")).substr(0,5)&&(i=i.replace("_gray",""),e.set("src",i))},_addButtonEvent:function(){this.item.addEvent("mouseover",this._menuItemMouseOver.bind(this)),this.item.addEvent("mouseout",this._menuItemMouseOut.bind(this)),this.item.addEvent("mousedown",this._menuItemMouseDown.bind(this)),this.item.addEvent("mouseup",this._menuItemMouseUp.bind(this))},_menuItemMouseOver:function(t){this.menu.items.each(function(e){e!=this&&"line"!=e.type&&(e.options.disable||e._menuItemMouseOut(t))}.bind(this)),this.options.disable||(this.item.set("styles",this.menu.css.menuOver),this.menu.current=this)},_menuItemMouseOut:function(t){this.options.disable||this.item.set("styles",this.menu.css.menuOut)},_menuItemMouseDown:function(t){this.options.disable||this.item.set("styles",this.menu.css.menuDown),t.stopPropagation()},_menuItemMouseUp:function(t){this.options.disable||this.item.set("styles",this.menu.css.menuUp)},doAction:function(t){this.options.disable||(this.options.action&&this.options.action.apply(this,[t]),this.menu.hideIm(!0))},remove:function(){this.item.destroy()}}),o2.widget.MenuLine=new Class({initialize:function(t,e){this.type="line",this.menu=t,this.createNode()},createNode:function(){this.item=new Element("div",{styles:this.menu.css.menuLine})},load:function(){this.item.inject(this.menu.node)},remove:function(){this.item.destroy()},setDisable:function(){}}),o2.widget.MenuMenu=new Class({Implements:[Options],Extends:o2.widget.MenuItem,initialize:function(t,e,i){this.subMenu=e,this.parent(t,i),this.subMenu.topMenu=this.menu,this.type="menu",this.createIcon(),this.subMenu.setPosition=function(){this.setPosition()}.bind(this)},createIcon:function(){new Element("div",{styles:this.menu.css.menuItemSubmenuIcon}).inject(this.text,"before"),this.text.setStyle("margin-right","16px")},_menuItemMouseOver:function(t){this.menu.items.each(function(e){e!=this&&"line"!=e.type&&(e.options.disable||e._menuItemMouseOut(t))}.bind(this)),this.options.disable||(this.item.set("styles",this.menu.css.menuOver),this.menu.current=this),this.subMenu.showIm()},_menuItemMouseOut:function(t){t.event.toElement==this.subMenu.node||this.subMenu.node.contains(t.event.toElement)||(this.options.disable||this.item.set("styles",this.menu.css.menuOut),this.subMenu.hideIm())},setPosition:function(t){var e,i,s=this.item.getPosition(),o=this.item.getSize();this.subMenu.node.setStyle("display","block");var n=this.subMenu.node.getSize(),a=this.subMenu.node.getOffsetParent(),r=a.getSize();e=s.y,(i=s.x.toFloat()+o.x.toFloat()-3).toFloat()+n.x.toFloat()>r.x&&(i=s.x.toFloat()-n.x.toFloat()+8);var l=a.getScroll().y.toFloat()||0;e+n.y>r.y+l&&(e=e-n.y+o.y+3)<0&&(e=0),this.subMenu.options.offsetX&&(i+=this.subMenu.options.offsetX),this.subMenu.options.offsetY&&(e+=this.subMenu.options.offsetY);var c=this.menu.node.getStyle("z-index");this.subMenu.node.setStyle("z-index",c+1),this.subMenu.node.setStyle("top",e),this.subMenu.node.setStyle("left",i)}}),o2.widget=o2.widget||{},o2.widget.Toolbar=new Class({Implements:[Options,Events],Extends:o2.widget.Common,options:{style:"default"},initialize:function(t,e,i){this.setOptions(e),this.bindObject=i,this.items={},this.children=[],this.childrenButton=[],this.childrenMenu=[],this.path=o2.session.path+"/widget/$Toolbar/",this.cssPath=o2.session.path+"/widget/$Toolbar/"+this.options.style+"/css.wcss",this._loadCss(),this.node=$(t),this.node.onselectstart=function(){return!1},this.node.oncontextmenu=function(){return!1}},load:function(){this.fireEvent("queryLoad")&&(this.node.set("styles",this.css.container),this._loadToolbarItemNode(),this._loadToolbarItems(),this.fireEvent("postLoad"))},_loadToolbarItemNode:function(){this.node.getChildren().each(function(t,e){var i=t.get("MWFnodetype");i&&("array"==typeOf(this[i])||(this[i]=[]),this[i].push(t))}.bind(this))},_loadToolbarItems:function(){this._loadToolBarSeparator(this.MWFToolBarSeparator),this._loadToolBarButton(this.MWFToolBarButton),this._loadToolBarOnOffButton(this.MWFToolBarOnOffButton),this._loadToolBarMenu(this.MWFToolBarMenu)},_loadToolBarSeparator:function(t){t&&t.each(function(t,e){t.set("styles",this.css.toolbarSeparator)}.bind(this))},_loadToolBarButton:function(t){t&&t.each(function(t,e){var i=new o2.widget.ToolbarButton(t,this,this.options);i.load(),this.fireEvent("buttonLoad",[i]),i.buttonID&&(this.items[i.buttonID]=i),this.children.push(i),this.childrenButton.push(i)}.bind(this))},_loadToolBarOnOffButton:function(t){t&&t.each(function(t,e){var i=new o2.widget.ToolbarOnOffButton(t,this,this.options);i.load(),this.fireEvent("buttonLoad",[i]),i.buttonID&&(this.items[i.buttonID]=i),this.children.push(i),this.childrenButton.push(i)}.bind(this))},_loadToolBarMenu:function(t){var e=this;t&&t.each(function(t,i){var s=new o2.widget.ToolbarMenu(t,this,{onAddMenuItem:function(t){this.fireEvent("addMenuItem",[t])}.bind(this),onMenuQueryShow:function(t){e.fireEvent("menuQueryShow",[this,t])},onMenuPostShow:function(t){e.fireEvent("menuPostShow",[this,t])},onMenuQueryHide:function(t){e.fireEvent("menuQueryHide",[this,t])},onMenuPostHide:function(t){e.fireEvent("menuPostHide",[this,t])},onLoad:function(t){e.fireEvent("menuLoaded",[this,t])}});s.load(),this.fireEvent("menuLoad",[s]),s.buttonID&&(this.items[s.buttonID]=s),this.children.push(s),this.childrenMenu.push(s)}.bind(this))}}),o2.widget.ToolbarButton=new Class({Implements:[Options,Events],options:{text:"",title:"",pic:"",action:"",actionScript:"",disable:!1},initialize:function(t,e,i){if(this.setOptions(i),this.node=$(t),this.toolbar=e,this.buttonID=this.node.get("MWFnodeid")||this.node.get("id"),this.node){var s=this.node.get("MWFButtonText");s&&(this.options.text=s);var o=this.node.get("title");o&&(this.options.title=o);var n=this.node.get("MWFButtonImage");n&&(this.options.pic=n);var a=this.node.get("MWFButtonImageOver");a&&(this.options.pic_over=a),this.node.get("MWFButtonDisable")&&(this.options.disable=!0);var r=this.node.get("MWFButtonAction");r&&(this.options.action=r)}else this.node=new Element("div").inject(this.toolbar.node);this.modifiyStyle=!0},load:function(){this._addButtonEvent(),this.node.title=this.options.title,this.node.set("styles",this.toolbar.css.button),this.options.pic&&(this.picNode=this._createImageNode(this.options.pic)),this.options.text&&(this.textNode=this._createTextNode(this.options.text)),this.setDisable(this.options.disable)},enable:function(){this.options.disable&&(this.setDisable(!1),this.options.disable=!1)},disable:function(){this.options.disable||(this.setDisable(!0),this.options.disable=!0)},setDisable:function(t){if(t){if(!this.options.disable){if(this.options.disable=!0,this.node.set("styles",this.toolbar.css.buttonDisable),this.picNode){this.picNode.set("styles",this.toolbar.css.buttonImgDivDisable);var e=(s=(i=this.picNode.getElement("img")).get("src")).substr(s.lastIndexOf("."),s.length);s=(s=s.substr(0,s.lastIndexOf(".")))+"_gray"+e,i.set("src",s)}this.textNode&&this.textNode.set("styles",this.toolbar.css.buttonTextDivDisable)}}else if(this.options.disable){var i,s;if(this.options.disable=!1,this.node.set("styles",this.toolbar.css.button),this.picNode)this.picNode.set("styles",this.toolbar.css.buttonImgDiv),s=(s=(i=this.picNode.getElement("img")).get("src")).replace("_gray",""),i.set("src",s);this.textNode&&this.textNode.set("styles",this.toolbar.css.buttonTextDiv)}},_createImageNode:function(t){if(t){var e=new Element("span",{styles:this.toolbar.css.buttonImgDiv}).inject(this.node);this.imgNode=new Element("img",{styles:this.toolbar.css.buttonImg,src:t}).inject(e);return e}return null},_createTextNode:function(t){return t?new Element("span",{styles:this.toolbar.css.buttonTextDiv,text:t}).inject(this.node):null},setText:function(t){this.node.getLast().set("text",t)},_addButtonEvent:function(){this.node.addEvent("mouseover",this._buttonMouseOver.bind(this)),this.node.addEvent("mouseout",this._buttonMouseOut.bind(this)),this.node.addEvent("mousedown",this._buttonMouseDown.bind(this)),this.node.addEvent("mouseup",this._buttonMouseUp.bind(this)),this.node.addEvent("click",this._buttonClick.bind(this))},_buttonMouseOver:function(){this.modifiyStyle&&(this.options.disable||this.node.set("styles",this.toolbar.css.buttonOver)),this.options.pic_over&&!this.options.disable&&this.imgNode&&this.imgNode.set("src",this.options.pic_over)},_buttonMouseOut:function(){this.modifiyStyle&&(this.options.disable||this.node.set("styles",this.toolbar.css.buttonOut)),this.options.pic_over&&!this.options.disable&&this.imgNode&&this.imgNode.set("src",this.options.pic)},_buttonMouseDown:function(){this.modifiyStyle&&(this.options.disable||this.node.set("styles",this.toolbar.css.buttonDown))},_buttonMouseUp:function(){this.modifiyStyle&&(this.options.disable||this.node.set("styles",this.toolbar.css.buttonUp))},_buttonClick:function(t){if(!this.options.disable&&this.options.action)if("string"===typeOf(this.options.action)){var e=this.options.action.split(":"),i=e.shift(),s=this.toolbar.bindObject?this.toolbar.bindObject:window;s[i]?(e.push(this),e.push(t),s[i].apply(s,e)):window[i]&&window[i].apply(this,e)}else this.options.action()}}),o2.widget.ToolbarOnOffButton=new Class({Implements:[Options,Events],Extends:o2.widget.ToolbarButton,on:function(){"on"!==this.status&&(this.options.disable||this.node.set("styles",this.toolbar.css.buttonDown),this.modifiyStyle=!1,this.status="on",this.textNode&&this.textNode.set("styles",this.toolbar.css.buttonTextDivDown))},off:function(){"on"===this.status&&(this.options.disable||this.node.set("styles",this.toolbar.css.buttonOut),this.modifiyStyle=!0,this.status="off",this.textNode&&this.textNode.set("styles",this.toolbar.css.buttonTextDiv))},_buttonClick:function(t){if("on"===this.status?(this.options.disable||this.node.set("styles",this.toolbar.css.buttonOut),this.modifiyStyle=!0,this.status="off",this.textNode&&this.textNode.set("styles",this.toolbar.css.buttonTextDiv)):(this.options.disable||this.node.set("styles",this.toolbar.css.buttonDown),this.modifiyStyle=!1,this.status="on",this.textNode&&this.textNode.set("styles",this.toolbar.css.buttonTextDivDown)),!this.options.disable&&this.options.action)if("string"===typeOf(this.options.action)){var e=this.options.action.split(":"),i=e.shift(),s=this.toolbar.bindObject?this.toolbar.bindObject:window;e.push(this.status),e.push(this),s[i]?(e.push(this),e.push(t),s[i].apply(s,e)):window[i]&&window[i].apply(this,e)}else this.options.action()}}),o2.widget.ToolbarMenu=new Class({Implements:[Options,Events],Extends:o2.widget.ToolbarButton,initialize:function(t,e,i){this.parent(t,e,i),this.modifiyStyle=!0,this.menu=null,this.buttonID=this.node.get("MWFnodeid")||this.node.get("id")},setDisable:function(t){if(this.menu&&(this.menu.options.disable=t),t){if(this.node.set("styles",this.toolbar.css.buttonDisable),this.picNode){this.picNode.set("styles",this.toolbar.css.buttonImgDivDisable);var e=(s=(i=this.picNode.getElement("img")).get("src")).substr(s.lastIndexOf("."),s.length);s=(s=s.substr(0,s.lastIndexOf(".")))+"_gray"+e,i.set("src",s)}this.textNode&&this.textNode.set("styles",this.toolbar.css.buttonTextDivDisable)}else{var i,s;if(this.node.set("styles",this.toolbar.css.button),this.picNode)this.picNode.set("styles",this.toolbar.css.buttonImgDiv),s=(s=(i=this.picNode.getElement("img")).get("src")).replace("_gray",""),i.set("src",s);this.textNode&&this.textNode.set("styles",this.toolbar.css.buttonTextDiv)}},load:function(){this._addButtonEvent(),this.node.title=this.options.title,this.node.set("styles",this.toolbar.css.button),this.options.pic&&(this.picNode=this._createImageNode(this.options.pic)),this.options.text&&(this.textNode=this._createTextNode(this.options.text)),this._createDownNode();var t=this;o2.require("o2.widget.Menu",function(){this.menu=new o2.widget.Menu(this.node,{style:this.toolbar.options.style,bindObject:this.options.bindObject,event:"click",disable:t.options.disable,onQueryShow:function(){var e=t.node.getPosition(t.node.getOffsetParent()),i=t.node.getSize();return this.setOptions({top:e.y+i.y-2,left:e.x}),t.fireEvent("menuQueryShow",[this]),!0},onPostShow:function(){var e=t.node.getPosition(t.node.getOffsetParent()),i=t.node.getSize();t.node.set("styles",{"background-color":this.node.getStyle("background-color"),"border-top":this.node.getStyle("border-top"),"border-right":this.node.getStyle("border-top"),"border-left":this.node.getStyle("border-top"),"border-bottom":"0"}),t.modifiyStyle=!1,t.tmpStyleNode=new Element("div.MWFtmpStyleNode",{styles:{position:"absolute",top:e.y+i.y-2,left:e.x+1,width:i.x-2,"z-index":this.node.getStyle("z-index")+1,"background-color":this.node.getStyle("background-color"),height:"1px",overflow:"hidden"}}).inject(t.node),t.fireEvent("menuPostShow",[this])},onQueryHide:function(){t.fireEvent("menuQueryHide",[this])},onPostHide:function(){t.node.set("styles",t.toolbar.css.button),t.modifiyStyle=!0,t.tmpStyleNode&&t.tmpStyleNode.destroy(),t.fireEvent("menuPostHide",[this])}}),this.menu.load(),this.fireEvent("load",[this.menu]),this.addMenuItems()}.bind(this)),this.setDisable(this.options.disable)},_createDownNode:function(){var t=new Element("div",{styles:this.toolbar.css.toolbarButtonDownNode}).inject(this.node);return t.set("html",'<img src="'+o2.session.path+"/widget/$Toolbar/"+this.toolbar.options.style+'/downicon.gif" />'),t},addMenuItems:function(){this.node.getChildren().each(function(t,e){var i=t.get("MWFnodetype");"MWFToolBarMenuItem"==i&&this._loadMenuItem(t),"MWFToolBarMenuLine"==i&&this._loadMenuLine(t)}.bind(this))},_loadMenuItem:function(t){var e=this,i=this.menu.addMenuItem(t.get("MWFButtonText"),"click",(function(i){e._menuItemClick(t.get("MWFButtonAction"),i,this)}),t.get("MWFButtonImage"),t.get("MWFButtonDisable"));this.fireEvent("addMenuItem",[i])},_menuItemClick:function(t,e,i){if(t){var s=t.split(":"),o=s.shift(),n=this.toolbar.bindObject?this.toolbar.bindObject:window;n[o]?(s.push(this),s.push(e),s.push(i),n[o].apply(n,s),this.menu.hideMenu()):window[o]&&(window[o].apply(this,s),this.menu.hideMenu())}},_loadMenuLine:function(){this.menu.addMenuLine()}}),o2.xDesktop=o2.xDesktop||{},o2.xd=o2.xDesktop,o2.xDesktop.requireApp=function(t,e,i,s){o2.requireApp(t,e,i,s)},o2.xApplication=o2.xApplication||{},MWF.xDesktop.loadConfig=function(t){o2.JSON.get("res/config/config.json",(function(e){layout.config=e,"auto"===layout.config.app_protocol&&(layout.config.app_protocol=window.location.protocol),layout.config.systemName=layout.config.systemName||layout.config.footer,layout.config.systemTitle=layout.config.systemTitle||layout.config.title,t&&t()}))},MWF.xDesktop.getService=function(t){MWF.xDesktop.getServiceAddress(layout.config,(function(e,i){layout.serviceAddressList=e,layout.centerServer=i,t&&t()}))},MWF.xDesktop.loadService=function(t){MWF.xDesktop.loadConfig((function(){MWF.xDesktop.getService(t)}))},MWF.xDesktop.checkLogin=function(t){layout.authentication=new MWF.xDesktop.Authentication({onLogin:t}),layout.authentication.isAuthenticated(function(e){layout.session.user=e.data,t&&t()}.bind(this),(function(){layout.authentication.loadLogin(this.node)}))},MWF.xDesktop.getDefaultLayout=function(t){MWF.UD.getPublicData("defaultLayout",function(e){e&&(layout.defaultLayout=e),t&&t()}.bind(this))},MWF.xDesktop.getUserLayout=function(t){MWF.UD.getPublicData("forceLayout",function(e){var i=null;e&&(i=e),MWF.UD.getDataJson("layout",function(e){e?(layout.userLayout=e,i&&(layout.userLayout.apps=Object.merge(layout.userLayout.apps,i.apps)),t&&t()):MWF.UD.getPublicData("defaultLayout",function(e){e&&(layout.userLayout=e,i&&(layout.userLayout.apps=Object.merge(layout.userLayout.apps,i.apps))),t&&t()}.bind(this))}.bind(this))}.bind(this))},MWF.xDesktop.notice=function(t,e,i,s,o,n){e||(e={x:"right",y:"top"}),t||(t="ok");var a=s||layout.desktop.desktopNode||document.body,r=o;r||(r={x:10,y:(e.y.toString().toLowerCase(),10)});var l={type:t,position:e,move:!1,target:a,offset:r,content:i};n&&"object"===typeOf(n)&&(l=Object.merge(l,n)),new mBox.Notice(l)},MWF.xDesktop.loadPortal=function(t){layout.openApplication(null,"portal.Portal",{portalId:t,onAfterModulesLoad:function(){var t=$("layout");t&&t.setStyles({position:"absolute",width:"100%","z-index":100,top:"0px",left:"0px"}).fade("out");var e=$("appContent");e&&e.setStyles({position:"absolute",width:"100%",top:"0px",opacity:0,left:"0px"}).fade("in")}},null,!0)},MWF.name={cns:function(t){if("array"!==typeOf(t))return[];var e=[];return t.each(function(t){e.push(this.cn(t))}.bind(this)),e},cn:function(t){if(!t)return"";var e=t.indexOf("@");return-1!==e?t.substring(0,e):t},ou:function(t){if(!t)return"";var e=t.indexOf("@"),i=t.lastIndexOf("@");return-1===e?t:i===e?"":t.substring(e+1,i)},flag:function(t){if(!t)return"";var e=t.lastIndexOf("@");return-1===e?"":t.substring(e+1,t.length)},type:function(t){if(!t)return"";var e=t.lastIndexOf("@");return-1===e?"":t.substring(e+1,t.length)}},MWF.xDesktop.confirm=function(t,e,i,s,o,n,a,r,l,c,d){MWF.require("MWF.xDesktop.Dialog",function(){var h,u=layout.desktop.node||$(document.body),p=u.getSize(),m=0,f=0;"element"==typeOf(e)?(m=(h=e.getPosition(u)).x,f=h.y):("firefox"==Browser.name?(m=parseFloat(e.event.clientX),f=parseFloat(e.event.clientY)):(m=parseFloat(e.event.x),f=parseFloat(e.event.y)),e.target&&(m=(h=e.target.getPosition(u)).x,f=h.y));m+parseFloat(o)>p.x&&(m-=parseFloat(o)),m<0&&(m=0),f+parseFloat(n)>p.y&&(f-=parseFloat(n)),f<0&&(f=0);var g="",y="";"object"==typeOf(s).toLowerCase()?(g=s.text,y=s.html):g=s;var x=new MWF.xDesktop.Dialog({title:i,style:d||"o2",top:f,left:m-20,fromTop:f,fromLeft:m-20,width:o,height:n,text:g,html:y,container:MWF.xDesktop.node,maskNode:c,buttonList:[{type:"ok",text:MWF.LP.process.button.ok,action:a},{type:"cancel",text:MWF.LP.process.button.cancel,action:r}]});switch(t.toLowerCase()){case"success":x.content.setStyle("background-image","url(data:image/png;base64,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)");break;case"error":x.content.setStyle("background-image","url(data:image/png;base64,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)");break;case"info":x.content.setStyle("background-image","url(data:image/png;base64,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)");break;case"warn":x.content.setStyle("background-image","url(data:image/png;base64,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)")}x.show(),l&&l(x)}.bind(this))},MWF.xDesktop.getImageSrc=function(t){"auto"==layout.config.app_protocol&&(layout.config.app_protocol=window.location.protocol);var e=layout.serviceAddressList.x_file_assemble_control;if(e)var i=layout.config.app_protocol+"//"+e.host+(80==e.port?"":":"+e.port)+e.context;else{var s=layout.config.center.host||window.location.hostname,o=layout.config.center.port;i=layout.config.app_protocol+"//"+s+("80"==o?"":":"+o)+"/x_program_center"}var n="/jaxrs/file/"+t+"/download/stream";return o2.filterUrl(i+n)},MWF.xDesktop.setImageSrc=function(){if(event){var t=event.srcElement?event.srcElement:event.target;if(t){t.onerror=null;var e=t.get("data-id");e&&t.set("src",MWF.xDesktop.getImageSrc(e))}}},MWF.xDesktop.uploadImage=function(t,e,i,s,o,n){this.action=new MWF.xDesktop.Actions.RestActions("/xDesktop/Actions/action.json","x_file_assemble_control"),this.action.invoke({name:"uploadImage",parameter:{reference:t,referencetype:e},data:i,file:s,success:o,failure:n})},MWF.xDesktop.uploadImageByScale=function(t,e,i,s,o,n,a){this.action=new MWF.xDesktop.Actions.RestActions("/xDesktop/Actions/action.json","x_file_assemble_control"),this.action.invoke({name:"uploadImageByScale",parameter:{reference:t,referencetype:e,scale:i||0},data:s,file:o,success:n,failure:a})},MWF.xDesktop.copyImage=function(t,e,i,s,o,n){this.action=new MWF.xDesktop.Actions.RestActions("/xDesktop/Actions/action.json","x_file_assemble_control"),this.action.invoke({name:"copyImage",parameter:{reference:t,referencetype:e,attachmentId:i,scale:s||0},success:o,failure:n})},MWF.xDesktop.getPortalFileUr=function(t,e){var i="x_portal_assemble_surface",s=MWF.Actions.getHost(i)+"/"+i+MWF.Actions.get(i).action.actions.readFile.uri;return s=(s=s.replace("{flag}",t)).replace("{applicationFlag}",e)},MWF.xDesktop.getProcessFileUr=function(t,e){var i="x_processplatform_assemble_surface",s=MWF.Actions.getHost(i)+"/"+i+MWF.Actions.get(i).action.actions.readFile.uri;return s=(s=s.replace("{flag}",t)).replace("{applicationFlag}",e)},MWF.xDesktop.getCMSFileUr=function(t,e){var i="x_cms_assemble_control",s=MWF.Actions.getHost(i)+"/"+i+MWF.Actions.get(i).action.actions.readFile.uri;return s=(s=s.replace("{flag}",t)).replace("{applicationFlag}",e)},MWF.xDesktop.getServiceAddress=function(t,e){var i=function(){var e=$("browser_loadding"),i=$("appContent");(e?e.getFirst():i).empty();var s="<div style='width: 800px; color: #ffffff; margin: 30px auto'><div style='height: 40px;'>   <div style='height: 40px; width: 40px; float: left; background: url(../x_desktop/img/error.png)'></div>   <div style='margin-left: 50px; font-size: 20px; line-height: 40px;'>"+MWF.LP.desktop.notice.errorConnectCenter1+"</div></div><div style='margin-left: 0px;'>";if("array"===typeOf(t.center))t.center.each((function(t){var e="http://"+(t.host?t.host:window.location.hostname)+(t.port?":"+t.port:"")+"/x_program_center/jaxrs/echo";s+="<br><a style='margin-left: 50px; color: #e0e8d1; line-height: 30px;' href='"+e+"' target='_blank'>"+e+"</a>"}));else{var o="http://"+(t.center.host?t.center.host:window.location.hostname)+(t.center.port?":"+t.center.port:"")+"/x_program_center/jaxrs/echo";s+="<br><a style='margin-left: 50px; color: #e0e8d1; line-height: 30px;'href='"+o+"' target='_blank'>"+o+"</a>"}s+="</div><br><div style='margin-left: 50px; font-size: 20px'>"+MWF.LP.desktop.notice.errorConnectCenter2+"</div></div>",(e?e.getFirst():i).set("html",s),!e&&i&&i.setStyle("background-color","#666666")};if("object"===typeOf(t.center))MWF.xDesktop.getServiceAddressConfigObject(t.center,e,i);else if("array"===typeOf(t.center)){MWF.xDesktop.getServiceAddressConfigArray(t,e,i)}},MWF.xDesktop.chooseCenter=function(t){for(var e=window.location.host,i=null,s=0;s<t.center.length;s++){var o=t.center[s];if(!o.host||o.host.toString().toLowerCase()===e.toString().toLowerCase()){i=o;break}}return i},MWF.xDesktop.getServiceAddressConfigArray=function(t,e,i){var s=[];t.center.each(function(t){s.push(MWF.xDesktop.getServiceAddressConfigObject(t,function(t,i){s.each((function(t){t&&t.res&&t.res.isRunning()&&t.res.cancel(),t&&t.actionWorker&&t.actionWorker.terminate()})),e&&e(t,i)}.bind(this),function(){if(s.length)for(var t=0;t<s.length;t++){if(s[t].res&&s[t].res.isRunning())return"";if(s[t].actionWorker&&s[t].actionWorker.terminate)return""}i&&i()}.bind(this)))}.bind(this))},MWF.xDesktop.getServiceAddressConfigObject=function(t,e,i){var s=t;s||(s=layout.config.center);var o=s.host||window.location.hostname,n=s.port,a="";"auto"==layout.config.app_protocol&&(layout.config.app_protocol=window.location.protocol),a=n&&"80"!=n?layout.config.app_protocol+"//"+o+":"+n+"/x_program_center/jaxrs/distribute/assemble/source/{source}":layout.config.app_protocol+"//"+o+"/x_program_center/jaxrs/distribute/assemble/source/{source}";var r=layout.config.applicationServer&&layout.config.applicationServer.host?layout.config.applicationServer.host:window.location.hostname;a=a.replace(/{source}/g,r);try{return MWF.restful("get",a,null,{onSuccess:function(i){e&&e(i.data,t)}.bind(this),onRequestFailure:function(t){i&&i(t)}.bind(this),onError:function(t){i&&i(t)}.bind(this)})}catch(t){return i&&i(),null}},MWF.xDesktop.$globalEvents={},MWF.xDesktop.addEvent=function(t,e,i){MWF.xDesktop.$globalEvents[t]||(MWF.xDesktop.$globalEvents[t]={}),MWF.xDesktop.$globalEvents[t][e]||(MWF.xDesktop.$globalEvents[t][e]=[]),MWF.xDesktop.$globalEvents[t][e].push(i)},MWF.xDesktop.addEvents=function(t,e){MWF.xDesktop.$globalEvents[t]||(MWF.xDesktop.$globalEvents[t]={}),Object.each(e,function(e,i){MWF.xDesktop.addEvent(t,i,e)}.bind(this))},MWF.xDesktop.removeEvent=function(t,e,i){return!MWF.xDesktop.$globalEvents[t]||(!MWF.xDesktop.$globalEvents[t][e]||void MWF.xDesktop.$globalEvents[t][e].erase(i))},MWF.xDesktop.removeEvents=function(t,e){return!MWF.xDesktop.$globalEvents[t]||(!MWF.xDesktop.$globalEvents[t][e]||void(MWF.xDesktop.$globalEvents[t][e]=[]))},MWF.org={parseOrgData:function(t,e,i){if(!t.distinguishedName)return t;switch(t.distinguishedName.substr(t.distinguishedName.length-2,2).toLowerCase()){case"@i":return this.parseIdentityData(t,e,i);case"@p":return this.parsePersonData(t,i);case"@u":return this.parseUnitData(t,i);case"@g":return this.parseGroupData(t,i);case"@r":return this.parseRoleData(t,i);case"@a":return this.parseAttributeData(t,i);default:return t}},parseIdentityData:function(t,e,i){if(i)return(t={id:t.id,name:t.name,distinguishedName:t.distinguishedName,unitLevelName:t.unitLevelName,person:t.person,unit:t.unit,unitName:t.unitName}).ignoreEmpower&&(s.ignoreEmpower=!0),t.ignoredEmpower&&(s.ignoredEmpower=!0),t;var s={id:t.id,name:t.name,unique:t.unique,distinguishedName:t.distinguishedName,person:t.person,unit:t.unit,unitName:t.unitName,unitLevelName:t.unitLevelName};if(t.personName&&(s.personName=t.personName),t.personEmployee&&(s.personEmployee=t.personEmployee),t.personUnique&&(s.personUnique=t.personUnique),t.personDn&&(s.personDn=t.personDn),t.ignoreEmpower&&(s.ignoreEmpower=!0),t.ignoredEmpower&&(s.ignoredEmpower=!0),!(e&&t.personDn&&t.personEmployee&&t.personUnique)){var o=t.woPerson;t.woPerson||MWF.Actions.get("x_organization_assemble_control").getPerson(t.person,(function(t){o=t.data}),null,!1),s.personName=o.name,s.personEmployee=o.employee,s.personUnique=o.unique,s.personDn=o.distinguishedName,e||(s.woPerson={id:o.id,genderType:o.genderType,name:o.name,employee:o.employee,unique:o.unique,distinguishedName:o.distinguishedName,dn:o.distinguishedName,mail:o.mail,weixin:o.weixin,qq:o.qq,mobile:o.mobile,officePhone:o.officePhone})}return s},parsePersonData:function(t,e){return e?{id:t.id,name:t.name,employee:t.employee,distinguishedName:t.distinguishedName}:{id:t.id,genderType:t.genderType,name:t.name,employee:t.employee,unique:t.unique,distinguishedName:t.distinguishedName,dn:t.distinguishedName,mail:t.mail,weixin:t.weixin,qq:t.qq,mobile:t.mobile,officePhone:t.officePhone}},parseUnitData:function(t,e){return e?{id:t.id,name:t.name,distinguishedName:t.distinguishedName,levelName:t.levelName}:{id:t.id,name:t.name,unique:t.unique,distinguishedName:t.distinguishedName,dn:t.distinguishedName,typeList:t.typeList,shortName:t.shortName,level:t.level,levelName:t.levelName}},parseGroupData:function(t,e){return e?{id:t.id,name:t.name,distinguishedName:t.distinguishedName}:{id:t.id,name:t.name,unique:t.unique,distinguishedName:t.distinguishedName,dn:t.distinguishedName}},parseRoleData:function(t,e){return e?{id:t.id,name:t.name,distinguishedName:t.distinguishedName}:{id:t.id,name:t.name,unique:t.unique,distinguishedName:t.distinguishedName,dn:t.distinguishedName}},parseAttributeData:function(t,e){return e?{id:t.id,name:t.name,distinguishedName:t.distinguishedName,person:t.person,attributeList:Array.clone(t.attributeList)}:{id:t.id,description:t.description,name:t.name,unique:t.unique,distinguishedName:t.distinguishedName,dn:t.distinguishedName,person:t.person,attributeList:Array.clone(t.attributeList)}}},MWF.xDesktop.Actions=MWF.xDesktop.Actions||{},MWF.xDesktop.Actions.RestActions=new Class({Implements:[Events],initialize:function(t,e,i){this.actionPath=t,this.serviceName=e,this.root=i},listApplicationAddress:function(t,e){var i=this.actions.listAddress;i=this.actions.slotHost+i;var s=new MWF.xApplication.Common.Actions.RestActions.Callback(t,e);MWF.getJSON(i,s)},getAddress:function(t,e){var i=layout.serviceAddressList[this.serviceName];if(i)this.address=layout.config.app_protocol+"//"+(i.host||window.location.hostname)+(80==i.port?"":":"+i.port)+i.context;else{var s=layout.desktop.centerServer.host||window.location.hostname,o=layout.desktop.centerServer.port;this.address=layout.config.app_protocol+"//"+s+("80"==o?"":":"+o)+"/x_program_center"}return t&&t.apply(),this.address},getActions:function(t){if(this.actions)t&&t();else{var e=this.root?"/"+this.root+this.actionPath:MWF.defaultPath+this.actionPath;MWF.getJSON(e,function(e){this.actions=e,t&&t()}.bind(this),!1,!1,!1)}},invokeUri:function(t){this.address||this.getAddress();var e=this.address+t.uri,i=!1!==t.async,s=t.method||"GET",o=new MWF.xDesktop.Actions.RestActions.Callback(t.success,t.failure),n=t.data?JSON.encode(t.data):"",a=!0;!1===t.withCredentials&&(a=!1),MWF.restful(s,e,n,o,i,a)},invoke:function(t){if(window.importScripts&&window.isCompletionEnvironment)return null;this.address||this.getAddress();var e=null;return this.getActions(function(){var i=this.actions[t.name],s=i.method||"GET",o=i.uri,n=i.progress;if(t.parameter&&Object.each(t.parameter,(function(e,i){var s=new RegExp("{"+i+"}","g");o=!1===t.urlEncode?o.replace(s,e):o.replace(s,encodeURI(e))})),o=this.address+o,layout.config.mock&&layout.config.mock[this.serviceName]){var a=layout.config.mock[this.serviceName][s.toLowerCase()];if(a){s=a.to||s;var r=a.append;o+="/"==o.substr(o.length-1,1)?r:"/"+r}}var l=!1!==t.async,c=new MWF.xDesktop.Actions.RestActions.Callback(t.success,t.failure);if(i.enctype&&"formdata"==i.enctype.toLowerCase())e=this.invokeFormData(s,o,t.data,t.file,c,l,n);else{var d=t.data?JSON.encode(t.data):"",h=!0;!1===t.withCredentials&&(h=!1),e=MWF.restful(s,o,d,c,l,h,t.cache)}}.bind(this)),e},formDataUpdateProgress:function(){},invokeFormDataWithProgress:function(t,e,i,s,o,n,a,r){var l=null,c=new Date;t.upload.addEventListener("progress",function(e){this.updateProgress(e,t,l,c)}.bind(this),!1),t.upload.addEventListener("load",function(e){o&&this.transferComplete(e,t,l,c,o)}.bind(this),!1),t.upload.addEventListener("loadstart",function(e){this.transferStart(e,t,l)}.bind(this),!1),t.upload.addEventListener("error",function(e){this.transferFailed(e,t,l)}.bind(this),!1),t.upload.addEventListener("abort",function(e){this.transferCanceled(e,t,l)}.bind(this),!1),t.upload.addEventListener("timeout",function(e){this.transferCanceled(e,t,l)}.bind(this),!1),t.addEventListener("readystatechange",function(e){this.xhrStateChange(e,t,l,n)}.bind(this),!1),t.open(e,i,!1!==a),t.withCredentials=!0,o&&File.prototype.isPrototypeOf(o)&&(l=this.addFormDataMessage(o,!1,t,r)),t.send(s)},setMessageText:function(t,e){if(t&&t.message){t.contentNode.getFirst("div").getFirst("div").getFirst("div");t.contentNode.getFirst("div").getLast("div").set("text",e),t.dateNode.set("text",(new Date).format("db"))}t&&t.moduleMessage&&t.moduleMessage.setMessageText&&t.moduleMessage.setMessageText()},setMessageTitle:function(t,e){t&&t.message&&t.subjectNode.set("text",e),t&&t.moduleMessage&&t.moduleMessage.setMessageTitle&&t.moduleMessage.setMessageTitle()},clearMessageProgress:function(t){t&&t.message&&t.contentNode.getFirst("div").getFirst("div").destroy();t&&t.moduleMessage&&t.moduleMessage.clearMessageProgress&&t.moduleMessage.clearMessageProgress()},transferStart:function(t,e,i){i&&i.message&&(this.setMessageText(i,MWF.LP.desktop.action.sendStart),i.status="progress"),i&&i.moduleMessage&&i.moduleMessage.transferStart&&i.moduleMessage.transferStart(),this.fireEvent("loadstart")},transferFailed:function(t,e,i){i&&i.message&&(this.setMessageText(i,MWF.LP.desktop.action.sendError),this.setMessageTitle(i,MWF.LP.desktop.action.sendError),this.clearMessageProgress(i),i.status="failed"),i&&i.moduleMessage&&i.moduleMessage.transferFailed&&i.moduleMessage.transferFailed(),this.fireEvent("error")},transferCanceled:function(t,e,i){i&&i.message&&(this.setMessageText(i,MWF.LP.desktop.action.sendAbort),this.setMessageTitle(i,MWF.LP.desktop.action.sendAbort),this.clearMessageProgress(i),i.status="cancel"),i&&i.moduleMessage&&i.moduleMessage.transferCanceled&&i.moduleMessage.transferCanceled(),this.fireEvent("abort")},transferComplete:function(t,e,i,s,o){var n=(new Date).getTime()-s.getTime(),a=o.size/n,r="K/S";a>1024&&(r="M/S",a/=1024),a>1024&&(r="G/S",a/=1024),a=a.round(2);var l="";if(n>36e5){var c=n%36e5,d=c/6e4,h=c%6e4/1e3;l=""+(n/36e5).toInt()+MWF.LP.desktop.action.hour+d.toInt()+MWF.LP.desktop.action.minute+h.toInt()+MWF.LP.desktop.action.second}else if(n>6e4){h=n%6e4/1e3;l=""+(d=n/6e4).toInt()+MWF.LP.desktop.action.minute+h.toInt()+MWF.LP.desktop.action.second}else{l=""+(h=n/1e3).toInt()+MWF.LP.desktop.action.second}i&&i.message&&(this.setMessageText(i,MWF.LP.desktop.action.uploadComplete+"  "+MWF.LP.desktop.action.speed+": "+a+r+"  "+MWF.LP.desktop.action.time+": "+l,MWF.LP.desktop.action.uploadComplete),this.setMessageTitle(i,MWF.LP.desktop.action.uploadComplete),this.clearMessageProgress(i),i.status="completed"),i&&i.moduleMessage&&i.moduleMessage.transferComplete&&i.moduleMessage.transferComplete(),this.fireEvent("load")},updateProgress:function(t,e,i,s){var o=t.loaded/t.total*100,n=(new Date).getTime()-s.getTime(),a=t.loaded/n,r="K/S";if(a>1024&&(r="M/S",a/=1024),a>1024&&(r="G/S",a/=1024),a=a.round(2),i&&i.message&&i.contentNode){var l=i.contentNode.getFirst("div").getFirst("div").getFirst("div"),c=i.contentNode.getFirst("div").getLast("div");l.setStyle("width",o+"%"),c.set("text",MWF.LP.desktop.action.sendStart+": "+a+r)}i&&i.moduleMessage&&i.moduleMessage.updateProgress&&i.moduleMessage.updateProgress(o),this.fireEvent("progress")},xhrStateChange:function(t,e,i,s){if(4==e.readyState){var o=e.status;if((o=1223==o?204:o)>=200&&o<300){var n=JSON.decode(e.responseText);if(n)switch(n.type){case"success":var a="";"array"==(r=typeOf(n.data))&&(a=n.data[0].id),"object"==r&&(a=n.data.id),MWF.runCallback(s,"success",[{type:"success",id:a,messageId:i&&i.moduleMessage?i.moduleMessage.data.id:"",data:n.data},e.responseText]);break;case"warn":MWF.xDesktop.notice("info",{x:"right",y:"top"},n.errorMessage.join("\n"));var r;a="";"array"==(r=typeOf(n.data))&&(a=n.data[0].id),"object"==r&&(a=n.data.id),MWF.runCallback(s,"success",[{type:"success",id:a},e.responseText]);break;case"error":(l=i&&i.moduleMessage?i.moduleMessage.data.id:"")&&e&&(e.messageId=l),MWF.runCallback(s,"failure",[e])}else(l=i&&i.moduleMessage?i.moduleMessage.data.id:"")&&e&&(e.messageId=l),MWF.runCallback(s,"failure",[e])}else{var l;(l=i&&i.moduleMessage?i.moduleMessage.data.id:"")&&e&&(e.messageId=l),MWF.runCallback(s,"failure",[e])}}},invokeFormDataWithoutProgress:function(t,e,i,s,o,n,a,r){var l=null,c=new Date;t.addEventListener("readystatechange",function(e){4==t.readyState&&(o&&this.transferComplete(e,t,l,c,o),this.xhrStateChange(e,t,l,n))}.bind(this),!1),t.open(e,i,!0),t.withCredentials=!0,l=this.addFormDataMessage(o,!0,t,r),t.send(s),this.setMessageText(l,MWF.LP.desktop.action.sendStart)},invokeFormDataWithForm:function(t,e,i,s,o,n,a){MWF.O2UploadCallback=n,MWF.O2UploadCallbackFun=function(){MWF.O2UploadCallback&&MWF.O2UploadCallback()};var r=s.items[0].value.el.getParent();r.set("styles",{width:"500px",height:"300px","background-color":"#999999",position:"absolute",top:"100px",left:"100px","z-index":"30000",display:"block"}).inject(document.body);var l=new Element("form",{method:e,action:-1!=i.indexOf("?")?i+"&callback=MWF.O2UploadCallbackFun":i+"?callback=MWF.O2UploadCallbackFun",enctype:"multipart/form-data",target:"o2_upload_iframe"}).inject(r);new Element("iframe",{name:"o2_upload_iframe"}).inject(r);s.items.each(function(t){"string"==typeOf(t.value)?new Element("input",{name:t.name,value:t.value}).inject(l):(t.value.el.inject(l),t.value.el.set("name",t.name))}.bind(this));new Element("input",{type:"submit"}).inject(l)},invokeFormData:function(t,e,i,s,o,n,a){e=o2.filterUrl(e);var r=new COMMON.Browser.Request;return s&&i.append("fileName",s.name),"o2_formdata"===i.type?this.invokeFormDataWithForm(r,t,e,i,s,o,n):r.upload?this.invokeFormDataWithProgress(r,t,e,i,s,o,n,a):this.invokeFormDataWithoutProgress(r,t,e,i,s,o,n,a),r},addFormDataMessage:function(t,e,i,s){if(layout.desktop.message){var o="";o=e?'<div style="height: 20px; line-height: 20px">'+MWF.LP.desktop.action.sendReady+"</div></div>":'<div style="overflow: hidden"><div style="height: 3px; border:1px solid #999; margin: 3px 0px"><div style="height: 3px; background-color: #acdab9; width: 0px;"></div></div><div style="height: 20px; line-height: 20px">'+MWF.LP.desktop.action.sendReady+"</div></div>";var n={subject:MWF.LP.desktop.action.uploadTitle,content:(t.name?t.name+"<br/>":"")+o},a=layout.desktop.message.addMessage(n);a.close=function(e,s){if("progress"==this.status){flag=!1;var o=MWF.LP.desktop.action.cancelUpload.replace(/{name}/g,t.name||"");MWF.xDesktop.confirm("wram",s,MWF.LP.desktop.action.cancelUploadTitle,o,"400","140",(function(){i.abort(),this.close()}),(function(){this.close()}))}else a.closeItem(e,s)}}if(this.targetModule){var r=this.targetModule.module.addFormDataMessage(this.targetModule.file);a||(a={}),a.moduleMessage=r,this.targetModule=null}return s&&window.setTimeout(function(){layout.desktop.message&&(layout.desktop.message.isShow||layout.desktop.message.show())}.bind(this),300),a},getAuthentication:function(t,e){this.invoke({name:"authentication",async:!0,success:function(i,s){"anonymous"!=i.data.tokenType?t&&t(i):e&&e(null,s,i.message)},failure:e})},login:function(t,e,i){this.invoke({name:"login",async:!0,data:t,success:function(t,s){"anonymous"!=t.data.tokenType?e&&e(t):i&&i(null,s,t.message)},failure:i})},logout:function(t,e){this.invoke({name:"logout",async:!1,success:t,failure:e})}}),MWF.xDesktop.Actions.RestActions.Callback=new Class({initialize:function(t,e,i,s){this.success=t,this.failure=e,this.appendSuccess=i,this.appendFailure=s},onSuccess:function(t,e){if(!t)return this.doError(null,e,"");switch(t.type){case"success":return this.appendSuccess&&this.appendSuccess(t),this.success?this.success(t,e):t;case"warn":return MWF.xDesktop.notice("info",{x:"right",y:"top"},t.errorMessage.join("\n")),this.appendSuccess&&this.appendSuccess(t),this.success?this.success(t):t;case"error":return this.doError(null,e,t.message)}},onRequestFailure:function(t){return this.doError(t,"","")},onFailure:function(t,e,i){return this.doError(t,e,i)},onError:function(t,e){return this.doError(null,t,e)},doError:function(t,e,i){if(this.appendFailure&&this.appendFailure(t,e,i),this.failure&&this.failure.owner){if(this.failure.reject||this.failure.rejectList&&this.failure.rejectList.length)return this.failure(t,e,i);this.failure=null}else if(this.failure)return this.failure(t,e,i);if(!this.failure&&!this.appendFailure&&0!=t.status){var s=i;if(t){var o=JSON.decode(t.responseText);s=o?o.message.trim()||"request json error":"request json error: "+t.responseText}s=(s=s.replace(/\</g,"&lt;")).replace(/\</g,"&gt;"),layout.session&&layout.session.user&&MWF.xDesktop.notice("error",{x:"right",y:"top"},s)}return Promise.reject(t)}}),MWF.xAction=MWF.xAction||{},MWF.xAction.RestActions=MWF.Actions={actions:{},loadedActions:{},get:function(t){if(this.actions[t])return this.actions[t];var e=null,i=o2.session.path+"/xAction/services/"+t+".json";return MWF.getJSON(i,function(t){e=t}.bind(this),!1,!1,!1),!MWF.xAction.RestActions.Action[t]&&e.clazz&&MWF.require("MWF.xAction.services."+e.clazz,null,!1),MWF.xAction.RestActions.Action[t]||(MWF.xAction.RestActions.Action[t]=new Class({Extends:MWF.xAction.RestActions.Action})),this.actions[t]=new MWF.xAction.RestActions.Action[t](t,e),this.actions[t]},load:function(t){if(this.loadedActions[t])return this.loadedActions[t];var e=null,i=this.getHost(t)+"/"+t+"/describe/api.json";if(MWF.getJSON(i,function(t){e=t.jaxrs}.bind(this),!1,!1,!1),e){var s={};return e.each(function(e){if(e.methods&&e.methods.length){var i={};e.methods.each(function(t){var e={uri:"/"+t.uri};t.method&&(e.method=t.method),t.enctype&&(e.enctype=t.enctype),i[t.name]=e}.bind(this)),s[e.name]=new MWF.xAction.RestActions.Action(t,i)}}.bind(this)),this.loadedActions[t]=s,s}return null},async:function(t,e){var i="function"===o2.typeOf(e)?e:e.success,s="function"===o2.typeOf(e)?null:e.failure,o=[],n=t.length,a=new Array(n-1),r=function(){o.length===n&&i.apply(this,a)};t.each((function(t,e){var i=t.par||[];i.push((function(t){a[e]=t,o.push(!0),r()})),i.push((function(t,e,i){o.push(!1),s?s():function(t,e,i){if(0!=t.status){var s=i;if(t){var o=JSON.decode(t.responseText);s=o?o.message.trim()||"request json error":"request json error: "+t.responseText}MWF.xDesktop.notice("error",{x:"right",y:"top"},s)}}(t,0,i),r()})),i.push(!0),i.push(t.urlEncode),i.push(t.cache),t.action[t.subAction][t.name].apply(t.action[t.subAction],i)}))},invokeAsync2:function(t,e){var i="function"===o2.typeOf(e)?e:e.success,s="function"===o2.typeOf(e)?null:e.failure,o=[],n=t.length,a=new Array(n-1),r=function(){o.length===n&&i.apply(this,a)};t.each((function(t,e){var i=t.par||[];i.push((function(t){a[e]=t,o.push(!0),r()})),i.push((function(t,e,i){o.push(!1),s?s():function(t,e,i){if(0!=t.status){var s=i;if(t){var o=JSON.decode(t.responseText);s=o?o.message.trim()||"request json error":"request json error: "+t.responseText}MWF.xDesktop.notice("error",{x:"right",y:"top"},s)}}(t,0,i),r()})),i.push(!0),i.push(t.urlEncode),i.push(t.cache),t.action[t.name].apply(t.action,i)}))},getHost:function(t){var e=layout.serviceAddressList[t],i="";if(e)i=layout.config.app_protocol+"//"+(e.host||window.location.hostname)+(80==e.port?"":":"+e.port);else{var s=layout.desktop.centerServer.host||window.location.hostname,o=layout.desktop.centerServer.port;i=layout.config.app_protocol+"//"+s+("80"==o?"":":"+o)}return i},invokeAsync:function(t,e){var i=t.length,s=arguments.length-2,o=[],n=new Array(i-1),a=arguments,r="function"===o2.typeOf(e)?e:e.success,l="function"===o2.typeOf(e)?null:e.failure,c=function(){o.length===i&&r.apply(this,n)},d=function(t,e,i){if(0!=t.status){var s=i;if(t){var o=JSON.decode(t.responseText);s=o?o.message.trim()||"request json error":"request json error: "+t.responseText}MWF.xDesktop.notice("error",{x:"right",y:"top"},s)}};t.each((function(t,e){var i=e<s?a[e+2]:a[s+1];if(i){var r="array"===o2.typeOf(i)?i:[i];r.unshift((function(t,e,i){o.push(!1),l?l():d(t,e,i),c()})),r.unshift((function(t){n[e]=t,o.push(!0),c()}));t.action[t.name].apply(t.action,r)}else t.action[t.name]((function(){n[e]=json,o.push(!0),c()}),(function(t,e,i){o.push(!1),l?l():d(t,e,i),c()}))}))}},MWF.xAction.RestActions.Action=new Class({initialize:function(t,e){this.action=new MWF.xDesktop.Actions.RestActions("/xAction/services/"+t+".json",t,""),this.action.actions=e,Object.each(this.action.actions,function(t,e){t.uri&&(this[e]||this.createMethod(t,e))}.bind(this))},createMethod:function(t,e){var i=t.uri,s=new RegExp("{.+?}","g"),o=i.match(s),n=[];o&&(n=o.map((function(t){return t.substring(1,t.length-1)}))),this[e]=this.invokeFunction(t,n,e)},invokeFunction:function(t,e,i){return function(){var s,o,n,a,r,l=e.length-1,c=arguments.length,d=arguments,h={};return"function"===typeOf(d[0])?(l=-1,s=c>++l?d[l]:null,o=c>++l?d[l]:null,e.each((function(t,e){h[t]=c>++l?d[l]:null})),!t.method||"post"!==t.method.toLowerCase()&&"put"!==t.method.toLowerCase()||(t.enctype&&"formdata"===t.enctype.toLowerCase()?(a=c>++l?d[l]:null,r=c>++l?d[l]:null):a=c>++l?d[l]:null),n=c>++l?d[l]:null,urlEncode=!(c>++l)||d[l],cache=c>++l?d[l]:"ie"!=Browser.name):(e.each((function(t,e){h[t]=c>e?d[e]:null})),!t.method||"post"!==t.method.toLowerCase()&&"put"!==t.method.toLowerCase()||(t.enctype&&"formdata"===t.enctype.toLowerCase()?(a=c>++l?d[l]:null,r=c>++l?d[l]:null):a=c>++l?d[l]:null),s=c>++l?d[l]:null,o=c>++l?d[l]:null,n=c>++l?d[l]:null,urlEncode=!(c>++l)||d[l],cache=c>++l?d[l]:"ie"!=Browser.name),this.invoke(t,{name:i,async:n,data:a,file:r,parameter:h,success:s,failure:o,urlEncode:urlEncode,cache:cache})}.bind(this)},invoke:function(t,e){return this.action.invoke(e)}}),MWF.xDesktop=MWF.xDesktop||{},MWF.xApplication=MWF.xApplication||{},MWF.xDesktop.Access=MWF.AC={companyList:null,action:null,getRoleList:function(){this.roleList||(this.roleList=[],layout.desktop.session.user.roleList.each(function(t){this.roleList.push(t.substring(0,t.indexOf("@")).toLowerCase())}.bind(this)))},isAdministrator:function(){return this.getRoleList(),"xadmin"===layout.desktop.session.user.name.toLowerCase()||-1!==this.roleList.indexOf("manager")},isProcessManager:function(){return!!layout.desktop.session.user.roleList&&(this.getRoleList(),this.isAdministrator()||-1!==this.roleList.indexOf("processplatformmanager"))},isPortalManager:function(){return!!layout.desktop.session.user.roleList&&(this.getRoleList(),this.isAdministrator()||-1!==this.roleList.indexOf("portalmanager"))},isQueryManager:function(){return!!layout.desktop.session.user.roleList&&(this.getRoleList(),this.isAdministrator()||-1!==this.roleList.indexOf("querymanager"))},isOrganizationManager:function(){return!!layout.desktop.session.user.roleList&&(this.getRoleList(),this.isAdministrator()||-1!==this.roleList.indexOf("organizationmanager"))},isMessageManager:function(){return!!layout.desktop.session.user.roleList&&(this.getRoleList(),this.isAdministrator()||-1!==this.roleList.indexOf("messagemanager"))},isServiceManager:function(){return!!layout.desktop.session.user.roleList&&(this.getRoleList(),this.isAdministrator()||-1!==this.roleList.indexOf("servicemanager"))},isUnitManager:function(){return!!layout.desktop.session.user.roleList&&(this.getRoleList(),this.isAdministrator()||-1!==this.roleList.indexOf("unitmanager"))},isGroupManager:function(){return!!layout.desktop.session.user.roleList&&(this.getRoleList(),this.isAdministrator()||-1!==this.roleList.indexOf("groupmanager"))},isRoleManager:function(){return!!layout.desktop.session.user.roleList&&(this.getRoleList(),this.isAdministrator()||-1!==this.roleList.indexOf("rolemanager"))},isPersonManager:function(){return!!layout.desktop.session.user.roleList&&(this.getRoleList(),this.isAdministrator()||-1!==this.roleList.indexOf("personmanager"))},isGroupCreator:function(){return!!layout.desktop.session.user.roleList&&(this.getRoleList(),-1!==this.roleList.indexOf("groupcreator"))},isProcessPlatformCreator:function(){return!!this.isAdministrator()||(!!this.isProcessManager()||!!layout.desktop.session.user.roleList&&(this.getRoleList(),-1!==this.roleList.indexOf("processplatformcreator")))},isPortalPlatformCreator:function(){return!!this.isAdministrator()||(!!this.isPortalManager()||!!layout.desktop.session.user.roleList&&(this.getRoleList(),-1!==this.roleList.indexOf("portalcreator")))},isQueryPlatformCreator:function(){return!!this.isAdministrator()||(!!this.isQueryManager()||!!layout.desktop.session.user.roleList&&(this.getRoleList(),-1!==this.roleList.indexOf("querycreator")))},isApplicationManager:function(t){this.isAdministrator()&&t.yes&&t.yes()},isCMSManager:function(){return this.getRoleList(),this.isAdministrator()||-1!==this.roleList.indexOf("cmsmanager")},isBBSManager:function(){return this.getRoleList(),this.isAdministrator()||-1!==this.roleList.indexOf("bbsmanager")||-1!==this.roleList.indexOf("bssmanager")},isOKRManager:function(){return this.getRoleList(),this.isAdministrator()||-1!==this.roleList.indexOf("okrmanager")},isCRMManager:function(){return this.getRoleList(),this.isAdministrator()||-1!==this.roleList.indexOf("crmmanager")},isAttendanceManager:function(){return this.getRoleList(),this.isAdministrator()||-1!==this.roleList.indexOf("attendancemanager")},isMeetingAdministrator:function(){return this.getRoleList(),this.isAdministrator()||-1!==this.roleList.indexOf("meetingmanager")},isHotPictureManager:function(){return this.getRoleList(),this.isAdministrator()||-1!==this.roleList.indexOf("hotpicturemanager")},isPersonEditor:function(t){return!!this.isAdministrator()||(!!this.isPersonManager()||!(!t.list||!t.list.length||-1===t.list.indexOf(layout.desktop.session.user.id)))},isCompanyEditor:function(t){this.isAdministrator()||this.isCompanyCreator()?t.yes&&t.yes():this.getCompanyList(function(){t.id?-1!==this.companyList.indexOf(t.id)?t.yes&&t.yes():t.no&&t.no():this.companyList.length>0?t.yes&&t.yes():t.no&&t.no()}.bind(this))},isDepartmentEditor:function(t){this.isAdministrator()||this.isCompanyCreator()?t.yes&&t.yes():this.getCompanyList(function(){t.id&&-1!==this.companyList.indexOf(t.id)?t.yes&&t.yes():t.no&&t.no()}.bind(this))},getCompanyList:function(t){null===this.companyList?(this.getAction(),this.action.getCompanyAccess(function(e){e.data?this.companyList=e.data:this.companyList=[],t&&t()}.bind(this),null,layout.desktop.session.user.id)):t&&t()},getAction:function(){this.action||(this.action=MWF.Actions.get("x_organization_assemble_control"))}},o2.require("MWF.widget.Dialog",null,!1),o2.xDesktop.Dialog=o2.DDL=new Class({Extends:o2.widget.Dialog,options:{zindex:null,maxHeightPercent:"98%"},_markShow:function(){if(this.options.mark){if(!this.markNode){var t=MWF.getMarkSize(this.options.maskNode),e=this.options.container||$(document.body);this.markNode=new Element("iframe",{styles:this.css.mark}).inject(e),this.markNode.set("styles",{height:t.y,width:t.x}),this.markNode_up||(this.markNode_up=new Element("div",{styles:this.css.mark}).inject(e)),this.markNode_up.set("styles",{height:t.y,width:t.x})}this.markNode.setStyle("display","block")}},setZindex:function(){"number"===o2.typeOf(this.options.zindex)&&this.options.zindex>0&&(this.css=Object.clone(this.css),this.css.from["z-index"]=this.options.zindex.toString(),this.css.to["z-index"]=this.options.zindex.toString(),this.css.mark["z-index"]=(this.options.zindex-1).toString())},getDialogNode:function(){this.setZindex(),this.width=this.options.width,this.height=this.options.height,this.node.set("styles",this.css.from);var t=this.options.container||$(document.body);this.node.inject(t),this.title=this.node.getElement(".MWF_dialod_title"),this.titleCenter=this.node.getElement(".MWF_dialod_title_center"),this.titleText=this.node.getElement(".MWF_dialod_title_text"),this.titleAction=this.node.getElement(".MWF_dialod_title_action"),this.content=this.node.getElement(".MWF_dialod_content"),this.bottom=this.node.getElement(".MWF_dialod_bottom"),this.resizeNode=this.node.getElement(".MWF_dialod_bottom_resize"),this.button=this.node.getElement(".MWF_dialod_button"),this.options.buttonList&&0!==this.options.buttonList.length||this.options.buttons?(this.okButton=this.node.getElement(".MWF_dialod_ok_button"),this.cancelButton=this.node.getElement(".MWF_dialod_cancel_button")):(this.button.setStyle("display","none"),this.buttonDisable=!0),this.backAction=this.node.getElement(".MWF_dialod_Action_back"),this.options.isTitle||(this.title.destroy(),this.title=null,this.titleCenter=null,this.titleRefresh=null,this.titleText=null,this.titleAction=null),this.title&&this.setTitleEvent(),this.content&&this.getContent(),this.titleAction&&this.getAction(),this.resizeNode&&this.setResizeNode(),this.content&&this.setContentSize(),this.backAction&&this.backAction.addEvent("click",this.close.bind(this))},getButton:function(){for(i in this.options.buttons)new Element("input",{type:"button",value:i,styles:this.css.button,class:"mainColor_bg",events:{click:this.options.buttons[i].bind(this)}}).inject(this.button);this.options.buttonList&&this.options.buttonList.each(function(t){var e,i=this.css.button;"ok"===t.type&&this.css.okButton&&(i=this.css.okButton),"cancel"===t.type&&this.css.cancelButton&&(i=this.css.cancelButton),t.styles&&(i=t.styles),"ok"===t.type&&this.okButton?(e=this.okButton).show():"cancel"===t.type&&this.cancelButton?(e=this.cancelButton).show():e=t.tag?new Element(t.tag,{}).inject(this.button):new Element("input",{type:"button"}).inject(this.button),"button"===e.get("type")?e.set({value:t.text,title:t.title,styles:i,class:"cancel"!==t.type?"mainColor_bg":"",events:{click:function(e){t.action.call(this,this,e)}.bind(this)}}):e.set({text:t.text,title:t.title,styles:i,class:"cancel"!==t.type?"mainColor_bg":"",events:{click:function(e){t.action.call(this,this,e)}.bind(this)}})}.bind(this))},setTitleEvent:function(){var t;this.options.isMove&&(layout.app&&(t=layout.app.content),layout.desktop.currentApp&&(t=layout.desktop.currentApp.content),this.containerDrag=new Drag.Move(this.node,{handle:this.title,container:this.options.positionNode||this.options.container||this.markNode||t,snap:5}))},getAction:function(){this.options.isClose&&(this.closeAction=new Element("div",{styles:this.css.closeAction}).inject(this.titleAction),this.closeAction.addEvent("click",this.close.bind(this))),this.options.isMax&&(this.maxAction=new Element("div",{styles:this.css.maxAction}).inject(this.titleAction),this.maxAction.addEvent("click",this.maxSize.bind(this)),this.restoreAction=new Element("div",{styles:this.css.restoreAction}).inject(this.titleAction),this.restoreAction.hide(),this.restoreAction.addEvent("click",this.restoreSize.bind(this)),this.title&&this.title.addEvent("dblclick",function(){this.switchMax()}.bind(this)))},switchMax:function(){this.isMax?this.restoreSize():this.maxSize()},maxSize:function(){this.oldNodeSize||(this.oldNodeSize={width:this.nodeWidth,height:this.nodeHeight}),this.oldContentSize||(this.oldContentSize={width:this.contentWidth,height:this.contentHeight});var t=$(document.body);layout.desktop.currentApp?t=layout.desktop.currentApp.content:this.options.container&&this.options.container.getSize().y<$(document.body).getSize().y&&(t=this.options.container);var e=t.getSize();this.options.width=e.x,this.options.height=e.y,this.setContentSize(e.y,e.x),this.node.setStyles({width:e.x+"px",height:e.y+"px",top:"0px",left:"0px"}),this.maxAction.setStyle("display","none"),this.restoreAction.setStyle("display",""),this.isMax=!0,this.fireEvent("max")},restoreSize:function(){this.contentHeight=this.oldContentSize.height,this.contentWidth=this.oldContentSize.width,this.nodeHeight=this.oldNodeSize.height,this.nodeWidth=this.oldNodeSize.width,this.content.setStyles(this.oldContentSize),this.node.setStyles(this.oldNodeSize),this.reCenter(),this.maxAction.setStyle("display",""),this.restoreAction.setStyle("display","none"),this.isMax=!1,this.fireEvent("restore")},reCenter:function(){var t;t=null===this.node.offsetParent?this.node.measure((function(){return this.getSize()})):this.node.getSize(),this.options.positionWidth&&(t.x=parseInt(this.options.positionWidth)),this.options.positionHeight&&(t.y=parseInt(this.options.positionHeight));var e=$(document.body);this.options.positionNode&&this.options.positionNode.getSize().y<$(document.body).getSize().y?e=this.options.positionNode:layout.desktop.currentApp?e=layout.desktop.currentApp.content:this.options.container&&this.options.container.getSize().y<$(document.body).getSize().y&&(e=this.options.container);var i=o2.getCenter(t,e,e);i.y<(this.options.minTop||0)&&(i.y=this.options.minTop||0),this.options.top=i.y,this.options.left=i.x,this.css.to.top=this.options.top+"px",this.css.to.left=this.options.left+"px",this.node.setStyles({top:this.css.to.top,left:this.css.to.left})},getOffsetY:function(t){return(t.getStyle("margin-top").toInt()||0)+(t.getStyle("margin-bottom").toInt()||0)+(t.getStyle("padding-top").toInt()||0)+(t.getStyle("padding-bottom").toInt()||0)+(t.getStyle("border-top-width").toInt()||0)+(t.getStyle("border-bottom-width").toInt()||0)},getOffsetX:function(t){return(t.getStyle("margin-left").toInt()||0)+(t.getStyle("margin-right").toInt()||0)+(t.getStyle("padding-left").toInt()||0)+(t.getStyle("padding-right").toInt()||0)+(t.getStyle("border-left-width").toInt()||0)+(t.getStyle("border-right-width").toInt()||0)},getMarginY:function(t){return(t.getStyle("margin-top").toInt()||0)+(t.getStyle("margin-bottom").toInt()||0)},getMarginX:function(t){return(t.getStyle("margin-left").toInt()||0)+(t.getStyle("margin-right").toInt()||0)},setContentHeightAuto:function(){var t=this.getMaxHeight(),e=0,i=0;this.title&&(e=e+this.getOffsetY(this.title)+this.title.getSize().y),this.bottom&&(e=e+this.getOffsetY(this.bottom)+this.bottom.getSize().y),this.button&&!this.buttonDisable&&(e=e+this.getOffsetY(this.button)+this.button.getSize().y),i=this.content?(e+=this.getMarginY(this.content))+this.content.getSize().y:e,"number"===typeOf(t)&&i>t?(this.options.height=t,this.options.contentHeight=null,this.options.fromTop=this.options.fromTop.toFloat()-e/2,this.options.top=this.options.top.toFloat()-e/2,this.css.to.height=t+"px",this.css.to.top=this.options.top+"px",this.css.from.top=this.options.fromTop+"px",this.node.setStyles({height:t}),this.contentHeight=t-e,this.content&&this.content.setStyles({height:t-e,"overflow-y":"auto"})):(this.options.height=i,this.options.contentHeight=null,this.options.fromTop=this.options.fromTop.toFloat()-e/2,this.options.top=this.options.top.toFloat()-e/2,this.css.to.height=i+"px",this.css.to.top=this.options.top+"px",this.css.from.top=this.options.fromTop+"px",this.node.setStyles({height:i}),this.contentHeight=i-e,this.content&&this.content.setStyles({height:i-e,"overflow-y":"hidden"}))},getMaxHeight:function(){var t,e;if(this.options.maxHeightPercent&&(t=this.options.maxHeightPercent,"string"===typeOf(t)&&"%"===t.substr(t.length-1,1))){var i=(this.options.positionNode||this.options.container||$(document.body)).getSize().y;(t=parseInt(i*parseInt(t)/100))+(this.options.minTop||0)>i&&(t=i-this.options.minTop)}return this.options.maxHeight&&"NaN"!==parseFloat(this.options.maxHeight).toString()?(e=parseFloat(this.options.maxHeight),"number"===typeOf(t)&&(e=Math.min(e,t))):"number"===typeOf(t)&&(e=t),e},getNodeSize:function(){return{height:this.nodeHeight+"px",width:this.nodeWidth+"px"}},getContentSize:function(t,e){var i,s;if(t)this.nodeHeight=t;else if(this.options.contentHeight)i=t=this.options.contentHeight.toFloat(),this.contentHeight=t;else{t=this.options.height.toFloat();var o=this.getMaxHeight();"number"===typeOf(o)&&o<t&&(t=o),this.nodeHeight=t}e?this.nodeWidth=e:this.options.contentWidth?(s=e=this.options.contentWidth.toFloat(),this.contentWidth=e):(e=this.options.width.toFloat(),this.nodeWidth=e);var n,a=0;if(this.title){var r=this.title.getSize().y,l=this.title.getStyle("padding-top").toFloat(),c=this.title.getStyle("padding-bottom").toFloat(),d=this.title.getStyle("margin-top").toFloat(),h=this.title.getStyle("margin-bottom").toFloat();a+=r+l+c+d+h}if(this.bottom){var u=this.bottom.getSize().y,p=this.bottom.getStyle("padding-top").toFloat(),m=this.bottom.getStyle("padding-bottom").toFloat(),f=this.bottom.getStyle("margin-top").toFloat(),g=this.bottom.getStyle("margin-bottom").toFloat();a+=u+p+m+f+g}if(this.button&&!this.buttonDisable){var y=this.button.getSize().y,x=this.button.getStyle("padding-top").toFloat(),b=this.button.getStyle("padding-bottom").toFloat(),v=this.button.getStyle("margin-top").toFloat(),w=this.button.getStyle("margin-bottom").toFloat();a+=y+x+b+v+w}var S=this.content.getStyle("padding-top").toFloat(),A=this.content.getStyle("padding-bottom").toFloat(),N=this.content.getStyle("margin-top").toFloat(),k=this.content.getStyle("margin-bottom").toFloat();if(a+=S+A+N+k,i?i=i+a+2:t-=a,n=this.content.getStyle("padding-left").toFloat()+this.content.getStyle("padding-right").toFloat()+this.content.getStyle("margin-left").toFloat()+this.content.getStyle("margin-right").toFloat(),s?s+=n:e-=n,i?(this.nodeHeight=i,this.options.height=i,this.options.contentHeight=null,this.options.fromTop=this.options.fromTop.toFloat()-a/2,this.options.top=this.options.top.toFloat()-a/2,this.css.to.height=i+"px",this.css.to.top=this.options.top+"px",this.css.from.top=this.options.fromTop+"px"):this.contentHeight=t,s?(this.nodeWidth=s,this.options.width=s,this.options.contentWidth=null,this.options.fromLeft=this.options.fromLeft.toFloat()-n/2,this.options.left=this.options.left.toFloat()-n/2,this.css.to.width=s+"px",this.css.to.left=this.options.left+"px",this.css.from.left=this.options.fromLeft+"px"):this.contentWidth=e,!t||t<0){this.content.setStyles({overflow:"hidden",height:"auto",width:e+"px"});var I=(t=this.content.getSize().y)+r+l+c+d+h;I=(I=(I=I+u+p+m+f+g)+y+x+b+v+w)+S+A+N+k,this.css.to.height=I}return{height:t+"px",width:e+"px"}},setContentHeight:function(t){var e;if(t)this.nodeHeight=t;else if(this.options.contentHeight)e=t=this.options.contentHeight.toFloat(),this.contentHeight=t;else{t=this.options.height.toFloat();var i=this.getMaxHeight();"number"===typeOf(i)&&i<t&&(t=i),this.nodeHeight=t}var s=0;if(this.title){var o=this.title.getSize().y,n=this.title.getStyle("padding-top").toFloat(),a=this.title.getStyle("padding-bottom").toFloat(),r=this.title.getStyle("margin-top").toFloat(),l=this.title.getStyle("margin-bottom").toFloat();s+=o+n+a+r+l}if(this.bottom){var c=this.bottom.getSize().y,d=this.bottom.getStyle("padding-top").toFloat(),h=this.bottom.getStyle("padding-bottom").toFloat(),u=this.bottom.getStyle("margin-top").toFloat(),p=this.bottom.getStyle("margin-bottom").toFloat();s+=c+d+h+u+p}if(this.button&&!this.buttonDisable){var m=this.button.getSize().y,f=this.button.getStyle("padding-top").toFloat(),g=this.button.getStyle("padding-bottom").toFloat(),y=this.button.getStyle("margin-top").toFloat(),x=this.button.getStyle("margin-bottom").toFloat();s+=m+f+g+y+x}var b=this.content.getStyle("padding-top").toFloat(),v=this.content.getStyle("padding-bottom").toFloat(),w=this.content.getStyle("margin-top").toFloat(),S=this.content.getStyle("margin-bottom").toFloat();if(s+=b+v+w+S,e?e=e+s+2:t-=s,e?(this.nodeHeight=e,this.options.height=e,this.options.contentHeight=null,this.options.fromTop=this.options.fromTop.toFloat()-s/2,this.options.top=this.options.top.toFloat()-s/2,this.css.to.height=e+"px",this.css.to.top=this.options.top+"px",this.css.from.top=this.options.fromTop+"px"):this.contentHeight=t,!t||t<0){this.content.setStyles({overflow:"hidden",height:"auto"});var A=(t=this.content.getSize().y)+o+n+a+r+l;A=(A=(A=A+c+d+h+u+p)+m+f+g+y+x)+b+v+w+S,this.css.to.height=A}else this.content.setStyles({height:t})},setContentWidthAuto:function(){var t=this.options.maxWidth||"100%";if("string"===typeOf(t)&&"%"===t.substr(t.length-1,1)){var e=(this.options.positionNode||this.options.container||$(document.body)).getSize().x;t=parseInt(e*parseInt(t)/100)}var i=0,s=0;(s=this.content?(i+=this.getMarginX(this.content))+this.content.getSize().x:i)>t?(this.nodeWidth=t,this.options.width=t,this.options.contentWidth=null,this.options.fromLeft=this.options.fromLeft.toFloat()-i/2,this.options.left=this.options.left.toFloat()-i/2,this.css.to.width=t+"px",this.css.to.left=this.options.left+"px",this.css.from.left=this.options.fromLeft+"px",this.node.setStyles({width:t}),this.contentWidth=t-this.getOffsetX(this.content),this.content&&this.content.setStyles({width:this.contentWidth,"overflow-x":"auto"})):(this.nodeWidth=s,this.options.width=s,this.options.contentHeight=null,this.options.fromLeft=this.options.fromLeft.toFloat()-i/2,this.options.left=this.options.left.toFloat()-i/2,this.css.to.width=s+"px",this.css.to.left=this.options.left+"px",this.css.from.left=this.options.fromLeft+"px",this.node.setStyles({width:s}),this.contentWidth=s-this.getOffsetX(this.content),this.content&&this.content.setStyles({width:this.contentWidth,"overflow-x":"hidden"}))},setContentWidth:function(t){var e;t?this.nodeWidth=t:this.options.contentWidth?(e=t=this.options.contentWidth.toFloat(),this.contentWidth=t):(t=this.options.width.toFloat(),this.nodeWidth=t);var i;if(i=this.content.getStyle("padding-left").toFloat()+this.content.getStyle("padding-right").toFloat()+this.content.getStyle("margin-left").toFloat()+this.content.getStyle("margin-right").toFloat(),e)e+=i;else{var s=t;t-=i}e?(this.nodeWidth=e,this.options.width=e,this.options.contentWidth=null,this.css.to.left=this.options.left+"px",this.css.from.left=this.options.fromLeft+"px",this.css.to.width=e+"px",this.options.fromLeft=this.options.fromLeft.toFloat()-i/2,this.options.left=this.options.left.toFloat()-i/2,this.node.setStyle("width",e)):(this.contentWidth=t,this.node.setStyle("width",s)),this.content.setStyles({width:t})},setContentSize:function(t,e){var i=t;i||(i=this.options.contentHeight?this.options.contentHeight:this.height);var s=e;s||(s=this.options.contentWidth?this.options.contentWidth:this.width),"auto"===i||"auto"===s?("auto"===i?this.setContentHeightAuto():this.setContentHeight(t),"auto"===s?this.setContentWidthAuto():this.setContentWidth(e)):(this.content.setStyles(this.getContentSize(t,e)),this.content.setStyle("width","auto"))}}),o2.DL.open=function(t){var e;t||(t={}),t.style||(t.style="user"),t.duration||(t.duration=200),!1!==t.isClose&&(t.isClose=!0),t.width&&"auto"!=t.width||t.contentWidth||t.content&&(t.content.show(),e=t.content.getComputedSize(),t.contentWidth=e.totalWidth.toFloat()),t.height&&"auto"!=t.height||t.contentHeight||t.content&&(e||(t.content.show(),e=t.content.getComputedSize()),t.contentHeight=e.totalHeight.toFloat()+2),t.width||t.contentWidth||(t.width=300),t.height||t.contentHeight||(t.height=150),!t.container&&layout&&layout.desktop.currentApp&&(t.container=layout.desktop.currentApp.content);var i=t.positionNode||t.container||$(document.body);if("auto"!==t.width&&"auto"!==t.height){if("string"==typeOf(t.width)&&1<t.width.length&&"%"==t.width.substr(t.width.length-1,1)&&(t.width=parseInt(i.getSize().x*parseInt(t.width,10)/100,10)),"string"==typeOf(t.height)&&1<t.height.length&&"%"==t.height.substr(t.height.length-1,1)&&(t.height=parseInt(i.getSize().y*parseInt(t.height,10)/100,10)),void 0===t.top&&void 0===t.left){var s=o2.getCenter({x:t.width||t.contentWidth,y:t.height||t.contentHeight+120},i,i);t.top=s.y<0?0:s.y,t.left=s.x<0?0:s.x}if(void 0===t.fromTop&&void 0===t.fromLeft){s=o2.getCenter({x:0*(t.width||t.contentWidth),y:0*(t.height||t.contentHeight+120)},i,i);t.fromTop=s.y<0?0:s.y,t.fromLeft=s.x<0?0:s.x}t.offset&&(t.offset.y&&(t.top=t.top+t.offset.y.toInt(),t.fromTop=t.fromTop+t.offset.y.toInt()),t.offset.x&&(t.left=t.left+t.offset.x.toInt(),t.fromLeft=t.fromLeft+t.offset.x.toInt())),t.top<0&&(t.top=0),t.left<0&&(t.left=0),t.fromTop<0&&(t.fromTop=0),t.fromLeft<0&&(t.fromLeft=0)}else void 0===t.top&&(t.top=0),void 0===t.left&&(t.left=0),void 0===t.fromTop&&(t.fromTop=0),void 0===t.fromLeft&&(t.fromLeft=0);t.mark=!(!1===t.mask);var o=new o2.DDL(t);return"auto"!==t.width&&"auto"!==t.height||o.reCenter(),o.show(),o},MWF.xDesktop=MWF.xDesktop||{},MWF.require("MWF.widget.Menu",null,!1),MWF.xDesktop.Menu=new Class({Extends:MWF.widget.Menu,Implements:[Options,Events],options:{style:"default",event:"contextmenu",disable:!1,top:-1,left:-1,container:null,where:{x:"left",y:"bottom"}},load:function(){this.fireEvent("queryLoad")&&(this.node=new Element("div#menu"),this.node.set("styles",this.css.container),this.options.event&&this.target&&this.target.addEvent(this.options.event,this.showIm.bind(this)),this.borderNode=new Element("div.MWFMenu",{styles:this.css.borderNode}).inject(this.options.container||$(document.body)),this.node.inject(this.borderNode),this.hide=this.hideMenu.bind(this),this.fireEvent("postLoad"))},showIm:function(t){if(!this.options.disable&&(this.hide=this.hideIm.bind(this),this.fireEvent("queryShow",[t]))){if(this.tmpBodyOncontextmenu=document.body.oncontextmenu,document.body.oncontextmenu=function(){return!1},this.pauseCount<=0){this.setItemWidth();var e=MWF.xDesktop.zIndexPool.zIndex;this.borderNode.setStyles({display:"block",opacity:this.options.opacity||1,"z-index":e}),this.setPosition(t),$(document.body).removeEvent("mousedown",this.hide),$(document.body).addEvent("mousedown",this.hide),this.show=!0}else this.pauseCount--;var i=this.node.getPosition(document.body),s=this.node.getSize(),o=document.body.getSize();if(i.y+s.y+10>o.y){var n=o.y-i.y-10;this.node.setStyle("height",n+"px"),this.node.addEvent("mousedown",(function(t){t.stopPropagation()}))}this.fireEvent("postShow")}},hideIm:function(t){this.fireEvent("queryHide")&&($(document.body).removeEvent("mousedown",this.hide),this.borderNode.set("styles",{display:"none",opacity:0}),this.show=!1,document.body.oncontextmenu=this.tmpBodyOncontextmenu,this.tmpBodyOncontextmenu=null,t&&this.topMenu&&this.topMenu.hideIm(),this.fireEvent("postHide"))},setPosition:function(t){var e=this.target.getPosition(this.target.getOffsetParent()),i=this.target.getSize();this.borderNode.show();var s=this.borderNode.getSize(),o=0,n=0;switch(this.options.where.x.toLowerCase()){case"right":o=e.x-s.x+i.x;break;default:o=e.x-0}switch(this.options.where.y.toLowerCase()){case"top":n=e.y-s.y;break;default:n=e.y+i.y}this.options.offsetY&&(n+=this.options.offsetY),this.options.offsetX&&(o+=this.options.offsetX);var a=$(document.body).getSize(),r=this.borderNode.getSize();o+r.x>a.x&&(o=a.x-r.x-10),this.borderNode.setStyle("top",n),this.borderNode.setStyle("left",o)}}),MWF.xDesktop=MWF.xDesktop||{},MWF.xApplication=MWF.xApplication||{},MWF.require("MWF.xDesktop.Actions.RestActions",null,!1),MWF.xDesktop.UserData=MWF.UD={getAction:function(){this.action=o2.Actions.get("x_organization_assemble_personal")},getData:function(t,e,i){this.action||this.getAction(),this.action.getUserData(t,(function(t){e&&e(t)}),null,i)},getDataJson:function(t,e,i){this.action||this.getAction(),this.action.getUserData(t,(function(t){var i=null;t.data&&(i=JSON.decode(t.data)),e&&e(i)}),null,i)},putData:function(t,e,i,s){this.action||this.getAction(),this.action.putUserData(t,e,(function(t){i&&i(t)}),null,s)},deleteData:function(t,e,i){this.action||this.getAction(),this.action.deleteUserData(t,(function(t){e&&e(t)}),null,i)},getPublicData:function(t,e,i){this.action||this.getAction(),this.action.getPublicUserData(t,(function(t){var i=null;t.data&&(i=JSON.decode(t.data)),e&&e(i)}),null,i)},putPublicData:function(t,e,i,s){this.action||this.getAction(),this.action.putPublicUserData(t,e,(function(t){i&&(i.success?i.success(t):i(t))}),(function(t,e,s){if(0!=t.status){var o=s;if(t){var n=JSON.decode(t.responseText);o=n?n.message.trim()||"request json error":"request json error: "+t.responseText}MWF.xDesktop.notice("error",{x:"right",y:"top"},o)}i&&i.failure&&i.failure(t,e,s)}),s)},deletePublicData:function(t,e,i){this.action||this.getAction(),this.action.deletePublicUserData(t,(function(t){e&&e(t)}),null,i)}},MWF.xApplication.Template=MWF.xApplication.Template||{},MWF.xApplication.Template.MPopupForm=MPopupForm=new Class({Extends:MWF.widget.Common,Implements:[Options,Events],options:{style:"default",width:500,height:450,top:null,left:null,bottom:null,right:null,minWidth:300,minHeight:220,isLimitSize:!0,ifFade:!0,hasTop:!1,hasTopIcon:!1,hasTopContent:!1,hasIcon:!0,hasBottom:!0,hasMask:!0,closeByClickMask:!1,hasScroll:!0,scrollType:"",title:"",draggable:!1,resizeable:!1,maxAction:!1,closeAction:!0,relativeToApp:!0,sizeRelateTo:"app",resultSeparator:","},initialize:function(t,e,i,s){this.setOptions(i),this.explorer=t,s?this.options.relativeToApp?(this.app=s.app||this.explorer.app,this.container=s.container||this.app.content,this.lp=s.lp||this.explorer.lp||this.app.lp,this.css=s.css||this.explorer.css||this.app.css,this.actions=s.actions||this.explorer.actions||this.app.actions||this.app.restActions):(this.container=s.container,this.lp=s.lp||this.explorer.lp,this.css=s.css||this.explorer.css,this.actions=s.actions||this.explorer.actions):this.options.relativeToApp?(this.app=this.explorer.app,this.container=this.app.content,this.lp=this.explorer.lp||this.app.lp,this.css=this.explorer.css||this.app.css,this.actions=this.explorer.actions||this.app.actions||this.app.restActions):(this.container=window.document.body,this.lp=this.explorer.lp,this.css=this.explorer.css,this.actions=this.explorer.actions),this.data=e||{},this.cssPath="../x_component_Template/$MPopupForm/"+this.options.style+"/css.wcss",this.load()},load:function(){this._loadCss()},_loadCss:function(){var t={};new Request.JSON({url:o2.filterUrl(this.cssPath),secure:!1,async:!1,method:"get",noCache:!1,onSuccess:function(e,s){t=e,MWF.widget.css[i]=e}.bind(this),onError:function(t,e){alert(e+t)}}).send();var e=!0;for(var i in t)if(i){e=!1;break}e||(this.css=Object.merge(t,this.css))},reload:function(t){t&&(this.data=this.form.getResult(!1,this.options.resultSeparator,!1,!1,!0)),this.formTopNode=null,this.setFormNodeSizeFun&&this.app&&this.app.removeEvent&&this.app.removeEvent("resize",this.setFormNodeSizeFun),this.formMaskNode&&this.formMaskNode.destroy(),this.formAreaNode&&this.formAreaNode.destroy(),this.isNew?this.create():this.isEdited?this.edit():this.open()},open:function(t){this.fireEvent("queryOpen"),this.isNew=!1,this.isEdited=!1,this._open(),this.fireEvent("postOpen")},create:function(){this.fireEvent("queryCreate"),this.isNew=!0,this._open(),this.fireEvent("postCreate")},edit:function(){this.fireEvent("queryEdit"),this.isEdited=!0,this._open(),this.fireEvent("postEdit")},_open:function(){if(this.options.hasMask&&(this.formMaskNode=new Element("div.formMaskNode",{styles:this.css.formMaskNode,events:{mouseover:function(t){t.stopPropagation()},mouseout:function(t){t.stopPropagation()},click:function(t){t.stopPropagation()},mousewheel:function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1},DOMMouseScroll:function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1}}}).inject(this.container||this.app.content)),this.formAreaNode=new Element("div.formAreaNode",{styles:this.css.formAreaNode}),this.createFormNode(),this.formMaskNode?this.formAreaNode.inject(this.formMaskNode,"after"):this.formAreaNode.inject(this.container||this.app.content),this.options.ifFade?this.formAreaNode.fade("in"):this.formAreaNode.setStyle("opacity",1),this.setFormNodeSize(),this.setFormNodeSizeFun=this.setFormNodeSize.bind(this),this.app&&this.app.addEvent&&this.app.addEvent("resize",this.setFormNodeSizeFun),this.options.draggable&&this.formTopNode){var t=(this.container||this.app.content).getSize(),e=this.formAreaNode.getSize();this.formAreaNode.makeDraggable({handle:this.formTopNode,limit:{x:[0,t.x-e.x],y:[0,t.y-e.y]},onDrag:function(){this.fireEvent("drag")}.bind(this),onComplete:function(){this.fireEvent("dragCompleted")}.bind(this)})}this.options.closeByClickMask&&this.formMaskNode&&this.formMaskNode.addEvent("click",function(t){this.close(t)}.bind(this)),this.options.resizeable&&(this.resizeNode=new Element("div.resizeNode",{styles:this.css.resizeNode}).inject(this.formNode),this.formAreaNode.makeResizable({handle:this.resizeNode,limit:{x:[this.options.minWidth,null],y:[this.options.minHeight,null]},onDrag:function(){var t=this.formAreaNode.getComputedSize();this.setNodesSize(t.width,t.height),this.fireEvent("resize")}.bind(this),onComplete:function(){var t=this.formAreaNode.getComputedSize();this.options.width=t.width,this.options.height=t.height,this.oldCoordinate&&(this.oldCoordinate.width=t.width,this.oldCoordinate.height=t.height),this.fireEvent("resizeCompleted")}.bind(this)}))},createFormNode:function(){this.formNode=new Element("div.formNode",{styles:this.css.formNode}).inject(this.formAreaNode),this.options.hasTop&&this.createTopNode(),this.options.hasIcon&&(this.formIconNode=new Element("div.formIconNode",{styles:this.isNew?this.css.formNewNode:this.css.formIconNode}).inject(this.formNode)),this.createContent(),this.options.hasBottom&&this.createBottomNode(),this._setCustom(),this.options.hasScroll&&("window"==this.options.scrollType?(this.formContentNode.setStyle("overflow","auto"),this.formTableContainer.setStyle("overflow","visible")):MWF.require("MWF.widget.ScrollBar",function(){new MWF.widget.ScrollBar(this.formTableContainer,{indent:!1,style:"xApp_TaskList",where:"before",distance:30,friction:4,axis:{x:!1,y:!0},onScroll:function(t){}})}.bind(this)))},_setCustom:function(){},createTopNode:function(){this.fireEvent("queryCreateTop"),this.formTopNode||(this.formTopNode=new Element("div.formTopNode",{styles:this.css.formTopNode}).inject(this.formNode),this.options.hasTopIcon&&(this.formTopIconNode=new Element("div",{styles:this.css.formTopIconNode}).inject(this.formTopNode)),this.formTopTextNode=new Element("div",{styles:this.css.formTopTextNode,text:this.options.title}).inject(this.formTopNode),this.options.closeAction&&(this.formTopCloseActionNode=new Element("div",{styles:this.css.formTopCloseActionNode,title:MWF.xApplication.Template.LP.MPopupForm.close}).inject(this.formTopNode),this.formTopCloseActionNode.addEvent("click",function(t){this.close(),t.stopPropagation()}.bind(this))),this.options.maxAction&&(this.formTopMaxActionNode=new Element("div",{styles:this.css.formTopMaxActionNode,title:MWF.xApplication.Template.LP.MPopupForm.max}).inject(this.formTopNode),this.formTopMaxActionNode.addEvent("click",function(){this.maxSize()}.bind(this)),this.formTopRestoreActionNode=new Element("div",{styles:this.css.formTopRestoreActionNode,title:MWF.xApplication.Template.LP.MPopupForm.restore}).inject(this.formTopNode),this.formTopRestoreActionNode.addEvent("click",function(){this.restoreSize()}.bind(this)),this.formTopNode.addEvent("dblclick",function(){this.switchMax()}.bind(this))),this.options.hasTopContent&&(this.formTopContentNode=new Element("div.formTopContentNode",{styles:this.css.formTopContentNode}).inject(this.formTopNode),this._createTopContent())),this.fireEvent("postCreateTop")},_createTopContent:function(){},createContent:function(){this.formContentNode=new Element("div.formContentNode",{styles:this.css.formContentNode}).inject(this.formNode),this.formTableContainer=new Element("div.formTableContainer",{styles:this.css.formTableContainer}).inject(this.formContentNode),this.formTableArea=new Element("div.formTableArea",{styles:this.css.formTableArea}).inject(this.formTableContainer),this._createTableContent()},_createTableContent:function(){this.formTableArea.set("html","<table width='100%' bordr='0' cellpadding='5' cellspacing='0' styles='formTable'><tr><td styles='formTableTitle' lable='empName'></td>    <td styles='formTableValue' item='empName'></td></tr><tr><td styles='formTableTitle' lable='departmentName'></td>    <td styles='formTableValue' item='departmentName'></td></tr><tr><td styles='formTableTitle' lable='recordDateString'></td>    <td styles='formTableValue' item='recordDateString'></td></tr><tr><td styles='formTableTitle' lable='status'></td>    <td styles='formTableValue' item='status'></td></tr><tr><td styles='formTableTitle' lable='appealReason'></td>    <td styles='formTableValue' item='appealReason'></td></tr><tr><td styles='formTableTitle' lable='appealDescription'></td>    <td styles='formTableValue' item='appealDescription'></td></tr><tr><td styles='formTableTitle' lable='opinion1'></td>    <td styles='formTableValue' item='opinion1'></td></tr></table>"),MWF.xDesktop.requireApp("Template","MForm",function(){this.form=new MForm(this.formTableArea,{empName:"xadmin"},{isEdited:this.isEdited||this.isNew,itemTemplate:{empName:{text:"姓名",type:"innertext"},departmentName:{text:"部门",tType:"department",notEmpty:!0},recordDateString:{text:"日期",tType:"date"},status:{text:"状态",tType:"number"},appealReason:{text:"下拉框",type:"select",selectValue:["测试1","测试2"]},appealDescription:{text:"描述",type:"textarea"},opinion1:{text:"测试",type:"button",value:"测试"}}},this.app),this.form.load()}.bind(this),!0)},createBottomNode:function(){this.fireEvent("queryCreateBottom"),this.formBottomNode=new Element("div.formBottomNode",{styles:this.css.formBottomNode}).inject(this.formNode),this._createBottomContent(),this.fireEvent("postCreateBottom")},_createBottomContent:function(){this.cancelActionNode=new Element("div.formCancelActionNode",{styles:this.css.formCancelActionNode,text:this.lp.cancel}).inject(this.formBottomNode),this.cancelActionNode.addEvent("click",function(t){this.cancel(t)}.bind(this)),(this.isNew||this.isEdited)&&(this.okActionNode=new Element("div.formOkActionNode",{styles:this.css.formOkActionNode,text:this.lp.ok}).inject(this.formBottomNode),this.okActionNode.addEvent("click",function(t){this.ok(t)}.bind(this)))},cancel:function(t){this.fireEvent("queryCancel"),this.close(),this.fireEvent("postCancel")},close:function(t){this.fireEvent("queryClose"),this._close(),this.setFormNodeSizeFun&&this.app&&this.app.removeEvent&&this.app.removeEvent("resize",this.setFormNodeSizeFun),this.formMaskNode&&this.formMaskNode.destroy(),this.formAreaNode&&this.formAreaNode.destroy(),this.fireEvent("postClose")},_close:function(){},ok:function(t){this.fireEvent("queryOk");var e=this.form.getResult(!0,this.options.resultSeparator,!0,!1,!0);e&&this._ok(e,function(t){"error"==t.type?this.app&&this.app.notice&&this.app.notice(t.message,"error"):(this.formMaskNode&&this.formMaskNode.destroy(),this.formAreaNode&&this.formAreaNode.destroy(),this.explorer&&this.explorer.view&&this.explorer.view.reload(),this.app&&this.app.notice&&this.app.notice(this.isNew?this.lp.createSuccess:this.lp.updateSuccess,"success"),this.fireEvent("postOk"))}.bind(this))},_ok:function(t,e){},switchMax:function(){this.isMax?this.restoreSize():this.maxSize()},maxSize:function(){this.oldCoordinate||(this.oldCoordinate={width:this.options.width,height:this.options.height,top:this.options.top,left:this.options.left,bottom:this.options.bottom,right:this.options.right}),this.options.width="100%",this.options.height="100%",this.options.top=null,this.options.left=null,this.options.bottom=null,this.options.right=null,this.setFormNodeSize(),this.formTopMaxActionNode.setStyle("display","none"),this.formTopRestoreActionNode.setStyle("display",""),this.isMax=!0,this.fireEvent("max")},restoreSize:function(){this.oldCoordinate&&(this.options.width=this.oldCoordinate.width,this.options.height=this.oldCoordinate.height,this.options.top=this.oldCoordinate.top,this.options.left=this.oldCoordinate.left,this.options.bottom=this.oldCoordinate.bottom,this.options.right=this.oldCoordinate.right),this.setFormNodeSize(),this.formTopMaxActionNode.setStyle("display",""),this.formTopRestoreActionNode.setStyle("display","none"),this.isMax=!1,this.fireEvent("restore")},setFormNodeSize:function(t,e,i,s,o,n){this._beforeFormNodeSize(),t||(t=this.options.width?this.options.width:"50%"),e||(e=this.options.height?this.options.height:"50%"),i||0==i||(i=this.options.top),s||0==s||(s=this.options.left),o||0==o||(o=this.options.bottom),n||0==n||(n=this.options.right),t=t.toString(),e=e.toString();var a=(this.container||this.app.content).getSize(),r=a.x,l=a.y;this.options.isLimitSize&&("%"!=t.substr(t.length-1,1)&&a.x<parseInt(t)&&(t=a.x),"%"!=e.substr(e.length-1,1)&&a.y<parseInt(e)&&(e=a.y)),"string"==typeof t&&1<t.length&&"%"==t.substr(t.length-1,1)&&(t=parseInt(r*parseInt(t,10)/100,10)),this.options.minWidth>t&&(t=this.options.minWidth),"string"==typeof e&&1<e.length&&"%"==e.substr(e.length-1,1)&&(e=parseInt(l*parseInt(e,10)/100,10)),this.options.minHeight>e&&(e=this.options.minHeight);var c={width:t+"px",height:e+"px"};null!=i?(c.top=i+"px",c.bottom="auto"):null!=o?(c.top="auto",c.bottom=o+"px"):(c.top=parseInt((l-e)/2,10)+"px",c.bottom="auto"),null!=s?(c.left=s+"px",c.right="auto"):null!=n?(c.left="auto",c.right=n+"px"):(c.left=parseInt((r-t)/2,10)+"px",c.right="auto"),this.formAreaNode&&this.formAreaNode.setStyles(c),this._setFormNodeSize(c),this.setNodesSize(t,e)},_beforeFormNodeSize:function(){},_setFormNodeSize:function(t){},setNodesSize:function(t,e){this.options.minWidth>t&&(t=this.options.minWidth),this.options.minHeight>e&&(e=this.options.minHeight),this.formNode.setStyles({width:t+"px",height:e+"px"});var i=this.formIconNode?this.formIconNode.getSize():{x:0,y:0},s=this.formTopNode?this.formTopNode.getSize():{x:0,y:0},o=this.formBottomNode?this.formBottomNode.getSize():{x:0,y:0},n=e-i.y-s.y-o.y,a=parseFloat(this.formContentNode.getStyle("margin-top"))||0,r=parseFloat(this.formContentNode.getStyle("margin-bottom"))||0,l=n-a-r;this.formContentNode.setStyles({height:l+"px"});var c=parseFloat(this.formContentNode.getStyle("padding-top"))||0,d=parseFloat(this.formContentNode.getStyle("padding-bottom"))||0,h=n-(a=parseFloat(this.formTableContainer.getStyle("margin-top"))||0)-(r=parseFloat(this.formTableContainer.getStyle("margin-bottom"))||0)-c-d-(parseFloat(this.formTableContainer.getStyle("padding-top"))||0)-(parseFloat(this.formTableContainer.getStyle("padding-bottom"))||0);"window"==this.options.scrollType&&(h-=10),this.formTableContainer.setStyles({height:h+"px"}),this._setNodesSize(t,e,l,h),this.fireEvent("resizeForm")},_setNodesSize:function(t,e,i,s){}}),MWF.xDesktop=MWF.xDesktop||{},MWF.xApplication=MWF.xApplication||{},MWF.xDesktop.requireApp("Template","MPopupForm",null,!1),MWF.require("MWF.xDesktop.UserData",null,!1),MWF.xDesktop.Authentication=new Class({Extends:MWF.widget.Common,Implements:[Options,Events],options:{style:"default",width:"420",height:"640",popupStyle_password:"o2platformSignupFlat",popupStyle_signup:"o2platformSignup"},initialize:function(t,e,i){this.setOptions(t),this.node=i,this.path=MWF.defaultPath+"/xDesktop/$Authentication/";var s=null;MWF.UD.getPublicData("loginStyleList",function(t){t&&t.enabledId&&MWF.UD.getPublicData(t.enabledId,function(t){t&&t.data&&(s=t.data)}.bind(this),!1)}.bind(this),!1),s?this.css=s:(this.cssPath=MWF.defaultPath+"/xDesktop/$Authentication/"+this.options.style+"/css.wcss",this._loadCss()),this.lp=MWF.LP.authentication,this.app=e||{}},isAuthenticated:function(t,e){MWF.Actions.get("x_organization_assemble_authentication").getAuthentication(t,e)},loadLogin:function(t){t&&(this.loginNode=t),!t&&this.loginNode&&(t=this.loginNode),layout.config.loginPage&&layout.config.loginPage.enable&&layout.config.loginPage.portal?(MWF.xDesktop.loadPortal(layout.config.loginPage.portal,this.options.loginParameter),this.fireEvent("openLogin")):(this.popupOptions={draggable:!1,closeAction:!1,hasMask:!1,relativeToApp:!1},this.popupPara={container:t},this.postLogin=function(t){layout.desktop.session.user=t.data,layout.session.user=t.data,layout.session.token=layout.session.user.token;var e=layout.desktop.session.user;if(e.identityList||(e.identityList=[]),e.roleList){var i=[];e.roleList.each((function(t){i.push(t.substring(0,t.indexOf("@")))})),e.roleList=e.roleList.concat(i)}window.location.reload()}.bind(this),this.openLoginForm(this.popupOptions),this.fireEvent("openLogin"))},logout:function(t){MWF.Actions.get("x_organization_assemble_authentication").logout(function(){this.socket&&(this.socket.close(),this.socket=null),layout.session&&layout.session.user&&(layout.session.user.token=""),t?t():window.location.reload()}.bind(this))},openLoginForm:function(t,e){var i=Object.merge(this.popupOptions||{},t||{},{onPostOk:function(t){e&&e(t),this.postLogin&&this.postLogin(t),this.fireEvent("postOk",t)}.bind(this)});i.width=this.options.width,i.height=this.options.height,new MWF.xDesktop.Authentication.LoginForm(this,{},i,this.popupPara).create()},openSignUpForm:function(t,e){var i=Object.merge(this.popupOptions||{},t||{},{onPostOk:function(t){e&&e(t),this.fireEvent("postOk",t)}.bind(this)});delete i.width,delete i.height,this.options.popupStyle_signup&&(i.popupStyle=this.options.popupStyle_signup),new MWF.xDesktop.Authentication.SignUpForm(this,{},i,this.popupPara).create()},openResetPasswordForm:function(t,e){var i=Object.merge(this.popupOptions||{},t||{},{onPostOk:function(t){e&&e(t),this.fireEvent("postOk",t)}.bind(this)});this.options.popupStyle_password&&(i.popupStyle=this.options.popupStyle_password),new MWF.xDesktop.Authentication.ResetPasswordForm(this,{},i,this.popupPara).create()},openChangePasswordForm:function(t,e){var i=Object.merge(this.popupOptions||{},t||{},{onPostOk:function(t){e&&e(t),this.fireEvent("postOk",t)}.bind(this)});new MWF.xDesktop.Authentication.ChangePasswordForm(this,{},i,this.popupPara).create()}}),MWF.xDesktop.Authentication.LoginForm=new Class({Extends:MPopupForm,Implements:[Options,Events],options:{style:"default",popupStyle:"o2platform",width:"650",height:"480",hasTop:!0,hasIcon:!1,hasTopIcon:!0,hasTopContent:!0,hasBottom:!1,hasScroll:!1,hasMark:!1,title:"",draggable:!0,closeAction:!0},load:function(){this.setOptions({title:layout.config&&(layout.config.systemTitle||layout.config.title)?layout.config.title||layout.config.systemTitle:MWF.LP.authentication.LoginFormTitle}),this._loadCss()},_createTopContent:function(){this.actions=MWF.Actions.get("x_organization_assemble_authentication"),this.faceLogin=!1,this.actions.getLoginMode(function(t){this.faceLogin=t.data.faceLogin}.bind(this),null,!1),this.faceLogin&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&COMMON.AjaxModule.loadDom("../o2_lib/adapter/adapter.js",function(){navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&(this.cameraLoginIcon=new Element("div",{styles:this.explorer.css.cameraLoginIcon}).inject(this.formTopContentNode),this.cameraLoginIcon.addEvent("click",function(){this.isCameraLogin?(this.closeCamera(),this.isCameraLogin=!1):(this.cameraLogin(),this.isCameraLogin=!0)}.bind(this)))}.bind(this))},closeCamera:function(){this.cameraLoginVideoNode&&(this.video&&this.video.destroy(),this.canvas&&this.canvas.destroy(),this.cameraLoginVideoNode&&this.cameraLoginVideoNode.destroy(),this.video=null,this.canvas=null,this.cameraLoginVideoNode=null),this.cameraLoginIcon.setStyles(this.explorer.css.cameraLoginIcon)},cameraLoginInit:function(){this.cameraLoginConfig={maxStep:2,step:0,count:0,max:2,errorCount:0,errorMax:3,user:"",tokens:[]}},cameraLoginReset:function(t){this.cameraLoginConfig.count=0,this.cameraLoginConfig.user="",t&&(this.cameraLoginConfig.errorCount=0)},cameraLogin:function(){this.cameraLoginInit(),this.cameraLoginIcon.setStyles(this.explorer.css.closeCameraLoginIcon),this.createCameraLoginNode(),this.startCameraLogin()},createCameraLoginNode:function(){this.cameraLoginVideoNode=new Element("div",{styles:this.explorer.css.cameraLoginVideoNode}).inject(this.container);var t=this.formNode.getSize(),e=this.formTopNode.getSize(),i=t.y-e.y;this.cameraLoginVideoNode.setStyles({width:t.x+"px",height:i+"px"}),this.cameraLoginVideoNode.position({relativeTo:this.formContentNode,position:"upperLeft",edge:"upperLeft"})},startCameraLogin:function(){this.cameraLoginVideoAreaNode=new Element("div").inject(this.cameraLoginVideoNode),this.cameraLoginVideoInfoNode=new Element("div",{styles:this.explorer.css.cameraLoginVideoInfoNode}).inject(this.cameraLoginVideoNode),this.cameraLoginVideoInfoNode.set("text",MWF.LP.desktop.login.camera_logining);var t=this.cameraLoginVideoNode.getSize(),e=this.cameraLoginVideoInfoNode.getSize(),i=t.y-e.y;this.cameraLoginVideoAreaNode.setStyle("height",i+"px"),this.cameraLoginVideoAreaNode.set("html","<video autoplay></video>"),this.video=this.cameraLoginVideoAreaNode.getFirst().setStyles({"background-color":"#000000",width:t.x+"px",height:i+"px"}),this.videoStart()},videoStart:function(){this.video.addEventListener("canplay",function(){window.setTimeout(function(){this.startCameraAuthentication()}.bind(this),500)}.bind(this)),navigator.mediaDevices.getUserMedia({audio:!1,video:!0}).then(function(t){this.video.srcObject=t}.bind(this)).catch(function(t){console.log("navigator.getUserMedia error: ",t),this.closeCamera()}.bind(this))},getFormData:function(){this.canvas||(this.canvas=new Element("canvas",{styles:{display:"none"}}).inject(this.cameraLoginVideoNode),this.canvas.width=this.video.videoWidth,this.canvas.height=this.video.videoHeight),this.canvas.getContext("2d").drawImage(this.video,0,0,this.canvas.width,this.canvas.height);var t=this.toBlob(this.canvas.toDataURL()),e=new FormData;return e.append("file",t),this.canvas.destroy(),{data:e,size:t.size}},checkUserFace:function(t){var e=window.location.host;e=e.replace(/\./g,"_"),this.faceAction.search(e,t.data,{name:"pic",size:t.size},function(t){if(t.data.results&&t.data.results.length){var e=t.data.thresholds["1e-5"];if(t.data.results[0].confidence>e){var i=t.data.faces[0].face_token,s=t.data.results[0].user_id;this.cameraLoginConfig.user&&this.cameraLoginConfig.user!==s?(this.cameraLoginReset(),this.cameraLoginConfig.errorCount++):(this.cameraLoginConfig.count++,this.cameraLoginConfig.user=s,this.cameraLoginConfig.tokens.push(i),this.cameraLoginConfig.step++,this.cameraLoginConfig.errorCount=0,this.cameraLoginVideoInfoNode.set("text",MWF.LP.desktop.login["camera_logining_"+this.cameraLoginConfig.step]))}else this.cameraLoginReset(),this.cameraLoginConfig.errorCount++}else this.cameraLoginReset(),this.cameraLoginConfig.errorCount++;this.checkCameraLogin()}.bind(this),function(){window.setTimeout(function(){this.startCameraAuthentication()}.bind(this),500)}.bind(this))},checkUserAlive:function(t,e,i){this.faceAction.detectattr(e,t.data,{name:"pic",size:t.size},function(t){t.data.faces&&t.data.faces.length&&this[i](t.data.faces[0].attributes)?(this.cameraLoginConfig.step++,this.cameraLoginConfig.errorCount=0,this.cameraLoginVideoInfoNode.set("text",MWF.LP.desktop.login["camera_logining_"+this.cameraLoginConfig.step])):this.cameraLoginConfig.errorCount++,this.checkCameraLogin()}.bind(this),function(){this.cameraLoginConfig.errorCount++,this.checkCameraLogin()}.bind(this))},checkUserSmile:function(t){return t.smile.value>t.smile.threshold},checkUserPitch:function(t){return t.headpose.pitch_angle<-10},startCameraAuthentication:function(){if(this.video){var t=this.getFormData();this.faceAction||(this.faceAction=MWF.Actions.get("x_faceset_control")),0===this.cameraLoginConfig.step&&this.checkUserFace(t),1===this.cameraLoginConfig.step&&this.checkUserAlive(t,"smiling","checkUserSmile"),2===this.cameraLoginConfig.step&&this.checkUserAlive(t,"headpose","checkUserPitch")}},toBlob:function(t){var e;e="data:image"===t.substr(0,10)?window.atob(t.split(",")[1]):window.atob(t);for(var i=new ArrayBuffer(e.length),s=new Uint8Array(i),o=0;o<e.length;o++)s[o]=e.charCodeAt(o);return new Blob([i],{type:"image/png"})},getDIF:function(t){return Math.max.apply(this,t)-Math.min.apply(this,t)},checkCameraLogin:function(){if(this.cameraLoginConfig.errorCount>this.cameraLoginConfig.errorMax)this.cameraLoginVideoInfoNode.set("text",MWF.LP.desktop.login.camera_loginError);else if(this.cameraLoginConfig.step>=this.cameraLoginConfig.maxStep){var t=MWF.LP.desktop.login.camera_loginSuccess.replace("{name}",this.cameraLoginConfig.user);this.cameraLoginVideoInfoNode.set("text",t),this.cameraLoginSuccess()}else window.setTimeout(function(){this.startCameraAuthentication()}.bind(this),100)},cameraLoginSuccess:function(){COMMON.AjaxModule.loadDom(["../o2_lib/CryptoJS/tripledes.js","../o2_lib/CryptoJS/mode-ecb.js"],function(){var t=layout.serviceAddressList.x_organization_assemble_authentication,e=layout.config.app_protocol+"//"+(t.host||window.location.hostname)+(80===t.port?"":":"+t.port)+t.context,i={client:"face",token:this.crypDES()};new Request.JSON({method:"POST",url:e+"/jaxrs/sso",data:JSON.stringify(i),secure:!1,emulation:!1,noCache:!0,withCredentials:!0,headers:{"Content-Type":"application/json; charset=utf-8"},onSuccess:function(t){this._close(),this.closeCamera(),this.formMaskNode&&this.formMaskNode.destroy(),this.formAreaNode.destroy(),this.explorer&&this.explorer.view&&this.explorer.view.reload(),this.app&&this.app.notice(this.lp.loginSuccess,"success"),this.fireEvent("postOk",t)}.bind(this),onError:function(){this.cameraLoginVideoInfoNode.set("text",MWF.LP.desktop.login.camera_loginError2)}.bind(this)}).send()}.bind(this))},crypDES:function(){var t=this.cameraLoginConfig.user,e=(new Date).getTime(),i=CryptoJS.enc.Utf8.parse("xplatform"),s=CryptoJS.DES.encrypt(t+"#"+e,i,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7}).ciphertext.toString(CryptoJS.enc.Base64);return s=(s=(s=s.replace(/=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")},_createTableContent:function(){this.loginType="captcha",this.codeLogin=!1,this.bindLogin=!1,this.captchaLogin=!0,this.actions.getLoginMode(function(t){this.codeLogin=t.data.codeLogin,this.bindLogin=t.data.bindLogin,this.captchaLogin=t.data.captchaLogin}.bind(this),null,!1),MWF.Actions.get("x_organization_assemble_personal").getRegisterMode(function(t){this.signUpMode=t.data.value}.bind(this),null,!1),this.bindLogin&&(this.bindLoginTipPic=new Element("div.bindLoginTipPic",{styles:this.css.bindLoginTipPic}).inject(this.formContentNode,"top"),this.bindLoginAction=new Element("div.bindLoginAction",{styles:this.css.bindLoginAction}).inject(this.formContentNode,"top"),this.bindLoginAction.addEvent("click",function(){this.showBindCodeLogin()}.bind(this)),this.backtoPasswordLoginTipPic=new Element("div.backtoPasswordLoginTipPic",{styles:this.css.backtoPasswordLoginTipPic}).inject(this.formContentNode,"top"),this.backtoPasswordLoginAction=new Element("div.backtoPasswordLoginAction",{styles:this.css.backtoPasswordLoginAction}).inject(this.formContentNode,"top"),this.backtoPasswordLoginAction.addEvent("click",function(){this.backtoPasswordLogin()}.bind(this)));var t="<table width='100%' bordr='0' cellpadding='0' cellspacing='0' styles='formTable'><tr><div><div item='passwordAction'>";if(this.codeLogin&&(t+="</div><div styles='titleSep'></div><div item='codeAction'></div></tr>"),t+="</table>",t+="<table width='100%' bordr='0' cellpadding='0' cellspacing='0' styles='formTable'><tr item='credentialTr'><td styles='formTableValueTop20' item='credential'></td></tr><tr item='passwordTr'><td styles='formTableValueTop20' item='password'></td></tr>",this.captchaLogin&&(t+="<tr item='captchaTr'><td styles='formTableValueTop20'><div item='captchaAnswer' style='float:left;'></div><div item='captchaPic' style='float:left;'></div><div item='changeCaptchaAction' style='float:left;'></div></td></tr>"),this.codeLogin&&(t+="<tr item='codeTr' style='display: none'><td styles='formTableValueTop20'>   <div item='codeAnswer' style='float:left;'></div>   <div item='verificationAction' style='float:left;'></div>   <div item='resendVerificationAction' style='float:left;display:none;'></div></td></tr>"),t+="<tr><td styles='formTableValueTop20' item='loginAction'></td></tr></table><table width='100%' bordr='0' cellpadding='0' cellspacing='0' styles='formTable'>",this.signUpMode&&"disable"!==this.signUpMode?t+="<tr><td><div item='signUpAction'></div><div item='forgetPassword'></div></td></tr>":t+="<tr><td><div styles='signUpAction'></div><div item='forgetPassword'></div></td></tr>",t+="<tr><td  styles='formTableValue' item='errorArea'></td></tr><tr><td  styles='formTableValue' item='oauthArea'></td></tr></table>",this.formTableArea.set("html",t),new Element("div",{styles:this.css.formFooter,text:layout.config.footer||layout.config.systemName}).inject(this.formTableArea,"after"),this.captchaLogin&&this.setCaptchaPic(),this.errorArea=this.formTableArea.getElement("[item=errorArea]"),this.oauthArea=this.formTableArea.getElement("[item=oauthArea]"),MWF.xDesktop.requireApp("Template","MForm",function(){this.form=new MForm(this.formTableArea,this.data,{style:this.options.popupStyle,verifyType:"single",isEdited:this.isEdited||this.isNew,itemTemplate:{credential:{text:this.lp.userName,defaultValue:this.lp.userName,className:"inputUser",notEmpty:!0,defaultValueAsEmpty:!0,emptyTip:this.lp.inputYourUserName,event:{focus:function(t){this.lp.userName===t.getValue()&&t.setValue(""),t.warningStatus||t.getElements()[0].setStyles(this.css.inputActive)}.bind(this),blur:function(t){""===t.getValue()&&t.setValue(this.lp.userName),t.warningStatus||t.getElements()[0].setStyles(this.css.inputUser)}.bind(this),keyup:function(t,e){13===e.event.keyCode&&this.ok()}.bind(this)},onEmpty:function(t){t.getElements()[0].setStyles(this.css.inputEmpty)}.bind(this),onUnempty:function(t){t.getElements()[0].setStyles(this.css.inputUser)}.bind(this)},password:{text:this.lp.password,type:"password",defaultValue:"password",className:"inputPassword",notEmpty:!0,defaultValueAsEmpty:!0,emptyTip:this.lp.inputYourPassword,event:{focus:function(t){"password"===t.getValue()&&t.setValue(""),t.warningStatus||t.getElements()[0].setStyles(this.css.inputActive)}.bind(this),blur:function(t){t.warningStatus||t.getElements()[0].setStyles(this.css.inputPassword)}.bind(this),keyup:function(t,e){13===e.event.keyCode&&this.ok()}.bind(this)},onEmpty:function(t){t.getElements()[0].setStyles(this.css.inputEmpty)}.bind(this),onUnempty:function(t){t.getElements()[0].setStyles(this.css.inputPassword)}.bind(this)},captchaAnswer:{tType:"number",text:this.lp.verificationCode,defaultValue:this.lp.verificationCode,className:"inputVerificationCode",notEmpty:!0,defaultValueAsEmpty:!0,emptyTip:this.lp.inputPicVerificationCode,event:{focus:function(t){this.lp.verificationCode===t.getValue()&&t.setValue(""),t.warningStatus||t.getElements()[0].setStyles(this.css.inputActive)}.bind(this),blur:function(t){""===t.getValue()&&t.setValue(this.lp.verificationCode),t.warningStatus||t.getElements()[0].setStyles(this.css.inputVerificationCode)}.bind(this),keyup:function(t,e){13===e.event.keyCode&&this.ok()}.bind(this)},onEmpty:function(t){t.getElements()[0].setStyles(this.css.inputEmpty)}.bind(this),onUnempty:function(t){t.getElements()[0].setStyles(this.css.inputVerificationCode)}.bind(this)},changeCaptchaAction:{value:this.lp.changeVerification,type:"innerText",className:"verificationChange",event:{click:function(){this.setCaptchaPic()}.bind(this)}},codeAnswer:{text:this.lp.verificationCode,defaultValue:this.lp.inputVerificationCode,className:"inputVerificationCode2",notEmpty:!0,defaultValueAsEmpty:!0,emptyTip:this.lp.inputVerificationCode,event:{focus:function(t){this.lp.inputVerificationCode===t.getValue()&&t.setValue(""),t.warningStatus||t.getElements()[0].setStyles(this.css.inputActive)}.bind(this),blur:function(t){""===t.getValue()&&t.setValue(this.lp.inputVerificationCode),t.warningStatus||t.getElements()[0].setStyles(this.css.inputVerificationCode2)}.bind(this),keyup:function(t,e){13===e.event.keyCode&&this.ok()}.bind(this)},onEmpty:function(t){t.getElements()[0].setStyles(this.css.inputEmpty)}.bind(this),onUnempty:function(t){t.getElements()[0].setStyles(this.css.inputVerificationCode2)}.bind(this)},verificationAction:{value:this.lp.sendVerification,type:"button",className:"inputSendVerification",event:{click:function(){this.sendVerificationAction()}.bind(this)}},resendVerificationAction:{value:this.lp.resendVerification,type:"button",className:"inputResendVerification"},loginAction:{value:this.lp.loginAction,type:"button",className:"inputLogin",event:{click:function(){this.ok()}.bind(this)}},passwordAction:{value:this.lp.passwordLogin,type:"innerText",className:"titleNode_active",event:{click:function(){this.codeLogin&&this.showPasswordLogin()}.bind(this)}},codeAction:{value:this.lp.codeLogin,type:"innerText",className:"titleNode_normal",event:{click:function(){this.showCodeLogin()}.bind(this)}},signUpAction:{value:this.lp.signUp,type:"innerText",className:"signUpAction",event:{click:function(){this.gotoSignup()}.bind(this)}},forgetPassword:{value:this.lp.forgetPassword,type:"innerText",className:"forgetPassword",event:{click:function(){this.gotoResetPassword()}.bind(this)}}}},this.app,this.css),this.form.load()}.bind(this),!0),this.bindLogin){this.bindLoginContainer=new Element("div",{styles:this.css.bindLoginContainer}).inject(this.formContentNode);var e="<div item='bindLoginTitle' styles='bindTitleNode'></div><div styles='bindBodyArea'><div item='bindPicArea' styles='bindPicArea'></div><div styles='bindSepArea'></div><div styles='bindExampleArea'></div></div><div styles='bindTipArea'>   <div styles='bindTipIconArea'></div>   <div styles='bindTipTextArea'>       "+this.lp.userAppCameraHtml+"       <div>"+this.lp.loginToPage+"</div></div>";this.bindLoginContainer.set("html",e),this.isShowEnable=!0,this.bindBodyArea=this.bindLoginContainer.getElement("[styles='bindBodyArea']"),this.bindLoginContainer.addEvent("mousemove",function(t){this.bindBodyArea.isOutside(t)?this.hideExampleArea(t):this.showExampleArea(t)}.bind(this)),this.bindPicArea=this.bindLoginContainer.getElement("[item='bindPicArea']"),this.setBindPic(),this.bindExampleArea=this.bindLoginContainer.getElement("[styles='bindExampleArea']"),this.bindSepArea=this.bindLoginContainer.getElement("[styles='bindSepArea']"),this.bindLoginContainer.getElement("[styles='bindTipLinkArea']").addEvent("click",function(){layout.config.appUrl?window.open(layout.config.appUrl,"_blank"):window.open(this.lp.o2downloadLink,"_blank")}.bind(this)),MWF.xDesktop.requireApp("Template","MForm",function(){this.bindform=new MForm(this.bindLoginContainer,{},{style:"o2platform",verifyType:"single",isEdited:this.isEdited||this.isNew,itemTemplate:{bindLoginTitle:{value:this.lp.bingLoginTitle,type:"innerText"}}},this.app,this.css),this.bindform.load()}.bind(this),!0)}this.loadOauthContent()},_beforeFormNodeSize:function(){!this.isPlusOauthSize&&this.oauthListNode&&(this.options.height=parseInt(this.options.height)+this.oauthArea.getSize().y,this.isPlusOauthSize=!0),(this.oauthListNode||!this.captchaLogin&&!this.bindLogin)&&(this.options.height=this.options.height-60),this.oauthListNode&&this.captchaLogin&&(this.options.height=this.options.height+60)},loadOauthContent:function(){this.actions.listOauthServer(function(t){this.oauthList=t.data||[],this.oauthList.length>0&&(this.oauthArea.getChildren().length||(this.oauthListNode=new Element("div",{styles:this.css.oauthListNode}).inject(this.oauthArea)),this.oauthList.each(function(t){"@O2企业微信"===t.displayName?t.qywx=!0:"@O2钉钉"===t.displayName&&(t.dingding=!0),this.loadOauthItem(t)}.bind(this)))}.bind(this),null,!1)},loadOauthItem:function(t){var e=0==t.icon.indexOf("http")?t.icon:"data:image/png;base64,"+t.icon,i=new Element("div",{styles:this.css.oauthItemNode,events:{click:function(){var t="../x_desktop/oauth.html?oauth="+encodeURIComponent(this.name);this.qywx&&(t+="&qywx="+this.qywx),this.dingding&&(t+="&dingding="+this.dingding),window.location=t}.bind(t)}}).inject(this.oauthListNode);new Element("img",{styles:this.css.oauthItemIconNode,src:e}).inject(i),new Element("div",{styles:this.css.oauthItemTextNode,text:t.name}).inject(i)},showExampleArea:function(){if(!this.isHiddingExample&&!this.isShowingExample&&this.isShowEnable){this.isShowingExample=!0;var t=this.bindBodyArea.getPosition(this.bindBodyArea.getParent()).x,e=(this.bindBodyArea.getParent().getSize().x-400)/2;this.intervalId=setInterval(function(){t>e?(this.bindBodyArea.setStyle("margin-left",t-5+"px"),t-=5):(clearInterval(this.intervalId),this.bindBodyArea.setStyle("width","400px"),this.bindSepArea.setStyle("display",""),this.bindExampleArea.setStyle("display",""),this.isHidEnable=!0,this.isShowEnable=!1,this.isShowingExample=!1)}.bind(this),10)}},hideExampleArea:function(){if(!this.isShowingExample&&!this.isHiddingExample&&this.isHidEnable){this.isHiddingExample=!0;var t=this.bindBodyArea.getPosition(this.bindBodyArea.getParent()).x;this.bindSepArea.setStyle("display","none"),this.bindExampleArea.setStyle("display","none");var e=(this.bindBodyArea.getParent().getSize().x-200)/2;this.intervalId2=setInterval(function(){t<e?(this.bindBodyArea.setStyle("margin-left",t+5+"px"),t+=5):(clearInterval(this.intervalId2),this.bindBodyArea.setStyle("width","204px"),this.isHidEnable=!1,this.isShowEnable=!0,this.isHiddingExample=!1)}.bind(this),10)}},showPasswordLogin:function(){this.errorArea.empty(),this.loginType="captcha",this.form.getItem("passwordAction").setStyles(this.css.titleNode_active),this.form.getItem("codeAction").setStyles(this.css.titleNode_normal),this.formTableArea.getElement("[item='passwordTr']").setStyle("display","");var t=this.formTableArea.getElement("[item='captchaTr']");t&&t.setStyle("display",""),this.formTableArea.getElement("[item='codeTr']").setStyle("display","none")},showCodeLogin:function(){this.errorArea.empty(),this.loginType="code",this.form.getItem("passwordAction").setStyles(this.css.titleNode_normal),this.form.getItem("codeAction").setStyles(this.css.titleNode_active),this.formTableArea.getElement("[item='passwordTr']").setStyle("display","none");var t=this.formTableArea.getElement("[item='captchaTr']");t&&t.setStyle("display","none"),this.formTableArea.getElement("[item='codeTr']").setStyle("display","")},showBindCodeLogin:function(){this.errorArea.empty(),this.formTableContainer.setStyle("display","none"),this.bindLoginContainer.setStyle("display",""),this.bindLoginTipPic.setStyle("display","none"),this.bindLoginAction.setStyle("display","none"),this.backtoPasswordLoginTipPic.setStyle("display",""),this.backtoPasswordLoginAction.setStyle("display",""),this.checkBindStatus()},backtoPasswordLogin:function(){this.errorArea.empty(),this.bindStatusInterval&&clearInterval(this.bindStatusInterval),this.formTableContainer.setStyle("display",""),this.bindLoginContainer.setStyle("display","none"),this.bindLoginTipPic.setStyle("display",""),this.bindLoginAction.setStyle("display",""),this.backtoPasswordLoginTipPic.setStyle("display","none"),this.backtoPasswordLoginAction.setStyle("display","none")},setBindPic:function(){this.bindPicArea.empty(),this.actions.getLoginBind(function(t){this.bindMeta=t.data.meta,new Element("img",{src:"data:image/png;base64,"+t.data.image}).inject(this.bindPicArea)}.bind(this))},setCaptchaPic:function(){if(this.captchaLogin){var t=this.formTableArea.getElement("[item='captchaPic']");t.empty(),this.actions.getLoginCaptcha(120,50,function(e){this.captcha=e.data.id,new Element("img",{src:"data:image/png;base64,"+e.data.image,styles:this.css.verificationImage}).inject(t)}.bind(this))}},sendVerificationAction:function(){var t=!0,e=this.form.getItem("credential"),i=e.getValue();i&&""!==i.trim()?(this.actions.checkCredential(i,function(i){i.data.value||(t=!1,e.setWarning(this.lp.userNotExist,"invalid"))}.bind(this),function(i){t=!1;var s=JSON.parse(i.responseText);e.setWarning(s.message,"invalid")}.bind(this),!1),t&&(e.clearWarning("invalid"),this.actions.createCredentialCode(i,(function(t){}),function(e){var i=JSON.parse(e.responseText);this.setWarning(i.message),t=!1}.bind(this)),t&&(this.errorArea.empty(),this.form.getItem("verificationAction").container.setStyle("display","none"),this.setResendVerification()))):e.setWarning(this.lp.inputYourUserName,"empty")},setResendVerification:function(){var t=this.form.getItem("resendVerificationAction");t.container.setStyle("display",""),this.resendElement=t.getElements()[0],this.resendElement.set("text",this.lp.resendVerification+"(60)");var e=60;this.timer=setInterval(function(){e>0?this.resendElement.set("text",this.lp.resendVerification+"("+--e+")"):(this.form.getItem("verificationAction").container.setStyle("display",""),t.container.setStyle("display","none"),clearInterval(this.timer))}.bind(this),1e3)},gotoSignup:function(){this.explorer.openSignUpForm(),this.close()},gotoResetPassword:function(){this.explorer.openResetPasswordForm(),this.close()},gotoChangePassword:function(t){this.explorer.openChangePasswordForm(t,function(){this.explorer.loadLogin()}.bind(this)),this.close()},checkBindStatus:function(){this.bindStatusInterval=setInterval(function(){this.actions.checkBindStatus(this.bindMeta,function(t){t.data&&t.data.name&&"anonymous"!==t.data.name&&(this.fireEvent("queryOk"),this._close(),this.formMaskNode&&this.formMaskNode.destroy(),this.formAreaNode.destroy(),this.explorer&&this.explorer.view&&this.explorer.view.reload(),this.app&&this.app.notice(this.lp.loginSuccess,"success"),this.fireEvent("postOk",t))}.bind(this),function(t){}.bind(this))}.bind(this),3e3)},_close:function(){this.bindStatusInterval&&clearInterval(this.bindStatusInterval),this.timer&&clearInterval(this.timer)},ok:function(){this.fireEvent("queryOk"),this.errorArea.empty();var t=null,e=null;"captcha"===this.loginType?(this.form.getItem("password").options.notEmpty=!0,this.captchaLogin&&(t=this.form.getItem("captchaAnswer"))&&(t.options.notEmpty=!0),(e=this.form.getItem("codeAnswer"))&&(e.options.notEmpty=!1)):"code"===this.loginType&&(this.form.getItem("password").options.notEmpty=!1,this.captchaLogin&&(t=this.form.getItem("captchaAnswer"))&&(t.options.notEmpty=!1),(e=this.form.getItem("codeAnswer"))&&(e.options.notEmpty=!0));var i=this.form.getResult(!0,",",!0,!1,!0);i&&this._ok(i,function(t){if("error"===t.type)this.app&&this.app.notice(t.message,"error");else if(t.data.passwordExpired){var e=t.data.distinguishedName;this.explorer.logout(function(){this.gotoChangePassword({userName:e})}.bind(this))}else this._close(),this.formMaskNode&&this.formMaskNode.destroy(),this.formAreaNode.destroy(),this.explorer&&this.explorer.view&&this.explorer.view.reload(),this.app&&this.app.notice(this.lp.loginSuccess,"success"),this.fireEvent("postOk",t)}.bind(this))},setWarning:function(t){this.errorArea.empty(),new Element("div",{text:t,styles:this.css.warningMessageNode}).inject(this.errorArea)},_ok:function(t,e){var i=null;"captcha"===this.loginType?(i={credential:t.credential,password:t.password},this.captchaLogin&&(i.captchaAnswer=t.captchaAnswer,i.captcha=this.captcha),this.actions.loginByCaptcha(i,function(t){e&&e(t)}.bind(this),function(t){var e=JSON.parse(t.responseText);this.setWarning(e.message),this.setCaptchaPic(),this.form.getItem("captchaAnswer")&&this.form.getItem("captchaAnswer").setValue("")}.bind(this))):"code"===this.loginType&&(i={credential:t.credential,codeAnswer:t.codeAnswer},this.actions.loginByCode(i,function(t){e&&e(t)}.bind(this),function(t){var e=JSON.parse(t.responseText);this.setWarning(e.message)}.bind(this)))}}),MWF.xDesktop.Authentication.SignUpForm=new Class({Extends:MPopupForm,Implements:[Options,Events],options:{style:"default",popupStyle:"o2platformSignup",width:"910",height:"740",hasTop:!0,hasIcon:!1,hasTopIcon:!0,hasTopContent:!0,hasBottom:!1,title:"",draggable:!0,closeAction:!0},load:function(){this.options.title||this.setOptions({title:MWF.LP.authentication.SignUpFormTitle}),this._loadCss()},_createTableContent:function(){var t=this;this.actions=MWF.Actions.get("x_organization_assemble_personal");var e="code";this.actions.getRegisterMode(function(t){e=t.data.value}.bind(this),null,!1),this.formTopNode.setStyle("height","50px"),this.formTableContainer.setStyles({width:"890px","margin-top":"40px"});var i="<table width='100%' bordr='0' cellpadding='5' cellspacing='0' styles='formTable'><tr><td styles='formTableTitle' lable='name' width='200'></td>   <td styles='formTableValue' item='name' width='350'></td>   <td styles='formTableValue' item='nameTip'></td></tr><tr><td styles='formTableTitle' lable='password'></td>   <td styles='formTableValue' item='password'></td>   <td styles='formTableValue'><div item='passwordStrengthArea'></div></div><div item='passwordTip'></div></td></tr><tr><td styles='formTableTitle' lable='confirmPassword'></td>   <td styles='formTableValue' item='confirmPassword'></td>   <td styles='formTableValue' item='confirmPasswordTip'></td></tr><tr><td styles='formTableTitle' lable='genderType'></td>   <td styles='formTableValue' item='genderType'></td>   <td styles='formTableValue' item='genderTypeTip'></td></tr><tr><td styles='formTableTitle' lable='mail'></td>   <td styles='formTableValue' item='mail'></td>   <td styles='formTableValue' item='mailTip'></td></tr><tr><td styles='formTableTitle' lable='mobile'></td>   <td styles='formTableValue' item='mobile'></td>   <td styles='formTableValue' item='mobileTip'></td></tr>";i+="code"===e?"<tr><td styles='formTableTitle' lable='codeAnswer'></td>   <td styles='formTableValue'><div item='codeAnswer' style='float:left;'></div><div item='verificationAction' style='float:left;'></div><div item='resendVerificationAction' style='float:left;display:none;'></div></td>   <td styles='formTableValue' item='verificationCodeTip'></td></tr>":"<tr><td styles='formTableTitle' lable='captchaAnswer'></td>   <td styles='formTableValue'><div item='captchaAnswer' style='float:left;'></div><div item='captchaPic' style='float:left;'></div><div item='changeCaptchaAction' style='float:left;'></div></td>   <td styles='formTableValue' item='captchaAnswerTip'></td></tr>",i+="<tr><td styles='formTableTitle'></td>   <td styles='formTableValue' item='signUpAction'></td>   <td styles='formTableValue' item='signUpTip'></td></tr><tr><td></td>   <td><div item='hasAccountArea'></div><div item='gotoLoginAction'></div></td>   <td></td></tr></table>",this.formTableArea.set("html",i),"captcha"===e&&this.setCaptchaPic(),MWF.xDesktop.requireApp("Template","MForm",function(){this.form=new MForm(this.formTableArea,this.data,{style:this.options.popupStyle,verifyType:"batchSingle",isEdited:this.isEdited||this.isNew,onPostLoad:function(){var t=this.form,e=this.formTableArea;t.getItem("name").tipNode=e.getElement("[item='nameTip']"),t.getItem("password").tipNode=e.getElement("[item='passwordTip']"),t.getItem("confirmPassword").tipNode=e.getElement("[item='confirmPasswordTip']"),t.getItem("mail").tipNode=e.getElement("[item='mailTip']"),t.getItem("genderType").tipNode=e.getElement("[item='genderTypeTip']"),t.getItem("mobile").tipNode=e.getElement("[item='mobileTip']"),this.tipNode=e.getElement("[item='signUpTip']"),t.getItem("captchaAnswer")&&(t.getItem("captchaAnswer").tipNode=e.getElement("[item='captchaAnswerTip']")),t.getItem("codeAnswer")&&(t.getItem("codeAnswer").tipNode=e.getElement("[item='verificationCodeTip']"))}.bind(this),itemTemplate:{name:{text:this.lp.userName,defaultValue:this.lp.userName,className:"inputUser",notEmpty:!0,defaultValueAsEmpty:!0,emptyTip:this.lp.inputYourUserName,validRule:{isInvalid:function(t,e){return this.checkUserName(t,e)}.bind(this)},validMessage:{isInvalid:this.lp.userExist},event:{focus:function(t){this.lp.userName===t.getValue()&&t.setValue(""),t.warningStatus||t.getElements()[0].setStyles(this.css.inputActive)}.bind(this),keyup:function(t,e){13===e.event.keyCode&&this.ok()}.bind(this),blur:function(t){t.verify(!0)&&(t.warningStatus||t.getElements()[0].setStyles(this.css.inputUser))}.bind(this)},onEmpty:function(t){t.getElements()[0].setStyles(this.css.inputEmpty)}.bind(this),onUnempty:function(t){t.getElements()[0].setStyles(this.css.inputUser)}.bind(this)},password:{text:this.lp.password,type:"password",className:"inputPassword",notEmpty:!0,defaultValueAsEmpty:!0,emptyTip:this.lp.inputYourPassword,validRule:{passwordIsWeak:function(t,e){return!this.getPasswordRule(e.getValue())}.bind(this)},validMessage:{passwordIsWeak:function(){return t.getPasswordRule(this.getValue())}},event:{focus:function(t){"password"===t.getValue()&&t.setValue(""),t.warningStatus||t.getElements()[0].setStyles(this.css.inputActive)}.bind(this),blur:function(t){t.verify(!0)}.bind(this)},onEmpty:function(t){t.getElements()[0].setStyles(this.css.inputEmpty)}.bind(this),onUnempty:function(t){t.getElements()[0].setStyles(this.css.inputPassword)}.bind(this)},confirmPassword:{text:this.lp.confirmPassword,type:"password",className:"inputComfirmPassword",notEmpty:!0,defaultValueAsEmpty:!0,emptyTip:this.lp.inputComfirmPassword,validRule:{passwordNotEqual:function(t,e){if(e.getValue()===this.form.getItem("password").getValue())return!0}.bind(this)},validMessage:{passwordNotEqual:this.lp.passwordNotEqual},event:{focus:function(t){"password"===t.getValue()&&t.setValue(""),t.warningStatus||t.getElements()[0].setStyles(this.css.inputActive)}.bind(this),keyup:function(t,e){13===e.event.keyCode&&this.ok()}.bind(this),blur:function(t){t.verify(!0)&&(t.warningStatus||t.getElements()[0].setStyles(this.css.inputComfirmPassword))}.bind(this)},onEmpty:function(t){t.getElements()[0].setStyles(this.css.inputEmpty)}.bind(this),onUnempty:function(t){t.getElements()[0].setStyles(this.css.inputComfirmPassword)}.bind(this)},mail:{text:this.lp.mail,defaultValue:this.lp.inputYourMail,className:"inputMail",notEmpty:!1,defaultValueAsEmpty:!0,emptyTip:this.lp.inputYourMail,validRule:{isFormatInvalid:function(t,e){return!t||t===this.lp.inputYourMail||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(t)?(e.tipNode.empty(),e.warningStatus=!1,!0):(e.warningStatus=!0,!1)}.bind(this)},validMessage:{isFormatInvalid:this.lp.mailFormatError},event:{focus:function(t){this.lp.inputYourMail===t.getValue()&&t.setValue(""),t.warningStatus||t.getElements()[0].setStyles(this.css.inputActive)}.bind(this),blur:function(t){t.verify(!0),t.warningStatus||t.getElements()[0].setStyles(this.css.inputMail)}.bind(this),keyup:function(t,e){13===e.event.keyCode&&this.ok()}.bind(this)},onEmpty:function(t){}.bind(this),onUnempty:function(t){}.bind(this)},genderType:{text:this.lp.genderType,className:"inputGenderType",type:"select",selectValue:this.lp.genderTypeValue.split(","),selectText:this.lp.genderTypeText.split(","),notEmpty:!0,emptyTip:this.lp.selectGenderType,event:{focus:function(t){t.warningStatus||t.getElements()[0].setStyles(this.css.inputActive)}.bind(this),blur:function(t){t.verify(!0),t.warningStatus||t.getElements()[0].setStyles(this.css.inputGenderType)}.bind(this),keyup:function(t,e){13===e.event.keyCode&&this.ok()}.bind(this)},onEmpty:function(t){t.getElements()[0].setStyles(this.css.inputEmpty)}.bind(this),onUnempty:function(t){t.getElements()[0].setStyles(this.css.inputGenderType)}.bind(this)},mobile:{text:this.lp.mobile,defaultValue:this.lp.inputYourMobile,className:"inputMobile",tType:"number",notEmpty:!0,defaultValueAsEmpty:!0,emptyTip:this.lp.inputYourMobile,validRule:{isInvalid:function(t,e){return this.checkMobile(t,e)}.bind(this)},validMessage:{isInvalid:this.lp.mobileIsRegisted},event:{focus:function(t){this.lp.inputYourMobile===t.getValue()&&t.setValue(""),t.warningStatus||t.getElements()[0].setStyles(this.css.inputActive)}.bind(this),keyup:function(t,e){13===e.event.keyCode&&this.ok()}.bind(this),blur:function(t){t.verify(!0)&&(t.warningStatus||t.getElements()[0].setStyles(this.css.inputMobile))}.bind(this)},onEmpty:function(t){t.getElements()[0].setStyles(this.css.inputEmpty)}.bind(this),onUnempty:function(t){t.getElements()[0].setStyles(this.css.inputMobile)}.bind(this)},captchaAnswer:{tType:"number",text:this.lp.verificationCode,defaultValue:this.lp.verificationCode,className:"inputVerificationCode",notEmpty:!0,defaultValueAsEmpty:!0,emptyTip:this.lp.inputPicVerificationCode,event:{focus:function(t){this.lp.verificationCode===t.getValue()&&t.setValue(""),t.warningStatus||t.getElements()[0].setStyles(this.css.inputActive)}.bind(this),blur:function(t){t.verify(!0),t.warningStatus||t.getElements()[0].setStyles(this.css.inputVerificationCode)}.bind(this),keyup:function(t,e){13===e.event.keyCode&&this.ok()}.bind(this)},onEmpty:function(t){t.getElements()[0].setStyles(this.css.inputEmpty)}.bind(this),onUnempty:function(t){t.getElements()[0].setStyles(this.css.inputVerificationCode)}.bind(this)},changeCaptchaAction:{value:this.lp.changeVerification,type:"innerText",className:"verificationChange",event:{click:function(){this.setCaptchaPic()}.bind(this)}},codeAnswer:{text:this.lp.verificationCode,defaultValue:this.lp.inputVerificationCode,className:"inputVerificationCode2",notEmpty:!0,defaultValueAsEmpty:!0,emptyTip:this.lp.inputVerificationCode,event:{focus:function(t){this.lp.inputVerificationCode===t.getValue()&&t.setValue(""),t.warningStatus||t.getElements()[0].setStyles(this.css.inputActive)}.bind(this),blur:function(t){t.verify(!0),t.warningStatus||t.getElements()[0].setStyles(this.css.inputVerificationCode2)}.bind(this),keyup:function(t,e){13===e.event.keyCode&&this.ok()}.bind(this)},onEmpty:function(t){t.getElements()[0].setStyles(this.css.inputEmpty)}.bind(this),onUnempty:function(t){t.getElements()[0].setStyles(this.css.inputVerificationCode2)}.bind(this)},verificationAction:{value:this.lp.sendVerification,type:"button",className:"inputSendVerification",event:{click:function(){this.sendVerificationAction()}.bind(this)}},resendVerificationAction:{value:this.lp.resendVerification,type:"button",className:"inputResendVerification"},signUpAction:{value:this.lp.signUp,type:"button",className:"inputSignUp",event:{click:function(){this.ok()}.bind(this)}},hasAccountArea:{value:this.lp.hasAccount,type:"innerText",className:"hasCountArea"},gotoLoginAction:{value:this.lp.gotoLogin,type:"innerText",className:"gotoLoginAction",event:{click:function(){this.gotoLogin()}.bind(this)}}}},this.app,this.css),this.form.load()}.bind(this),!0)},checkMobile:function(t,e){var i=!0;return this.actions.checkRegisterMobile(t,function(){i=!0}.bind(this),function(t){if(404===t.status)e.options.validMessage.isInvalid=this.lp.pageNotFound,i=!1;else{var s=JSON.parse(t.responseText);e.options.validMessage.isInvalid=s.message,i=!1}}.bind(this),!1),i},checkUserName:function(t,e){var i=!0;return this.actions.checkRegisterName(t,function(){i=!0}.bind(this),function(t){if(404===t.status)e.options.validMessage.isInvalid=this.lp.pageNotFound,i=!1;else{var s=JSON.parse(t.responseText);e.options.validMessage.isInvalid=s.message,i=!1}}.bind(this),!1),i},setCaptchaPic:function(){var t=this.formTableArea.getElement("[item='captchaPic']");t.empty(),this.actions.getRegisterCaptcha(120,50,function(e){this.captcha=e.data.id,new Element("img",{src:"data:image/png;base64,"+e.data.image,styles:this.css.verificationImage}).inject(t)}.bind(this))},sendVerificationAction:function(){var t=!0,e=this.form.getItem("mobile");if(e.verify(!0)){if(e.clearWarning(),e.getElements()[0].setStyles(this.css.inputMobile),this.actions.createRegisterCode(e.getValue(),(function(t){}),function(e){var i=this.form.getItem("codeAnswer"),s=JSON.parse(e.responseText);404===e.status?(i.setWarning(s.message,this.lp.pageNotFound),t=!1):(i.setWarning(s.message,"invalid"),t=!1)}.bind(this),!1),!t)return!1;this.form.getItem("verificationAction").container.setStyle("display","none"),this.setResendVerification()}},setResendVerification:function(){var t=this.form.getItem("resendVerificationAction");t.container.setStyle("display",""),this.resendElement=t.getElements()[0],this.resendElement.set("text",this.lp.resendVerification+"(60)");var e=60;this.timer=setInterval(function(){e>0?this.resendElement.set("text",this.lp.resendVerification+"("+--e+")"):(this.form.getItem("verificationAction").container.setStyle("display",""),t.container.setStyle("display","none"),clearInterval(this.timer))}.bind(this),1e3)},getPasswordRule:function(t){var e="";return this.actions.checkRegisterPassword(t,function(t){e=t.data.value||""}.bind(this),null,!1),e},gotoLogin:function(){this.explorer.openLoginForm({},(function(){window.location.reload()})),this.close()},setWarning:function(t){this.tipNode.empty(),new Element("div",{text:t,styles:this.css.warningMessageNode}).inject(this.tipNode)},setNotice:function(t){this.tipNode.empty(),new Element("div",{text:t,styles:this.css.noticeMessageNode}).inject(this.tipNode)},ok:function(){this.tipNode.empty(),this.fireEvent("queryOk");var t=this.form.getResult(!0,",",!0,!1,!0);t&&this._ok(t,function(t){"error"===t.type?this.app&&this.app.notice(t.message,"error"):(this.formMaskNode&&this.formMaskNode.destroy(),this.formAreaNode.destroy(),this.setNotice(this.lp.registeSuccess),this.app&&this.app.notice(this.lp.registeSuccess,"success"),this.fireEvent("postOk",t),this.gotoLogin())}.bind(this))},_ok:function(t,e){t.captcha=this.captcha,this.actions.register(t,function(t){e&&e(t)}.bind(this),function(t){if(404===t.status)this.setWarning(this.lp.pageNotFound);else{var e=JSON.parse(t.responseText);this.setWarning(e.message)}}.bind(this))}}),MWF.xDesktop.Authentication.ResetPasswordForm=new Class({Extends:MPopupForm,Implements:[Options,Events],options:{style:"default",popupStyle:"o2platformSignup",width:"710",height:"450",hasTop:!0,hasIcon:!1,hasTopIcon:!0,hasTopContent:!0,hasBottom:!1,title:"",draggable:!0,closeAction:!0},load:function(){this.options.title||this.setOptions({title:MWF.LP.authentication.ResetPasswordFormTitle}),this._loadCss()},_createTopContent:function(){this.actions=MWF.Actions.get("x_organization_assemble_personal"),this.actions.getRegisterMode(function(t){this.signUpMode=t.data.value}.bind(this),null,!1),this.signUpMode&&"disable"!==this.signUpMode&&(this.gotoSignupNode=new Element("div",{styles:this.css.formTopContentCustomNode,text:this.lp.signUp}).inject(this.formTopContentNode),this.gotoSignupNode.addEvent("click",function(){this.gotoSignup()}.bind(this)),new Element("div",{styles:this.css.formTopContentSepNode}).inject(this.formTopContentNode)),this.gotoLoginNode=new Element("div",{styles:this.css.formTopContentCustomNode,text:this.lp.loginAction}).inject(this.formTopContentNode),this.gotoLoginNode.addEvent("click",function(){this.gotoLogin()}.bind(this))},_createTableContent:function(){this.formTableContainer.setStyles(this.css.formTableContainer2),this.loadSteps(),this.loadStepForm_1(),this.loadStepForm_2(),this.loadStepForm_3()},reset:function(){this.formTableArea.empty(),this._createTableContent()},loadSteps:function(){var t=new Element("div",{styles:this.css.stepsContainer}).inject(this.formTableArea);this.step_1=new Element("div",{styles:this.css.step_1_active,text:this.lp.shotMessageCheck}).inject(t),this.stepLink_1=new Element("div",{styles:this.css.stepLink_1}).inject(this.step_1),this.step_2=new Element("div",{styles:this.css.step_2,text:this.lp.setMewPassword}).inject(t),this.stepLink_2=new Element("div",{styles:this.css.stepLink_2}).inject(this.step_2),this.step_3=new Element("div",{styles:this.css.step_3,text:this.lp.completed}).inject(t)},loadStepForm_1:function(){this.stepNode_1=new Element("div",{html:"<table width='100%' bordr='0' cellpadding='5' cellspacing='0' styles='formTable'><tr><td styles='formTableTitle' lable='name' width='80'></td>   <td styles='formTableValue' item='name' width='350'></td></tr><tr><td styles='formTableTitle' lable='codeAnswer'></td>   <td styles='formTableValue'>       <div item='codeAnswer' style='float:left;'></div>       <div item='verificationAction' style='float:left;'></div>       <div item='resendVerificationAction' style='float:left;display:none;'></div></td>   </tr><tr><td styles='formTableTitle'></td>   <td styles='formTableValue' item='nextStep'></td></tr></table>",styles:{display:""}}).inject(this.formTableArea),MWF.xDesktop.requireApp("Template","MForm",function(){this.stepForm_1=new MForm(this.stepNode_1,{},{style:this.options.popupStyle,verifyType:"single",isEdited:this.isEdited||this.isNew,itemTemplate:{name:{text:this.lp.userName,defaultValue:this.lp.userName,className:"inputUser",notEmpty:!0,defaultValueAsEmpty:!0,emptyTip:this.lp.inputYourUserName,validRule:{isInvalid:function(t,e){return this.checkUserName(t,e)}.bind(this)},validMessage:{isInvalid:this.lp.userNotExist},event:{focus:function(t){this.lp.userName===t.getValue()&&t.setValue(""),t.warningStatus||t.getElements()[0].setStyles(this.css.inputActive)}.bind(this),blur:function(t){""===t.getValue()&&t.setValue(this.lp.userName),t.warningStatus||t.getElements()[0].setStyles(this.css.inputUser)}.bind(this),keyup:function(t,e){13===e.event.keyCode&&this.gotoStep(2)}.bind(this)},onEmpty:function(t){t.getElements()[0].setStyles(this.css.inputEmpty)}.bind(this),onUnempty:function(t){t.getElements()[0].setStyles(this.css.inputUser)}.bind(this)},codeAnswer:{text:this.lp.verificationCode,defaultValue:this.lp.inputVerificationCode,className:"inputVerificationCode2",notEmpty:!0,defaultValueAsEmpty:!0,emptyTip:this.lp.inputVerificationCode,event:{focus:function(t){this.lp.inputVerificationCode===t.getValue()&&t.setValue(""),t.warningStatus||t.getElements()[0].setStyles(this.css.inputActive)}.bind(this),blur:function(t){""===t.getValue()&&t.setValue(this.lp.inputVerificationCode),t.warningStatus||t.getElements()[0].setStyles(this.css.inputVerificationCode2)}.bind(this),keyup:function(t,e){13===e.event.keyCode&&this.gotoStep(2)}.bind(this)},onEmpty:function(t){t.getElements()[0].setStyles(this.css.inputEmpty)}.bind(this),onUnempty:function(t){t.getElements()[0].setStyles(this.css.inputVerificationCode2)}.bind(this)},verificationAction:{value:this.lp.sendVerification,type:"button",className:"inputSendVerification",event:{click:function(){this.sendVerificationAction()}.bind(this)}},resendVerificationAction:{value:this.lp.resendVerification,type:"button",className:"inputResendVerification"},nextStep:{value:this.lp.nextStep,type:"button",className:"inputSignUp",event:{click:function(){this.gotoStep(2)}.bind(this)}}}},this.app,this.css),this.stepForm_1.load()}.bind(this),!0)},loadStepForm_2:function(){var t=this;html="<table width='100%' bordr='0' cellpadding='5' cellspacing='0' styles='formTable'><tr><td styles='formTableTitle' lable='password' width='80'></td>   <td styles='formTableValue' item='password' width='350'></td>   <td styles='formTableValue'><div item='passwordStrengthArea'></div></td></tr><tr><td styles='formTableTitle' lable='confirmPassword'></td>   <td styles='formTableValue' item='confirmPassword'></td>   <td styles='formTableValue'></td></tr><tr><td styles='formTableTitle'></td>   <td styles='formTableValue' item='nextStep'></td>   <td styles='formTableValue'></td></tr></table>",this.stepNode_2=new Element("div",{html:html,styles:{display:"none"}}).inject(this.formTableArea),MWF.xDesktop.requireApp("Template","MForm",function(){this.stepForm_2=new MForm(this.stepNode_2,{},{style:this.options.popupStyle,verifyType:"single",isEdited:this.isEdited||this.isNew,itemTemplate:{password:{text:this.lp.setNewPassword,type:"password",className:"inputPassword",notEmpty:!0,defaultValueAsEmpty:!0,emptyTip:this.lp.inputYourPassword,attr:{placeholder:this.lp.inputYourPassword},validRule:{passwordIsWeak:function(t,e){return!this.getPasswordRule(e.getValue())}.bind(this)},validMessage:{passwordIsWeak:function(){return t.getPasswordRule(this.getValue())}},event:{focus:function(t){"password"===t.getValue()&&t.setValue(""),t.warningStatus||t.getElements()[0].setStyles(this.css.inputActive)}.bind(this),blur:function(t){t.verify(!0)}.bind(this)},onEmpty:function(t){t.getElements()[0].setStyles(this.css.inputEmpty)}.bind(this),onUnempty:function(t){t.getElements()[0].setStyles(this.css.inputPassword)}.bind(this)},confirmPassword:{text:this.lp.confirmNewPassword,type:"password",className:"inputComfirmPassword",notEmpty:!0,defaultValueAsEmpty:!0,emptyTip:this.lp.inputComfirmPassword,attr:{placeholder:this.lp.inputComfirmPassword},validRule:{passwordNotEqual:function(t,e){if(e.getValue()===this.stepForm_2.getItem("password").getValue())return!0}.bind(this)},validMessage:{passwordNotEqual:this.lp.passwordNotEqual},event:{focus:function(t){"password"===t.getValue()&&t.setValue(""),t.warningStatus||t.getElements()[0].setStyles(this.css.inputActive)}.bind(this),blur:function(t){t.warningStatus||t.getElements()[0].setStyles(this.css.inputComfirmPassword)}.bind(this),keyup:function(t,e){13===e.event.keyCode&&this.gotoStep(3)}.bind(this)},onEmpty:function(t){t.getElements()[0].setStyles(this.css.inputEmpty)}.bind(this),onUnempty:function(t){t.getElements()[0].setStyles(this.css.inputComfirmPassword)}.bind(this)},nextStep:{value:this.lp.nextStep,type:"button",className:"inputSignUp",event:{click:function(){this.gotoStep(3)}.bind(this)}}}},this.app,this.css),this.stepForm_2.load()}.bind(this),!0)},loadStepForm_3:function(){this.stepNode_3=new Element("div",{styles:this.css.stepFormResult}).inject(this.formTableArea)},createSetForm_3:function(t,e){var i=null;t?(this.stepNode_3.setStyles(this.css.stepFormResult),this.stepNode_3.setStyle("display",""),new Element("div",{styles:this.css.resetPasswordSuccess,text:this.lp.resetPasswordSuccess}).inject(this.stepNode_3),i=new Element("div",{styles:this.css.resetPasswordResultArea}).inject(this.stepNode_3),new Element("div",{styles:this.css.resetPasswordResultWord,text:this.lp.resetPasswordSuccessWord}).inject(i),new Element("div",{styles:this.css.resetPasswordResultAction,text:this.lp.gotoLogin}).inject(i).addEvent("click",function(){this.gotoLogin()}.bind(this))):(this.stepNode_3.setStyles(this.css.stepFormResult_fail),this.stepNode_3.setStyle("display",""),new Element("div",{styles:this.css.resetPasswordFail,text:e+this.lp.resetPasswordFail}).inject(this.stepNode_3),i=new Element("div",{styles:this.css.resetPasswordResultArea}).inject(this.stepNode_3),new Element("div",{styles:this.css.resetPasswordResultWord,text:this.lp.resetPasswordFailWord}).inject(i),new Element("div",{styles:this.css.resetPasswordResultAction,text:this.lp.backtoModify}).inject(i).addEvent("click",function(){this.reset()}.bind(this)))},gotoStep:function(t){var e=this["stepForm_"+(t-1)];if(e.clearWarning(),e.getResult(!0,",",!0,!1,!0)){var i;for(i=1;i<=t;i++)this["step_"+i].setStyles(this.css["step_"+i+"_active"]),i!==t&&this["stepLink_"+i]&&this["stepLink_"+i].setStyles(this.css["stepLink_"+i+"_active"]);for(i=t+1;i<=3;i++)this["step_"+i].setStyles(this.css["step_"+i]),3!==i&&this["stepLink_"+i].setStyles(this.css["stepLink_"+i]);for(i=1;i<=3;i++)i===t?this["stepNode_"+i].setStyle("display",""):this["stepNode_"+i].setStyle("display","none");if(3===t){var s={credential:this.stepForm_1.getItem("name").getValue(),codeAnswer:this.stepForm_1.getItem("codeAnswer").getValue(),password:this.stepForm_2.getItem("password").getValue()};this.actions.resetPassword(s,function(){this.createSetForm_3(!0)}.bind(this),function(t){var e=JSON.parse(t.responseText);this.createSetForm_3(!1,e.message)}.bind(this),!1)}}},checkMobile:function(t){var e=!0;return this.actions.checkRegisterMobile(t,function(){e=!0}.bind(this),function(){e=!1}.bind(this),!1),e},checkUserName:function(t,e){var i=!1;return this.actions.checkCredentialOnResetPassword(t,function(t){t.data&&(i=t.data.value)}.bind(this),function(t){if(404===t.status)e.options.validMessage.isInvalid=this.lp.pageNotFound,i=!1;else{var s=JSON.parse(t.responseText);e.options.validMessage.isInvalid=s.message,i=!1}}.bind(this),!1),i},sendVerificationAction:function(){var t=!0,e=this.stepForm_1.getItem("name");if(this.stepForm_1.clearWarning(),e.verify(!0)){if(this.actions.createCodeOnResetPassword(e.getValue(),(function(t){}),function(i){var s=JSON.parse(i.responseText);e.setWarning(s.message,"invalid"),t=!1}.bind(this),!1),!t)return!1;this.stepForm_1.getItem("verificationAction").container.setStyle("display","none"),this.setResendVerification()}},setResendVerification:function(){var t=this.stepForm_1.getItem("resendVerificationAction");t.container.setStyle("display",""),this.resendElement=t.getElements()[0],this.resendElement.set("text",this.lp.resendVerification+"(60)");var e=60;this.timer=setInterval(function(){e>0?this.resendElement.set("text",this.lp.resendVerification+"("+--e+")"):(this.stepForm_1.getItem("verificationAction").container.setStyle("display",""),t.container.setStyle("display","none"),clearInterval(this.timer))}.bind(this),1e3)},getPasswordRule:function(t){var e="";return this.actions.checkRegisterPassword(t,function(t){e=t.data.value||""}.bind(this),null,!1),e},gotoLogin:function(){this.explorer.openLoginForm({},(function(){window.location.reload()})),this.close()},gotoSignup:function(){this.explorer.openSignUpForm(),this.close()}}),MWF.xDesktop.Authentication.ChangePasswordForm=new Class({Extends:MPopupForm,Implements:[Options,Events],options:{style:"default",popupStyle:"o2platform",width:"650",height:"480",hasTop:!0,hasIcon:!1,hasTopIcon:!0,hasTopContent:!0,hasBottom:!1,hasScroll:!1,hasMark:!1,title:"",draggable:!0,closeAction:!0,userName:""},load:function(){this.options.title||this.setOptions({title:MWF.LP.authentication.ChangePasswordFormTitle}),this._loadCss()},_createTableContent:function(){var t=this;this.actions=MWF.Actions.get("x_organization_assemble_personal");this.formTableArea.set("html","<table width='100%' bordr='0' cellpadding='0' cellspacing='0' styles='formTable'><tr><td styles='formTableValueTop20' item='password'></td></tr><tr><td styles='formTableValueTop20' item='newPassword'></td><tr><td styles='formTableValue'><div item='passwordTip'></div></td></tr><tr><td styles='formTableValueTop20' item='confirmPassword'></td><tr><td styles='formTableValueTop20' item='submitAction'></td></tr><tr><td><div item='forgetPassword'></div><div item='gotoLoginAction'></div></td></tr><tr><td  styles='formTableValue' item='errorArea'></td></tr></table>"),this.errorArea=this.formTableArea.getElement("[item=errorArea]"),MWF.xDesktop.requireApp("Template","MForm",function(){this.form=new MForm(this.formTableArea,this.data,{style:this.options.popupStyle,verifyType:"single",isEdited:this.isEdited||this.isNew,onPostLoad:function(){var t=this.form;t.getItem("password").tipNode=this.errorArea,t.getItem("newPassword").tipNode=this.errorArea,t.getItem("confirmPassword").tipNode=this.errorArea}.bind(this),itemTemplate:{password:{text:this.lp.oldPassword,type:"password",className:"inputPassword",notEmpty:!0,defaultValueAsEmpty:!0,emptyTip:this.lp.inputYourOldPassword,attr:{placeholder:this.lp.oldPassword},event:{focus:function(t){"password"===t.getValue()&&t.setValue(""),t.warningStatus||t.getElements()[0].setStyles(this.css.inputActive)}.bind(this),blur:function(t){t.warningStatus||t.getElements()[0].setStyles(this.css.inputPassword)}.bind(this),keyup:function(t,e){13===e.event.keyCode&&this.ok()}.bind(this)},onEmpty:function(t){t.getElements()[0].setStyles(this.css.inputEmpty)}.bind(this),onUnempty:function(t){t.getElements()[0].setStyles(this.css.inputPassword)}.bind(this)},newPassword:{text:this.lp.newPassword,type:"password",className:"inputPassword",notEmpty:!0,defaultValueAsEmpty:!0,emptyTip:this.lp.inputYourNewPassword,attr:{placeholder:this.lp.newPassword},validRule:{passwordIsWeak:function(t,e){return!this.getPasswordRule(e.getValue())}.bind(this)},validMessage:{passwordIsWeak:function(){return t.getPasswordRule(this.getValue())}},event:{focus:function(t){t.warningStatus||t.getElements()[0].setStyles(this.css.inputActive)}.bind(this),blur:function(t){}.bind(this),keyup:function(t,e){13===e.event.keyCode&&this.ok()}.bind(this)},onEmpty:function(t){t.getElements()[0].setStyles(this.css.inputEmpty)}.bind(this),onUnempty:function(t){t.getElements()[0].setStyles(this.css.inputPassword)}.bind(this)},confirmPassword:{text:this.lp.confirmNewPassword,type:"password",className:"inputComfirmPassword",notEmpty:!0,defaultValueAsEmpty:!0,emptyTip:this.lp.inputComfirmPassword,attr:{placeholder:this.lp.confirmPassword},validRule:{passwordNotEqual:function(t,e){if(e.getValue()===this.form.getItem("newPassword").getValue())return!0}.bind(this)},validMessage:{passwordNotEqual:this.lp.passwordNotEqual},event:{focus:function(t){t.warningStatus||t.getElements()[0].setStyles(this.css.inputActive)}.bind(this),blur:function(t){t.warningStatus||t.getElements()[0].setStyles(this.css.inputComfirmPassword)}.bind(this),keyup:function(t,e){13===e.event.keyCode&&this.ok()}.bind(this)},onEmpty:function(t){t.getElements()[0].setStyles(this.css.inputEmpty)}.bind(this),onUnempty:function(t){t.getElements()[0].setStyles(this.css.inputComfirmPassword)}.bind(this)},forgetPassword:{value:this.lp.forgetPassword,type:"innerText",className:"forgetPassword",event:{click:function(){this.gotoResetPassword()}.bind(this)}},gotoLoginAction:{value:this.lp.loginAction,type:"innerText",className:"signUpAction",event:{click:function(){this.gotoLogin()}.bind(this)}},passwordTip:{type:"innerText",className:"forgetPassword",defaultValue:layout.config.passwordRegexHint||""},submitAction:{value:this.lp.submitAction,type:"button",className:"inputLogin",event:{click:function(){this.ok()}.bind(this)}}}},this.app,this.css),this.form.load()}.bind(this),!0)},gotoLogin:function(){this.explorer.openLoginForm({},(function(){window.location.reload()})),this.close()},getPasswordRule:function(t){var e="";return this.actions.checkRegisterPassword(t,function(t){e=t.data.value||""}.bind(this),null,!1),e},gotoResetPassword:function(){this.explorer.openResetPasswordForm(),this.close()},ok:function(){this.fireEvent("queryOk"),this.errorArea.empty();var t=this.form.getResult(!0,",",!0,!1,!0);t&&this._ok(t,function(t){"error"===t.type?this.app&&this.app.notice(t.message,"error"):(this._close(),this.formMaskNode&&this.formMaskNode.destroy(),this.formAreaNode.destroy(),this.explorer&&this.explorer.view&&this.explorer.view.reload(),this.app&&this.app.notice(this.lp.changePasswordSuccess,"success"),this.fireEvent("postOk",t))}.bind(this))},setWarning:function(t){this.errorArea.empty(),new Element("div",{text:t,styles:this.css.warningMessageNode}).inject(this.errorArea)},_ok:function(t,e){var i={userName:this.options.userName,oldPassword:t.password,newPassword:t.newPassword,confirmPassword:t.confirmPassword,isEncrypted:"n"};o2.Actions.load("x_organization_assemble_personal").ResetAction.setPasswordAnonymous(i,function(t){e&&e(t)}.bind(this),function(t){var e=JSON.parse(t.responseText);this.setWarning(e.message)}.bind(this))}}),MWF.require("MWF.widget.Dialog",null,!1),MWF.xDesktop.Window=new Class({Extends:MWF.widget.Dialog,Implements:[Options,Events],options:{style:"default",title:"window",width:"800",height:"600",top:"10",left:"10",fromTop:"0",fromLeft:"0",mark:!1,html:"",text:"",url:"",content:null,isMax:!0,isClose:!0,isResize:!0,isMove:!0,buttons:null,buttonList:null},initialize:function(t,e){var i=layout.desktop.desktopNode.getPosition();this.options.top=parseFloat(this.options.top)+i.y,this.options.fromTop=parseFloat(this.options.fromTop)+i.y,this.app=t,this.parent(e),this.isHide=!1,this.isMax=!1},changeStyle:function(){var t=this.getNodeStyleStatus();this.cssPath=MWF.defaultPath+"/widget/$Dialog/"+this.options.style+"/css.wcss",this._loadCss(),this.getContentUrl(),new Request.HTML({url:this.contentUrl,method:"GET",async:!1,onSuccess:function(e){var i=e[0],s=i.getElement(".MWF_dialod_title"),o=i.getElement(".MWF_dialod_title_center"),n=i.getElement(".MWF_dialod_title_refresh"),a=i.getElement(".MWF_dialod_title_text"),r=i.getElement(".MWF_dialod_title_action"),l=i.getElement(".MWF_dialod_under"),c=i.getElement(".MWF_dialod_content"),d=i.getElement(".MWF_dialod_bottom"),h=i.getElement(".MWF_dialod_bottom_resize"),u=i.getElement(".MWF_dialod_button");this.title&&s&&(this.title.clearStyles(),this.title.set("style",s.get("style"))),this.titleCenter&&o&&(this.titleCenter.clearStyles(),this.titleCenter.set("style",o.get("style"))),this.titleRefresh&&n&&(this.titleRefresh.clearStyles(),this.titleRefresh.set("style",n.get("style"))),this.titleText&&a&&(this.titleText.clearStyles(),this.titleText.set("style",a.get("style"))),this.titleAction&&r&&(this.titleAction.clearStyles(),this.titleAction.set("style",r.get("style"))),this.under&&l&&(this.under.clearStyles(),this.under.set("style",l.get("style"))),this.content&&c&&(this.content.clearStyles(),this.content.set("style",c.get("style"))),this.bottom&&d&&(this.bottom.clearStyles(),this.bottom.set("style",d.get("style"))),this.resizeNode&&h&&(this.resizeNode.clearStyles(),this.resizeNode.set("style",h.get("style"))),this.button&&u&&(this.button.clearStyles(),this.button.set("style",u.get("style"))),this.setNodeStyleStatus(t),this.node.setStyles(this.css.to),this.spacer.setStyles(this.css.spacerTo),this.closeActionNode&&this.closeActionNode.setStyles(this.css.closeActionNode),this.maxActionNode&&this.maxActionNode.setStyles(this.css.maxActionNode),this.minActionNode&&this.minActionNode.setStyles(this.css.minActionNode),this.restoreActionNode&&this.restoreActionNode.setStyles(this.css.restoreActionNode),this.app==this.app.desktop.currentApp?(this.node.setStyles(this.css.current),this.spacer.setStyles(this.css.spacerCurrent)):(this.node.setStyles(this.css.uncurrent),this.spacer.setStyles(this.css.spacerUncurrent)),this.setContentSize()}.bind(this)}).send()},setNodeStyleStatus:function(t){this.css.to.height=t.nodeTo.height,this.css.to.width=t.nodeTo.width,this.css.to.top=t.nodeTo.top,this.css.to.left=t.nodeTo.left,this.css.to["z-index"]=t.nodeTo["z-index"],this.css.from.top=t.nodeFrom.top,this.css.from.left=t.nodeFrom.left,this.css.from["z-index"]=t.nodeFrom["z-index"],this.css.spacerTo.height=t.spacerTo.height,this.css.spacerTo.width=t.spacerTo.width,this.css.spacerTo.top=t.spacerTo.top,this.css.spacerTo.left=t.spacerTo.left,this.css.spacerTo["z-index"]=t.spacerTo["z-index"],this.css.spacerFrom.top=t.spacerFrom.top,this.css.spacerFrom.left=t.spacerFrom.left,this.css.spacerFrom["z-index"]=t.spacerFrom["z-index"]},getNodeStyleStatus:function(){return{nodeTo:{height:this.css.to.height,width:this.css.to.width,top:this.css.to.top,left:this.css.to.left,"z-index":this.css.to["z-index"]},nodeFrom:{top:this.css.from.top,left:this.css.from.left,"z-index":this.css.from["z-index"]},spacerTo:{height:this.css.spacerTo.height,width:this.css.spacerTo.width,top:this.css.spacerTo.top,left:this.css.spacerTo.left,"z-index":this.css.spacerTo["z-index"]},spacerFrom:{top:this.css.spacerFrom.top,left:this.css.spacerFrom.left,"z-index":this.css.spacerFrom["z-index"]}}},reStyle:function(t){t&&this.setOptions(t);var e=null;MWF.xDesktop.zIndexPool&&(e=MWF.xDesktop.zIndexPool.applyZindex()),this.css.to.height=this.options.height+"px",this.css.to.width=this.options.width+"px",this.css.to.top=this.options.top+"px",this.css.to.left=this.options.left+"px",this.css.from.top=this.options.fromTop+"px",this.css.from.left=this.options.fromLeft+"px",e&&(this.css.from["z-index"]=e+1,this.css.to["z-index"]=e+1),this.node&&this.node.set("styles",this.css.from),this.css.spacerTo.height=this.options.height+"px",this.css.spacerTo.width=this.options.width+"px",this.css.spacerTo.top=this.options.top+"px",this.css.spacerTo.left=this.options.left+"px",this.css.spacerFrom.top=this.options.fromTop+"px",this.css.spacerFrom.left=this.options.fromLeft+"px",e&&(this.css.spacerFrom["z-index"]=e,this.css.spacerTo["z-index"]=e),this.spacer&&this.spacer.set("styles",this.css.spacerFrom)},setCurrent:function(){if(MWF.xDesktop.zIndexPool&&this.node.getStyle("z-index").toFloat()+1<MWF.xDesktop.zIndexPool.zIndex){var t=MWF.xDesktop.zIndexPool.applyZindex();this.css.spacerTo["z-index"]=t,this.css.spacerFrom["z-index"]=t,this.spacer&&this.spacer.setStyle("z-index",t),this.css.to["z-index"]=t+1,this.css.from["z-index"]=t+1,this.node.setStyle("z-index",t+1)}this.node.setStyles(this.css.current),this.spacer&&this.spacer.setStyles(this.css.spacerCurrent)},setUncurrent:function(){this.node.setStyles(this.css.uncurrent),this.spacer&&this.spacer.setStyles(this.css.spacerUncurrent)},setTitleEvent:function(){this.node.addEvent("mousedown",function(){this.app.setCurrent()}.bind(this)),this.containerDrag=new Drag(this.title,{handle:this.title,onStart:function(t,e){this.containerDrag.stop();var i=this.node.clone(!1).inject($(document.body)),s=this.node.getSize();i.setStyles({opacity:.7,border:"2px dashed #999","z-index":this.node.getStyle("z-index"),width:s.x,height:s.y,"background-color":"#CCC",position:"absolute"}),i.position({relativeTo:this.node,position:"upperLeft",edge:"upperLeft"});var o=new Drag.Move(i,{onStart:function(){this.node.fade("out"),this.spacer.fade("out")}.bind(this),onDrop:function(t,e,i){this.node.fade("in"),this.spacer.fade(this.css.spacerTo.opacity),this.node.position({relativeTo:t,position:"upperLeft",edge:"upperLeft"});var s=this.node.getPosition();this.spacer.setStyles({top:s.y,left:s.x}),this.css.spacerTo.left=s.x,this.css.spacerTo.top=s.y,this.css.to.left=s.x,this.css.to.top=s.y,t.destroy(),this.fireEvent("moveDrop",[i])}.bind(this),onCancel:function(t){t.destroy(),o=null}});o.start(e)}.bind(this)}),this.options.isResize&&this.node.makeResizable({handle:this.resizeNode||this.bottom,limit:{x:[200,null],y:[200,null]},onDrag:function(){var t=this.node.getComputedSize();this.spacer&&(this.spacer.setStyles({width:t.width,height:t.height}),this.css.spacerTo.width=t.width,this.css.spacerTo.height=t.height),this.css.to.width=t.width,this.css.to.height=t.height,this.setContentSize(t.height,t.width),this.fireEvent("resize")}.bind(this),onComplete:function(){this.fireEvent("resizeCompleted")}.bind(this)})},getContentUrl:function(){layout.desktop.windowCss?this.contentUrl=MWF.defaultPath+"/xDesktop/$Window/desktop_default/dialog.html":this.contentUrl=MWF.defaultPath+"/xDesktop/$Window/"+this.options.style+"/dialog.html"},_loadCss:function(){this.app.desktop.windowCss?this.css=this.app.desktop.windowCss:(this.path=MWF.defaultPath+"/xDesktop/$Window/",this.cssPath=MWF.defaultPath+"/xDesktop/$Window/"+this.options.style+"/css.wcss",new Request.JSON({url:this.cssPath,secure:!1,async:!1,method:"get",noCache:!0,onSuccess:function(t,e){this.css=t}.bind(this),onError:function(t,e){alert(t)}}).send())},getSpacer:function(){this.spacer||(this.spacer=new Element("div",{styles:this.css.spacerFrom}).inject(this.options.container||$(document.body)))},showNoAnimation:function(t,e){t?this.showMaxIm():e?(this.showIm(),this.hideIm()):this.showIm()},showMaxIm:function(t){this.querySetMaxStyle(),this.getSpacer(),this.spacer.setStyle("display","block"),this.node.setStyle("display","block");var e,i=this.getMaxSize(),s=Object.clone(this.css.spacerTo),o=Object.clone(this.css.to);s.top=i.position.y,s.left=i.position.x,s.width=i.spacer.x,s.height=i.spacer.y,o.top=i.position.y,o.left=i.position.x,o.width=i.node.x,o.height=i.node.y,e=i.contentSize,this.fireEvent("queryShow")&&(this.fireEvent("queryMax"),this.node.setStyles(o),this.spacer.setStyles(s),this.content.setStyles(e),this.titleText&&this.getTitle(),this.isMax=!0,this.isHide=!1,this.containerDrag&&this.containerDrag.detach(),this.postSetMaxStyle(),t&&t(),this.fireEvent("postShow"),this.fireEvent("postMax"),this.maxActionNode&&this.maxActionNode.setStyles(this.css.restoreActionNode))},showIm:function(){this.options.mark&&this._markShow(),this.getSpacer(),this.spacer.setStyle("display","block"),this.node.setStyle("display","block");var t=this.getContentSize(this.css.to.height.toFloat(),this.css.to.width.toFloat());this.fireEvent("queryShow")&&(this.spacer.setStyles(this.css.spacerTo),this.app.desktop.currentApp!=this.app&&this.spacer.setStyles(this.css.spacerUncurrent),this.content.setStyles(t),this.node.setStyles(this.css.to),this.titleText&&this.getTitle(),this.isHide=!1,this.containerDrag&&this.containerDrag.attach(),this.fireEvent("postShow"))},show:function(){this.options.mark&&this._markShow(),this.morph||(this.morph=new Fx.Morph(this.node,{duration:100,link:"chain"})),this.morph.setOptions({duration:50}),this.getSpacer(),this.spacerMorph||(this.spacerMorph=new Fx.Morph(this.spacer,{duration:100,link:"chain"})),this.spacerMorph.setOptions({duration:50}),this.contentMorph||(this.contentMorph=new Fx.Morph(this.content,{duration:50,link:"chain"})),this.contentMorph.setOptions({duration:50}),this.spacer.setStyle("display","block"),this.node.setStyle("display","block");var t=this.getContentSize(this.css.to.height.toFloat(),this.css.to.width.toFloat());if(this.fireEvent("queryShow")){var e=!1,i=!1,s=!1;this.spacerMorph.start(this.css.spacerTo).chain(function(){this.app.desktop.currentApp!=this.app&&this.spacer.setStyles(this.css.spacerUncurrent),i=!0,o()}.bind(this)),this.contentMorph.start(t).chain(function(){s=!0,o()}.bind(this)),this.morph.start(this.css.to).chain(function(){e=!0,o()}.bind(this));var o=function(){e&&i&&s&&(this.titleText&&this.getTitle(),this.isHide=!1,this.containerDrag&&this.containerDrag.attach(),this.fireEvent("postShow"))}.bind(this)}},restore:function(t){this.querySetRestoreStyle(),this.options.mark&&this._markShow(),this.morph||(this.morph=new Fx.Morph(this.node,{duration:100,link:"chain"})),this.morph.setOptions({duration:50}),this.getSpacer(),this.spacerMorph||(this.spacerMorph=new Fx.Morph(this.spacer,{duration:100,link:"chain"})),this.spacerMorph.setOptions({duration:50}),this.contentMorph||(this.contentMorph=new Fx.Morph(this.content,{duration:50,link:"chain"})),this.contentMorph.setOptions({duration:50}),this.spacer.setStyle("display","block"),this.node.setStyle("display","block");var e=this.getContentSize(this.css.to.height.toFloat(),this.css.to.width.toFloat());if(this.fireEvent("queryRestore")){var i=!1,s=!1,o=!1;this.spacerMorph.start(this.css.spacerTo).chain(function(){this.app.desktop.currentApp!=this.app&&this.spacer.setStyles(this.css.spacerUncurrent),s=!0,n()}.bind(this)),this.contentMorph.start(e).chain(function(){o=!0,n()}.bind(this)),this.morph.start(this.css.to).chain(function(){this.app.desktop.currentApp!=this.app&&this.node.setStyles(this.css.uncurrent),i=!0,n()}.bind(this));var n=function(){i&&s&&o&&(this.titleText&&this.getTitle(),this.isHide=!1,this.isMax=!1,this.containerDrag&&this.containerDrag.attach(),this.postSetRestoreStyle(),t&&t(),this.fireEvent("resize"),this.fireEvent("postRestore"))}.bind(this);this.maxActionNode&&this.maxActionNode.setStyles(this.css.maxActionNode)}},querySetRestoreStyle:function(){this.css.windowTitleRestore&&this.title.setStyles(this.css.windowTitleRestore),this.css.titleRefresh&&this.titleRefresh.setStyles(this.css.titleRefresh),this.css.windowTitleTextRestore&&this.titleText.setStyles(this.css.windowTitleTextRestore),this.css.windowTitleActionRestore&&this.titleAction.setStyles(this.css.windowTitleActionRestore),this.closeActionNode&&this.css.closeActionNode&&this.closeActionNode.setStyles(this.css.closeActionNode),this.maxActionNode&&this.css.maxActionNode&&this.maxActionNode.setStyles(this.css.maxActionNode),this.minActionNode&&this.css.minActionNode&&this.minActionNode.setStyles(this.css.minActionNode)},postSetRestoreStyle:function(){this.css.windowNodeRestore&&this.node.setStyles(this.css.windowNodeRestore)},restoreIm:function(t){this.querySetRestoreStyle(),this.getSpacer(),this.spacer.setStyle("display","block"),this.node.setStyle("display","block");var e=this.getContentSize(this.css.to.height.toFloat(),this.css.to.width.toFloat());this.fireEvent("queryRestore")&&(this.node.setStyles(this.css.to),this.spacer.setStyles(this.css.spacerTo),this.content.setStyles(e),this.titleText&&this.getTitle(),this.isHide=!1,this.isMax=!1,this.containerDrag&&this.containerDrag.attach(),this.postSetRestoreStyle(),t&&t(),this.fireEvent("resize"),this.fireEvent("postRestore"),this.maxActionNode&&this.maxActionNode.setStyles(this.css.maxActionNode))},hideIm:function(t,e,i){this.getSpacer(),t&&(this.css.from.left=t,this.css.spacerFrom.left=t),e&&(this.css.from.top=e,this.css.spacerFrom.top=e),this.fireEvent("queryHide")&&(this.titleText&&this.titleText.set("text",""),this.button&&this.button.set("html",""),this.spacer.setStyles(this.css.spacerFrom),this.node.setStyles(this.css.from),this._markHide(),this.isHide=!0,this.node.setStyle("display","none"),this.spacer.setStyle("display","none"),i&&i(),this.fireEvent("postHide"))},hide:function(t,e,i){if(this.morph||(this.morph=new Fx.Morph(this.node,{duration:100,link:"chain"})),this.morph.setOptions({duration:100}),this.getSpacer(),this.spacerMorph||(this.spacerMorph=new Fx.Morph(this.spacer,{duration:100,link:"chain"})),this.spacerMorph.setOptions({duration:100}),t&&(this.css.from.left=t,this.css.spacerFrom.left=t),e&&(this.css.from.top=e,this.css.spacerFrom.top=e),this.fireEvent("queryHide")){this.titleText&&this.titleText.set("text",""),this.button&&this.button.set("html","");var s=!1,o=!1;this.spacerMorph.start(this.css.spacerFrom).chain(function(){o=!0,n()}.bind(this)),this.morph.start(this.css.from).chain(function(){s=!0,n()}.bind(this));var n=function(){s&&o&&(this._markHide(),this.isHide=!0,this.node.setStyle("display","none"),this.spacer.setStyle("display","none"),i&&i(),this.fireEvent("postHide"))}.bind(this)}},_hideIm:function(){this.node.setStyle("display","none"),this.spacer.setStyle("display","none")},_showIm:function(){this.node.setStyle("display","block"),this.spacer.setStyle("display","block")},_fadeOut:function(){this.node.fade("out"),this.spacer.fade("out")},_fadeIn:function(){this.node.fade("in"),this.spacer.fade("in")},close:function(t){this.morph||(this.morph=new Fx.Morph(this.node,{duration:100,link:"chain"})),this.morph.setOptions({duration:100}),this.getSpacer(),this.spacerMorph||(this.spacerMorph=new Fx.Morph(this.spacer,{duration:100,link:"chain"})),this.spacerMorph.setOptions({duration:100}),this.fireEvent("queryClose")&&(this.spacer.destroy(),this.spacer=null,this._markHide(),this.node.destroy(),this.node=null,t&&t(),this.fireEvent("postClose"),o2.release(this))},getAction:function(){this.titleAction.setStyles(this.css.titleAction);var t=this;this.closeActionNode=new Element("div",{styles:this.css.closeActionNode,events:{mouseover:function(e){this.setStyles(t.css.titleActionOver),e.stopPropagation()},mouseout:function(e){this.setStyles(t.css.titleActionOut),e.stopPropagation()},mousedown:function(e){this.setStyles(t.css.titleActionDown),e.stopPropagation()},mouseup:function(e){this.setStyles(t.css.titleActionOver),e.stopPropagation()},click:function(t){this.app.close(),t.stopPropagation()}.bind(this)}}).inject(this.titleAction),0!=this.options.isMax&&(this.maxActionNode=new Element("div",{styles:this.css.maxActionNode,events:{mouseover:function(){this.setStyles(t.css.titleActionOver)},mouseout:function(){this.setStyles(t.css.titleActionOut)},mousedown:function(){this.setStyles(t.css.titleActionDown)},mouseup:function(){this.setStyles(t.css.titleActionOver)},click:function(){this.app.maxOrRestoreSize()}.bind(this)}}).inject(this.titleAction)),this.options.isResize&&this.title.addEvent("dblclick",this.app.maxOrRestoreSize.bind(this.app)),this.minActionNode=new Element("div",{styles:this.css.minActionNode,events:{mouseover:function(){this.setStyles(t.css.titleActionOver)},mouseout:function(){this.setStyles(t.css.titleActionOut)},mousedown:function(){this.setStyles(t.css.titleActionDown)},mouseup:function(){this.setStyles(t.css.titleActionOver)},click:function(){this.app.minSize()}.bind(this)}}).inject(this.titleAction),0!=this.options.isRefresh&&this.titleRefresh.addEvents({mouseover:function(){this.setStyles(t.css.titleActionOver)},mouseout:function(){this.setStyles(t.css.titleActionOut)},mousedown:function(){this.setStyles(t.css.titleActionDown)},mouseup:function(){this.setStyles(t.css.titleActionOver)},click:function(t){this.app.refresh()}.bind(this),dblclick:function(t){t.stopPropagation()}.bind(this)})},maxOrRestoreSize:function(t){this.isMax?this.restoreSize(t):this.maxSize(t)},restoreSize:function(t){this.restore(t)},maxSize:function(t){this.querySetMaxStyle(),this.morph||(this.morph=new Fx.Morph(this.node,{duration:50,link:"chain"})),this.morph.setOptions({duration:50}),this.getSpacer(),this.spacerMorph||(this.spacerMorph=new Fx.Morph(this.spacer,{duration:50,link:"chain"})),this.spacerMorph.setOptions({duration:50}),this.contentMorph||(this.contentMorph=new Fx.Morph(this.content,{duration:50,link:"chain"})),this.contentMorph.setOptions({duration:50}),this.spacer.setStyle("display","block"),this.node.setStyle("display","block");var e,i=this.getMaxSize(),s=Object.clone(this.css.spacerTo),o=Object.clone(this.css.to);if(s.top=i.position.y,s.left=i.position.x,s.width=i.spacer.x,s.height=i.spacer.y,o.top=i.position.y,o.left=i.position.x,o.width=i.node.x,o.height=i.node.y,e=i.contentSize,this.fireEvent("queryMax")){var n=!1,a=!1,r=!1;this.spacerMorph.start(s).chain(function(){this.app.desktop.currentApp!=this.app&&this.spacer.setStyles(this.css.spacerUncurrent),a=!0,l()}.bind(this)),this.contentMorph.start(e).chain(function(){r=!0,l()}.bind(this)),this.morph.start(o).chain(function(){this.app.desktop.currentApp!=this.app&&this.node.setStyles(this.css.uncurrent),n=!0,l()}.bind(this));var l=function(){n&&a&&r&&(this.titleText&&this.getTitle(),this.isMax=!0,this.isHide=!1,this.containerDrag&&this.containerDrag.detach(),this.postSetMaxStyle(),t&&t(),this.fireEvent("resize"),this.fireEvent("postMax"))}.bind(this);this.maxActionNode&&this.maxActionNode.setStyles(this.css.restoreActionNode)}},querySetMaxStyle:function(){this.css.windowTitleMax&&this.title.setStyles(this.css.windowTitleMax),this.css.windowTitleRefreshMax&&this.titleRefresh.setStyles(this.css.windowTitleRefreshMax),this.css.windowTitleTextMax&&this.titleText.setStyles(this.css.windowTitleTextMax),this.css.windowTitleActionMax&&this.titleAction.setStyles(this.css.windowTitleActionMax),this.closeActionNode&&this.css.windowActionNodeMax&&this.closeActionNode.setStyles(this.css.windowActionNodeMax),this.maxActionNode&&this.css.windowActionNodeMax&&this.maxActionNode.setStyles(this.css.windowActionNodeMax),this.minActionNode&&this.css.windowActionNodeMax&&this.minActionNode.setStyles(this.css.windowActionNodeMax)},postSetMaxStyle:function(){this.css.windowNodeMax&&this.node.setStyles(this.css.windowNodeMax)},maxSizeIm:function(t){this.querySetMaxStyle(),this.getSpacer(),this.spacer.setStyle("display","block"),this.node.setStyle("display","block");var e,i=this.getMaxSize(),s=Object.clone(this.css.spacerTo),o=Object.clone(this.css.to);s.top=i.position.y,s.left=i.position.x,s.width=i.spacer.x,s.height=i.spacer.y,o.top=i.position.y,o.left=i.position.x,o.width=i.node.x,o.height=i.node.y,e=i.contentSize,this.fireEvent("queryMax")&&(this.node.setStyles(o),this.spacer.setStyles(s),this.content.setStyles(e),this.titleText&&this.getTitle(),this.isMax=!0,this.isHide=!1,this.containerDrag&&this.containerDrag.detach(),this.postSetMaxStyle(),t&&t(),this.fireEvent("resize"),this.fireEvent("postMax"),this.maxActionNode&&this.maxActionNode.setStyles(this.css.restoreActionNode))},getMaxSize:function(){var t=layout.desktop.desktopNode.getSize(),e=layout.desktop.desktopNode.getPosition(),i=this.spacer.getStyle("padding-top").toFloat(),s=this.spacer.getStyle("padding-bottom").toFloat(),o=this.spacer.getStyle("padding-left").toFloat(),n=this.spacer.getStyle("padding-right").toFloat();spacerHeight=t.y-i-s,spacerWidth=t.x-o-n,i=this.node.getStyle("padding-top").toFloat(),s=this.node.getStyle("padding-bottom").toFloat(),o=this.node.getStyle("padding-left").toFloat(),n=this.node.getStyle("padding-right").toFloat(),nodeHeight=t.y-i-s,nodeWidth=t.x-o-n;var a=this.getContentSize(nodeHeight,nodeWidth);return{node:{x:nodeWidth,y:nodeHeight},spacer:{x:spacerWidth,y:spacerHeight},position:{x:e.x,y:e.y},contentSize:a}}}),MWF.xDesktop.WindowTransparent=new Class({Implements:[Options,Events],options:{style:"default"},initialize:function(t,e){this.setOptions(e);layout.desktop.desktopNode.getPosition();this.app=t,this.fireEvent("queryLoad"),this.isMax=!1,this.isHide=!1,this.css={to:{width:"0",height:"0",left:"0",top:"0"}};var i=null;MWF.xDesktop.zIndexPool&&(i=MWF.xDesktop.zIndexPool.applyZindex()),this.node=new Element("div",{styles:{width:"0px",height:"0px",top:"0px",left:"0px",position:"absolute","z-index":i||100}}).inject(this.options.container||$(document.body)),this.content=new Element("div",{styles:{width:"100%",height:"100%"}}).inject(this.node),this.fireEvent("postLoad")},show:function(){this.fireEvent("queryShow"),this.node.setStyle("display","block"),this.isHide=!1,this.fireEvent("postShow")},hide:function(){this.fireEvent("queryHide"),this.node.setStyle("display","none"),this.isHide=!0,this.fireEvent("postHide")},restore:function(t){this.fireEvent("queryRestore"),this.node.setStyle("display","block"),this.isHide=!1,this.fireEvent("postRestore"),t&&t()},restoreSize:function(t){this.restore(t)},close:function(t){this.fireEvent("queryClose"),this.node.destroy(),this.node=null,this.content=null,t&&t(),this.fireEvent("postClose")},maxOrRestoreSize:function(t){this.isMax?this.restoreSize(t):this.maxSize(t)},maxSize:function(t){this.fireEvent("queryMax"),this.node.setStyle("display","block"),this.isHide=!1,this.fireEvent("resize"),this.fireEvent("postMax"),t&&t()},restoreIm:function(){this.restore()},maxSizeIm:function(){this.maxSize()},setCurrent:function(){if(MWF.xDesktop.zIndexPool&&this.node.getStyle("z-index").toFloat()+1<MWF.xDesktop.zIndexPool.zIndex){var t=MWF.xDesktop.zIndexPool.applyZindex();this.node.setStyle("z-index",t)}},_fadeOut:function(){this.node.fade("out"),this.spacer&&this.spacer.fade("out")},_fadeIn:function(){this.node.fade("in"),this.spacer&&this.spacer.fade("in")},setUncurrent:function(){},reStyle:function(){},changeStyle:function(){}}),MWF.xApplication.Common=MWF.xApplication.Common||{options:{multitask:!1,executable:!0}},MWF.require("MWF.xDesktop.Window",null,!1),Events.implement({fireEvent:function(t,e,i){if(this.options&&this.options.name&&MWF.xDesktop&&MWF.xDesktop.$globalEvents&&MWF.xDesktop.$globalEvents[this.options.name]){var s=MWF.xDesktop.$globalEvents[this.options.name][t];s&&s.each((function(t){i?t.delay(i,this,e):t.apply(this,e)}),this)}t=t.replace(/^on([A-Z])/,(function(t,e){return e.toLowerCase()}));var o=this.$events[t];return o?(e=Array.convert(e),o.each((function(t){i?t.delay(i,this,e):t.apply(this,e)}),this),this):this}}),MWF.xApplication.Common.Main=new Class({Extends:MWF.widget.Common,Implements:[Options,Events],options:{desktopReload:!0,style:"default",name:"Common",icon:"",title:"",event:null,width:"800",height:"600",isResize:!0,isMax:!0,setCurrent:!0,isRefresh:!1,isWindowRefresh:!0},initialize:function(t,e){this.setOptions(e),this.desktop=t,this.path="../x_component_"+this.options.name.replace(/\./g,"_")+"/$Main/",this.options.icon=this.path+this.options.style+"/"+this.options.icon,this.cssPath=this.path+this.options.style+"/css.wcss",this.options.mvcStyle&&(this.stylePath=this.path+this.options.style+"/"+this.options.mvcStyle),this.options.mvcStyle||this._loadCss()},fireAppEvent:function(t){this.fireEvent(t),this[("on-"+t).camelCase()]&&this[("on-"+t).camelCase()]()},loadNoAnimation:function(t,e,i){this.fireAppEvent("queryLoad"),this.inBrowser?this.loadInBrowser(t):"Homepage"===layout.viewMode?this.loadWindowFlat(t):this.loadWindow(t,!1,e,i)},load:function(t,e){this.fireAppEvent("queryLoad"),this.inBrowser?this.loadInBrowser(e):"Default"===layout.viewMode?this.loadWindowFlat(t):this.loadWindow(t)},loadApplication:function(t){t&&t()},loadWindow:function(t,e,i,s){this.fireAppEvent("queryLoadWindow");var o={style:"desktop_"+this.desktop.options.style,title:this.options.title,isResize:this.options.isResize,isMax:this.options.isMax,isRefresh:this.options.isWindowRefresh,container:this.desktop.node,onPostShow:function(){t&&this.setCurrent(),this.fireAppEvent("postLoadWindow"),this.fireAppEvent("queryLoadApplication"),this.options.title&&this.setTitle(this.options.title),this.stylePath?this.content.loadCss(this.stylePath,this.loadWindowApplication.bind(this)):this.loadWindowApplication()}.bind(this),onResize:function(){this.window.options.title=this.options.title,this.window.getTitle(),this.fireAppEvent("resize")}.bind(this),onResizeCompleted:function(){this.fireAppEvent("resizeCompleted")}.bind(this),onMoveDrop:function(t){"firefox"==Browser.name?(t.event.clientX<0||t.event.clientY<0)&&this.openInNewBrowser():(t.event.x<0||t.event.y<0)&&this.openInNewBrowser()}.bind(this)};this.options.event&&(o.fromTop=this.options.event.page.y,o.fromLeft=this.options.event.page.x),o.width=this.options.width||o.width,o.height=this.options.height||o.height,this.window=new MWF.xDesktop.Window(this,o),this.fireAppEvent("loadWindow"),this.content=this.window.content,!1===e?this.window.showNoAnimation(i,s):this.window.show()},loadWindowApplication:function(){this.setContentEvent(),this.loadApplication(function(){this.fireAppEvent("postLoadApplication")}.bind(this)),this.fireAppEvent("postLoad")},loadWindowFlat:function(t){this.window={app:this,isHide:!1,isMax:!0,maxSize:function(){},restore:function(){},setCurrent:function(){this.window.node.removeClass("layout_component_node_hide"),this.window.node.addClass("layout_component_node_show")}.bind(this),setUncurrent:function(){this.window.node.addClass("layout_component_node_hide"),this.window.node.removeClass("layout_component_node_show")}.bind(this),hide:function(){},maxOrRestoreSize:function(){},restoreSize:function(){},close:function(t){this.content.destroy(),t&&t()}.bind(this)},this.window.node=new Element("div.layout_component_node").inject(layout.desktop.contentNode),this.window.content=new Element("div.layout_component_content").inject(this.window.node),this.content=this.window.content,this.resizeFun=function(){this.fireAppEvent("resize")}.bind(this),layout.desktop.addEvent("resize",this.resizeFun),t?this.setCurrent():this.setUncurrent(),this.fireAppEvent("postLoadWindow"),this.fireAppEvent("queryLoadApplication"),this.options.title&&this.setTitle(this.options.title),this.stylePath?this.content.loadCss(this.stylePath,this.loadWindowApplication.bind(this)):this.loadWindowApplication()},loadInBrowser:function(t){this.window={isHide:!1,isMax:!0,maxSize:function(){},restore:function(){},setCurrent:function(){},setUncurrent:function(){},hide:function(){},maxOrRestoreSize:function(){},restoreSize:function(){},close:function(){}},this.window.titleText=$(document.head).getElement("title");try{this.window.titleText.set("text",this.options.title)}catch(t){}t&&"element"===o2.typeOf(t)&&(this.window.content=t),this.window.content||(this.window.content=$("appContent")||$("layout")),this.window.content||(this.window.content=new Element("div",{styles:{width:0,height:0}}).inject(document.body)),this.content=this.window.content,window.addEvent("resize",function(){this.fireAppEvent("resize")}.bind(this)),window.addEventListener("beforeunload",function(t){this.fireAppEvent("queryClose")}.bind(this)),layout.mobile&&window.addEventListener("pagehide",function(t){this.fireAppEvent("queryClose")}.bind(this)),this.fireAppEvent("postLoadWindow"),this.fireAppEvent("queryLoadApplication"),this.setContentEvent(),this.options.title&&this.setTitle(this.options.title),this.stylePath&&o2.loadCss(this.stylePath),this.loadApplication(function(){this.fireAppEvent("postLoadApplication")}.bind(this)),this.fireAppEvent("postLoad")},openInNewBrowser:function(t){this.desktop.openBrowserApp=this.options.name,this.desktop.openBrowserStatus=this.recordStatus?this.recordStatus():null;var e=this.desktop.openBrowserStatus?JSON.encode(this.desktop.openBrowserStatus):"",i="../x_desktop/app.html?app="+this.options.name+"&status="+e;window.open(o2.filterUrl(i),"_blank"),this.inBrowser||t||this.close()},openInNewWindow:function(){this.desktop.openBrowserApp=this.options.name,this.desktop.openBrowserStatus=this.recordStatus?this.recordStatus():null,window.open(o2.filterUrl("../x_desktop/app.html"),"_blank"),this.inBrowser||this.close()},setContentEvent:function(){},setCurrent:function(){if(this.desktop.currentApp==this)return!0;this.desktop.currentApp&&this.desktop.currentApp.setUncurrent(),this.window.setCurrent(),this.window.isHide?this.window.isMax?this.window.maxSize(function(){this.fireAppEvent("current")}.bind(this)):this.window.restore(function(){this.fireAppEvent("current")}.bind(this)):this.fireAppEvent("current"),this.taskitem&&this.taskitem.selected(),this.desktop.currentApp=this,this.desktop.appCurrentList.erase(this),this.desktop.appCurrentList.push(this)},setUncurrent:function(){this.desktop.currentApp==this?(this.window.setUncurrent(),this.taskitem.unSelected(),this.desktop.currentApp=null,this.fireAppEvent("uncurrent")):(this.window.setUncurrent(),this.taskitem.unSelected())},minSize:function(){this.fireAppEvent("queryMinSize");var t=this.taskitem.node.getPosition();this.setUncurrent(),this.window.hide(t.x,t.y,function(){this.fireAppEvent("postMinSize")}.bind(this))},_minSize:function(){var t=this.taskitem.node.getPosition();this.setUncurrent(),this.window.hide(t.x,t.y)},maxOrRestoreSize:function(){var t=!0;this.window.isMax&&(t=!1),this.fireAppEvent(t?"queryMaxSize":"queryRestoreSize"),this.window.maxOrRestoreSize(function(){this.fireAppEvent(t?"postMaxSize":"postRestoreSize")}.bind(this))},maxSize:function(t){this.window.isMax?t&&t():(this.fireAppEvent("queryMaxSize"),this.window.maxSize(function(){this.fireAppEvent("postMaxSize"),t&&t()}.bind(this)))},_maxSize:function(t){this.window.maxSize()},restoreSize:function(t){this.fireAppEvent("queryRestoreSize"),this.window.restoreSize(function(){this.fireAppEvent("postRestoreSize"),t&&t()}.bind(this))},_restoreSize:function(t){this.window.restoreSize()},refresh:function(){this.desktop.refreshApp(this)},close:function(t){this.inBrowser?(window.open("","_self").close(),window.close()):(this.fireAppEvent("queryClose"),this.setUncurrent(),this.window.close(function(){t||this.taskitem.destroy(),this.window=null,this.taskitem=null,this.resizeFun&&layout.desktop.removeEvent("resize",this.resizeFun),this.desktop.closeApp(this,t),this.fireAppEvent("postClose"),o2.release(this)}.bind(this)))},setTitle:function(t){try{this.taskitem&&(this.taskitem.textNode.set("text",t),this.taskitem.node.set("title",t+(this.appId?"-"+this.appId:"")),this.taskitem.setTaskitemSize()),this.options.title=t,this.window.titleText.set("text",t)}catch(t){}},loading:function(){},unLoading:function(){},onQueryLoad:function(){},onQueryLoadWindow:function(){},onLoadWindow:function(){},onPostLoadWindow:function(){},onQueryLoadApplication:function(){},onPostLoadApplication:function(){},onPostLoad:function(){},onResize:function(){},onQueryClose:function(){},onPostClose:function(){},onQueryMinSize:function(){},onPostMinSize:function(){},onQueryMaxSize:function(){},onPostMaxSize:function(){},onQueryRestoreSize:function(){},onPostRestoreSize:function(){},dialog:function(t){MWF.require("MWF.xDesktop.Dialog",function(){t.markNode=this.content,new MWF.xDesktop.Dialog(t).show()}.bind(this))},notice:function(t,e,i,s,o){if(window.mBox){s||(s={x:"right",y:"top"}),i||(i=this.content),i||(i=this.window.content),e||(e="ok");var n=i||layout.layout.contentNode;layout.mobile&&(n=$(document.body));var a=o;a||(a={x:10,y:(s.y.toString().toLowerCase(),10)}),new mBox.Notice({type:e,position:s,move:!1,target:n,delayClose:"error"==e?1e4:5e3,offset:a,content:t})}},confirm:function(t,e,i,s,o,n,a,r,l,c,d){MWF.require("MWF.xDesktop.Dialog",function(){var h=layout.mobile?$(document.body):this.content||$(document.body),u=h.getSize(),p=0,m=0;if(layout.mobile)parseFloat(o)>u.x?(o=u.x-40,p=40):p=(u.x-parseFloat(o))/2,m=parseFloat(n)>u.y?0:(u.y-parseFloat(n))/2;else{var f;if("element"==typeOf(e))p=(f=e.getPosition(h)).x,m=f.y;else if("firefox"==Browser.name?(p=parseFloat(e.event.clientX||e.event.x),m=parseFloat(e.event.clientY||e.event.y)):(p=parseFloat(e.event.x),m=parseFloat(e.event.y)),e.target)p=(f=e.target.getPosition(h)).x,m=f.y;p+parseFloat(o)>u.x&&(p-=parseFloat(o)),p<0&&(p=0),m+parseFloat(n)>u.y&&(m-=parseFloat(n)),m<0&&(m=0),p-=20}var g="",y="";"object"==typeOf(s).toLowerCase()?(g=s.text,y=s.html):g=s;var x=new MWF.xDesktop.Dialog({title:i,style:d||"o2",top:m,left:p,fromTop:m,fromLeft:p,width:o,height:n,text:g,html:y,container:h,mark:!!c,maskNode:c||h,buttonList:[{type:"ok",text:MWF.LP.process.button.ok,action:a},{type:"cancel",text:MWF.LP.process.button.cancel,action:r}]});switch(t.toLowerCase()){case"success":x.content.setStyle("background-image","url(data:image/png;base64,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)");break;case"error":x.content.setStyle("background-image","url(data:image/png;base64,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)");break;case"info":x.content.setStyle("background-image","url(data:image/png;base64,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)");break;case"warn":x.content.setStyle("background-image","url(data:image/png;base64,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)")}x.show(),l&&l(x)}.bind(this))},dlg:function(t,e,i,s,o,n,a,r,l){MWF.require("MWF.xDesktop.Dialog",function(){var c=this.content.getSize(),d=e?MWF.getEPointer(e):MWF.getCenter({x:o,y:n},this.content,this.content),h=d.x||0,u=d.y||0;h+parseFloat(o)>c.x&&(h-=parseFloat(o)),h<0&&(h=0),u+parseFloat(n)>c.y&&(u-=parseFloat(n)),u<0&&(u=0);var p="",m="";"object"===typeOf(s).toLowerCase()?(p=s.text,m=s.html):p=s;var f=new MWF.xDesktop.Dialog({title:i,style:l||"o2",top:u,left:h-20,fromTop:u,fromLeft:h-20,width:o,height:n,text:p,html:m,container:this.content,mark:!!r,maskNode:r||this.content,buttonList:a});switch(t.toLowerCase()){case"success":f.content.setStyle("background-image","url(data:image/png;base64,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)");break;case"error":f.content.setStyle("background-image","url(data:image/png;base64,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)");break;case"info":f.content.setStyle("background-image","url(data:image/png;base64,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)");break;case"warn":f.content.setStyle("background-image","url(data:image/png;base64,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)")}f.show()}.bind(this))},alert:function(t,e,i,s,o,n){MWF.require("MWF.widget.Dialog",function(){var a=$(document.body).getSize(),r=0,l=0;if("center"===e){var c=o2.getCenterPosition(this.content,o,n);r=c.x,l=c.y}else r=parseFloat(e.event.x),l=parseFloat(e.event.y),"firefox"==Browser.name&&(r=parseFloat(e.event.clientX),l=parseFloat(e.event.clientY)),r-=parseFloat(o)/2,l-=parseFloat(n)/2;r+parseFloat(o)>a.x&&(r-=parseFloat(o)),r<0&&(r=0),l+parseFloat(n)>a.y&&(l-=parseFloat(n)),l<0&&(l=0);var d="",h="";"object"==typeOf(s).toLowerCase()?(d=s.text,h=s.html):d=s;var u=new MWF.DL({title:i,style:"o2",top:l,left:r,fromTop:l,fromLeft:r,width:o,height:n,text:d,html:h,maskNode:this.content,container:this.content,buttonList:[{text:MWF.LP.process.button.ok,action:function(){this.close()}}]});switch(t.toLowerCase()){case"success":u.content.setStyle("background-image","url(data:image/png;base64,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)");break;case"error":u.content.setStyle("background-image","url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABsVJREFUeNqkWFtsFGUU/nZn2r21IqX3llp6AQmkWDVGAgIlGI0EeMAHffAFa998MCQaE8JDxZCgSHzQKIm3qPHFGC7GW0xqkIgIKhhEwFJaKSDQUtplu73s7vidmX/q32F2uw2TnOzMv2fO+f5z/8fci7yvWAZYRXo4CCwLAM1cq+HvXRYwQrrM/7rTwB+TwC/dwKG3uU75mVxCO7T7wExgKHiBATzJ2411wMoy3pSQ5gg6UiFpgpQgDZNukK6TLgBHuf7lAPD5q8DfXMpQl5U3mA4P4ztAO3+2tADLCQSV+VsR/5L+If0G/EqgH78EvKtwT1lqr0en6SfoLaCe1niB7nj+CQIuV+uZWYApV8RNPPAVcP/rQMtF4I03gbNcpjdvt5KxQXs4SKKflxBI54PAs20EElNvZTQJucjLFyUtpZwioJVurFtMD/4MXBXWDUqnL5jHHYt0PgQ8da/4UFMwThpTz0HF7wfEj0/kSKwVAwsZU5U1wKkTwOBBj7GD08xE17QSSJPanVCKlCSNkM5s2mT/JtV6epZ8InclsH4R9TjYRKWPZQixnch2POJsZNpOb5HOb9yIi5s3I5XJIHb2rL2LoBZL+fBZKhOZaS3LgPgh4HcnYZ34scFI+goQxsj8iA+QHipItrejrKwMiaVLMZJIIEpFAaUkH76AFrEVfLxEzzEej/0FXFOGc8CQ8bmFTOE6DciEUnCBCsapoLGxETU1NYhGo7i+YAHiSlFauWMmvqAGKOzcVzDlh2mdo2o/loCJkeEVRnldSMsGUdCrKaiqqkJxcTEikQgKCgpsRbJzk4oukm8iB1+CfEUKkLtZub/CZOsFvht0Qi1lrAfW0WwvN3gyI7J1K+7ZswfNzc0oLS1FKBRCMBiEaZoIh8OOovp6jI6NYXLLFjQ1NdlAxCKGYaCwsBAlJSWoJ08lwQZTKaSPHJmSL9YZZWZx438eZ8yLMwwWtWeYaqvv9oBJ8UWDyovWrUMgEPi/ZPPeBWT/rlhhx0h1dbUNRABPpSrvBVhixw4kd+26rRyMOq3jCl31kzya0vSiKgW91/DOnbZJ53V22iAsy5pSIopra2vtNflP3KIDcTcwuH074pQT8JEvelkMF4kjpBuY0n1Dbjj7XDcpSCCU+gCKxWK+77hABghkOAsQuUIOivmq3xrSm2qMLJZxrwEKlGJQ5QGUC8gVBSSYQ67hoCidAiPzSCCHZSxVlXopeHhiAk30v8RBtivFQO3etg1Du3fbbihQKe0L3MmqmGrYwaAMRuPKMl6aVCkeJ11jRvSuWYO+vj4kk0lf4bIu/wuf8MfV+5NZ5I87RhhVuAKmTGhsbHPCWSwiwoYoOMQ60tDQgPLycjvNfWOA6/J/Op3GefJzsMLcAwfs6PSz0JhTXAfcBDNlVCS0xaYHSEql3jCBRLSC5k3faV1XZZnwySWABmUqJKCo8oUOaNTZbL9SlzE4Niwh8lURLf/TyoQzAZFgdcmvDklhjKsKXKAqsF5rZEztAboOAz+KA4xHmeo0+tNFqky7VMkKfJ+nAnuV2rtn1pS0td32n16B67kpRjZuqQrs6pB5mW37s5OswoLNaOTUdRfQRjPWGhrqOF80aYVSTwXWgfQQSL8URiqa6wGkV+B+ZuAlTwUWF/VxyPoUeD/uTH5x4xhjiNapoHXWhj3l+ubhw0hTkbtz3SXdBNJHIJgFn+Vx0Tlg37eOi+RAkTTk+MDueY1WWc64qQ5oZpSXhpSiedrOz1HBBVWZZ8Pn0phzcjj9DfBBvz1r4aYkrz3PvEhZq9lIyfgY3RXwzrY3lKKytWtxhgp6fHaaL5+AoU8stulPvgB+UFZJuPOMPaF/D5wgoGq6q9XMosianER3FiD58iWcDNr/GvCegwtDbjeywShAGQ5Y3aYzZC00PELsDkxFmOGokosv6cy/XV8DHyr3XFfL1rSBnL/WNqKUcw3rQWWhD6A7oaSTPV1dwEecX07CmX1v6W3Re4iz5IAl5xqCiTIMW0zJ5DsAkXKOLxbHy/1iEQ3IiHdYmAbGdZccsBhDXXKcoMAyWqjCynJwywVCqjgbz2kJVokR5RoXyKRkctYTpQ5Iepica+Q4QesMU0GUoCozPjGS0QZ5t9uzJ51ioO6T9FVZc1XFiLgm5X6ROJjvJ5EOZ4iXwaeIs2Elz1WreExtlVFRJjQZjGQekTFAuq80PRazbp6JTtOyxy87FX9EkYCY8H6v6fDMNzNdagayQYXVZ5mIei7UmrHrnQlFSZXJY9qnECuXIjMPMJZ2lHIPj6aaGg0FNOD5CJHWjtl5f0n5T4ABAFHaXG6UVjGNAAAAAElFTkSuQmCC)");break;case"info":u.content.setStyle("background-image","url(data:image/png;base64,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)");break;case"warn":u.content.setStyle("background-image","url(data:image/png;base64,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)")}u.content.setStyle("overflow","auto"),u.show()}.bind(this))}}),MWF.xApplication=MWF.xApplication||{},MWF.xApplication.process=MWF.xApplication.process||{},MWF.xApplication.process.Work=MWF.xApplication.process.Work||{},MWF.xApplication.process.Work.options=Object.clone(o2.xApplication.Common.options),MWF.xApplication.process.Work.options.multitask=!0,MWF.xApplication.process.Work.Main=new Class({Extends:MWF.xApplication.Common.Main,Implements:[Options,Events],options:{style:"default",name:"process.Work",icon:"icon.png",width:"1200",height:"800",title:"",workId:"",draftId:"",draft:null,workCompletedId:"",taskId:"",jobId:"",form:null,priorityWork:"",isControl:!1,taskObject:null,readonly:!1,worklogType:"record"},onQueryLoad:function(){this.options.title||this.setOptions({title:MWF.xApplication.process.Work.LP.title}),this.lp=MWF.xApplication.process.Work.LP,this.status&&(this.options.workId=this.status.workId,this.options.workCompletedId=this.status.workCompletedId,this.options.jobId=this.status.jobId,this.options.draftId=this.status.draftId,this.options.priorityWork=this.status.priorityWork,this.options.readonly="true"===this.status.readonly),this.action=MWF.Actions.get("x_processplatform_assemble_surface")},loadWorkApplication:function(t,e){var i="firefox"==Browser.name?"work_firefox":"desktop";e&&(this.mask=new MWF.widget.Mask({style:i,loading:e})),this.formNode=new Element("div",{styles:this.css.formNode}).inject(this.node),this.options.isRefresh?(e&&this.mask.loadNode(this.content),this.loadWork()):this.maxSize(function(){e&&this.mask.loadNode(this.content),this.loadWork()}.bind(this)),t&&t()},loadApplication:function(t){this.node=new Element("div",{styles:this.css.content}).inject(this.content),layout.mobile?this.loadWorkApplication(t,!1):"Default"==layout.viewMode?MWF.require("MWF.widget.Mask",function(){this.loadWorkApplication(t,!0)}.bind(this)):this.loadWorkApplication(t,!1),this.addEvent("postClose",function(){}.bind(this)),this.addKeyboardEvents()},refreshTaskCenter:function(){this.desktop.apps&&this.desktop.apps.TaskCenter&&(this.desktop.apps.TaskCenter.content&&this.desktop.apps.TaskCenter.content.unmask(),this.desktop.apps.TaskCenter.refreshAll&&this.desktop.apps.TaskCenter.refreshAll())},addKeyboardEvents:function(){this.addEvent("keySave",function(t){this.keySave(t)}.bind(this))},keySave:function(t){this.appForm&&(this.options.readonly||(this.appForm.saveWork(),t.preventDefault()))},reload:function(t){this.appForm&&(this.formNode.empty(),MWF.release(this.appForm),this.appForm=null,this.form=null,this.$events={}),t?(this.parseData(t),this.openWork()):this.loadWork()},loadWork:function(){var t=this.options.workCompletedId||this.options.workId||this.options.workid||this.options.workcompletedid;if(t)this.loadWorkByWork(t);else if(this.options.draftId||this.options.draftid){var e=this.options.draftId||this.options.draftid;MWF.Actions.get("x_processplatform_assemble_surface").getDraft(e,function(t){this.loadWorkByDraft(t.data.work,t.data.data)}.bind(this))}else if(this.options.draft)this.loadWorkByDraft(this.options.draft);else if(this.options.jobId||this.options.jobid||this.options.job){var i=this.options.jobId||this.options.jobid||this.options.job;delete this.options.jobId,delete this.options.jobid,delete this.options.job,this.loadWorkByJob(i)}},loadWorkByWork:function(t){var e,i,s,o,n=!1,a=!1,r=!1,l=function(){a&&n&&r&&(e&&s&&o&&i?(this.parseData(e.data,s.data,o.data,i.data,e.data.recordList,e.data.attachmentList),this.mask&&this.mask.hide(),layout.session&&layout.session.user?(this.openWork(),this.unLoading()):layout.sessionPromise&&layout.sessionPromise.then(function(){this.openWork(),this.unLoading()}.bind(this),(function(){}))):this.options.jobId||this.options.jobid||this.options.job?(delete this.options.workCompletedId,delete this.options.workId,delete this.options.workid,delete this.options.workcompletedid,this.loadWork()):layout.sessionPromise.then(function(){this.close()}.bind(this),(function(){})))}.bind(this);this.options.form&&this.options.form.id||this.options.formid?o2.Actions.invokeAsync([{action:this.action,name:"loadWorkV2"},{action:this.action,name:"getWorkLog"},{action:this.action,name:"getWorkControl"},{action:this.action,name:layout.mobile?"getFormV2Mobile":"getFormV2"}],{success:function(t,r,c,d){e=t,i=r,s=c,o=d,a=!0,n=!0,l()}.bind(this),failure:function(){}.bind(this)},t,t,t,[this.options.formid||this.options.form.id,(new Date).getTime()]):(this.action[layout.mobile?"lookupFormWithWorkMobile":"lookupFormWithWork"](t,function(t){var e=t.data.id;if(t.data.form)o=t,n=!0,l();else{var i=t.data.cacheTag||"";this.action[layout.mobile?"getFormV2Mobile":"getFormV2"](e,i,(function(t){o=t,n=!0,l()}),(function(){n=!0,l()}))}}.bind(this),(function(){n=!0,l()})),o2.Actions.invokeAsync([{action:this.action,name:"loadWorkV2"},{action:this.action,name:"getWorkLog"},{action:this.action,name:"getWorkControl"}],{success:function(t,o,n){e=t,i=o,s=n,a=!0,l()}.bind(this),failure:function(){}.bind(this)},t));MWF.xDesktop.requireApp("process.Xform","$all",(function(){r=!0,l()}))},loadWorkByJob:function(t){MWF.Actions.get("x_processplatform_assemble_surface").listWorkByJob(t,function(t){var e=t.data.workCompletedList.length,i=t.data.workList.length+e;if(1===i)this.options.workId=t.data.workList.length?t.data.workList[0].id:t.data.workCompletedList[0].id,this.loadWork();else if(i>1){var s=this.filterId(t.data.workList,t.data.workCompletedList,this.options.priorityWork);if(s)this.options.workId=s,this.loadWork();else if(this.options.choice){var o=this.createWorksArea();t.data.workList.each(function(t){this.createWorkNode(t,o)}.bind(this)),t.data.workCompletedList.each(function(t){this.createWorkCompletedNode(t,o)}.bind(this)),this.mask&&this.mask.hide(),this.formNode.setStyles(this.css.formNode_bg)}else t.data.workList.length?this.options.workId=t.data.workList[0].id:this.options.workId=t.data.workCompletedList[0].id,this.loadWork()}else layout.sessionPromise.then(function(){this.close()}.bind(this),(function(){}))}.bind(this),function(){}.bind(this))},loadWorkByDraft:function(t,e){o2.Actions.invokeAsync([{action:this.action,name:layout.mobile?"getFormMobile":"getForm"}],{success:function(i){if(i){var s={activity:{},data:e||{},taskList:[],work:t};this.parseData(s,{allowVisit:!0,allowProcessing:!0,allowSave:!0,allowDelete:!0},i.data,[],[],[]),this.mask&&this.mask.hide(),layout.session&&layout.session.user?(this.openWork(),this.unLoading()):layout.sessionPromise&&layout.sessionPromise.then(function(){this.openWork(),this.unLoading()}.bind(this),(function(){}))}}.bind(this),failure:function(){}},[t.form,t.application])},createWorkNode:function(t,e,i){var s=e.getLast(),o=new Element("div",{styles:this.css.workItemNode}).inject(s);new Element("div",{styles:this.css.workItemTitleNode}).inject(o).set("text",t.title);var n=new Element("div",{styles:this.css.workItemInforNode}).inject(o);if(i)n.set("text",this.lp.completedWork);else{new Element("div",{styles:this.css.workItemInforTitleNode,text:this.lp.currentActivity}).inject(n),new Element("div",{styles:this.css.workItemInforContentNode,text:t.activityName}).inject(n),new Element("div",{styles:this.css.workItemInforTitleNode,text:this.lp.currentUsers}).inject(n);var a=[];MWF.Actions.get("x_processplatform_assemble_surface").listTaskByWork(t.id,function(t){t.data.each(function(t){a.push(MWF.name.cn(t.person))}.bind(this));new Element("div",{styles:this.css.workItemInforContentNode,text:a.join(", ")}).inject(n)}.bind(this))}var r=this;o.store("workId",t.id),o.addEvents({mouseover:function(){this.addClass("mainColor_border"),this.setStyles(r.css.workItemNode_over)},mouseout:function(){this.removeClass("mainColor_border"),this.setStyles(r.css.workItemNode)},click:function(){var t=this.retrieve("workId");t&&(r.options.workId=t,r.loadWork())}})},createWorksArea:function(){var t=new Element("div",{styles:this.css.workListArea}).inject(this.formNode);new Element("div",{styles:this.css.workListAreaTitle,text:this.lp.selectWork}).inject(t),new Element("div",{styles:this.css.workListContent}).inject(t);return t},filterId:function(t,e,i){if(!i)return"";if(!t.length&&!e.length)return"";if(t.length){var s=t.filter(function(t){return t.id==i}.bind(this));if(s.length)return s[0].id}return e.length&&(s=e.filter(function(t){return t.id==i}.bind(this))).length?s[0].id:""},parseData:function(t,e,i,s,o,n){var a=t.work.title;this.setTitle(a||this.options.title),this.activity=t.activity,this.data=t.data,this.taskList=t.taskList,this.currentTask=this.getCurrentTaskData(t),this.taskList=t.taskList,this.readList=t.readList,this.routeList=t.routeList,this.work=t.work,this.workCompleted=t.work.completedTime?t.work:null,this.workLogList=s,this.recordList=o,this.attachmentList=n,this.control=e,i&&(i.form?(this.formDataText=i.form.data?MWF.decodeJsonString(i.form.data):"",this.form=this.formDataText?JSON.decode(this.formDataText):null,this.relatedFormMap=i.relatedFormMap,this.relatedScriptMap=i.relatedScriptMap,this.relatedLanguage=i.relatedLanguage,delete i.form.data,this.formInfor=i.form):(this.formDataText=i.data?MWF.decodeJsonString(i.data):"",this.form=this.formDataText?JSON.decode(this.formDataText):null,delete i.data,this.formInfor=i))},loadMobileActions:function(){if(this.control.allowSave||this.control.allowProcessing){this.mobileActionBarNode=new Element("div",{styles:this.css.mobileActionBarNode}).inject(this.node,"after");var t=this.content.getSize().y-40;this.node.setStyles({height:t+"px","min-height":t+"px",overflow:"auto","padding-bottom":"40px"})}this.control.allowSave&&(this.mobileSaveActionNode=new Element("div",{styles:this.css.mobileSaveActionNode,text:this.lp.save}).inject(this.mobileActionBarNode),this.mobileSaveActionNode.addEvents({click:function(){this.appForm.saveWork()}.bind(this),touchstart:function(){this.setStyle("background-color","#EEEEEE")},touchcancel:function(){this.setStyle("background-color","#ffffff")},touchend:function(){this.setStyle("background-color","#ffffff")}}),this.control.allowProcessing&&this.mobileSaveActionNode.setStyles({width:"49%",float:"left"})),this.control.allowProcessing&&(this.mobileProcessActionNode=new Element("div",{styles:this.css.mobileSaveActionNode,text:this.lp.process}).inject(this.mobileActionBarNode),this.mobileProcessActionNode.addEvents({click:function(){this.appForm.processWork()}.bind(this),touchstart:function(){this.setStyle("background-color","#EEEEEE")},touchcancel:function(){this.setStyle("background-color","#ffffff")},touchend:function(){this.setStyle("background-color","#ffffff")}}),this.control.allowSave&&this.mobileProcessActionNode.setStyles({width:"49%",float:"right"}))},errorWork:function(){this.mask&&this.mask.hide(),this.node.set("text","openError")},getCurrentTaskData:function(t){return!t.currentTaskIndex&&0!==t.currentTaskIndex||-1==t.currentTaskIndex?null:(this.options.taskId=this.taskList[t.currentTaskIndex].id,this.taskList[t.currentTaskIndex])},openWork:function(){if(this.form){this.formNode.empty(),this.formNode.setStyles(this.css.formNode);window.location.href;MWF.xDesktop.requireApp("process.Xform","$all",function(){this.appForm=new MWF.APPForm(this.formNode,this.form,{}),this.appForm.businessData={data:this.data,originalData:Object.clone(this.data),taskList:this.taskList,readList:this.readList,work:this.work,workCompleted:this.workCompleted,control:this.control,activity:this.activity,task:this.currentTask,workLogList:this.workLogList,recordList:this.recordList,routeList:this.routeList,attachmentList:this.attachmentList,inheritedAttachmentList:this.inheritedAttachmentList,formInfor:this.formInfor,status:{readonly:this.readonly}},this.appForm.workAction=this.action,this.appForm.app=this,this.appForm.formDataText=this.formDataText,this.$events&&this.$events.queryLoadForm&&this.appForm.addEvent("queryLoad",function(){this.fireEvent("queryLoadForm")}.bind(this)),this.appForm.load(function(){this.mask&&this.mask.hide(),window.o2android&&window.o2android.appFormLoaded&&(layout.appForm=this.appForm,window.o2android.appFormLoaded(JSON.stringify(this.appForm.mobileTools))),window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.appFormLoaded&&(layout.appForm=this.appForm,window.webkit.messageHandlers.appFormLoaded.postMessage(JSON.stringify(this.appForm.mobileTools))),"processTask"==this.options.action&&(this.appForm.processWork(),this.options.action=""),this.fireEvent("postLoadForm")}.bind(this))}.bind(this))}},recordStatus:function(){return{workId:this.options.workId,workCompletedId:this.options.workCompletedId,jobId:this.options.jobId,draftId:this.options.draftId,priorityWork:this.options.priorityWork,readonly:this.readonly}},onPostClose:function(){this.appForm&&(this.appForm.modules.each((function(t){MWF.release(t)})),MWF.release(this.appForm))}}),MWF.xApplication.Selector=MWF.xApplication.Selector||{},o2.xApplication.Selector.package=MWF.O2Selector=new Class({Implements:[Options],options:{count:0,type:"person",title:"",groups:[],roles:[],units:[],unitType:"",values:[],exclude:[],categoryType:"unit",dutyUnitLevelBy:"duty"},initialize:function(t,e,i){if(MWF.xApplication.Selector.LP||MWF.xDesktop.requireApp("Selector","lp."+MWF.language,null,!1),this.loading=!0,e.title||(e.title=MWF.xApplication.Selector.LP.multiSelectTitle),this.setOptions(e),this.container=t,this.options.types&&"array"===typeOf(this.options.types)&&this.options.types.length>0)MWF.xDesktop.requireApp("Selector","MultipleSelector",function(){this.selector=new MWF.xApplication.Selector.MultipleSelector(this.container,this.options),!0!==i&&this.selector.load(),this.loading=!1}.bind(this));else{var s="string"===typeOf(this.options.type)?this.options.type.capitalize():this.options.type;s&&("unit"===s.toLowerCase()&&this.options.unitType?MWF.xDesktop.requireApp("Selector","UnitWithType",function(){this.selector=new MWF.xApplication.Selector.UnitWithType(this.container,e),!0!==i&&this.selector.load(),this.loading=!1}.bind(this)):"identity"===s.toLowerCase()&&this.options.dutys&&this.options.dutys.length&&"duty"===this.options.categoryType.toLowerCase()?MWF.xDesktop.requireApp("Selector","IdentityWidthDuty",function(){this.selector=new MWF.xApplication.Selector.IdentityWidthDuty(this.container,e),!0!==i&&this.selector.load(),this.loading=!1}.bind(this)):"identity"===s.toLowerCase()&&this.options.dutys&&this.options.dutys.length?MWF.xDesktop.requireApp("Selector","IdentityWidthDutyCategoryByUnit",function(){this.selector=new MWF.xApplication.Selector.IdentityWidthDutyCategoryByUnit(this.container,e),!0!==i&&this.selector.load(),this.loading=!1}.bind(this)):MWF.xDesktop.requireApp("Selector",s,function(){this.selector=new MWF.xApplication.Selector[s](this.container,e),!0!==i&&this.selector.load(),this.loading=!1}.bind(this)))}}}),MWF.O2SelectorFilter=new Class({Implements:[Options],options:{count:0,type:"person",title:"Select Person",groups:[],roles:[],units:[],unitType:"",values:[]},initialize:function(t,e){if(this.setOptions(e),this.value=t,this.options.types&&"array"===typeOf(this.options.types)&&this.options.types.length>0)MWF.xDesktop.requireApp("Selector","MultipleSelector",function(){this.selectFilter=new MWF.xApplication.Selector.MultipleSelector.Filter(this.container,this.options)}.bind(this),!1);else{var i="string"===typeOf(this.options.type)?this.options.type.capitalize():this.options.type;i&&("unit"===i.toLowerCase()&&this.options.unitType?MWF.xDesktop.requireApp("Selector","UnitWithType",function(){this.selector=new MWF.xApplication.Selector.UnitWithType.Filter(this.container,e),this.selector.load()}.bind(this)):"identity"===i.toLowerCase()&&this.options.dutys&&this.options.dutys.length&&"duty"===this.options.categoryType.toLowerCase()?MWF.xDesktop.requireApp("Selector","IdentityWidthDuty",function(){this.selectFilter=new MWF.xApplication.Selector.IdentityWidthDuty.Filter(this.value,e)}.bind(this),!1):"identity"===i.toLowerCase()&&this.options.dutys&&this.options.dutys.length?MWF.xDesktop.requireApp("Selector","IdentityWidthDutyCategoryByUnit",function(){this.selectFilter=new MWF.xApplication.Selector.IdentityWidthDutyCategoryByUnit.Filter(this.value,e)}.bind(this)):MWF.xDesktop.requireApp("Selector",i,function(){this.selectFilter=new MWF.xApplication.Selector[i].Filter(this.value,e)}.bind(this),!1))}},filter:function(t,e){return this.selectFilter.filter(t,e)}}),function(){var t=function(t,e){var i,s=(i="string"===typeOf(t)?(t={id:t}).id:t.distinguishedName||t.name||t.id).length;switch(i.substring(s-1,s)){case"U":new o2.widget.O2Unit(t,e,{style:"xform"});break;case"I":new o2.widget.O2Identity(t,e,{style:"xform"});break;case"G":new o2.widget.O2Group(t,e,{style:"xform"});break;case"P":new o2.widget.O2Person(t,e,{style:"xform"});break;case"R":new o2.widget.O2Role(t,e,{style:"xform"})}};Element.prototype.setSelectPerson=function(e,i){i.types&&(i.type=""),i.onComplete=function(e){o2.require("o2.widget.O2Identity",function(){i.values=[],this.empty(),e.each(function(e){i.values.push(e.data),t(e.data,this),i.selectItem&&i.selectItem(e)}.bind(this)),this.store("data-value",i.values)}.bind(this))}.bind(this),i.values&&i.values.each(function(e){this.store("data-value",i.values),t(e,this)}.bind(this)),this.addEvent("click",function(){var t=this.getZIndex();i.zIndex=t+1,new MWF.O2Selector(e,i)}.bind(this))}}(),MWF.xApplication.Selector=MWF.xApplication.Selector||{},MWF.xApplication.Selector.Person=new Class({Extends:MWF.widget.Common,Implements:[Options,Events],options:{style:"default",count:0,title:"",groups:[],roles:[],values:[],exclude:[],exclude:[],zIndex:1e3,expand:!0,embedded:!1,selectAllEnable:!1,selectAllRange:"direct",level1Indent:10,indent:10,hasLetter:!0,hasTop:!1,hasShuttle:!1,searchbarInTopNode:!0,hasSelectedSearchbar:!1,noSelectedContainer:!1,contentUrl:"",injectToBody:!1,selectSingleItem:!1,hiddenEmptyCategory:!1,flatCategory:!1,selectType:"person",isCheckStatus:!1,showSelectedCount:!1,itemHeight:29,identityItemWidth:0,storeRange:"full",showEmptyText:!0},setInitTitle:function(){this.setOptions({title:MWF.xApplication.Selector.LP.selectPerson})},initialize:function(t,e){this.active=!0,this.setOptions(e),this.options.title||this.setInitTitle(),this.path="../x_component_Selector/$Selector/",this.cssPath="../x_component_Selector/$Selector/"+this.options.style+"/css.wcss",this._loadCss(!0),this.container=$(t),Object.defineProperties(this,{orgAction:{get:function(){return o2.Actions.get("x_organization_assemble_control")}},processAction:{get:function(){return o2.Actions.get("x_processplatform_assemble_surface")}},designerAction:{get:function(){return o2.Actions.get("x_processplatform_assemble_designer")}},portalAction:{get:function(){return o2.Actions.get("x_portal_assemble_surface")}},portalDesignerAction:{get:function(){return o2.Actions.get("x_portal_assemble_designer")}},cmsAction:{get:function(){return o2.Actions.get("x_cms_assemble_control")}},queryAction:{get:function(){return o2.Actions.get("x_query_assemble_designer")}}}),this.lastPeople="",this.pageCount="13",this.selectedItems=[],this.items=[],this.subCategorys=[],this.subItems=[],this.options.values||(this.options.values=[]),this._init()},_init:function(){this.selectType="person",this.className="Person"},load:function(){this.fireEvent("queryLoad",[this]),this.options.contentUrl?this.loadWithUrl():(layout.mobile?this.loadMobile():this.loadPc(),this.fireEvent("load"))},loadMobile:function(){this.maskRelativeNode=$(document.body),this.maskRelativeNode.mask({destroyOnHide:!0,style:this.css.maskNode}),this.node=new Element("div",{styles:this.css.containerNodeMobile}),this.node.setStyle("z-index",this.options.zIndex.toInt()+1),this.node.setStyle("height",$(document.body).getSize().y+"px"),this.titleNode=new Element("div",{styles:this.css.titleNodeMobile}).inject(this.node),this.titleCancelActionNode=new Element("div",{styles:this.css.titleCancelActionNodeMobile,text:MWF.SelectorLP.back}).inject(this.titleNode),this.titleOkActionNode=new Element("div",{styles:this.css.titleOkActionNodeMobile,text:MWF.SelectorLP.ok}).inject(this.titleNode),this.titleTextNode=new Element("div",{styles:this.css.titleTextNodeMobile,text:this.options.title}).inject(this.titleNode),this.contentNode=new Element("div",{styles:this.css.contentNode}).inject(this.node);var t=$(document.body).getSize().y-40;this.contentNode.setStyle("height",t+"px"),this.loadContent(),this.node.inject($(document.body)),this.node.setStyles({top:"0px",left:"0px"}),this.setEvent()},setMaskResize:function(){var t=this.container.getSize();this.mask.resize(),this.maskInterval=window.setInterval(function(){var e=this.container.getSize();t.x===e.x&&t.y===e.y||(this.mask.position(),this.mask.resize(),t.x=e.x,t.y=e.y)}.bind(this),66)},loadPc:function(){if(this.options.embedded)this.node=new Element("div",{styles:this.css.containerNode_embedded,events:{click:function(t){t.stopPropagation()},mousedown:function(t){t.stopPropagation()},mouseover:function(t){t.stopPropagation()},mouseout:function(t){t.stopPropagation()},keydown:function(t){t.stopPropagation()}}}),this.contentNode=new Element("div",{styles:this.css.contentNode_embedded?this.css.contentNode_embedded:this.css.contentNode}).inject(this.node),this.loadContent(),(this.options.width||this.options.height)&&this.setSize(),this.node.inject(this.container);else{this.css.maskNode["z-index"]=this.options.zIndex;var t=this.container.getPosition(this.container.getOffsetParent());this.mask=new Mask(this.container,{destroyOnHide:!0,style:this.css.maskNode,useIframeShim:!0,iframeShimOptions:{browsers:!0},onShow:function(){this.shim.shim.setStyles({opacity:0,top:t.y+"px",left:t.x+"px"})}}),this.mask.show(),this.setMaskResize(),this.node=new Element("div",{styles:this.options.noSelectedContainer?this.css.containerNodeSingle:this.css.containerNode,events:{click:function(t){t.stopPropagation()},mousedown:function(t){t.stopPropagation()},mouseover:function(t){t.stopPropagation()},mouseout:function(t){t.stopPropagation()},keydown:function(t){t.stopPropagation()}}}),this.node.setStyle("z-index",this.options.zIndex.toInt()+1),this.titleNode=new Element("div.titleNode",{styles:this.css.titleNode}).inject(this.node),this.titleActionNode=new Element("div",{styles:this.css.titleActionNode}).inject(this.titleNode),this.titleTextNode=new Element("div",{styles:this.css.titleTextNode,text:this.options.title}).inject(this.titleNode),this.contentNode=new Element("div",{styles:this.css.contentNode}).inject(this.node),this.loadContent(),this.actionNode=new Element("div",{styles:this.css.actionNode}).inject(this.node),this.loadAction(),this.node.inject(this.container),this.node.position({relativeTo:this.container,position:"center",edge:"center"});var e=this.container.getSize(),i=this.node.getSize();this.node.makeDraggable({handle:this.titleNode,limit:{x:[0,e.x-i.x],y:[0,e.y-i.y]}}),(this.options.width||this.options.height)&&this.setSize(),this.setEvent()}},loadWithUrl:function(){new Request.HTML({url:this.options.contentUrl,method:"GET",async:!1,onSuccess:function(t,e,i,s){this.node=t[0],this.loadContentWithHTML(),this.fireEvent("load")}.bind(this),onFailure:function(t){alert(t)}}).send()},loadContentWithHTML:function(){var t=this.options.injectToBody?$(document.body):this.container;this.options.embedded||(this.maskRelativeNode=t,this.css.maskNode["z-index"]=this.options.zIndex,this.maskRelativeNode.mask({destroyOnHide:!0,style:this.css.maskNode})),this.options.embedded||(this.node.setStyles(this.css.containerNodeMobile),this.node.setStyle("z-index",this.options.zIndex.toInt()+1)),this.node.setStyle("height",t.getSize().y+"px"),this.titleNode=this.node.getElement(".MWF_selector_titleNode"),this.titleTextNode=this.node.getElement(".MWF_selector_titleTextNode"),this.titleCancelActionNode=this.node.getElement(".MWF_selector_titleCancelActionNode"),this.titleOkActionNode=this.node.getElement(".MWF_selector_titleOkActionNode"),this.contentNode=this.node.getElement(".MWF_selector_contentNode"),this.selectNode=this.node.getElement(".MWF_selector_selectNode"),this.searchInputDiv=this.node.getElement(".MWF_selector_searchInputDiv"),this.searchInput=this.node.getElement(".MWF_selector_searchInput"),this.flatCategoryScrollNode=this.node.getElement(".MWF_selector_flatCategoryScrollNode"),this.flatCategoryNode=this.node.getElement(".MWF_selector_flatCategoryNode"),this.options.flatCategory&&this.flatCategoryScrollNode&&(this.isFlatCategory=!0,this.flatSubCategoryNodeList=[]),this.letterAreaNode=this.node.getElement(".MWF_selector_letterAreaNode"),this.itemAreaScrollNode=this.node.getElement(".MWF_selector_itemAreaScrollNode"),this.itemAreaNode=this.node.getElement(".MWF_selector_itemAreaNode"),this.itemSearchAreaScrollNode=this.node.getElement(".MWF_selector_itemSearchAreaScrollNode"),this.itemSearchAreaNode=this.node.getElement(".MWF_selector_itemSearchAreaNode"),this.selectedScrollNode=this.node.getElement(".MWF_selector_selectedScrollNode"),this.selectedNode=this.node.getElement(".MWF_selector_selectedNode"),this.selectedItemSearchAreaNode=this.node.getElement(".MWF_selector_selectedItemSearchAreaNode"),this.actionNode=this.node.getElement(".MWF_selector_actionNode"),this.okActionNode=this.node.getElement(".MWF_selector_okActionNode"),this.cancelActionNode=this.node.getElement(".MWF_selector_cancelActionNode"),this.titleNode&&this.titleNode.setStyles(this.css.titleNodeMobile),this.titleTextNode&&(this.titleTextNode.setStyles(this.css.titleTextNodeMobile),this.options.title&&this.titleTextNode.set("text",this.options.title)),this.titleCancelActionNode&&this.titleCancelActionNode.setStyles(this.css.titleCancelActionNodeMobile),this.titleOkActionNode&&this.titleOkActionNode.setStyles(this.css.titleOkActionNodeMobile),this.contentNode&&this.contentNode.setStyles(this.css.contentNode),this.selectNode&&this.selectNode.setStyles(this.css.selectNodeMobile),this.searchInputDiv&&this.searchInputDiv.setStyles(this.css.searchInputDiv),this.searchInput&&this.searchInput.setStyles(1===this.options.count.toInt()||this.options.noSelectedContainer?this.css.searchInputSingle:this.css.searchInput),this.letterAreaNode&&this.letterAreaNode.setStyles(this.css.letterAreaNode),this.itemAreaScrollNode&&this.itemAreaScrollNode.setStyles(this.css.itemAreaScrollNode),this.itemAreaNode&&this.itemAreaNode.setStyles(this.css.itemAreaNode),this.itemSearchAreaScrollNode&&this.itemSearchAreaScrollNode.setStyles(this.css.itemSearchAreaScrollNode),this.itemSearchAreaNode&&this.itemSearchAreaNode.setStyles(this.css.itemAreaNode),this.selectedScrollNode&&this.selectedScrollNode.setStyles(this.css.selectedScrollNode),this.selectedNode&&this.selectedNode.setStyles(this.css.selectedNode),this.selectedItemSearchAreaNode&&this.selectedItemSearchAreaNode.setStyles(this.css.itemAreaNode),this.actionNode&&this.actionNode.setStyles(this.css.actionNode),this.okActionNode&&(this.okActionNode.setStyles(this.css.okActionNode),this.okActionNode.set("text",MWF.SelectorLP.ok)),this.cancelActionNode&&(this.cancelActionNode.setStyles(this.css.cancelActionNode),this.cancelActionNode.set("text",MWF.SelectorLP.cancel)),this.loadContent(),this.actionNode&&this.loadAction(),this.node.inject(t),this.options.embedded||this.node.setStyles({top:"0px",left:"0px"}),this.setEvent()},getUnitIdentityCount:function(){},getUnitSelecteIndentityCount:function(t){var e;return this.selectedItems.each(function(i){0===i.data.unitLevelName.indexOf(t)&&e++}.bind(this)),e},getGroupNestCount:function(){},getGroupSelecteIndentityCount:function(t){var e;return this.selectedItems.each(function(t){0===t.data.unitLevelName.indexOf(unitLevelName)&&e++}.bind(this)),e},setEvent:function(){this.titleActionNode&&this.titleActionNode.addEvent("click",function(){this.fireEvent("cancel"),this.close()}.bind(this)),this.titleCancelActionNode&&this.titleCancelActionNode.addEvent("click",function(){this.fireEvent("cancel"),this.close()}.bind(this)),this.titleOkActionNode&&this.titleOkActionNode.addEvent("click",function(){this.fireEvent("complete",[this.selectedItems]),!1!==this.options.closeOnclickOk&&this.close()}.bind(this))},close:function(){this.fireEvent("close"),this.node.destroy(),this.options.embedded||(this.maskRelativeNode||this.container).unmask(),this.maskInterval&&(window.clearInterval(this.maskInterval),this.maskInterval=null),this.active=!1,MWF.release(this)},loadAction:function(){this.okActionNode||(this.okActionNode=new Element("button",{styles:this.css.okActionNode,text:MWF.SelectorLP.ok}).inject(this.actionNode)),this.cancelActionNode||(this.cancelActionNode=new Element("button",{styles:this.css.cancelActionNode,text:MWF.SelectorLP.cancel}).inject(this.actionNode)),this.okActionNode.addEvent("click",function(){this.fireEvent("complete",[this.selectedItems]),!1!==this.options.closeOnclickOk&&this.close()}.bind(this)),this.cancelActionNode.addEvent("click",function(){this.fireEvent("cancel"),this.close()}.bind(this))},loadContent:function(t,e){this.fireEvent("queryLoadContent",[this]),t&&(this.contentNode=t),this.options.contentUrl||e?(this.loadSelectedNodeHTML(),this.loadSelectNodeHTML(t)):layout.mobile?(this.loadSelectedNodeMobile(),this.loadSelectNodeMobile()):(this.loadSelectNode(),this.options.hasShuttle&&this.loadShuttleNode(),this.loadSelectedNode()),this.fireEvent("postLoadContent",[this])},getOffsetX:function(t){return(t.getStyle("margin-left").toInt()||0)+(t.getStyle("margin-right").toInt()||0)+(t.getStyle("padding-left").toInt()||0)+(t.getStyle("padding-right").toInt()||0)+(t.getStyle("border-left-width").toInt()||0)+(t.getStyle("border-right-width").toInt()||0)},getOffsetY:function(t){return(t.getStyle("margin-top").toInt()||0)+(t.getStyle("margin-bottom").toInt()||0)+(t.getStyle("padding-top").toInt()||0)+(t.getStyle("padding-bottom").toInt()||0)+(t.getStyle("border-top-width").toInt()||0)+(t.getStyle("border-bottom-width").toInt()||0)},loadSelectNodeHTML:function(t){var e,i;if(t)0===(i=(e=t.getSize()).y)&&(i=t.getStyle("height").toInt());else{if(0===(e=(this.options.injectToBody?$(document.body):this.container).getSize()).y&&(e.y=$(document.body).getSize().y),this.node){var s=this.node.getStyle("zoom").toInt()||0;s&&(e.x=100*e.x/s,e.y=100*e.y/s),this.node.setStyles({width:e.x+"px",height:e.y+"px"})}i=e.y-this.getOffsetY(this.contentNode),this.titleNode&&(i=i-this.getOffsetY(this.titleNode)-(this.titleNode.getStyle("height").toInt()||0)),this.actionNode&&(i=i-this.getOffsetY(this.actionNode)-(this.actionNode.getStyle("height").toInt()||0)),this.contentNode.setStyle("height",i+"px")}window.location.href.toLowerCase().indexOf("workmobilewithaction.html");this.selectNode.setStyle("height",i+"px"),this.searchInput&&(this.initSearchInput(),i=i-this.getOffsetY(this.searchInputDiv)-(this.searchInputDiv.getStyle("height").toInt()||0)),this.options.hasLetter&&this.letterAreaNode&&(width=e.x-18,this.letterAreaNode.setStyle("width",width+"px"),this.loadLetters(),i=i-this.getOffsetY(this.letterAreaNode)-(this.letterAreaNode.getStyle("height").toInt()||0)),this.itemAreaScrollNode.setStyle("height",i+"px"),this.itemAreaScrollNode.setStyle("overflow","auto"),this.itemSearchAreaScrollNode&&this.itemSearchAreaScrollNode.setStyles({display:"none",height:i+"px",overflow:"hidden"}),this.itemSearchAreaNode.setStyle("display","none"),this.initLoadSelectItems(),this.checkLoadSelectItems()},loadSelectNodeMobile:function(){this.selectNode=new Element("div.selectNode",{styles:this.css.selectNodeMobile}).inject(this.contentNode);var t,e=this.container.getSize(),i=$(document.body).getSize(),s={x:Math.min(e.x,i.x),y:Math.min(e.y,i.y)},o=window.location.href.toLowerCase().indexOf("workmobilewithaction.html")>-1;t=o?s.y-40-20-6-20:s.y,this.selectNode.setStyle("height",t+"px"),this.searchInputDiv=new Element("div.searchInputDiv",{styles:this.css.searchInputDiv}).inject(this.selectNode),this.searchInput=new Element("input.searchInput",{styles:1===this.options.count.toInt()||this.options.noSelectedContainer?this.css.searchInputSingle:this.css.searchInput,type:"text"}).inject(this.searchInputDiv);var n=s.x-20-18;this.searchInput.setStyle("width",n+"px"),this.searchInput.setStyle("height","20px"),this.initSearchInput(),this.options.hasLetter&&(this.letterAreaNode=new Element("div",{styles:this.css.letterAreaMobileNode}).inject(this.selectNode),n=s.x-18,this.letterAreaNode.setStyle("width",n+"px"),this.loadLetters()),this.itemAreaScrollNode=new Element("div.itemAreaScrollNode",{styles:this.css.itemAreaScrollNode}).inject(this.selectNode),t=o?s.y-40-20-78-20:s.y-42-31-40,this.itemAreaScrollNode.setStyle("height",t+"px"),this.itemAreaScrollNode.setStyle("overflow","auto"),this.itemAreaNode=new Element("div.itemAreaNode",{styles:this.css.itemAreaNode}).inject(this.itemAreaScrollNode),this.itemSearchAreaNode=new Element("div.itemSearchAreaNode",{styles:this.css.itemAreaNode}).inject(this.itemAreaScrollNode),this.itemSearchAreaNode.setStyle("display","none"),this.initLoadSelectItems(),this.checkLoadSelectItems()},loadSelectedNodeHTML:function(){this.setSelectedItem(),this.selectedScrollNode&&this.selectedScrollNode.setStyle("display","none")},checkLoadSelectItems:function(){this.options.groups.length||this.options.roles.length?this.loadSelectItemsByCondition():this.loadSelectItems()},loadShuttleNode:function(){this.shuttleNode||(this.shuttleNode=new Element("div.shuttleNode",{styles:this.css.shuttleNode}).inject(this.contentNode),this.shuttleInnerNode=new Element("div.shuttleInnerNode",{styles:this.css.shuttleInnerNode}).inject(this.shuttleNode),this.goRightNode=new Element("div.goRightNode",{styles:this.css.goRightNode}).inject(this.shuttleInnerNode),this.goLeftNode=new Element("div.goLeftNode",{styles:this.css.goLeftNode}).inject(this.shuttleInnerNode))},loadSelectNode:function(){this.selectNode=new Element("div.selectNode",{styles:this.css.selectNode}).inject(this.contentNode),this.options.hasTop&&(this.selectTopNode=new Element("div.selectTopNode",{styles:this.css.selectTopNode}).inject(this.selectNode),this.selectTopTextNode=new Element("div",{text:MWF.SelectorLP.waitingSelect,styles:this.css.selectTopTextNode}).inject(this.selectTopNode)),this.options.searchbarInTopNode?this.searchInputDiv=new Element("div",{styles:this.css.searchInputDiv}).inject(this.selectTopNode||this.selectNode):this.searchInputDiv=new Element("div.searchInputDiv",{styles:this.css.searchInputDiv}).inject(this.selectNode),this.searchInput=new Element("input",{styles:this.css.searchInput,placeholder:MWF.SelectorLP.searchDescription,type:"text"}).inject(this.searchInputDiv),this.initSearchInput(),this.options.hasLetter&&(this.letterAreaNode=new Element("div",{styles:this.css.letterAreaNode}).inject(this.selectNode),this.loadLetters()),this.itemAreaScrollNode=new Element("div",{styles:this.css.itemAreaScrollNode}).inject(this.selectNode),this.itemAreaNode=new Element("div",{styles:this.css.itemAreaNode}).inject(this.itemAreaScrollNode),this.itemSearchAreaNode=new Element("div",{styles:this.css.itemAreaNode}).inject(this.itemAreaScrollNode),this.itemSearchAreaNode.setStyle("display","none"),this.loadSelectNodeScroll(),this.initLoadSelectItems(),this.checkLoadSelectItems()},loadSelectNodeScroll:function(){var t=this.itemAreaScrollNode.getStyle("overflow-y");("string"!==typeOf(t)||"auto"!==t.toLowerCase()&&"scroll"!==t.toLowerCase())&&MWF.require("MWF.widget.ScrollBar",function(){var t=this;new MWF.widget.ScrollBar(this.itemAreaScrollNode,{style:"xApp_Organization_Explorer",where:"before",distance:30,friction:4,axis:{x:!1,y:!0},onScroll:function(e){t._scrollEvent(e)}})}.bind(this))},initSearchInput:function(){this.searchInput.addEvents({keydown:function(t){var e=this.searchInput.retrieve("searchTimer",null);e&&(window.clearTimeout(e),this.searchInput.eliminate("searchTimer")),e=window.setTimeout(function(){this.search()}.bind(this),800),this.searchInput.store("searchTimer",e)}.bind(this),change:function(t){this.searchInput.get("value")||this.initSearchArea(!1)}.bind(this),blur:function(){this.searchInput.get("value")||this.initSearchArea(!1)}.bind(this)})},initSearchArea:function(t){this.searchItems=[],t?(this.itemSearchAreaNode.empty(),this.itemAreaNode.setStyle("display","none"),this.itemSearchAreaNode.getParent()!==this.itemAreaScrollNode&&this.itemAreaScrollNode.setStyle("display","none"),this.flatCategoryScrollNode&&this.flatCategoryScrollNode.setStyle("display","none"),this.itemSearchAreaScrollNode&&this.itemSearchAreaScrollNode.setStyle("display","block"),this.itemSearchAreaNode.setStyle("display","block")):(this.itemAreaScrollNode.setStyle("display","block"),this.itemAreaNode.setStyle("display","block"),this.flatCategoryScrollNode&&this.flatSubCategoryNodeList&&this.flatSubCategoryNodeList.length>1&&this.flatCategoryScrollNode.setStyle("display","block"),this.itemSearchAreaScrollNode&&this.itemSearchAreaScrollNode.setStyle("display","none"),this.itemSearchAreaNode.setStyle("display","none"))},search:function(){var t;this.options.groups.length||this.options.roles.length||this.options.forceSearchInItem?(t=this.searchInput.get("value"))?(this.initSearchArea(!0),this.searchInItems(t)):this.initSearchArea(!1):(t=this.searchInput.get("value"))?this._listItemByKey(function(t){this.initSearchArea(!0),t.data.each(function(t){if(!this.isExcluded(t)){var e=this._newItemSearch(t,this,this.itemSearchAreaNode);this.searchItems.push(e)}}.bind(this))}.bind(this),null,t):this.initSearchArea(!1)},searchInItems:function(t){var e=[];return this.createItemsSearchData(function(){var i=t.toLowerCase();this.itemsSearchData.each(function(t){var s=t.text+"#"+t.pinyin+"#"+t.firstPY,o=t.data.distinguishedName||t.data.id||t.data.name||t.data.text;-1!==s.indexOf(i)&&-1===e.indexOf(o)&&(this._newItem(t.data,this,this.itemSearchAreaNode),e.push(o))}.bind(this))}.bind(this)),e},createItemsSearchData:function(t){this.itemsSearchData?t&&t():(this.itemsSearchData=[],MWF.require("MWF.widget.PinYin",function(){var e=[];this.items.each(function(t){var i=t.data.distinguishedName||t.data.id||t.data.name||t.data.text;if(-1==e.indexOf(i)){var s=t._getShowName().toLowerCase(),o=s.toPY().toLowerCase(),n=s.toPYFirst().toLowerCase();this.itemsSearchData.push({text:s,pinyin:o,firstPY:n,data:t.data}),e.push(i)}}.bind(this)),delete e,t&&t()}.bind(this)))},initSelectedSearchInput:function(){this.selectedSearchInput.addEvents({keydown:function(t){var e=this.selectedSearchInput.retrieve("searchTimer",null);e&&(window.clearTimeout(e),this.selectedSearchInput.eliminate("searchTimer")),e=window.setTimeout(function(){this.selectedSearch()}.bind(this),800),this.selectedSearchInput.store("searchTimer",e)}.bind(this),change:function(t){this.selectedSearchInput.get("value")||this.selectedSearch()}.bind(this),blur:function(){this.selectedSearchInput.get("value")||this.selectedSearch()}.bind(this)})},selectedSearch:function(){var t=this.selectedSearchInput.get("value");t?this.selectedSearchInItems(t):this.showAllSelectedItem()},selectedSearchInItems:function(t){var e=t.toLowerCase();MWF.require("MWF.widget.PinYin",function(){this.selectedItems.each(function(t){if(!t.searchedText){var i=t._getShowName().toLowerCase(),s=i.toPY().toLowerCase(),o=i.toPYFirst().toLowerCase();t.searchedText=i+"#"+s+"#"+o}-1!==t.searchedText.indexOf(e)?t.node.show():t.node.hide()}.bind(this))}.bind(this),null,!1)},showAllSelectedItem:function(){this.selectedItems.each((function(t){t.node.show()}))},loadSelectedNode:function(t){this.selectedContainerNode||(this.selectedContainerNode=new Element("div",{styles:this.css.selectedContainerNode}).inject(this.contentNode),this.options.noSelectedContainer&&this.selectedContainerNode.hide(),this.options.hasTop&&(this.selectedTopNode=new Element("div",{styles:this.css.selectedTopNode}).inject(this.selectedContainerNode),this.selectedTopTextNode=new Element("div",{text:MWF.SelectorLP.selected,styles:this.css.selectedTopTextNode}).inject(this.selectedTopNode),this.emptySelectedNode=new Element("div",{text:MWF.SelectorLP.empty,styles:this.css.selectedTopActionNode,events:{click:function(){this.emptySelectedItems()}.bind(this)}}).inject(this.selectedTopNode)),this.options.hasSelectedSearchbar&&(this.options.searchbarInTopNode?this.selectedSearchInputDiv=new Element("div",{styles:this.css.searchInputDiv}).inject(this.selectedTopNode||this.selectedContainerNode):this.selectedSearchInputDiv=new Element("div.selectedSearchInputDiv",{styles:this.css.searchInputDiv}).inject(this.selectedContainerNode),this.selectedSearchInput=new Element("input",{styles:this.css.searchInput,placeholder:MWF.SelectorLP.searchDescription,type:"text"}).inject(this.selectedSearchInputDiv),this.initSelectedSearchInput()),this.selectedScrollNode=new Element("div.selectedScrollNode",{styles:this.css.selectedScrollNode}).inject(this.selectedContainerNode),this.selectedNode=new Element("div.selectedNode",{styles:this.css.selectedNode}).inject(this.selectedScrollNode),this.options.hasSelectedSearchbar&&(this.selectedItemSearchAreaNode=new Element("div.selectedItemSearchAreaNode",{styles:this.css.itemAreaNode}).inject(this.selectedScrollNode),this.selectedItemSearchAreaNode.setStyle("display","none")),this.setSelectedItem(),this.loadSelectedNodeScroll(),t&&t())},emptySelectedItems:function(){for(;this.selectedItems.length;)this.selectedItems[0].clickItem()},loadSelectedNodeScroll:function(){var t=this.selectedScrollNode.getStyle("overflow-y");("string"!==typeOf(t)||"auto"!==t.toLowerCase()&&"scroll"!==t.toLowerCase())&&MWF.require("MWF.widget.ScrollBar",function(){new MWF.widget.ScrollBar(this.selectedScrollNode,{style:"xApp_Organization_Explorer",where:"before",distance:100,friction:4,axis:{x:!1,y:!0}})}.bind(this))},loadSelectedNodeMobile:function(){this.selectedScrollNode=new Element("div.selectedScrollNode",{styles:this.css.selectedScrollNode}).inject(this.contentNode),this.selectedNode=new Element("div.selectedNode",{styles:this.css.selectedNode}).inject(this.selectedScrollNode),this.setSelectedItem(),this.selectedScrollNode.setStyle("display","none")},setSelectedItem:function(){this.options.values.length&&this.options.values.each(function(t,e){"object"===typeOf(t)?this.selectedItems.push(this._newItemSelected(t,this,null)):this._getItem(function(t){this.options.values[e]=t.data,this.selectedItems.push(this._newItemSelected(t.data,this,null))}.bind(this),null,t,!1)}.bind(this))},loadLetters:function(){var t=this;letters=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];var e=this.css.letterNode,i=this.css.letterNode_over;if(layout.mobile){e=this.css.letterNode_mobile||e,i=this.css.letterNode_mobile_over||i;var s=this.container.getSize(),o=layout.mobile?(s.x-18)/13:(s.x-20-4-18)/13;e.width=o+"px",i.width=o+"px"}letters.each(function(s){var o=new Element("div",{styles:e,text:s}).inject(this.letterAreaNode);layout.mobile?o.addEvents({click:function(){t.listPersonByPinyin(this)}}):o.addEvents({mouseover:function(t){t.target.setStyles(i);var e=new Element("div",{styles:this.css.letterShowNode,text:t.target.get("text")}).inject(this.selectNode);e.position({relativeTo:this.itemAreaScrollNode,position:"center",edge:"center"}),t.target.store("showNode",e)}.bind(this),mouseout:function(t){t.target.retrieve("showNode").destroy(),t.target.setStyles(e)}.bind(this),click:function(){t.listPersonByPinyin(this)}})}.bind(this))},listPersonByPinyin:function(t){this.searchInput.focus();var e=this.searchInput.get("value");e+=t.get("text"),this.searchInput.set("value",e),this.options.groups.length||this.options.roles.length?e?(this.initSearchArea(!0),this.searchInItems(e)):this.initSearchArea(!1):e&&this._listItemByPinyin(function(t){this.initSearchArea(!0),t.data.each(function(t){this.isExcluded(t)||this._newItemSearch(t,this,this.itemSearchAreaNode)}.bind(this))}.bind(this),null,e.toLowerCase())},initLoadSelectItems:function(){this.loaddingItems=!1,this.isItemLoaded=!1,this.loadItemsQueue=0,this.initSearchArea(!1)},loadSelectItems:function(t,e){if(!this.isItemLoaded)if(this.loaddingItems)t&&this.loadItemsQueue++;else{this.loaddingItems=!0;this._listItemNext(this.getLastLoadedItemId(),20,function(i){if(i.data.length){var s=0;i.data.each(function(t,e){if(this.isExcluded(t))s++,e+1===20&&(this.tailExcludeItemId=t.distinguishedName);else{var i=this._newItem(t,this,this.itemAreaNode);this.items.push(i),e+1===20&&(this.tailExcludeItemId=null)}}.bind(this)),this.loaddingItems=!1,e?20-e-s<0&&(s=e+s-20,this.loadItemsQueue++):s>0&&this.loadItemsQueue++,i.data.length<20?this.isItemLoaded=!0:this.loadItemsQueue>0&&(this.loadItemsQueue--,this.loadSelectItems(t,s))}else this.isItemLoaded=!0,this.loaddingItems=!1;this.afterLoadSelectItem&&this.afterLoadSelectItem()}.bind(this))}},getLastLoadedItemId:function(){return this.tailExcludeItemId?this.tailExcludeItemId:this.items.length?this.items[this.items.length-1].data.distinguishedName:"(0)"},loadSelectItemsByCondition:function(){this.options.groups.each(function(t){this.orgAction.listGroupByKey(function(t){if(t.data.length){var e=t.data[0],i=this._newItemCategory("ItemGroupCategory",e,this,this.itemAreaNode);this.subCategorys.push(i),this._getChildrenItemIds(e).each(function(t){this._getItem(function(t){if(!this.isExcluded(t.data)){var e=this._newItem(t.data,this,i.children);this.items.push(e)}}.bind(this),null,t)}.bind(this))}}.bind(this),null,t)}.bind(this)),this.options.roles.each(function(t){this.orgAction.listRoleByKey(function(t){if(t.data.length){var e=t.data[0],i=this._newItemCategory("ItemRoleCategory",e,this,this.itemAreaNode);this.subCategorys.push(i),this._getChildrenItemIds(e).each(function(t){this._getItem(function(t){if(!this.isExcluded(t.data)){var e=this._newItem(t.data,this,i.children);this.items.push(e)}}.bind(this),null,t)}.bind(this))}}.bind(this),null,t)}.bind(this))},isExcluded:function(t){if(0===this.options.exclude.length)return!1;this.excludeFlagMap||(this.excludeFlagMap={},this.options.exclude.each(function(t){t&&(this.excludeFlagMap["string"===typeOf(t)?t:t.distinguishedName||t.id||t.unique||t.employee||t.levelName]=!0)}.bind(this)));var e=this.excludeFlagMap;return t.distinguishedName&&e[t.distinguishedName]||t.id&&e[t.id]||t.unique&&e[t.unique]||t.employee&&e[t.employee]||t.levelName&&e[t.levelName]},_getChildrenItemIds:function(t){return t.personList},_newItemCategory:function(t,e,i,s){return new MWF.xApplication.Selector.Person[t](e,i,s)},_listItemByKey:function(t,e,i){this.orgAction.listPersonByKey(function(e){t&&t.apply(this,[e])}.bind(this),e,i)},_getItem:function(t,e,i,s){this.orgAction.getPerson(function(e){t&&t.apply(this,[e])}.bind(this),e,"string"===typeOf(i)?i:i.distinguishedName,s)},_newItemSelected:function(t,e,i,s){return new MWF.xApplication.Selector.Person.ItemSelected(t,e,i,s)},_listItemByPinyin:function(t,e,i){this.orgAction.listPersonByPinyin(function(e){t&&t.apply(this,[e])}.bind(this),e,i)},_newItem:function(t,e,i){return new MWF.xApplication.Selector.Person.Item(t,e,i)},_newItemSearch:function(t,e,i){return this._newItem(t,e,i)},_listItemNext:function(t,e,i){this.orgAction.listPersonNext(t,e,function(t){i&&i.apply(this,[t])}.bind(this))},_scrollEvent:function(t){if(!this.options.groups.length&&!this.options.roles.length){var e=this.itemAreaScrollNode.getScrollSize(),i=this.itemAreaScrollNode.getSize();t+30>e.y-i.y&&(this.isItemLoaded||this.loadSelectItems())}},afterLoadSelectItem:function(){0===this.items.length&&0===this.subItems.length&&0===this.subCategorys.length&&(this.noSelectableItemTextDiv=new Element("div",{text:MWF.SelectorLP.noSelectableItemText,styles:this.css.noSelectableItemText}).inject(this.itemAreaNode)),this.options.selectSingleItem&&this.selectSingleItem(),this.fireEvent("afterLoadSelectItem",[this])},selectSingleItem:function(){this.options.contentUrl||layout.mobile?this._selectSingleItem():(this.options.hasShuttle&&!this.shuttleNode&&this.loadShuttleNode(),this.selectedContainerNode?this._selectSingleItem():this.loadSelectedNode(function(){this._selectSingleItem()}.bind(this)))},_selectSingleItem:function(){var t=this,e=function(){1===this.items.length||1===this.subItems.length?1===this.items.length&&0===this.subItems.length?(this.items[0].isSelected||this.items[0].clickItem(),this.fireEvent("afterSelectSingleItem",[this,this.items[0]])):0===this.items.length&&1===this.subItems.length?(this.items[0].isSelected||this.subItems[0].clickItem(),this.fireEvent("afterSelectSingleItem",[this,this.items[0]])):1===this.items.length&&1===this.subItems.length&&this.items[0]===this.subItems[0]?(this.items[0].isSelected||this.items[0].clickItem(),this.fireEvent("afterSelectSingleItem",[this,this.items[0]])):t.fireEvent("afterCheckSelectSingleItem",[t]):t.fireEvent("afterCheckSelectSingleItem",[t])}.bind(this),i=function(e){e.loaded?function(e){if(e.subCategorys&&0!==e.subCategorys.length)if(1===e.subCategorys.length)e.subItems&&e.subItems.length>0?t.fireEvent("afterCheckSelectSingleItem",[t]):e.subCategorys[0]._hasChild&&e.subCategorys[0]._hasChild()?i(e.subCategorys[0]):(isSingleItem=!0,e.subItems[0].isSelected||e.subItems[0].clickItem(),t.fireEvent("afterSelectSingleItem",[t,e.subItems[0]]));else{for(var s=[],o=0;o<e.subCategorys.length;o++)e.subCategorys[o]._hasChild&&e.subCategorys[o]._hasChild()&&s.push(e.subCategorys[o]);1===s.length&&(e.subItems&&0!==e.subItems.length||i(s[0])),0===s.length&&e.subItems&&1===e.subItems.length?(isSingleItem=!0,e.subItems[0].isSelected||e.subItems[0].clickItem(),t.fireEvent("afterSelectSingleItem",[t,e.subItems[0]])):t.fireEvent("afterCheckSelectSingleItem",[t])}else e.subItems&&1===e.subItems.length?(isSingleItem=!0,e.subItems[0].isSelected||e.subItems[0].clickItem(),t.fireEvent("afterSelectSingleItem",[t,e.subItems[0]])):t.fireEvent("afterCheckSelectSingleItem",[t])}(e):e.loading&&window.setTimeout((function(){i(e)}),100)};1===this.subCategorys.length&&0===this.subItems.length?i(this.subCategorys[0]):0===this.subCategorys.length?e():t.fireEvent("afterCheckSelectSingleItem",[t])},setSize:function(){if(this.options.width||this.options.height){var t=function(t){return(t.getStyle("margin-left").toInt()||0)+(t.getStyle("margin-right").toInt()||0)+(t.getStyle("padding-left").toInt()||0)+(t.getStyle("padding-right").toInt()||0)+(t.getStyle("border-left-width").toInt()||0)+(t.getStyle("border-right-width").toInt()||0)},e=function(t){return(t.getStyle("margin-top").toInt()||0)+(t.getStyle("margin-bottom").toInt()||0)+(t.getStyle("padding-top").toInt()||0)+(t.getStyle("padding-bottom").toInt()||0)+(t.getStyle("border-top-width").toInt()||0)+(t.getStyle("border-bottom-width").toInt()||0)};if(this.options.width&&"auto"===this.options.width){this.node&&this.node.setStyle("width","auto"),this.selectNode.setStyles({width:"50%",float:"left"}),this.letterAreaNode&&this.letterAreaNode.setStyle("width","auto"),this.selectedContainerNode.setStyle("width","auto");var i=this.selectedScrollNode.getStyle("overflow-y");"string"!==typeOf(i)||"auto"!==i.toLowerCase()&&"scroll"!==i.toLowerCase()?this.selectedScrollNode.setStyle("margin-right","8px"):this.selectedScrollNode.setStyle("width","auto")}else if(this.options.width&&"number"===typeOf(this.options.width.toInt())){var s;this.node?(s=this.options.width.toInt()-t(this.node),this.node.setStyle("width",s)):s=this.options.width.toInt(),s-=t(this.contentNode),this.shuttleNode&&(s=s-t(this.shuttleNode)-this.shuttleNode.getStyle("width").toInt());var o=s-t(this.selectNode)-t(this.selectedContainerNode),n=this.options.noSelectedContainer?o:Math.floor(o/2)-2;this.selectNode.setStyle("width",n),this.letterAreaNode&&this.letterAreaNode.setStyle("width",n-19),this.selectedContainerNode.setStyle("width",n);i=this.selectedScrollNode.getStyle("overflow-y");"string"!==typeOf(i)||"auto"!==i.toLowerCase()&&"scroll"!==i.toLowerCase()?this.selectedScrollNode.setStyle("width",n-8):this.selectedScrollNode.setStyle("width",n)}if(this.options.height&&"number"===typeOf(this.options.height.toInt())){var a;this.node?(a=this.options.height.toInt()-e(this.node),this.node.setStyle("height",a)):a=this.options.height.toInt(),a=a-e(this.contentNode)-1,this.titleNode&&(a=a-e(this.titleNode)-this.titleNode.getStyle("height").toInt()),this.actionNode&&(a=a-e(this.actionNode)-this.actionNode.getStyle("height").toInt());var r=a-e(this.selectNode);if(this.selectNode.setStyle("height",r),this.shuttleNode){this.shuttleNode.setStyle("height",r);var l=e(this.shuttleInnerNode)+this.shuttleInnerNode.getStyle("height").toInt();this.shuttleInnerNode.setStyle("margin-top",(r-l)/2+"px")}var c=r-e(this.searchInputDiv)-this.searchInputDiv.getStyle("height").toInt();!this.options.searchbarInTopNode&&this.selectTopNode&&(c=c-e(this.selectTopNode)-this.selectTopNode.getStyle("height").toInt()),this.letterAreaNode&&(c=c-e(this.letterAreaNode)-this.letterAreaNode.getStyle("height").toInt()),c-=e(this.itemAreaScrollNode),this.itemAreaScrollNode.setStyle("height",c);var d=a-e(this.selectedContainerNode);this.selectedContainerNode.setStyle("height",d);var h=d;this.selectedTopNode&&(h=h-e(this.selectedTopNode)-this.selectedTopNode.getStyle("height").toInt()),!this.options.searchbarInTopNode&&this.selectedSearchInputDiv&&(h=h-e(this.selectedSearchInputDiv)-this.selectedSearchInputDiv.getStyle("height").toInt()),this.selectedScrollNode.setStyle("height",h)}this.fireEvent("setSize",[this])}},addFlatCategoryItem:function(t,e,i,s){if(this.flatSubCategoryNodeList||(this.flatSubCategoryNodeList=[]),e&&this.flatSubCategoryNodeList.push(t),!this.isFlatCategoryLoaded&&this.flatSubCategoryNodeList.length>1){this.flatCategoryScrollNode.show(),this.flatCategoryScrollNode.setStyles(this.css.flatCategoryScrollNode);var o=this.itemAreaScrollNode.getStyle("height").toInt();this.flatCategoryScrollNode.setStyle("height",o+"px"),this.flatCategoryNode.setStyles(this.css.flatCategoryNode),this.isFlatCategoryLoaded=!0,this.itemAreaScrollNode.setStyles(this.css.itemAreaScrollNode_flatCategory)}var n;if(e&&t.inject(i||this.flatCategoryNode),s&&(n=new Element("div.subCategoryListNode").inject(i||this.flatCategoryNode)),e)if(this.currentCategoryItemNode){var a=this.flatCategoryNode.getElement(".flatCategoryItemNode");if(a){var r=a.retrieve("dn"),l=this.currentCategoryItemNode.retrieve("dn");if(r&&l)r!=l&&(t.click(),this.currentCategoryItemNode=t);else{var c=a.get("title"),d=this.currentCategoryItemNode.get("title");if(c&&c)c!=d&&(t.click(),this.currentCategoryItemNode=t);else a.get("text")!=this.currentCategoryItemNode.get("text")&&(t.click(),this.currentCategoryItemNode=t)}}}else t.click(),this.currentCategoryItemNode=t;return n}}),MWF.xApplication.Selector.Person.Item=new Class({initialize:function(t,e,i,s,o,n){this.clazz="Item",this.data=t,this.selector=e,this.container=i,this.isSelected=!1,this.level=s?s.toInt():1,this.category=o,this.subItems=[],this.subCategorys=[],n||this.load()},_getShowName:function(){return this.data.name+(this.data.employee?"("+this.data.employee+")":"")},_getTtiteText:function(){return this.data.name+(this.data.employee?"("+this.data.employee+")":"")},_setIcon:function(){var t=this.selector.options.style;this.iconNode.setStyle("background-image","url(../x_component_Selector/$Selector/"+t+"/icon/personicon.png)")},load:function(){if("Item"===this.clazz&&this.selector.fireEvent("queryLoadItem",[this]),this.node||(this.node=new Element("div",{styles:this.selector.css.selectorItem}).inject(this.container)),this.levelNode=new Element("div",{styles:this.selector.css.selectorItemLevelNode}).inject(this.node),"identity"!==this.selector.selectType||0===this.selector.options.identityItemWidth){var t=this.selector.options.level1Indent+(this.level-1)*this.selector.options.indent;this.levelNode.setStyle("width",t+"px")}this.iconNode=new Element("div",{styles:this.selector.css.selectorItemIconNode}).inject(this.node),this._setIcon(),this.actionNode=new Element("div",{styles:this.selector.css.selectorItemActionNode}).inject(this.node),(1===this.selector.options.count.toInt()||this.selector.options.noSelectedContainer)&&this.selector.css.selectorItemActionNode_single&&this.actionNode.setStyles(this.selector.css.selectorItemActionNode_single),this.textNode=new Element("div",{styles:this.selector.css.selectorItemTextNode,text:this._getShowName(),title:this._getTtiteText()}).inject(this.node),this.textNode.store("indent",t);var e=this.textNode.getStyle("margin-left").toFloat()+t;this.textNode.setStyle("margin-left",e+"px"),this.selector.options.identityItemWidth&&"identity"===this.selector.selectType&&this.node.setStyles({float:"left","min-width":this.selector.options.identityItemWidth+"px"}),this.postLoad&&this.postLoad(),this.loadSubItem(),this.setEvent(),this.check(),"Item"===this.clazz&&this.selector.fireEvent("postLoadItem",[this])},loadSubItem:function(){},disable:function(){this.node.hide(),this.disabled=!0},enable:function(){this.node.show(),this.disabled=!1},check:function(){this.checkSelected()},checkSelectedSingle:function(){this.selector.options.values.filter(function(t,e){return"object"===typeOf(t)?this.data.distinguishedName===t.distinguishedName:"string"===typeOf(t)&&this.data.distinguishedName===t}.bind(this)).length&&this.selectedSingle()},checkSelected:function(){var t=this.selector.selectedItems.filter(function(t,e){return t.data.distinguishedName===this.data.distinguishedName}.bind(this));t.length&&(t[0].addItem(this),this.selectedItem=t[0],this.setSelected())},checkTextNodeIndent:function(t,e){var i=t.retrieve("indent");if(i&&e&&e["margin-left"]){var s=e["margin-left"].toFloat()+i;t.setStyle("margin-left",s+"px")}},setSelected:function(){this.isSelected=!0,this.node.setStyles(this.selector.css.selectorItem_selected),this.textNode.setStyles(this.selector.css.selectorItemTextNode_selected),this.checkTextNodeIndent(this.textNode,this.selector.css.selectorItemTextNode_selected),this.actionNode.setStyles(this.selector.css.selectorItemActionNode_selected),(1===this.selector.options.count.toInt()||this.selector.options.noSelectedContainer)&&this.selector.css.selectorItemActionNode_single_selected&&this.actionNode.setStyles(this.selector.css.selectorItemActionNode_single_selected)},setEvent:function(){this.node.addEvents({mouseover:function(){this.overItem()}.bind(this),mouseout:function(){this.outItem()}.bind(this),click:function(){this.clickItem(null,!0)}.bind(this)})},clickItem:function(t,e){this.isSelected?this.unSelected(e):this.selected(e)},overItem:function(){this.isSelected?this.selector.css.selectorItem_over_force&&this.node.setStyles(this.selector.css.selectorItem_over_force):this.node.setStyles(this.selector.css.selectorItem_over),this.isSelected?this.selector.css.selectorItemActionNode_over_force&&this.node.setStyles(this.selector.css.selectorItemActionNode_over_force):(this.actionNode.setStyles(this.selector.css.selectorItemActionNode_over),(1===this.selector.options.count.toInt()||this.selector.options.noSelectedContainer)&&this.selector.css.selectorItemActionNode_single_over&&this.actionNode.setStyles(this.selector.css.selectorItemActionNode_single_over))},outItem:function(){this.isSelected?this.selector.css.selectorItem_over_force&&this.node.setStyles(this.selector.css.selectorItem_selected):this.node.setStyles(this.selector.css.selectorItem),this.isSelected?this.selector.css.selectorItemActionNode_over_force&&(this.actionNode.setStyles(this.selector.css.selectorItemActionNode_selected),(1===this.selector.options.count.toInt()||this.selector.options.noSelectedContainer)&&this.selector.css.selectorItemActionNode_single_selected&&this.actionNode.setStyles(this.selector.css.selectorItemActionNode_single_selected)):(this.actionNode.setStyles(this.selector.css.selectorItemActionNode),(1===this.selector.options.count.toInt()||this.selector.options.noSelectedContainer)&&this.selector.css.selectorItemActionNode_single&&this.actionNode.setStyles(this.selector.css.selectorItemActionNode_single))},selectedSingle:function(t){this.isSelected?(this.selector.emptySelectedItems(),this.unSelectedSingle(t)):(this.selector.currentItem&&this.selector.currentItem.unSelectedSingle(),this.selector.emptySelectedItems(),this.getData(function(){this.selector.currentItem=this,this.isSelected=!0,this.selector.selectedItems.push(this),this.node.setStyles(this.selector.css.selectorItem_selected),this.textNode.setStyles(this.selector.css.selectorItemTextNode_selected),this.checkTextNodeIndent(this.textNode,this.selector.css.selectorItemTextNode_selected),this.actionNode.setStyles(this.selector.css.selectorItemActionNode_selected),(1===this.selector.options.count.toInt()||this.selector.options.noSelectedContainer)&&this.selector.css.selectorItemActionNode_single_selected&&this.actionNode.setStyles(this.selector.css.selectorItemActionNode_single_selected),this.selector.fireEvent("selectItem",[this]),t&&this.selector.fireEvent("valid",[this.selector,this])}.bind(this)))},getData:function(t){t&&t()},unSelectedSingle:function(t){this.selector.currentItem=null,this.isSelected=!1,this.selector.selectedItems.erase(this),this.node.setStyles(this.selector.css.selectorItem),this.textNode.setStyles(this.selector.css.selectorItemTextNode),this.checkTextNodeIndent(this.textNode,this.selector.css.selectorItemTextNode),this.actionNode.setStyles(this.selector.css.selectorItemActionNode),(1===this.selector.options.count.toInt()||this.selector.options.noSelectedContainer)&&this.selector.css.selectorItemActionNode_single&&this.actionNode.setStyles(this.selector.css.selectorItemActionNode_single),this.selector.fireEvent("unselectItem",[this]),t&&this.selector.fireEvent("valid",[this.selector,this])},selected:function(t,e,i,s){var o=this.selector.options.maxCount||this.selector.options.count;(o=o.toInt())||(o=0),1==o&&this.selector.emptySelectedItems&&this.selector.emptySelectedItems(),0===o||this.selector.selectedItems.length+1<=o?(this.isSelected=!0,this.node&&(this.node.setStyles(this.selector.css.selectorItem_selected),this.textNode.setStyles(this.selector.css.selectorItemTextNode_selected),this.checkTextNodeIndent(this.textNode,this.selector.css.selectorItemTextNode_selected),this.actionNode.setStyles(this.selector.css.selectorItemActionNode_selected),(1===this.selector.options.count.toInt()||this.selector.options.noSelectedContainer)&&this.selector.css.selectorItemActionNode_single_selected&&this.actionNode.setStyles(this.selector.css.selectorItemActionNode_single_selected)),this.selectedItem=this.selector._newItemSelected(this.data,this.selector,this,i),this.selector.selectedItems.push(this.selectedItem),this.selector.fireEvent("selectItem",[this]),t&&this.selector.fireEvent("valid",[this.selector,this]),e&&e()):MWF.xDesktop.notice("error",{x:"right",y:"top"},MWF.SelectorLP.selectItemMaxText.replace("{count}",o),this.node)},unSelected:function(t,e){var i=this.isSelected;this.isSelected=!1,this.node&&(this.node.setStyles(this.selector.css.selectorItem),this.textNode.setStyles(this.selector.css.selectorItemTextNode),this.checkTextNodeIndent(this.textNode,this.selector.css.selectorItemTextNode),this.actionNode.setStyles(this.selector.css.selectorItemActionNode),(1===this.selector.options.count.toInt()||this.selector.options.noSelectedContainer)&&this.selector.css.selectorItemActionNode_single&&this.actionNode.setStyles(this.selector.css.selectorItemActionNode_single)),this.category&&"all"!==this.selector.options.selectAllRange&&this.category.checkUnselectAll(),this.selector.searchItems&&this.selector.searchItems.length&&this.selector.searchItems.each(function(t){var e=t.data,i=this.data;(e.distinguishedName&&e.distinguishedName===i.distinguishedName||e.id&&e.id===i.id||e.unique&&e.unique===i.unique||e.employee&&e.employee===i.employee||e.levelName&&e.levelName===i.levelName)&&(t.isSelected=!1,t.node.setStyles(this.selector.css.selectorItem),t.textNode.setStyles(this.selector.css.selectorItemTextNode),this.checkTextNodeIndent(t.textNode,this.selector.css.selectorItemTextNode),t.actionNode.setStyles(this.selector.css.selectorItemActionNode),(1===this.selector.options.count.toInt()||this.selector.options.noSelectedContainer)&&this.selector.css.selectorItemActionNode_single&&t.actionNode.setStyles(this.selector.css.selectorItemActionNode_single))}.bind(this)),this.selectedItem&&(this.selector.selectedItems.erase(this.selectedItem),this.selectedItem.items.each(function(t){(t.isSelected||t===this&&i)&&(("all"===this.selector.options.selectAllRange||"identity"==this.selector.selectType&&(this.selector.options.showSelectedCount||this.selector.options.isCheckStatus))&&t.category&&t.category._addSelectedCount&&t.category._addSelectedCount(-1,!0));t!=this&&(t.isSelected=!1,t.node.setStyles(this.selector.css.selectorItem),t.textNode.setStyles(this.selector.css.selectorItemTextNode),this.checkTextNodeIndent(t.textNode,this.selector.css.selectorItemTextNode),t.actionNode.setStyles(this.selector.css.selectorItemActionNode),(1===this.selector.options.count.toInt()||this.selector.options.noSelectedContainer)&&this.selector.css.selectorItemActionNode_single&&t.actionNode.setStyles(this.selector.css.selectorItemActionNode_single))}.bind(this)),this.selectedItem.destroy(),this.selectedItem=null),this.selector.fireEvent("unselectItem",[this]),t&&this.selector.fireEvent("valid",[this.selector,this]),e&&e()},postLoad:function(){},getParentCategoryByLevel:function(t){var e=this.category;do{if(e.level===t)return e;e=e.category}while(e)}}),MWF.xApplication.Selector.Person.ItemSelected=new Class({Extends:MWF.xApplication.Selector.Person.Item,initialize:function(t,e,i,s){this.data=t,this.selector=e,this.container=s||this.selector.selectedNode,this.isSelected=!1,this.clazz="ItemSelected",this.items=[],i&&this.items.push(i),this.level=0,this.node=new Element("div",{styles:this.selector.css.selectorItem}).inject(this.container),this.node.setStyle("display","none"),this.getData(function(){this.node.setStyle("display",""),this.load()}.bind(this))},postLoad:function(){this.selector.css.selectorSelectedItemActionNode&&(this.actionNode.setStyles(this.selector.css.selectorSelectedItemActionNode),(1===this.selector.options.count.toInt()||this.selector.options.noSelectedContainer)&&this.selector.css.selectorSelectedItemActionNode_single&&this.actionNode.setStyles(this.selector.css.selectorSelectedItemActionNode_single)),this.selector.css.selectorSelectedItemTextNode&&this.textNode.setStyles(this.selector.css.selectorSelectedItemTextNode)},getData:function(t){t&&t()},clickItem:function(t,e){this.items.length?(this.items.each((function(t){t.unSelected(e)})),e&&this.selector.fireEvent("valid",[this.selector,this])):(this.destroy(),this.selector.selectedItems.erase(this),e&&this.selector.fireEvent("valid",[this.selector,this]))},overItem:function(){this.isSelected||(this.selector.css.selectorItem_selected_over?this.node.setStyles(this.selector.css.selectorItem_selected_over):this.node.setStyles(this.selector.css.selectorItem_over),this.actionNode.setStyles(this.selector.css.selectorItemActionNode_selected_over),(1===this.selector.options.count.toInt()||this.selector.options.noSelectedContainer)&&this.selector.css.selectorItemActionNode_single_selected_over&&this.actionNode.setStyles(this.selector.css.selectorItemActionNode_single_selected_over))},outItem:function(){if(this.isSelected)this.selector.css.selectorItem_over_force&&this.node.setStyles(this.selector.css.selectorItem_selected);else{var t=this.selector.css.selectorSelectedItem||this.selector.css.selectorItem;this.node.setStyles(t)}if(this.isSelected)this.selector.css.selectorItemActionNode_over_force&&(this.actionNode.setStyles(this.selector.css.selectorItemActionNode_selected),(1===this.selector.options.count.toInt()||this.selector.options.noSelectedContainer)&&this.selector.css.selectorItemActionNode_single_selected&&this.actionNode.setStyles(this.selector.css.selectorItemActionNode_single_selected));else{t=this.selector.css.selectorSelectedItemActionNode||this.selector.css.selectorItemActionNode;this.actionNode.setStyles(t),1!==this.selector.options.count.toInt()&&!this.selector.options.noSelectedContainer||!this.selector.css.selectorSelectedItemActionNode_single&&!this.selector.css.selectorItemActionNode_single||this.actionNode.setStyles(this.selector.css.selectorSelectedItemActionNode_single||this.selector.css.selectorItemActionNode_single)}},addItem:function(t){-1===this.items.indexOf(t)&&this.items.push(t)},check:function(){if(this.selector.items.length){var t=this.selector.items.filter(function(t,e){return t.data.distinguishedName===this.data.distinguishedName}.bind(this));this.items=t,t.length&&t.each(function(t){t.selectedItem=this,t.setSelected()}.bind(this))}this.afterCheck&&this.afterCheck()},destroy:function(){this.node&&this.node.destroy()}}),MWF.xApplication.Selector.Person.ItemCategory=new Class({Extends:MWF.xApplication.Selector.Person.Item,initialize:function(t,e,i,s,o,n){this.data=t,this.selector=e,this.container=i,this.isSelected=!1,this.level=s?s.toInt():1,this.category=o,this.subItems=[],this.subCategorys=[],n||this.load()},load:function(){this.selector.isFlatCategory?this.loadForFlat():this.loadForNormal()},loadForFlat:function(){if(this.selector.fireEvent("queryLoadCategory",[this]),this.node=new Element("div.flatCategoryItemNode",{styles:this.selector.css.flatCategoryItemNode,title:this._getTtiteText()}),this.node.store("category",this),this.node.store("dn",this.data.distinguishedName),this.textNode=new Element("div",{styles:this.selector.css.flatCategoryItemTextNode,text:this._getShowName()}).inject(this.node),this.children=new Element("div",{styles:this.selector.css.selectorItemCategoryChildrenNode}).inject(this.selector.itemAreaNode),this.children.setStyle("display","none"),this.selector.options.selectAllEnable&&1!==this.selector.options.count.toInt()){var t=new Element("div",{styles:this.selector.css.flatCategory_selectAllWrap}).inject(this.children);this.selectAllNode=new Element("div",{styles:this.selector.css.flatCategory_selectAll,text:MWF.SelectorLP.selectAll}).inject(t),this.selectAllNode.addEvent("click",function(t){this.isSelectedAll?("all"===this.selector.options.selectAllRange?this.unselectAllNested(t,null,!0):this.unselectAll(t,null,!0),this.selector.fireEvent("unselectCatgory",[this]),this.selector.fireEvent("unselectCatgeory",[this])):("all"===this.selector.options.selectAllRange?this.selectAllNested(t,!0):this.selectAll(t,!0),this.selector.fireEvent("selectCatgory",[this]),this.selector.fireEvent("selectCatgeory",[this])),t.stopPropagation()}.bind(this))}this.selectAllNode&&("direct"!==this.selector.options.selectAllRange||this._hasChildItem()||this.selectAllNode.setStyle("display","none")),this.node.addEvents({click:function(){this.selector.currentFlatCategory!==this&&(this.selector.currentFlatCategory&&this.selector.currentFlatCategory.clickFlatCategoryItem(null,!0),this.selector.currentFlatCategory=this,this.clickFlatCategoryItem())}.bind(this)});var e,i=!this._hasChildCategory||this._hasChildCategory();e=this.nodeContainer?this.nodeContainer:this.category&&this.category.subCategoryListNode?this.category.subCategoryListNode:null,this.subCategoryListNode=this.selector.addFlatCategoryItem(this.node,this._hasChildItem(),e,i),this.check(),this.loadCategoryChildren&&this.loadCategoryChildren(),this.selector.fireEvent("postLoadCategory",[this])},loadForNormal:function(){if(this.selector.fireEvent("queryLoadCategory",[this]),this.createNode(),this.levelNode=new Element("div",{styles:this.selector.css.selectorItemLevelNode}).inject(this.node),"identity"!==this.selector.selectType||0===this.selector.options.identityItemWidth){var t=this.selector.options.level1Indent+(this.level-1)*this.selector.options.indent;this.levelNode.setStyle("width",t+"px")}else this.node.setStyle("clear","both");this.iconNode=new Element("div",{styles:this.selector.css.selectorItemCategoryIconNode||this.selector.css.selectorItemIconNode}).inject(this.node),this._setIcon(),this.actionNode=new Element("div",{styles:this.selector.options.expand?this.selector.css.selectorItemCategoryActionNode_expand:this.selector.css.selectorItemCategoryActionNode_collapse}).inject(this.node),this.selector.options.selectAllEnable&&1!==this.selector.options.count.toInt()&&(this.selectAllNode=new Element("div",{styles:this.selector.css.selectorItemCategoryActionNode_selectAll,title:MWF.SelectorLP.selectChildren}).inject(this.node),this.selectAllNode.addEvent("click",function(t){if(this.isSelectedAll)"all"===this.selector.options.selectAllRange?this.unselectAllNested(t,null,!0):this.unselectAll(t,null,!0),this.selector.fireEvent("unselectCatgory",[this]),this.selector.fireEvent("unselectCategory",[this]);else{if("all"===this.selector.options.selectAllRange){var e=new Element("div.categorySelectedNode").inject(this.selector.selectedNode);this.selectAllNested(t,!0,e)}else this.selectAll(t,!0);this.selector.fireEvent("selectCatgory",[this]),this.selector.fireEvent("selectCategory",[this])}t.stopPropagation()}.bind(this)),this.selector.css.selectorItemCategoryActionNode_selectAll_over&&this.selectAllNode.addEvents({mouseover:function(t){this.isSelectedAll||this.isSelectedSome||this.selectAllNode.setStyles(this.selector.css.selectorItemCategoryActionNode_selectAll_over)}.bind(this),mouseout:function(t){this.isSelectedAll||this.isSelectedSome||this.selectAllNode.setStyles(this.selector.css.selectorItemCategoryActionNode_selectAll)}.bind(this)})),this.textNode=new Element("div",{styles:this.selector.css.selectorItemCategoryTextNode,text:this._getShowName()}).inject(this.node);var e=this.textNode.getStyle("margin-left").toFloat()+t;if(this.textNode.setStyle("margin-left",e+"px"),this.selector.options.showSelectedCount&&"identity"==this.selector.selectType&&(this.selectedCountNode=new Element("span").inject(this.textNode)),this.children=new Element("div.children",{styles:this.selector.css.selectorItemCategoryChildrenNode}).inject(this.node,"after"),this.selector.options.expand||this.children.setStyle("display","none"),this.selector.options.expandEmptyCategory&&!this._hasChildItem())this.children.hide(),this.actionNode.setStyles(this.selector.css.selectorItemCategoryActionNode_collapse),this.isExpand=!1;else{var i=this.selector._getChildrenItemIds(this.data);if(i){var s=i.length;this.childrenHeight=s*this.selector.options.itemHeight,this.children.setStyle("height",this.childrenHeight+"px")}if(this.selector.options.identityItemWidth&&"identity"===this.selector.selectType){t=0===this.level?this.selector.options.level1Indent:this.selector.options.indent;this.children.setStyles({"padding-left":t+"px",overflow:"hidden"})}this._hasChild()||(this.selector.options.hiddenEmptyCategory?this.node.hide():(this.actionNode.setStyle("background","transparent"),this.textNode.setStyle("color","#777"))),this.selectAllNode&&("direct"!==this.selector.options.selectAllRange||this._hasChildItem()||this.selectAllNode.setStyle("display","none"))}this.setEvent(),this.check(),this.afterLoad(),this.selector.fireEvent("postLoadCategory",[this])},createNode:function(){this.node=new Element("div",{styles:this.selector.css.selectorItemCategory,title:this._getTtiteText()}).inject(this.container)},unselectAll:function(t,e,i){var s=function(){var t=e||[];e&&"array"!==typeOf(e)&&(t=[e]),(this.subItems||[]).each(function(e){e.isSelected&&!t.contains(e)&&e.unSelected(i)}.bind(this)),this.selectAllNode&&(this.selector.isFlatCategory?this.selectAllNode.setStyles(this.selector.css.flatCategory_selectAll):this.selector.css.selectorItemCategoryActionNode_selectAll&&this.selectAllNode.setStyles(this.selector.css.selectorItemCategoryActionNode_selectAll)),this.isSelectedAll=!1}.bind(this);this.loaded?s():this.clickItem(function(){s()}.bind(this))},unselectAllNested:function(t,e,i){this.unselectAll(t,e,i),this.subCategorys&&this.subCategorys.length&&this.subCategorys.each((function(s){s.unselectAllNested(t,e,i)}))},selectAllNested:function(t,e,i){var s;i&&(s=new Element("div.categorySelectedNode").inject(i)),this.selectAll(t,e,s,function(){this.subCategorys&&this.subCategorys.length&&this.subCategorys.each((function(s){if(i)var o=new Element("div.categorySelectedNode").inject(i);s.selectAllNested(t,e,o)}))}.bind(this))},selectAll:function(t,e,i,s){this.loaded||this.selector.isFlatCategory?(this._selectAll(t,e,i),s&&s()):this.clickItem(function(){this._selectAll(t,e,i),s&&s()}.bind(this))},_selectAll:function(t,e,i){if("direct"!==this.selector.options.selectAllRange||this.subItems&&this.subItems.length){var s=this.selector.options.maxCount||this.selector.options.count;s||(s=0);var o=0;if(this.subItems.each(function(t){t.isSelected&&o++}.bind(this)),0===s.toInt()||this.selector.selectedItems.length+(this.subItems.length-o)<=s){var n=0,a=function(){if(this.subItems.each(function(t){t.isSelected||t.disabled||t.selected(!1,function(){n++,this.subItems.length===n&&e&&this.selector.fireEvent("valid",[this.selector,this])}.bind(this),i)}.bind(this)),this.selectAllNode)if(this.selector.isFlatCategory)this.selectAllNode.setStyles(this.selector.css.flatCategory_selectAll_selected);else if(this.selector.css.selectorItemCategoryActionNode_selectAll_selected){var t=this.selector.css.selectorItemCategoryActionNode_selectAll_selected;this.selector.options.isCheckStatus&&"identity"===this.selector.selectType&&this._getSelectedCount()<this._getTotalCount()&&(t=this.selector.css.selectorItemCategoryActionNode_selectsome_selected),this.selectAllNode.setStyles(t)}this.isSelectedAll=!0}.bind(this);this._beforeSelectAll?this._beforeSelectAll(a):a()}else MWF.xDesktop.notice("error",{x:"right",y:"top"},MWF.SelectorLP.selectItemMaxText.replace("{count}",s),this.node)}},checkSelectAll:function(){if(!this.isSelectedAll&&this.selectAllNode&&this.subItems){for(var t=!0,e=0;e<this.subItems.length;e++)if(!this.subItems[e].isSelected){t=!1;break}t&&(this.selector.isFlatCategory?this.selectAllNode.setStyles(this.selector.css.flatCategory_selectAll_selected):this.selector.css.selectorItemCategoryActionNode_selectAll_selected&&this.selectAllNode.setStyles(this.selector.css.selectorItemCategoryActionNode_selectAll_selected),this.isSelectedAll=!0)}},checkUnselectAll:function(){if(this.isSelectedAll&&this.selectAllNode&&this.subItems){for(var t=!1,e=0;e<this.subItems.length;e++)if(this.subItems[e].isSelected){t=!0;break}t||(this.selector.isFlatCategory?this.selectAllNode.setStyles(this.selector.css.flatCategory_selectAll):this.selector.css.selectorItemCategoryActionNode_selectAll&&this.selectAllNode.setStyles(this.selector.css.selectorItemCategoryActionNode_selectAll),this.isSelectedAll=!1)}},afterLoad:function(){1===this.level&&this.clickItem()},clickFlatCategoryItem:function(t,e){if(this._hasChildItem()){var i=this.children.getStyle("display");e?(this.children.setStyles({display:"none"}),this.node.setStyles(this.selector.css.flatCategoryItemNode),this.isExpand=!1):"none"===i?(this.children.setStyles({display:"block",height:"auto"}),this.node.setStyles(this.selector.css.flatCategoryItemNode_selected),this.isExpand=!0):(this.children.setStyles({display:"none"}),this.node.setStyles(this.selector.css.flatCategoryItemNode),this.isExpand=!1),t&&t()}},clickItem:function(t){if(this._hasChild()||this.selector.options.expandEmptyCategory){if(this.fx||(this.fx=new Fx.Tween(this.children,{duration:200})),!this.fx.isRunning())"none"===this.children.getStyle("display")?(this.children.setStyles({display:"block",height:"0px"}),this.fx.start("height","0px",this.childrenHeight+"px"),this.actionNode.setStyles(this.selector.css.selectorItemCategoryActionNode_expand),this.isExpand=!0,this.selector.fireEvent("expand",[this])):(this.childrenHeight||(this.childrenHeight=this.children.getStyle("height").toFloat()),this.fx.start("height",this.childrenHeight+"px","0px").chain(function(){this.children.setStyles({display:"none",height:"0px"})}.bind(this)),this.actionNode.setStyles(this.selector.css.selectorItemCategoryActionNode_collapse),this.isExpand=!1,this.selector.fireEvent("collapse",[this]));t&&t()}},overItem:function(){this.selector.css.selectorItemCategory_over&&this.node.setStyles(this.selector.css.selectorItemCategory_over),"none"===this.children.getStyle("display")?this._hasChild()&&this.selector.css.selectorItemCategoryActionNode_collapse_over&&this.actionNode.setStyles(this.selector.css.selectorItemCategoryActionNode_collapse_over):this._hasChild()&&this.selector.css.selectorItemCategoryActionNode_expand_over&&this.actionNode.setStyles(this.selector.css.selectorItemCategoryActionNode_expand_over)},outItem:function(){this.selector.css.selectorItemCategory_over&&this.node.setStyles(this.selector.css.selectorItemCategory),"none"===this.children.getStyle("display")?this._hasChild()&&this.selector.css.selectorItemCategoryActionNode_collapse_over&&this.actionNode.setStyles(this.selector.css.selectorItemCategoryActionNode_collapse):this._hasChild()&&this.selector.css.selectorItemCategoryActionNode_expand_over&&this.actionNode.setStyles(this.selector.css.selectorItemCategoryActionNode_expand)},_hasChild:function(){var t=this.selector._getChildrenItemIds(this.data);return!(!t||!t.length)},_hasChildCategory:function(){return null},_hasChildItem:function(){return this._hasChild()},_getTtiteText:function(){return this.data.levelName?this.data.name+"("+this.data.levelName+")":this.data.name}}),MWF.xApplication.Selector.Person.ItemGroupCategory=new Class({Extends:MWF.xApplication.Selector.Person.ItemCategory,_getShowName:function(){return this.data.name},_setIcon:function(){var t=this.selector.options.style;this.iconNode.setStyle("background-image","url(../x_component_Selector/$Selector/"+t+"/icon/groupicon.png)")}}),MWF.xApplication.Selector.Person.ItemRoleCategory=new Class({Extends:MWF.xApplication.Selector.Person.ItemCategory,_getShowName:function(){return this.data.name},_setIcon:function(){var t=this.selector.options.style;this.iconNode.setStyle("background-image","url(../x_component_Selector/$Selector/"+t+"/icon/roleicon.png)")}}),MWF.xApplication.Selector.Person.Filter=new Class({Implements:[Options,Events],options:{style:"default",groups:[],roles:[]},initialize:function(t,e){this.setOptions(e),this.value=t,this.orgAction=MWF.Actions.get("x_organization_assemble_control")},filter:function(t,e){this.value=t;var i=this.value;(this.options.groups.length||this.options.roles.length)&&(i={key:i,groupList:this.options.groupList,roleList:this.options.roleList}),this.orgAction.listPersonByKey(function(t){data=t.data,e&&e(data)}.bind(this),null,i)}}),MWF.xApplication.Selector=MWF.xApplication.Selector||{},MWF.xDesktop.requireApp("Selector","Person",null,!1),MWF.xApplication.Selector.Identity=new Class({Extends:MWF.xApplication.Selector.Person,options:{style:"default",count:0,title:"",units:[],values:[],dutys:[],zIndex:1e3,expand:!1,noUnit:!1,include:[],exclude:[],resultType:"",expandSubEnable:!0,selectAllEnable:!0},setInitTitle:function(){this.setOptions({title:MWF.xApplication.Selector.LP.selectIdentity})},_init:function(){this.selectType="identity",this.className="Identity"},loadSelectItems:function(){if(this.options.disabled)this.afterLoadSelectItem();else if("Identity"===this.className&&(this.options.isCheckStatus||this.options.showSelectedCount)){var t=[],e=[],i=function(){this.options.include.length>0&&this.options.include.each((function(i){var s="string"===typeOf(i)?i:i.distinguishedName,o=s.split("@").getLast().toLowerCase();"u"===o?t.push(s):"g"===o&&e.push(s)}))}.bind(this),s=function(){var i,s,o,n,a,r;this.unitExcludedIdentityCount={},this.groupExcludedIdentityCount={},this.unitSelectedIdentityCount={},this.groupSelectedIdentityCount={};var l=function(){i&&s&&o&&n&&this.caculateNestedSubCount(a,r,function(){this._loadSelectItems()}.bind(this))}.bind(this);this.getIdentityCountMap(this.options.values,e&&e.length>0,function(t){this.unitSelectedIdentityCount=t.unitMap,this.groupSelectedIdentityCount=t.groupMap,o=!0,l()}.bind(this)),this.getIdentityCountMap(this.options.exclude,e&&e.length>0,function(t){this.unitExcludedIdentityCount=t.unitMap,this.groupExcludedIdentityCount=t.groupMap,n=!0,l()}.bind(this)),t&&t.length>0?o2.Actions.load("x_organization_assemble_express").UnitAction.listWithUnitTree({unitList:t},function(t){a=t.data,i=!0,l()}.bind(this)):(i=!0,l()),e&&e.length>0?o2.Actions.load("x_organization_assemble_express").GroupAction.listWithGroupTree({groupList:e},function(t){r=t.data,s=!0,l()}.bind(this)):(s=!0,l())}.bind(this);this.options.noUnit?(i(),s()):this.options.units.length?(i(),this.options.units.each(function(e){t.push("string"===typeOf(e)?e:e.distinguishedName||e.id||e.unique||e.levelName)}.bind(this)),s()):this.orgAction.listTopUnit(function(e){this.topUnitObj=e.data,this.topUnitObj.each(function(e){t.push(e.distinguishedName)}.bind(this)),s()}.bind(this))}else this._loadSelectItems()},_loadSelectItems:function(t){var e=this.afterLoadSelectItem.bind(this);if("person"===this.options.resultType&&(this.titleTextNode?this.titleTextNode.set("text",MWF.xApplication.Selector.LP.selectPerson):this.options.title=MWF.xApplication.Selector.LP.selectPerson),this.options.noUnit)this.loadInclude(e);else if(this.options.units.length){var i=function(){this.unitLoaded=!0,this.includeLoaded&&e()}.bind(this),s=i;this.loadInclude(function(){this.includeLoaded=!0,this.unitLoaded&&e()}.bind(this));for(var o=[],n=0;n<this.options.units.length;n++){var a=this.options.units[n];"string"===typeOf(a)?o.push(a):"object"===typeOf(a)&&o.push(a.id||a.distinguishedName||a.unique||a.levelName)}o2.Actions.load("x_organization_assemble_express").UnitAction.listObject({unitList:o},function(t){t.data.length&&t.data.each(function(t){var e=this._newItemCategory("ItemUnitCategory",t,this,this.itemAreaNode);this.subCategorys.push(e)}.bind(this)),i()}.bind(this),s)}else{var r=function(t){t.each(function(t){if(!this.isExcluded(t)){var e=this._newItemCategory("ItemUnitCategory",t,this,this.itemAreaNode);this.subCategorys.push(e)}}.bind(this)),e()}.bind(this);this.topUnitObj?r(this.topUnitObj):this.orgAction.listTopUnit(function(t){r(t.data)}.bind(this))}},loadInclude:function(t){this.includeObject||(this.includeObject=new MWF.xApplication.Selector.Identity.Include(this,this.itemAreaNode,{include:this.options.include,resultType:this.options.resultType,expandSubEnable:this.options.expandSubEnable,onAfterLoad:t})),this.includeObject.load()},checkLoadSelectItems:function(){this.options.units.length,this.loadSelectItems()},_scrollEvent:function(t){return!0},_getChildrenItemIds:function(){return null},_newItemCategory:function(t,e,i,s,o,n,a){return new MWF.xApplication.Selector.Identity[t](e,i,s,o,n,a)},_listItem:function(t,e,i,s){if(this.options.noUnit)this.includeObject.listByFilter(t,s,function(t){var i={data:t};e&&e.apply(this,[i])}.bind(this));else{var o="key"===t?"listIdentityByKey":"listIdentityByPinyin";this.options.units.length?(s=this.getLikeKey(s,this.options.units),this.orgAction[o](function(i){this.includeObject.listByFilter(t,s,function(t){i.data=t.concat(i.data||[]),e&&e.apply(this,[i])}.bind(this))}.bind(this),i,s)):this.orgAction[o](function(t){e&&e.apply(this,[t])}.bind(this),i,s)}},_listItemByKey:function(t,e,i){this._listItem("key",t,e,i)},_getItem:function(t,e,i,s){this.orgAction.getIdentity(function(e){t&&t.apply(this,[e])}.bind(this),e,"string"===typeOf(i)?i:i.distinguishedName,s)},_newItemSelected:function(t,e,i,s){return new MWF.xApplication.Selector.Identity.ItemSelected(t,e,i,s)},_listItemByPinyin:function(t,e,i){this._listItem("pinyin",t,e,i)},_newItem:function(t,e,i,s,o,n){return new MWF.xApplication.Selector.Identity.Item(t,e,i,s,o,n)},_newItemSearch:function(t,e,i,s){return new MWF.xApplication.Selector.Identity.SearchItem(t,e,i,s)},getLikeKey:function(t,e){var i=[];(e=e||[]).each((function(t){"string"===typeOf(t)&&i.push(t),"object"===typeOf(t)&&i.push(t.distinguishedName)}));var s={key:t,unitList:i};if(!this.dutyDnList){var o=[],n=[];(this.options.dutys||[]).each((function(t){if("string"===typeOf(t)){var e=t.split("@");"UD"===e[e.length-1].toUpperCase()?o.push(t):n.push(t)}"object"===typeOf(t)&&(t.distinguishedName?o.push(t.distinguishedName):t.name&&n.push(t.name))})),n.length&&o2.Actions.get("x_organization_assemble_express").listDutyWithName({nameList:n},function(t){t.data&&t.data.unitDutyList&&(o=o.concat(t.data.unitDutyList))}.bind(this),null,!1),this.dutyDnList=o}return this.dutyDnList.length&&(s.unitDutyList=this.dutyDnList),i.length?s:t},getIdentityAllLevelName:function(t,e,i){var s={unitMap:{},groupMap:{}};this.listIndetityObject(t,function(t,o){t.each(function(t){t.unitLevelName&&(s.unitMap[t.unitLevelName]=(s.unitMap[t.unitLevelName]||0)+1)}.bind(this)),e?this.listLevelNameGroupMap(t,function(t){for(var e in t){var o=t[e].identityList.length;o&&(s.groupMap[e]=o)}i&&i(s)}.bind(this)):i&&i(s)}.bind(this))},getIdentityCountMap:function(t,e,i){var s={unitMap:{},groupMap:{}};this.listIndetityObject(t,function(t,o){t.each(function(t){t.unitLevelName&&(s.unitMap[t.unitLevelName]=(s.unitMap[t.unitLevelName]||0)+1)}.bind(this)),e?this.listLevelNameGroupMap(t,function(t){for(var e in t){var o=t[e].identityList.length;o&&(s.groupMap[e]=o)}i&&i(s)}.bind(this)):i&&i(s)}.bind(this))},listIndetityObject:function(t,e){var i=[];t.each((function(t){"object"===typeOf(t)?t.unitLevelName&&t.distinguishedName||i.push(t.distinguishedName||t.id||t.unique):i.push(t)})),i.length>0?o2.Actions.load("x_organization_assemble_express").IdentityAction.listObject({identityList:i},function(i){var s={};i.data.each((function(t){s[t.matchKey]=t}));var o=[];t.each((function(t){var e="object"===typeOf(t)?t.distinguishedName||t.id||t.unique:t;o.push(s[e]?s[e]:t)})),e&&e(o,s)}.bind(this)):e&&e(t,{})},listLevelNameGroupMap:function(t,e,i,s){var o=t.map((function(t){return t.distinguishedName})).clean();o.length>0?o2.Actions.load("x_organization_assemble_express").GroupAction.listWithIdentityObject({recursiveGroupFlag:!0,identityList:o,referenceFlag:!!i,recursiveOrgFlag:!!s},function(t){var i={},s=t.data;s.each((function(t){i[t.distinguishedName]=t})),s.each((function(t){t.identityList=t.identityList.filter((function(t){return o.contains(t)})),t.groupObjectList=[],t.groupList.each((function(e){i[e]&&t.groupObjectList.push(i[e])}))}));var n={},a=function(t,e){var i=e?e+"/"+t.name:t.name;n[i]=t,t.groupObjectList.each((function(t){a(t,i)}))};s.each((function(t){a(t)})),e&&e(n)}.bind(this)):e&&e({})},caculateNestedSubCount:function(t,e,i){if(this.allUnitObject||(this.allUnitObject={}),this.allGroupObject||(this.allGroupObject={}),this.allGroupObjectByDn||(this.allGroupObjectByDn={}),e&&e.length&&e.each(function(t){this.caculateGroupNestedCount(t)}.bind(this)),t&&t.length&&t.each(function(t){this.allUnitObject[t.levelName]||this.caculateUnitNestedCount(t)}.bind(this)),this.allGroupObject)for(var s in this.allGroupObject){var o=this.allGroupObject[s];this.allGroupObjectByDn[o.distinguishedName]=o}i&&i()},caculateGroupNestedCount:function(t,e){if(!this.isExcluded(t)){var i=e?e+"/"+t.distinguishedName.split("@")[0]:t.distinguishedName.split("@")[0];if(!this.allGroupObject[i]){this.allGroupObject[i]=t;var s=t.subDirectIdentityCount;this.groupExcludedIdentityCount&&this.groupExcludedIdentityCount[i]&&(s=(s||0)-this.groupExcludedIdentityCount[i]);var o=0;this.groupSelectedIdentityCount&&this.groupSelectedIdentityCount[i]&&(o=this.groupSelectedIdentityCount[i]);var n=i.split("/"),a=[];n.each(function(t){a.push(t);var e=a.join("/"),i=this.allGroupObject[e];i&&(i.subNestedIdentityCount=(i.subNestedIdentityCount||0)+s,i.selectedNestedIdentityCount=(i.selectedNestedIdentityCount||0)+o)}.bind(this)),t.subGroups.each(function(t){this.caculateGroupNestedCount(t,i)}.bind(this)),t.subUnits.each(function(t){var e=this.allUnitObject[t.levelName];this.caculateUnitNestedCount(t,i,!!e)}.bind(this))}}},caculateUnitNestedCount:function(t,e,i){if(!this.isExcluded(t)){var s,o;if(this.allUnitObject[t.levelName]){if(!i)return;s=this.allUnitObject[t.levelName].subNestedIdentityCount||0,s=this.allUnitObject[t.levelName].selectedNestedIdentityCount||0}else this.allUnitObject[t.levelName]=t,s=t.subDirectIdentityCount,this.unitExcludedIdentityCount&&this.unitExcludedIdentityCount[t.levelName]&&(s=(s||0)-this.unitExcludedIdentityCount[t.levelName]),o=0,this.unitSelectedIdentityCount&&this.unitSelectedIdentityCount[t.levelName]&&(o=this.unitSelectedIdentityCount[t.levelName]);if(e){var n=e.split("/"),a=[];n.each(function(t){a.push(t);var e=a.join("/"),i=this.allGroupObject[e];i&&(i.subNestedIdentityCount=(i.subNestedIdentityCount||0)+s,i.selectedNestedIdentityCount=(i.selectedNestedIdentityCount||0)+o)}.bind(this))}if(!i){var r=t.levelName.split("/"),l=[];r.each(function(t){l.push(t);var e=l.join("/"),i=this.allUnitObject[e];i&&(i.subNestedIdentityCount=(i.subNestedIdentityCount||0)+s,i.selectedNestedIdentityCount=(i.selectedNestedIdentityCount||0)+o)}.bind(this)),t.subUnits.each(function(t){this.caculateUnitNestedCount(t,e)}.bind(this))}}}}),MWF.xApplication.Selector.Identity.Item=new Class({Extends:MWF.xApplication.Selector.Person.Item,_getShowName:function(){return this.data.name},_getTtiteText:function(){return this.data.name+(this.data.unitLevelName?"("+this.data.unitLevelName+")":"")},_setIcon:function(){var t=this.selector.options.style;this.iconNode.setStyle("background-image","url(../x_component_Selector/$Selector/"+t+"/icon/personicon.png)")},getData:function(t,e){if("person"===this.selector.options.resultType){var i=!1;if(this.data&&this.data.distinguishedName){var s=this.data.distinguishedName;"p"===s.substr(s.length-1,1).toLowerCase()&&(i=!0)}i?t&&t():this.data.woPerson?(this.data=this.data.woPerson,t&&t()):this.data.person?this.selector.orgAction.getPerson(function(e){this.data=e.data,t&&t()}.bind(this),null,this.data.person):t&&t()}else{if(this.selector.options.ignorePerson||"simple"===this.selector.options.storeRange)return void(t&&t());!e&&t&&t(),this.data.woPerson||this.data.personDn&&this.data.personEmployee&&this.data.personUnique?e&&t&&t():this.selector.orgAction.getPerson(function(i){this.data.woPerson=i.data,e&&t&&t()}.bind(this),null,this.data.person)}},checkSelectedSingle:function(){var t="person"===this.selector.options.resultType;this.selector.options.values.filter(function(e,i){return t?"object"===typeOf(e)&&(e.id&&e.id===this.data.person||e.person&&e.person===this.data.id||this.data.distinguishedName&&this.data.distinguishedName===e.distinguishedName):"object"===typeOf(e)?this.data.distinguishedName===e.distinguishedName:"string"===typeOf(e)&&this.data.distinguishedName===e}.bind(this)).length&&this.selectedSingle()},checkSelected:function(){var t="person"===this.selector.options.resultType,e=this.selector.selectedItems.filter(function(e,i){return t?e.data.id&&e.data.id===this.data.person||e.data.person&&e.data.person===this.data.id||e.data.distinguishedName&&e.data.distinguishedName===this.data.distinguishedName:e.data.distinguishedName===this.data.distinguishedName}.bind(this));e.length&&(e[0].addItem(this),this.selectedItem=e[0],this.setSelected(),("all"===this.selector.options.selectAllRange||"identity"==this.selector.selectType&&(this.selector.options.showSelectedCount||this.selector.options.isCheckStatus))&&this.category&&this.category._addSelectedCount&&this.category._addSelectedCount(1,!0))}}),MWF.xApplication.Selector.Identity.SearchItem=new Class({Extends:MWF.xApplication.Selector.Identity.Item,_getShowName:function(){return this.data.name+(this.data.unitLevelName?"("+this.data.unitLevelName+")":"")}}),MWF.xApplication.Selector.Identity.ItemSelected=new Class({Extends:MWF.xApplication.Selector.Person.ItemSelected,getData:function(t,e){if("person"===this.selector.options.resultType){var i=!1;if(this.data&&this.data.distinguishedName){var s=this.data.distinguishedName;"p"===s.substr(s.length-1,1).toLowerCase()&&(i=!0)}i?t&&t():this.data.woPerson?(this.data=this.data.woPerson,t&&t()):this.data.person?this.selector.orgAction.getPerson(function(e){this.data=e.data,t&&t()}.bind(this),null,this.data.person):t&&t()}else if(this.data.woPerson||this.data.personDn&&this.data.personEmployee&&this.data.personUnique)t&&t();else{if(this.selector.options.ignorePerson||"simple"===this.selector.options.storeRange)return void(t&&t());!e&&t&&t(),this.data.person?this.selector.orgAction.getPerson(function(i){this.data.woPerson=i.data,e&&t&&t()}.bind(this),function(i,s,o){var n=o;if(i){var a=JSON.decode(i.responseText);n=a?a.message.trim()||"request json error":"request json error: "+i.responseText}MWF.xDesktop.notice("error",{x:"right",y:"top"},n),e&&t&&t()}.bind(this),this.data.person):(MWF.xDesktop.notice("error",{x:"right",y:"top"},MWF.SelectorLP.noPerson.replace(/{name}/g,this.data.name)),e&&t&&t())}},_getShowName:function(){return this.data.name+(this.data.unitLevelName?"("+this.data.unitLevelName+")":"")},_getTtiteText:function(){return this.data.name+(this.data.unitLevelName?"("+this.data.unitLevelName+")":"")},_setIcon:function(){var t=this.selector.options.style;this.iconNode.setStyle("background-image","url(../x_component_Selector/$Selector/"+t+"/icon/personicon.png)")},check:function(){if(this.selector.items.length){var t="person"===this.selector.options.resultType,e=this.selector.items.filter(function(e,i){return t?e.data.person&&e.data.person===this.data.id||e.data.id&&e.data.id===this.data.person||e.data.distinguishedName&&e.data.distinguishedName===this.data.distinguishedName:e.data.distinguishedName===this.data.distinguishedName}.bind(this));this.items=e,e.length&&e.each(function(t){t.selectedItem=this,t.setSelected(),("all"===this.selector.options.selectAllRange||"identity"==this.selector.selectType&&(this.selector.options.showSelectedCount||this.selector.options.isCheckStatus))&&t.category&&t.category._addSelectedCount&&t.category._addSelectedCount(1,!0)}.bind(this))}this.afterCheck&&this.afterCheck()}}),MWF.xApplication.Selector.Identity.ItemCategory=new Class({Extends:MWF.xApplication.Selector.Person.ItemCategory,createNode:function(){this.node=new Element("div",{styles:this.selector.css.selectorItemCategory_department,title:this._getTtiteText()}).inject(this.container)},_addSelectedCount:function(t,e){var i=(this._getSelectedCount()||0)+t;this.selectedCount=i,this.checkCountAndStatus(i),e&&this.category&&this.category._addSelectedCount&&this.category._addSelectedCount(t,e)},checkCountAndStatus:function(t){if(this.selector.options.showSelectedCount&&this.selectedCountNode.set("text",t?"("+t+")":""),this.selector.options.isCheckStatus&&this.selectAllNode){var e,i=this._getTotalCount();if(i)t>=i?(e=this.selector.css.selectorItemCategoryActionNode_selectAll_selected,this.isSelectedSome=!1,this.isSelectedAll=!0):t>0?(e=this.selector.css.selectorItemCategoryActionNode_selectsome_selected,this.isSelectedSome=!0,this.isSelectedAll=!1):(e=this.selector.css.selectorItemCategoryActionNode_selectAll,this.isSelectedSome=!1,this.isSelectedAll=!1),this.selectAllNode.setStyles(e)}else 0===t&&"all"===this.selector.options.selectAllRange&&this.selectAllNode&&(e=this.selector.css.selectorItemCategoryActionNode_selectAll,this.isSelectedSome=!1,this.isSelectedAll=!1,this.selectAllNode.setStyles(e))},_getShowName:function(){return this.data.name},_getTotalCount:function(){if(!this.selector.allUnitObject)return 0;var t=this.selector.allUnitObject[this.data.levelName];return t?t.subNestedIdentityCount:0},_getSelectedCount:function(){if("number"===typeOf(this.selectedCount))return this.selectedCount;if(!this.selector.allUnitObject)return 0;var t=this.selector.allUnitObject[this.data.levelName],e=t?t.selectedNestedIdentityCount:0;return this.selectedCount=e,e},_setIcon:function(){var t=this.selector.options.style;this.iconNode.setStyle("background-image","url(../x_component_Selector/$Selector/"+t+"/icon/companyicon.png)")},_beforeSelectAll:function(t){if(this.selector.options.ignorePerson||"simple"===this.selector.options.storeRange&&"person"!==this.selector.options.resultType)t();else{var e={};"person"===this.selector.options.resultType?this.subItems.each(function(t){var i=!1;if(t.data&&t.data.distinguishedName){var s=t.data.distinguishedName;"p"===s.substr(s.length-1,1).toLowerCase()&&(i=!0)}i||t.data.woPerson||!t.data.person||(e[t.data.person]=t)}.bind(this)):this.subItems.each(function(t){!t.data.woPerson&&t.data.person&&(e[t.data.person]=t)}.bind(this));var i=Object.keys(e);i.length>0?o2.Actions.load("x_organization_assemble_express").PersonAction.listObject({personList:i},(function(i){i.data.each(function(t){e[t.id]&&(e[t.id].data.woPerson=t)}.bind(this)),t()})):t()}},clickItem:function(t){if(this._hasChild()&&!this.loading){var e=!this.loaded;this.loading=!0,this.loadSub(function(){(this.loading=!1,e)?(this.selector.isFlatCategory||(this.children.setStyles({display:"block",height:"auto"}),this.actionNode.setStyles(this.selector.css.selectorItemCategoryActionNode_expand),this.isExpand=!0),this.selector.fireEvent("expand",[this])):"none"===this.children.getStyle("display")?(this.children.setStyles({display:"block",height:"auto"}),this.actionNode.setStyles(this.selector.css.selectorItemCategoryActionNode_expand),this.isExpand=!0,this.selector.fireEvent("expand",[this])):(this.children.setStyles({display:"none",height:"0px"}),this.actionNode.setStyles(this.selector.css.selectorItemCategoryActionNode_collapse),this.isExpand=!1,this.selector.fireEvent("collapse",[this]));t&&t()}.bind(this))}},loadSub:function(t){this._loadSub(function(e){t&&t()}.bind(this))},_loadSub:function(t){if(this.loaded)t&&t();else{var e=function(){this.selector.options.expandSubEnable&&!this.categoryLoaded?this.selector.orgAction.listSubUnitDirect(function(e){e.data.each(function(t){if(!this.selector.isExcluded(t)){var e=this.selector._newItemCategory("ItemUnitCategory",t,this.selector,this.children,this.level+1,this);this.subCategorys.push(e)}}.bind(this)),this.loaded=!0,t&&t(!0)}.bind(this),null,this.data.distinguishedName):(this.loaded=!0,t&&t(!0))}.bind(this);this.itemLoaded?e():this.selector.orgAction.listIdentityWithUnit(function(t){t.data.each(function(t){if(!this.selector.isExcluded(t)){var e=this.selector._newItem(t,this.selector,this.children,this.level+1,this);this.selector.items.push(e),this.subItems&&this.subItems.push(e)}}.bind(this)),e()}.bind(this),null,this.data.distinguishedName)}},_hasChild:function(){return(this.data.subDirectUnitCount?this.data.subDirectUnitCount:0)+(this.data.subDirectIdentityCount?this.data.subDirectIdentityCount:0)},_hasChildCategory:function(){return this.data.subDirectUnitCount?this.data.subDirectUnitCount:0},_hasChildItem:function(){return this.data.subDirectIdentityCount?this.data.subDirectIdentityCount:0},afterLoad:function(){if(1===this.level&&this.clickItem(),this.selector.options.showSelectedCount||this.selector.options.isCheckStatus){var t=this._getSelectedCount();this.checkCountAndStatus(t)}},clickFlatCategoryItem:function(t,e){if(this._hasChildItem()){var i=!this.itemLoaded;this.loadItemChildren(function(){if(e)this.children.setStyles({display:"none",height:"0px"}),this.node.setStyles(this.selector.css.flatCategoryItemNode),this.isExpand=!1;else if(i)this.children.setStyles({display:"block",height:"auto"}),this.node.setStyles(this.selector.css.flatCategoryItemNode_selected),this.isExpand=!0;else{"none"===this.children.getStyle("display")?(this.children.setStyles({display:"block",height:"auto"}),this.node.setStyles(this.selector.css.flatCategoryItemNode_selected),this.isExpand=!0):(this.children.setStyles({display:"none",height:"0px"}),this.node.setStyles(this.selector.css.flatCategoryItemNode),this.isExpand=!1)}t&&t()}.bind(this))}},loadCategoryChildren:function(t){this.categoryLoaded?t&&t():this.selector.options.expandSubEnable?this.selector.orgAction.listSubUnitDirect(function(e){e.data.each(function(t){if(!this.selector.isExcluded(t)){var e=this.selector._newItemCategory("ItemUnitCategory",t,this.selector,this.children,this.level+1,this);this.subCategorys.push(e)}}.bind(this)),this.categoryLoaded=!0,t&&t()}.bind(this),null,this.data.distinguishedName):t&&t()},loadItemChildren:function(t){this.itemLoaded?t&&t():this.selector.orgAction.listIdentityWithUnit(function(e){e.data.each(function(t){if(!this.selector.isExcluded(t)){var e=this.selector._newItem(t,this.selector,this.children,this.level+1,this);this.selector.items.push(e),this.subItems&&this.subItems.push(e)}this.itemLoaded=!0}.bind(this)),t&&t()}.bind(this),null,this.data.distinguishedName)}}),MWF.xApplication.Selector.Identity.ItemUnitCategory=new Class({Extends:MWF.xApplication.Selector.Identity.ItemCategory}),MWF.xApplication.Selector.Identity.ItemGroupCategory=new Class({Extends:MWF.xApplication.Selector.Identity.ItemCategory,createNode:function(){this.node=new Element("div",{styles:this.selector.css.selectorItemCategory}).inject(this.container)},_setIcon:function(){var t=this.selector.options.style;this.iconNode.setStyle("background-image","url(../x_component_Selector/$Selector/"+t+"/icon/groupicon.png)")},_getTotalCount:function(){if(!this.selector.allGroupObjectByDn)return 0;var t=this.selector.allGroupObjectByDn[this.data.distinguishedName];return t?t.subNestedIdentityCount:0},_getSelectedCount:function(){if("number"===typeOf(this.selectedCount))return this.selectedCount;if(!this.selector.allGroupObjectByDn)return 0;var t=this.selector.allGroupObjectByDn[this.data.distinguishedName],e=t?t.selectedNestedIdentityCount:0;return this.selectedCount=e,e},loadSub:function(t){if(this.loaded)t&&t();else{var e,i,s,o;this.data.personList&&(e=new Element("div").inject(this.children)),this.data.identityList&&(i=new Element("div").inject(this.children)),this.data.groupList&&(s=new Element("div").inject(this.children)),this.data.unitList&&(o=new Element("div").inject(this.children));var n=0,a=0,r=0,l=0,c=function(e,i){var s=i||1;this.selector.options.expandSubEnable?("person"===e&&(n+=s),"identity"===e&&(a+=s),"unit"===e&&(r+=s),"group"===e&&(l+=s),this.data.personList&&0!==this.data.personList.length&&this.data.personList.length!=n||this.data.identityList&&0!==this.data.identityList.length&&this.data.identityList.length!=a||this.data.unitList&&0!==this.data.unitList.length&&this.data.unitList.length!=r||this.data.groupList&&0!==this.data.groupList.length&&this.data.groupList.length!=l||(this.loaded=!0,t&&t())):("person"===e&&(n+=s),"identity"===e&&(a+=s),this.data.personList&&0!==this.data.personList.length&&this.data.personList.length!=n||this.data.identityList&&0!==this.data.identityList.length&&this.data.identityList.length!=a||(this.loaded=!0,t&&t()))}.bind(this);c(),this.data.identityList&&this.data.identityList.length>0&&("person"===this.selector.options.resultType?o2.Actions.load("x_organization_assemble_express").PersonAction.listWithIdentityObject({identityList:this.data.identityList},function(t){this.selector.includeObject.loadPersonItem(t,i,this.level+1,this),c("identity",this.data.identityList.length)}.bind(this),function(){c("identity",this.data.identityList.length)}.bind(this)):o2.Actions.load("x_organization_assemble_express").IdentityAction.listObject({identityList:this.data.identityList},function(t){this.selector.includeObject.loadIdentityItem(t,i,this.level+1,this),c("identity",this.data.identityList.length)}.bind(this),function(){c("identity",this.data.identityList.length)}.bind(this))),this.data.personList&&this.data.personList.length>0&&("person"===this.selector.options.resultType?o2.Actions.load("x_organization_assemble_express").PersonAction.listObject({personList:this.data.personList},function(t){this.selector.includeObject.loadPersonItem(t,e,this.level+1,this),c("person",this.data.personList.length)}.bind(this),function(){c("person",this.data.personList.length)}.bind(this)):o2.Actions.load("x_organization_assemble_express").IdentityAction.listWithPersonObject({personList:this.data.personList},function(t){this.selector.includeObject.loadIdentityItem(t,e,this.level+1,this),c("person",this.data.personList.length)}.bind(this),function(){c("person",this.data.personList.length)}.bind(this))),this.selector.options.expandSubEnable&&((this.data.unitList||[]).each(function(t){this.selector.orgAction.getUnit(function(t){this.selector.includeObject.loadUnitItem(t,o,this.level+1,this),c("unit")}.bind(this),(function(){c("unit")}),t)}.bind(this)),(this.data.groupList||[]).each(function(t){this.selector.orgAction.getGroup(function(t){this.selector.includeObject.loadGroupItem(t,s,this.level+1,this),c("group")}.bind(this),(function(){c("group")}),t)}.bind(this)))}},loadCategoryChildren:function(t){if(this.categoryLoaded)t&&t();else{var e,i;this.data.groupList&&(e=new Element("div").inject(this.children)),this.data.unitList&&(i=new Element("div").inject(this.children));var s=0,o=0,n=function(e,i){var n=i||1;this.selector.options.expandSubEnable?("unit"===e&&(s+=n),"group"===e&&(o+=n),this.data.unitList&&0!==this.data.unitList.length&&this.data.unitList.length!=s||this.data.groupList&&0!==this.data.groupList.length&&this.data.groupList.length!=o||(this.categoryLoaded=!0,t&&t())):this.categoryLoaded=!0}.bind(this);n(),this.selector.options.expandSubEnable&&((this.data.unitList||[]).each(function(t){this.selector.orgAction.getUnit(function(t){this.selector.includeObject.loadUnitItem(t,i,this.level+1,this),n("unit")}.bind(this),(function(){n("unit")}),t)}.bind(this)),(this.data.groupList||[]).each(function(t){this.selector.orgAction.getGroup(function(t){this.selector.includeObject.loadGroupItem(t,e,this.level+1,this),n("group")}.bind(this),(function(){n("group")}),t)}.bind(this)))}},loadItemChildren:function(t){if(this.itemLoaded)t&&t();else{var e,i;this.data.personList&&(e=new Element("div").inject(this.children)),this.data.identityList&&(i=new Element("div").inject(this.children));var s=0,o=0,n=function(e,i){var n=i||1;"person"===e&&(s+=n),"identity"===e&&(o+=n),this.data.personList&&0!==this.data.personList.length&&this.data.personList.length!=s||this.data.identityList&&0!==this.data.identityList.length&&this.data.identityList.length!=o||(this.itemLoaded=!0,t&&t())}.bind(this);n(),this.data.identityList&&this.data.identityList.length>0&&("person"===this.selector.options.resultType?o2.Actions.load("x_organization_assemble_express").PersonAction.listWithIdentityObject({identityList:this.data.identityList},function(t){this.selector.includeObject.loadPersonItem(t,i,this.level+1,this),n("identity",this.data.identityList.length)}.bind(this),function(){n("identity",this.data.identityList.length)}.bind(this)):o2.Actions.load("x_organization_assemble_express").IdentityAction.listObject({identityList:this.data.identityList},function(t){this.selector.includeObject.loadIdentityItem(t,i,this.level+1,this),n("identity",this.data.identityList.length)}.bind(this),function(){n("identity",this.data.identityList.length)}.bind(this))),this.data.personList&&this.data.personList.length>0&&("person"===this.selector.options.resultType?o2.Actions.load("x_organization_assemble_express").PersonAction.listObject({personList:this.data.personList},function(t){this.selector.includeObject.loadPersonItem(t,e,this.level+1,this),n("person",this.data.personList.length)}.bind(this),function(){n("person",this.data.personList.length)}.bind(this)):o2.Actions.load("x_organization_assemble_express").IdentityAction.listWithPersonObject({personList:this.data.personList},function(t){this.selector.includeObject.loadIdentityItem(t,e,this.level+1,this),n("person",this.data.personList.length)}.bind(this),function(){n("person",this.data.personList.length)}.bind(this)))}},_hasChild:function(){return(this.data.unitList?this.data.unitList.length:0)+(this.data.groupList?this.data.groupList.length:0)+(this.data.personList?this.data.personList.length:0)+(this.data.identityList?this.data.identityList.length:0)},_hasChildCategory:function(){return(this.data.unitList?this.data.unitList.length:0)+(this.data.groupList?this.data.groupList.length:0)},_hasChildItem:function(){return(this.data.personList?this.data.personList.length:0)+(this.data.identityList?this.data.identityList.length:0)}}),MWF.xApplication.Selector.Identity.ItemRoleCategory=new Class({Extends:MWF.xApplication.Selector.Person.ItemCategory,_getShowName:function(){return this.data.name},_setIcon:function(){var t=this.selector.options.style;this.iconNode.setStyle("background-image","url(../x_component_Selector/$Selector/"+t+"/icon/roleicon.png)")}}),MWF.xApplication.Selector.Identity.Include=new Class({Implements:[Options,Events],options:{include:[],resultType:"",expandSubEnable:!0},initialize:function(t,e,i){this.setOptions(i),this.selector=t,this.itemAreaNode=$(e),this.orgAction=MWF.Actions.get("x_organization_assemble_control")},load:function(t){if(!this.options.include||0===this.options.include.length)return this.fireEvent("afterLoad"),void(t&&t());var e=0,i=function(){++e===this.options.include.length&&(this.fireEvent("afterLoad"),t&&t())}.bind(this);this.includeAreaNode=new Element("div.includeAreaNode").inject(this.itemAreaNode,"top"),this.selector.isFlatCategory&&(this.flatCategoryAreaNode=new Element("div.includeFlatCategoryAreaNode").inject(this.selector.flatCategoryNode,"top")),this.options.include.each(function(t){var e,s,o,n=new Element("div").inject(this.includeAreaNode);(this.flatCategoryAreaNode&&(e=new Element("div").inject(this.flatCategoryAreaNode)),"string"===typeOf(t))?"u"===(o=(s=t.split("@"))[s.length-1].toLowerCase())?this.orgAction.listUnitByKey(function(t){this.loadUnitItem(t,n,null,null,e),i()}.bind(this),i,t):"i"===o?this.orgAction.listIdentityByKey(function(t){this.loadIdentityItem(t,n,null,null,!0),i()}.bind(this),i,t):"g"===o?this.orgAction.listGroupByKey(function(t){this.loadGroupItem(t,n,null,null,e),i()}.bind(this),i,t):"p"===o?"person"===this.options.resultType?this.orgAction.getPerson(function(t){this.loadPersonItem(t,n,null,null,!0),i()}.bind(this),i,t):this.orgAction.listIdentityByPerson(function(t){this.loadIdentityItem(t,n,null,null,!0),i()}.bind(this),i,t):"person"===this.options.resultType?this.orgAction.listPersonByKey(function(t){this.loadPersonItem(t,n,null,null,!0),i()}.bind(this),i,t):this.orgAction.listIdentityByKey(function(t){this.loadIdentityItem(t,n,null,null,!0),i()}.bind(this),i,t):"u"===(o=(s=t.distinguishedName.split("@"))[s.length-1].toLowerCase())?this.orgAction.getUnit(function(t){this.loadUnitItem(t,n,null,null,e),i()}.bind(this),i,t.distinguishedName):"i"===o?this.orgAction.getIdentity(function(t){this.loadIdentityItem(t,n,null,null,!0),i()}.bind(this),i,t.distinguishedName):"g"===o?this.orgAction.getGroup(function(t){this.loadGroupItem(t,n,null,null,e),i()}.bind(this),i,t.distinguishedName,null,null,!0):"p"===o?"person"===this.options.resultType?this.orgAction.getPerson(function(t){this.loadPersonItem(t,n,null,null,!0),i()}.bind(this),i,t.distinguishedName):this.orgAction.listIdentityByPerson(function(t){this.loadIdentityItem(t,n,null,null,!0),i()}.bind(this),i,t.distinguishedName):"person"===this.options.resultType?this.orgAction.getPerson(function(t){this.loadPersonItem(t,n,null,null,!0),i()}.bind(this),i,t.distinguishedName):this.orgAction.getIdentity(function(t){this.loadIdentityItem(t,n,null,null,!0),i()}.bind(this),i,t.distinguishedName)}.bind(this))},loadPersonItem:function(t,e,i,s,o){t.data&&("array"===typeOf(t.data)?t.data:[t.data]).each(function(t){if(!this.selector.isExcluded(t)){this.includePerson||(this.includePerson=[]),o&&this.includePerson.push(t.distinguishedName),this.includePersonObject||(this.includePersonObject=[]),o&&this.includePersonObject.push(t);var n=this.selector._newItem(t,this.selector,e||this.includeAreaNode,i||1,s);this.selector.items.push(n),s&&s.subItems?s.subItems.push(n):this.selector.subItems&&this.selector.subItems.push(n)}}.bind(this))},loadIdentityItem:function(t,e,i,s,o){t.data&&("array"===typeOf(t.data)?t.data:[t.data]).each(function(t){if(!this.selector.isExcluded(t)){this.includeIdentity||(this.includeIdentity=[]),o&&this.includeIdentity.push(t.distinguishedName),this.includeIdentityObject||(this.includeIdentityObject=[]),o&&this.includeIdentityObject.push(t);var n=this.selector._newItem(t,this.selector,e||this.includeAreaNode,i||1,s);this.selector.items.push(n),s&&s.subItems?s.subItems.push(n):this.selector.subItems&&this.selector.subItems.push(n)}}.bind(this))},loadUnitItem:function(t,e,i,s,o){t.data&&("array"===typeOf(t.data)?t.data:[t.data]).each(function(t){var n;this.selector.isExcluded(t)||(this.includeUnit||(this.includeUnit=[]),this.includeUnit.push(t.distinguishedName),o?((n=this.selector._newItemCategory("ItemUnitCategory",t,this.selector,e||this.includeAreaNode,i,s,!0)).nodeContainer=o,n.load()):n=this.selector._newItemCategory("ItemUnitCategory",t,this.selector,e||this.includeAreaNode,i,s),s&&s.subCategorys?s.subCategorys.push(n):this.selector.subCategorys&&this.selector.subCategorys.push(n))}.bind(this))},loadGroupItem:function(t,e,i,s,o){t.data&&("array"===typeOf(t.data)?t.data:[t.data]).each(function(t){var n;this.selector.isExcluded(t)||(this.includeGroup||(this.includeGroup=[]),this.includeGroup.push(t.distinguishedName),o?((n=this.selector._newItemCategory("ItemGroupCategory",t,this.selector,e||this.includeAreaNode,i,s,!0)).nodeContainer=o,n.load()):n=this.selector._newItemCategory("ItemGroupCategory",t,this.selector,e||this.includeAreaNode,i,s),s&&s.subCategorys?s.subCategorys.push(n):this.selector.subCategorys&&this.selector.subCategorys.push(n))}.bind(this))},listByFilter:function(t,e,i){var s=this.listByFilterPerson(e)||[];this.listByFilterUnitAndGroup(t,e,function(o){this.listByFilterGroup(t,e,function(t){i&&i(s.concat(o||[]).concat(t||[]))}.bind(this))}.bind(this))},listByFilterPerson:function(t){var e=[],i=[],s="string"===typeOf(t)?t.toLowerCase():t.key.toLowerCase();return this.includeIdentityObject&&this.includeIdentityObject.length&&(e=this.includeIdentityObject.filter((function(t){return(t.pinyin||"").indexOf(s)>-1||(t.pinyinInitial||"").indexOf(s)>-1||(t.distinguishedName||"").indexOf(s)>-1}))),this.includePersonObject&&this.includePersonObject.length&&(i=this.includePersonObject.filter((function(t){return(t.pinyin||"").indexOf(s)>-1||(t.pinyinInitial||"").indexOf(s)>-1||(t.distinguishedName||"").indexOf(s)>-1}))),e.concat(i)},listByFilterGroup:function(t,e,i){var s="string"===typeOf(e)?e.toLowerCase():e.key.toLowerCase();if(this.includeGroup&&this.includeGroup.length){var o={key:s,groupList:this.includeGroup};this.orgAction["pinyin"===t?"listPersonByPinyin":"listPersonByKey"](function(t){if("person"===this.options.resultType)i&&i(t.data);else{var e=(t.data||[]).map((function(t){return t.id}));o2.Actions.get("x_organization_assemble_express").listIdentityWithPerson({personList:e},function(t){i&&i(t.data)}.bind(this),function(){i&&i()}.bind(this))}}.bind(this),function(){i&&i()}.bind(this),o)}else i&&i()},listByFilterUnitAndGroup:function(t,e,i){"string"===typeOf(e)?e.toLowerCase():e.key.toLowerCase();this.includeUnit&&this.includeUnit.length?(e=this.getUnitFilterKey(e,this.includeUnit,this.includeGroup),this.orgAction.listIdentityByKey(function(t){i&&i(t.data)}.bind(this),(function(){i&&i()}),e)):i&&i()},getUnitFilterKey:function(t,e,i){var s=[];(e||[]).each((function(t){"string"===typeOf(t)&&s.push(t),"object"===typeOf(t)&&s.push(t.distinguishedName)}));var o=[];if((i||[]).each((function(t){"string"===typeOf(t)&&o.push(t),"object"===typeOf(t)&&o.push(t.distinguishedName)})),s.length||o.length){var n={key:t};return s.length&&(n.unitList=s),o.length&&(n.groupList=o),n}return t}}),MWF.xApplication.Selector.Identity.Filter=new Class({Implements:[Options,Events],options:{style:"default",units:[],resultType:""},initialize:function(t,e){this.setOptions(e),this.value=t,this.orgAction=MWF.Actions.get("x_organization_assemble_control")},filter:function(t,e){this.value=t;var i=this.value;if(this.options.units.length){var s=[];this.options.units.each((function(t){"string"===typeOf(t)&&s.push(t),"object"===typeOf(t)&&s.push(t.distinguishedName)})),i={key:this.value,unitList:s}}var o=null;this.orgAction.listIdentityByKey(function(t){o=t.data,e&&e(o)}.bind(this),null,i)}}),MWF.xApplication.Selector=MWF.xApplication.Selector||{},MWF.xDesktop.requireApp("Selector","Identity",null,!1),MWF.xApplication.Selector.Unit=new Class({Extends:MWF.xApplication.Selector.Identity,options:{style:"default",count:0,units:[],values:[],zIndex:1e3,expand:!0,exclude:[],expandSubEnable:!0,selectAllEnable:!0,selectType:"unit"},setInitTitle:function(){this.setOptions({title:MWF.xApplication.Selector.LP.selectUnit})},_init:function(){this.selectType="unit",this.className="Unit"},loadSelectItems:function(t){if(this.options.disabled)this.afterLoadSelectItem();else{var e=this.afterLoadSelectItem.bind(this);if(this.options.units.length){for(var i=[],s=0;s<this.options.units.length;s++){var o=this.options.units[s];"string"===typeOf(o)?i.push(o):"object"===typeOf(o)&&i.push(o.id||o.distinguishedName||o.unique||o.levelName)}o2.Actions.load("x_organization_assemble_express").UnitAction.listObject({unitList:i},function(t){t.data.length&&t.data.each(function(t){if(this.options.expandSubEnable){if(t.subDirectUnitCount){var e=this._newItemCategory("ItemCategory",t,this,this.itemAreaNode);this.subCategorys.push(e)}}else{var i=this._newItem(t,this,this.itemAreaNode);this.items.push(i),this.subItems.push(i)}}.bind(this)),e()}.bind(this),e)}else this.orgAction.listTopUnit(function(t){t.data.each(function(t){if(!this.isExcluded(t)){var e=this._newItem(t,this,this.itemAreaNode,1);this.items.push(e),this.subItems.push(e)}}.bind(this)),e()}.bind(this))}},_scrollEvent:function(t){return!0},_getChildrenItemIds:function(){return null},_newItemCategory:function(t,e,i,s,o,n,a){return new MWF.xApplication.Selector.Unit[t](e,i,s,o,n,a)},_listItemByKey:function(t,e,i){if(this.options.expandSubEnable){if(this.options.units.length){var s=[];this.options.units.each((function(t){"string"===typeOf(t)&&s.push(t),"object"===typeOf(t)&&s.push(t.distinguishedName)})),i={key:i,unitList:s}}this.orgAction.listUnitByKey(function(e){t&&t.apply(this,[e])}.bind(this),e,i)}else i?(this.initSearchArea(!0),this.searchInItems(i)):this.initSearchArea(!1)},_getItem:function(t,e,i,s){this.orgAction.getUnit(function(e){t&&t.apply(this,[e])}.bind(this),e,"string"===typeOf(i)?i:i.distinguishedName,s)},_newItemSelected:function(t,e,i,s){return new MWF.xApplication.Selector.Unit.ItemSelected(t,e,i,s)},_listItemByPinyin:function(t,e,i){if(this.options.units.length){var s=[];this.options.units.each((function(t){"string"===typeOf(t)&&s.push(t),"object"===typeOf(t)&&s.push(t.distinguishedName)})),i={key:i,unitList:s}}this.orgAction.listUnitByPinyininitial(function(e){t&&t.apply(this,[e])}.bind(this),e,i)},_newItem:function(t,e,i,s,o,n){return new MWF.xApplication.Selector.Unit.Item(t,e,i,s,o,n)},_newItemSearch:function(t,e,i,s){return new MWF.xApplication.Selector.Unit.SearchItem(t,e,i,s)}}),MWF.xApplication.Selector.Unit.Item=new Class({Extends:MWF.xApplication.Selector.Identity.Item,load:function(){this.selector.isFlatCategory?!this.justItem&&this.selector.options.expandSubEnable&&this.data.subDirectUnitCount?this.loadCategoryForFlatCategory():this.ignoreItem||this.loadForNormal(!0):this.loadForNormal()},loadForNormal:function(t,e){this.selector.fireEvent("queryLoadItem",[this]),this.node||(this.node=new Element("div",{styles:this.selector.css.selectorItem}).inject(e||this.container)),this.levelNode=new Element("div",{styles:this.selector.css.selectorItemLevelNode}).inject(this.node);var i=this.selector.options.level1Indent+(this.level-1)*this.selector.options.indent;this.levelNode.setStyle("width",i+"px"),this.iconNode=new Element("div",{styles:this.selector.css.selectorItemIconNode}).inject(this.node),this._setIcon(),this.actionNode=new Element("div",{styles:this.selector.css.selectorItemActionNode}).inject(this.node),(1===this.selector.options.count.toInt()||this.selector.options.noSelectedContainer)&&this.selector.css.selectorItemActionNode_single&&this.actionNode.setStyles(this.selector.css.selectorItemActionNode_single),this.textNode=new Element("div",{styles:this.selector.css.selectorItemTextNode,text:this._getShowName(),title:this._getTtiteText()}).inject(this.node),this.textNode.store("indent",i);var s=this.textNode.getStyle("margin-left").toFloat()+i;this.textNode.setStyle("margin-left",s+"px"),this.postLoad&&this.postLoad(),t||this.loadSubItem(),this.setEvent(),this.check(),this.afterLoad&&this.afterLoad(),this.selector.fireEvent("postLoadItem",[this])},_getShowName:function(){return this.isShowLevelName&&this.data.levelName?this.data.levelName:this.data.name},_getTtiteText:function(){return this.data.levelName||this.data.name},_setIcon:function(){var t=this.selector.options.style;this.iconNode.setStyle("background-image","url(../x_component_Selector/$Selector/"+t+"/icon/departmenticon.png)")},loadSubItem:function(){(this.selector.options.expandSubEnable||this.selector.options.forceShowSubEnable)&&(this.isExpand=this.selector.options.expand,(this._hasChild()||this.selector.options.expandEmptyCategory)&&(this.selector.options.expand?"number"===typeOf(this.selector.options.defaultExpandLevel)?this.level<=this.selector.options.defaultExpandLevel&&this._hasChild()?(this.levelNode.setStyles(this.selector.css.selectorItemLevelNode_expand),this.loadSubItems()):(this.isExpand=!1,this.levelNode.setStyles(this.selector.css.selectorItemLevelNode_collapse)):1===this.level&&this._hasChild()?(this.levelNode.setStyles(this.selector.css.selectorItemLevelNode_expand),this.loadSubItems()):(this.isExpand=!1,this.levelNode.setStyles(this.selector.css.selectorItemLevelNode_collapse)):this.levelNode.setStyles(this.selector.css.selectorItemLevelNode_collapse),this.levelNode.addEvent("click",function(t){this.isExpand?(this.selector.fireEvent("collapse",[this]),this.children.setStyle("display","none"),this.levelNode.setStyles(this.selector.css.selectorItemLevelNode_collapse),this.isExpand=!1):(this.selector.fireEvent("expand",[this]),this.loadSubItems(),this.levelNode.setStyles(this.selector.css.selectorItemLevelNode_expand),this.isExpand=!0),t.stopPropagation()}.bind(this)),this.selector.css.selectorItemLevelNode_expand_over&&this.selector.css.selectorItemLevelNode_collapse_over&&this.levelNode.addEvents({mouseover:function(t){var e=this.isExpand?this.selector.css.selectorItemLevelNode_expand_over:this.selector.css.selectorItemLevelNode_collapse_over;this.levelNode.setStyles(e)}.bind(this),mouseout:function(t){var e=this.isExpand?this.selector.css.selectorItemLevelNode_expand:this.selector.css.selectorItemLevelNode_collapse;this.levelNode.setStyles(e)}.bind(this)}),this.selectAllNode||1===this.selector.options.count.toInt()||"blue_flat"===this.selector.options.style||"blue_flat_mobile"===this.selector.options.style||(this.selectAllNode=new Element("div",{styles:this.selector.css.selectorItemCategoryActionNode_selectAll,title:MWF.SelectorLP.selectChildren}).inject(this.textNode,"before"),this.selectAllNode.addEvent("click",function(t){if(this.isSelectedAll)"all"===this.selector.options.selectAllRange?this.unselectAllNested(t,null,!0):this.unselectAll(t,null,!0),this.selector.fireEvent("unselectCatgory",[this]),this.selector.fireEvent("unselectCategory",[this]);else{if("all"===this.selector.options.selectAllRange){var e=new Element("div.categorySelectedNode").inject(this.selector.selectedNode);this.selectAllNested(t,!0,e)}else this.selectAll(t,!0);this.selector.fireEvent("selectCatgory",[this]),this.selector.fireEvent("selectCategory",[this])}t.stopPropagation()}.bind(this)),this.selector.css.selectorItemCategoryActionNode_selectAll_over&&this.selectAllNode.addEvents({mouseover:function(t){this.isSelectedAll||this.selectAllNode.setStyles(this.selector.css.selectorItemCategoryActionNode_selectAll_over)}.bind(this),mouseout:function(t){this.isSelectedAll||this.selectAllNode.setStyles(this.selector.css.selectorItemCategoryActionNode_selectAll)}.bind(this)}))))},unselectAll:function(t,e,i){var s=e||[];e&&"array"!==typeOf(e)&&(s=[e]),(this.subItems||[]).each(function(t){t.isSelected&&!s.contains(t)&&t.unSelected(i)}.bind(this)),this.selectAllNode&&(this.selector.isFlatCategory?this.selectAllNode.setStyles(this.selector.css.flatCategory_selectAll):this.selector.css.selectorItemCategoryActionNode_selectAll&&this.selectAllNode.setStyles(this.selector.css.selectorItemCategoryActionNode_selectAll)),this.isSelectedAll=!1},unselectAllNested:function(t,e,i){this.unselectAll(t,e,i),this.subCategorys&&this.subCategorys.length&&this.subCategorys.each((function(s){s.unselectAllNested&&s.unselectAllNested(t,e,i)})),this.subItems&&this.subItems.length&&this.subItems.each((function(s){s.unselectAllNested&&s.unselectAllNested(t,e,i)}))},selectAllNested:function(t,e,i){var s;i&&(s=new Element("div.categorySelectedNode").inject(i)),this.selectAll(t,e,s,function(){this.subCategorys&&this.subCategorys.length&&this.subCategorys.each((function(s){if(i)var o=new Element("div.categorySelectedNode").inject(i);s.selectAllNested&&s.selectAllNested(t,e,o)})),this.subItems&&this.subItems.length&&this.subItems.each((function(s){if(i)var o=new Element("div.categorySelectedNode").inject(i);s.selectAllNested&&s.selectAllNested(t,e,o)}))}.bind(this))},selectAll:function(t,e,i,s){this.loaded||this.selector.isFlatCategory?(this._selectAll(t,e,i),s&&s()):(this.loadSubItems(function(){this._selectAll(t,e,i),s&&s()}.bind(this)),this.levelNode.setStyles(this.selector.css.selectorItemLevelNode_expand),this.isExpand=!0)},_selectAll:function(t,e,i){if(this.subItems&&this.subItems.length){var s=this.selector.options.maxCount||this.selector.options.count;s||(s=0);var o=0;if(this.subItems.each(function(t){t.isSelected&&o++}.bind(this)),0===s.toInt()||this.selector.selectedItems.length+(this.subItems.length-o)<=s){var n=function(){var t=0;this.subItems.each(function(s){s.isSelected||s.disabled||s.selected(!1,function(){t++,this.subItems.length===t&&e&&this.selector.fireEvent("valid",[this.selector,this])}.bind(this),i)}.bind(this)),this.selectAllNode&&(this.selector.isFlatCategory?this.selectAllNode.setStyles(this.selector.css.flatCategory_selectAll_selected):this.selector.css.selectorItemCategoryActionNode_selectAll_selected&&this.selectAllNode.setStyles(this.selector.css.selectorItemCategoryActionNode_selectAll_selected)),this.isSelectedAll=!0}.bind(this);this._beforeSelectAll?this._beforeSelectAll(n):n()}else MWF.xDesktop.notice("error",{x:"right",y:"top"},MWF.SelectorLP.selectItemMaxText.replace("{count}",s),this.node)}},checkSelectAll:function(){if(!this.isSelectedAll&&this.selectAllNode&&this.subItems){for(var t=!0,e=0;e<this.subItems.length;e++)if(!this.subItems[e].isSelected){t=!1;break}t&&(this.selector.isFlatCategory?this.selectAllNode.setStyles(this.selector.css.flatCategory_selectAll_selected):this.selector.css.selectorItemCategoryActionNode_selectAll_selected&&this.selectAllNode.setStyles(this.selector.css.selectorItemCategoryActionNode_selectAll_selected),this.isSelectedAll=!0)}},checkUnselectAll:function(){if(this.isSelectedAll&&this.selectAllNode&&this.subItems){for(var t=!1,e=0;e<this.subItems.length;e++)if(this.subItems[e].isSelected){t=!0;break}t||(this.selector.isFlatCategory?this.selectAllNode.setStyles(this.selector.css.flatCategory_selectAll):this.selector.css.selectorItemCategoryActionNode_selectAll&&this.selectAllNode.setStyles(this.selector.css.selectorItemCategoryActionNode_selectAll),this.isSelectedAll=!1)}},loadSubItems:function(t){this.loaded||this.loading?this.children.setStyle("display","block"):(this.loading=!0,this.children||(this.children=new Element("div",{styles:this.selector.css.selectorItemCategoryChildrenNode}).inject(this.node,"after")),this.children.setStyle("display","block"),this.selector.orgAction.listSubUnitDirect(function(e){e.data.each(function(t){if(!this.selector.isExcluded(t)){var e=this.selector._newItem(t,this.selector,this.children,this.level+1,this);this.selector.items.push(e),this.subItems||(this.subItems=[]),this.subItems.push(e)}}.bind(this)),this.loaded=!0,this.loading=!1,t&&t()}.bind(this),null,this.data.distinguishedName))},getData:function(t){t&&t()},postLoad:function(){if("blue_flat"===this.selector.options.style)if(1===this.level){var t=26;this.levelNode.setStyle("width",t+"px")}else{t=26+(this.level-1)*this.selector.options.indent;this.levelNode.setStyle("width",t+"px")}},loadCategoryForFlatCategory:function(){if(this.selector.fireEvent("queryLoadCategory",[this]),this.flatCategoryItemNode||(this.flatCategoryItemNode=new Element("div.flatCategoryItemNode",{styles:this.selector.css.flatCategoryItemNode,title:this._getTtiteText()}),this.flatCategoryItemNode.store("category",this),this.flatCategoryItemNode.store("dn",this.data.distinguishedName),this.flatCategoryItemTextNode=new Element("div",{styles:this.selector.css.flatCategoryItemTextNode,text:this._getShowName(),title:this._getTtiteText()}).inject(this.flatCategoryItemNode)),this.children=new Element("div",{styles:this.selector.css.selectorItemCategoryChildrenNode}).inject(this.selector.itemAreaNode),this.children.setStyle("display","none"),1===this.level&&this.loadForNormal(!0,this.children),!this.selectAllNode&&1!==this.selector.options.count.toInt()){var t=new Element("div",{styles:this.selector.css.flatCategory_selectAllWrap}).inject(this.children);this.selectAllNode=new Element("div",{styles:this.selector.css.flatCategory_selectAll,text:MWF.SelectorLP.selectAll}).inject(t),this.selectAllNode.addEvent("click",function(t){this.isSelectedAll?(this.unselectAll(t),this.selector.fireEvent("unselectCatgory",[this]),this.selector.fireEvent("unselectCategory",[this])):(this.selectAll(t),this.selector.fireEvent("selectCatgory",[this]),this.selector.fireEvent("selectCategory",[this])),t.stopPropagation()}.bind(this))}this.flatCategoryItemNode.addEvents({click:function(){this.selector.currentFlatCategory!==this&&(this.selector.currentFlatCategory&&this.selector.currentFlatCategory.clickFlatCategoryItem(null,!0),this.selector.currentFlatCategory=this,this.clickFlatCategoryItem())}.bind(this)});var e,i=!this.data.subDirectUnitCount||this.data.subDirectUnitCount;e=this.nodeContainer?this.nodeContainer:this.category&&this.category.subCategoryListNode?this.category.subCategoryListNode:null,this.subCategoryListNode=this.selector.addFlatCategoryItem(this.flatCategoryItemNode,this.data.subDirectUnitCount,e,i),this.loadCategoryChildren&&this.loadCategoryChildren(),this.selector.fireEvent("postLoadCategory",[this])},clickFlatCategoryItem:function(t,e){var i=!this.itemLoaded;this.loadItemChildren(function(){if(e)this.children.setStyles({display:"none"}),this.flatCategoryItemNode.setStyles(this.selector.css.flatCategoryItemNode),this.isExpand=!1;else if(i)this.children.setStyles({display:"block"}),this.flatCategoryItemNode.setStyles(this.selector.css.flatCategoryItemNode_selected),this.isExpand=!0;else{"none"===this.children.getStyle("display")?(this.children.setStyles({display:"block"}),this.flatCategoryItemNode.setStyles(this.selector.css.flatCategoryItemNode_selected),this.isExpand=!0):(this.children.setStyles({display:"none"}),this.flatCategoryItemNode.setStyles(this.selector.css.flatCategoryItemNode),this.isExpand=!1)}t&&t()}.bind(this))},loadCategoryChildren:function(t){this.categoryLoaded?t&&t():this.selector.orgAction.listSubUnitDirect(function(e){e.data.each(function(t){if(!this.selector.isExcluded(t)&&t.subDirectUnitCount)this.selector._newItem(t,this.selector,this.children,this.level+1,this)}.bind(this)),this.categoryLoaded=!0,t&&t()}.bind(this),null,this.data.distinguishedName)},loadItemChildren:function(t){this.itemLoaded?t&&t():this.selector.orgAction.listSubUnitDirect(function(e){e.data.each(function(t){if(!this.selector.isExcluded(t)){var e=this.selector._newItem(t,this.selector,this.children,this.level+1,this,!0);e.justItem=!0,e.load(),this.selector.items.push(e),this.subItems||(this.subItems=[]),this.subItems.push(e)}}.bind(this)),this.itemLoaded=!0,t&&t()}.bind(this),null,this.data.distinguishedName)},_hasChild:function(){return this.data.subDirectUnitCount}}),MWF.xApplication.Selector.Unit.SearchItem=new Class({Extends:MWF.xApplication.Selector.Unit.Item,load:function(){this.loadForNormal()},_getShowName:function(){return this.data.levelName||this.data.name},loadSubItems:function(t){this.loaded||this.loading?this.children.setStyle("display","block"):(this.loading=!0,this.children||(this.children=new Element("div",{styles:this.selector.css.selectorItemCategoryChildrenNode}).inject(this.node,"after")),this.children.setStyle("display","block"),this.selector.orgAction.listSubUnitDirect(function(e){e.data.each(function(t){var e;this.selector.isExcluded(t)||(this.selector.isFlatCategory?((e=this.selector._newItem(t,this.selector,this.children,this.level+1,this,!0)).isShowLevelName=!0,e.load()):e=this.selector._newItem(t,this.selector,this.children,this.level+1,this),this.selector.items.push(e),this.subItems||(this.subItems=[]),this.subItems.push(e))}.bind(this)),this.loaded=!0,this.loading=!1,t&&t()}.bind(this),null,this.data.distinguishedName))}}),MWF.xApplication.Selector.Unit.ItemSelected=new Class({Extends:MWF.xApplication.Selector.Identity.ItemSelected,getData:function(t){t&&t()},_getTtiteText:function(){return this.data.levelName||this.data.name},_getShowName:function(){return this.data.name+(this.data.levelName?"("+this.data.levelName+")":"")},_setIcon:function(){var t=this.selector.options.style;this.iconNode.setStyle("background-image","url(../x_component_Selector/$Selector/"+t+"/icon/departmenticon.png)")}}),MWF.xApplication.Selector.Unit.ItemCategory=new Class({Extends:MWF.xApplication.Selector.Identity.ItemCategory,loadSub:function(t){this.loaded?t&&t():this.selector.orgAction.listSubUnitDirect(function(e){e.data.each(function(t){if(!this.selector.isExcluded(t)){var e=this.selector._newItem(t,this.selector,this.children,this.level+1,this);e.isItem=!0,e.isCategory=!0,this.selector.items.push(e),this.subItems&&this.subItems.push(e),this.subCategorys.push(e)}}.bind(this)),this.loaded=!0,t&&t()}.bind(this),null,this.data.distinguishedName)},_hasChild:function(){return this.data.subDirectUnitCount?this.data.subDirectUnitCount:0},_hasChildCategory:function(){return this.data.subDirectUnitCount?this.data.subDirectUnitCount:0},_hasChildItem:function(){return this.data.subDirectUnitCount?this.data.subDirectUnitCount:0},loadCategoryChildren:function(t){this.categoryLoaded?t&&t():this.selector.orgAction.listSubUnitDirect(function(e){e.data.each(function(t){if(!this.selector.isExcluded(t)){var e=this.selector._newItem(t,this.selector,this.children,this.level+1,this,!0);e.ignoreItem=!0,e.load(),this.subCategorys.push(e)}}.bind(this)),this.categoryLoaded=!0,t&&t()}.bind(this),null,this.data.distinguishedName)},loadItemChildren:function(t){this.itemLoaded?t&&t():this.selector.orgAction.listSubUnitDirect(function(e){e.data.each(function(t){if(!this.selector.isExcluded(t)){var e=this.selector._newItem(t,this.selector,this.children,this.level+1,this,!0);e.justItem=!0,e.load(),this.selector.items.push(e),this.subItems&&this.subItems.push(e)}}.bind(this)),this.itemLoaded=!0,t&&t()}.bind(this),null,this.data.distinguishedName)}}),MWF.xApplication.Selector.Unit.Filter=new Class({Implements:[Options,Events],options:{style:"default",units:[]},initialize:function(t,e){this.setOptions(e),this.value=t,this.orgAction=MWF.Actions.get("x_organization_assemble_control")},filter:function(t,e){this.value=t;var i=this.value;if(this.options.units.length){var s=[];this.options.units.each((function(t){"string"===typeOf(t)&&s.push(t),"object"===typeOf(t)&&s.push(t.distinguishedName)})),i={key:i,unitList:s}}this.orgAction.listUnitByKey(function(t){data=t.data,e&&e(data)}.bind(this),null,i)}}),MWF.xApplication.Selector=MWF.xApplication.Selector||{},MWF.xDesktop.requireApp("Selector","Identity",null,!1),MWF.xApplication.Selector.IdentityWidthDuty=new Class({Extends:MWF.xApplication.Selector.Identity,options:{style:"default",count:0,title:"",dutys:[],units:[],values:[],zIndex:1e3,expand:!1,noUnit:!1,include:[],resultType:"",expandSubEnable:!0,selectAllEnable:!0,exclude:[],selectType:"identity"},setInitTitle:function(){this.setOptions({title:MWF.xApplication.Selector.LP.selectIdentity})},_init:function(){this.selectType="identity",this.className="IdentityWidthDuty"},loadSelectItems:function(t){var e=this.afterLoadSelectItem.bind(this);if(this.options.disabled)this.afterLoadSelectItem();else if("person"===this.options.resultType&&(this.titleTextNode?this.titleTextNode.set("text",MWF.xApplication.Selector.LP.selectPerson):this.options.title=MWF.xApplication.Selector.LP.selectPerson),this.options.dutys.length){var i=0,s=function(){++i===this.options.dutys.length&&(this.dutyLoaded=!0,this.includeLoaded&&e())}.bind(this);this.loadInclude(function(){this.includeLoaded=!0,this.dutyLoaded&&e()}.bind(this));var o=function(){this.options.dutys.each(function(t){var e={name:t,id:t},i=this._newItemCategory("ItemCategory",e,this,this.itemAreaNode);this.subCategorys.push(i),s()}.bind(this))}.bind(this);if(0===this.options.units.length)o();else{var n=[];if(this.options.units.each((function(t){var e="string"===typeOf(t)?t:t.distinguishedName||t.unique||t.id||t.levelName;e&&n.push(e)})),this.options.expandSubEnable){var a=[],r=function(){MWF.Actions.get("x_organization_assemble_express").listUnitSubNested({unitList:n},function(t){var e=[];if(1===this.options.units.length){e=Array.clone(n);for(var i=0;i<t.data.length;i++)e.contains(t.data[i].distinguishedName)||e.push(t.data[i].distinguishedName)}else a.each((function(i){e.push(i.distinguishedName||i.unique||i.id||i.levelName);for(var s=0;s<t.data.length;s++)t.data[s].levelName.indexOf(i.levelName)>-1&&e.push(t.data[s].distinguishedName)}));this.allUnitNames=e,o()}.bind(this),null)}.bind(this),l=!1;1===this.options.units.length?r():(this.options.units.each((function(t){"string"===typeOf(t)?-1===t.indexOf("/")?l=!0:a.push({levelName:t}):t.levelName?a.push(t):l=!0})),l?o2.Actions.load("x_organization_assemble_express").UnitActions.listObject(function(t){a=t.data||[],r()}.bind(this)):r())}else this.allUnitNames=n,o()}}},search:function(){var t=this.searchInput.get("value");if(t){this.initSearchArea(!0);var e=this.searchInItems(t)||[];this.options.include&&this.options.include.length&&this.includeObject.listByFilter("key",t,function(t){t.each(function(t){e.contains(t.distinguishedName)||this.isExcluded(t)||this._newItem(t,this,this.itemSearchAreaNode)}.bind(this))}.bind(this))}else this.initSearchArea(!1)},listPersonByPinyin:function(t){this.searchInput.focus();var e=this.searchInput.get("value");e+=t.get("text"),this.searchInput.set("value",e),this.search()},checkLoadSelectItems:function(){this.options.units.length,this.loadSelectItems()},_scrollEvent:function(t){return!0},_getChildrenItemIds:function(){return null},_newItemCategory:function(t,e,i,s,o,n,a){return new MWF.xApplication.Selector.IdentityWidthDuty[t](e,i,s,o,n,a)},_listItemByKey:function(t,e,i){this.options.units.length&&(i={key:i,unitList:this.options.units}),this.orgAction.listIdentityByKey(function(e){t&&t.apply(this,[e])}.bind(this),e,i)},_getItem:function(t,e,i,s){this.orgAction.getIdentity(function(e){t&&t.apply(this,[e])}.bind(this),e,"string"===typeOf(i)?i:i.distinguishedName,s)},_newItemSelected:function(t,e,i,s){return new MWF.xApplication.Selector.IdentityWidthDuty.ItemSelected(t,e,i,s)},_listItemByPinyin:function(t,e,i){this.options.units.length&&(i={key:i,unitList:this.options.units}),this.orgAction.listIdentityByPinyin(function(e){t&&t.apply(this,[e])}.bind(this),e,i)},_newItem:function(t,e,i,s,o,n){return new MWF.xApplication.Selector.IdentityWidthDuty.Item(t,e,i,s,o,n)},_newItemSearch:function(t,e,i,s){return new MWF.xApplication.Selector.IdentityWidthDuty.SearchItem(t,e,i,s)}}),MWF.xApplication.Selector.IdentityWidthDuty.Item=new Class({Extends:MWF.xApplication.Selector.Identity.Item,_getShowName:function(){return this.data.name},_getTtiteText:function(){return this.data.name+(this.data.unitLevelName?"("+this.data.unitLevelName+")":"")},_setIcon:function(){var t=this.selector.options.style;this.iconNode.setStyle("background-image","url(../x_component_Selector/$Selector/"+t+"/icon/personicon.png)")}}),MWF.xApplication.Selector.IdentityWidthDuty.SearchItem=new Class({Extends:MWF.xApplication.Selector.Identity.Item,_getShowName:function(){return this.data.name+(this.data.unitLevelName?"("+this.data.unitLevelName+")":"")}}),MWF.xApplication.Selector.IdentityWidthDuty.ItemSelected=new Class({Extends:MWF.xApplication.Selector.Identity.ItemSelected,_getShowName:function(){return this.data.name+(this.data.unitLevelName?"("+this.data.unitLevelName+")":"")},_getTtiteText:function(){return this.data.name+(this.data.unitLevelName?"("+this.data.unitLevelName+")":"")},_setIcon:function(){var t=this.selector.options.style;this.iconNode.setStyle("background-image","url(../x_component_Selector/$Selector/"+t+"/icon/personicon.png)")}}),MWF.xApplication.Selector.IdentityWidthDuty.ItemCategory=new Class({Extends:MWF.xApplication.Selector.Identity.ItemCategory,createNode:function(){this.node=new Element("div",{styles:this.selector.css.selectorItemCategory_department,title:this._getTtiteText()}).inject(this.container)},_getShowName:function(){return this.data.name},_setIcon:function(){var t=this.selector.options.style;this.iconNode.setStyle("background-image","url(../x_component_Selector/$Selector/"+t+"/icon/companyicon.png)")},_addSelectedCount:function(){var t=this._getSelectedCount();this.checkCountAndStatus(t)},_getTotalCount:function(){return this.subItems.length},_getSelectedCount:function(){return this.subItems.filter((function(t){return t.isSelected})).length},loadSub:function(t){this._loadSub(function(e){if(e&&(this.selector.options.showSelectedCount||this.selector.options.isCheckStatus)){var i=this._getSelectedCount();this.checkCountAndStatus(i)}t&&t()}.bind(this))},_loadSub:function(t){if(this.loaded||this.loadingsub)t&&t();else if(this.loadingsub=!0,this.selector.options.units.length){var e={name:this.data.name,unit:"",unitList:this.selector.allUnitNames};MWF.Actions.get("x_organization_assemble_express").getDuty(e,function(e){e.data.each(function(t){if(!this.selector.isExcluded(t)){var e=this.selector._newItem(t,this.selector,this.children,this.level+1,this);this.selector.items.push(e),this.subItems&&this.subItems.push(e)}}.bind(this)),this.loaded||(this.loaded=!0,this.loadingsub=!1,this.itemLoaded=!0,t&&t(!0))}.bind(this),null,!1)}else this.selector.orgAction.listIdentityWithDuty(function(e){e.data.each(function(t){if(!this.selector.isExcluded(t)){var e=this.selector._newItem(t,this.selector,this.children,this.level+1,this);this.selector.items.push(e),this.subItems&&this.subItems.push(e)}}.bind(this)),this.loaded=!0,this.loadingsub=!1,t&&t(!0)}.bind(this),null,this.data.name)},loadCategoryChildren:function(t){this.loadSub(t),this.categoryLoaded=!0},loadItemChildren:function(t){this.loadSub(t)},_hasChild:function(){return!0},_hasChildCategory:function(){return!0},_hasChildItem:function(){return!0}}),MWF.xApplication.Selector.IdentityWidthDuty.ItemUnitCategory=new Class({Extends:MWF.xApplication.Selector.Identity.ItemUnitCategory,loadSub:function(t){this.loaded?t&&t():this.selector.orgAction.listIdentityWithUnit(function(e){this.itemLoaded||(e.data.each(function(t){if(!this.selector.isExcluded(t)){var e=this.selector._newItem(t,this.selector,this.children,this.level+1,this);this.selector.items.push(e),this.subItems&&this.subItems.push(e)}}.bind(this)),this.itemLoaded=!0),this.selector.options.expandSubEnable||(this.loaded=!0,t&&t()),this.selector.options.expandSubEnable&&this.selector.orgAction.listSubUnitDirect(function(e){e.data.each(function(t){if(!this.selector.isExcluded(t)){var e=this.selector._newItemCategory("ItemUnitCategory",t,this.selector,this.children,this.level+1,this);this.subCategorys.push(e)}}.bind(this)),this.loaded=!0,t&&t()}.bind(this),null,this.data.distinguishedName)}.bind(this),null,this.data.distinguishedName)},loadCategoryChildren:function(t){this.categoryLoaded?t&&t():(this.loadSub(t),this.categoryLoaded=!0,this.itemLoaded=!0)},loadItemChildren:function(t){this.itemLoaded?t&&t():(this.selector.orgAction.listIdentityWithUnit(function(e){e.data.each(function(t){if(!this.selector.isExcluded(t)){var e=this.selector._newItem(t,this.selector,this.children,this.level+1,this);this.selector.items.push(e),this.subItems&&this.subItems.push(e)}}.bind(this)),t&&t()}.bind(this),null,this.data.distinguishedName),this.itemLoaded=!0)}}),MWF.xApplication.Selector.IdentityWidthDuty.ItemGroupCategory=new Class({Extends:MWF.xApplication.Selector.Identity.ItemGroupCategory}),MWF.xApplication.Selector.IdentityWidthDuty.Filter=new Class({Implements:[Options,Events],options:{style:"default",units:[],dutys:[]},initialize:function(t,e){this.setOptions(e),this.value=t,this.orgAction=MWF.Actions.get("x_organization_assemble_control")},getList:function(t){this.list=[],MWF.require("MWF.widget.PinYin",function(){this.options.dutys.each(function(t){if(this.options.units.length){var e=MWF.Actions.get("x_organization_assemble_express"),i={name:t,unit:""};this.options.units.each(function(t){"string"===typeOf(t)?i.unit=t:i.unit=t.distinguishedName||t.unique||t.id||t.levelName,e.getDuty(i,function(t){t.data.each(function(t){t.pinyin=t.name.toPY().toLowerCase(),t.firstPY=t.name.toPYFirst().toLowerCase(),this.list.push(t)}.bind(this))}.bind(this),null,!1)}.bind(this))}else this.orgAction.listIdentityWithDuty(function(t){t.data.each(function(t){t.pinyin=t.name.toPY().toLowerCase(),t.firstPY=t.name.toPYFirst().toLowerCase(),this.list.push(t)}.bind(this))}.bind(this),null,t,!1)}.bind(this)),t&&t()}.bind(this))},filter:function(t,e){this.value=t,this.getList(function(){var t=this.list.filter(function(t){return-1!=(t.name+"#"+t.pinyin+"#"+t.firstPY).indexOf(this.value)}.bind(this));e&&e(t)}.bind(this))}}),MWF.xApplication.Selector=MWF.xApplication.Selector||{},MWF.xDesktop.requireApp("Selector","IdentityWidthDuty",null,!1),MWF.xApplication.Selector.IdentityWidthDutyCategoryByUnit=new Class({Extends:MWF.xApplication.Selector.IdentityWidthDuty,options:{style:"default",count:0,title:"",dutys:[],units:[],values:[],zIndex:1e3,expand:!1,noUnit:!1,include:[],resultType:"",expandSubEnable:!0,selectAllEnable:!0,exclude:[],dutyUnitLevelBy:"duty",identitySortBy:"identityNumber",selectType:"identity"},setInitTitle:function(){this.setOptions({title:MWF.xApplication.Selector.LP.selectIdentity})},_init:function(){this.selectType="identity",this.className="IdentityWidthDutyCategoryByUnit"},getUnitUniqueFormDn:function(t){if(!t)return"";var e=t.split("@");return 3===e.length?e[1]:t},loadSelectItems:function(t){if("person"===this.options.resultType&&(this.titleTextNode?this.titleTextNode.set("text",MWF.xApplication.Selector.LP.selectPerson):this.options.title=MWF.xApplication.Selector.LP.selectPerson),this.options.disabled)this.afterLoadSelectItem();else if(this.options.dutys.length){this.loadInclude(function(){this.includeLoaded=!0,this.dutyLoaded&&this.afterLoadSelectItem()}.bind(this));for(var e=[],i=[],s=0;s<this.options.units.length;s++){var o=this.options.units[s];"string"===typeOf(o)?(e.push(o),i.push(this.getUnitUniqueFormDn(o))):(e.push(o.distinguishedName||o.unique||o.id||o.levelName),i.push(o.distinguishedName?this.getUnitUniqueFormDn(o.distinguishedName):o.unique||o.id||o.levelName))}this.unitStringList=e,this.unitUniqueList=i,o2.Actions.load("x_organization_assemble_express").UnitDutyAction.listIdentityWithUnitWithNameObject({nameList:this.options.dutys,unitList:e,recursiveUnit:!!this.options.expandSubEnable},function(t){this.allIdentityData=t.data,this._loadSelectItems(t.data)}.bind(this))}else this.afterLoadSelectItem()},_loadSelectItems:function(t){var e=this.listNestedUnitByIdentity(t);this.dataTree=e,this.uniqueIdentity(e),"duty"===this.options.dutyUnitLevelBy?(this.level1Container=[],this.options.units&&this.options.units.length&&this.options.units.each(function(t,e){var i=new Element("div").inject(this.itemAreaNode);this.level1Container.push(i)}.bind(this)),this._loadSelectItemsByDutyUnit(e)):this._loadSelectItemsByIdentityUnit(e),this.dutyLoaded=!0,this.includeLoaded&&this.afterLoadSelectItem()},_loadSelectItemsByIdentityUnit:function(t){if(t.unitList){this.sortUnit(t.unitList);for(var e=0;e<t.unitList.length;e++){var i=t.unitList[e],s=this._newItemCategory("ItemCategory",i,this,this.itemAreaNode);this.subCategorys.push(s)}}},sortUnit:function(t){"duty"===this.options.dutyUnitLevelBy&&this.options.units?t.sort(function(t,e){var i=this.getIndexFromUnitOption(t),s=this.getIndexFromUnitOption(e);return 0===t.orderNumber&&(t.orderNumber=-1),0===e.orderNumber&&(e.orderNumber=-1),(i=-1===i?9999999+(t.orderNumber||9999999):i)-(s=-1===s?9999999+(e.orderNumber||9999999):s)}.bind(this)):t.sort(function(t,e){return 0===t.orderNumber&&(t.orderNumber=-1),0===e.orderNumber&&(e.orderNumber=-1),(t.orderNumber||9999999)-(e.orderNumber||9999999)}.bind(this))},_loadSelectItemsByDutyUnit:function(t){if(t.unitList)for(var e=0;e<t.unitList.length;e++){var i=t.unitList[e];if(this.isUnitContain(i)){var s=this.itemAreaNode;if(this.level1Container&&this.level1Container.length){var o=this.getIndexFromUnitOption(i);o>-1&&this.level1Container.length>o&&this.level1Container[o]&&(s=this.level1Container[o])}var n=this._newItemCategory("ItemCategory",i,this,s);this.subCategorys.push(n)}else this._loadSelectItemsByDutyUnit(i)}},getIndexFromUnitOption:function(t){if(!this.unitStringList||!this.unitStringList.length)return-1;var e=-1;return-1==e&&t.distinguishedName&&(e=this.unitStringList.indexOf(t.distinguishedName)),-1==e&&t.id&&(e=this.unitStringList.indexOf(t.id)),-1==e&&t.unique&&(e=this.unitStringList.indexOf(t.unique)),-1==e&&t.levelName&&(e=this.unitStringList.indexOf(t.levelName)),-1==e&&t.unique&&(e=this.unitUniqueList.indexOf(t.unique)),-1==e&&!t.unique&&t.distinguishedName&&(e=this.unitUniqueList.indexOf(t.distinguishedName.split("@")[1]||"")),e},isUnitContain:function(t){if(0===this.options.units.length)return!0;this.unitFlagMap||(this.unitFlagMap={},this.options.units.each(function(t){t&&(this.unitFlagMap["string"===typeOf(t)?t:t.distinguishedName||t.id||t.unique||t.employee||t.levelName]=!0)}.bind(this))),this.unitUniqueMap||(this.unitUniqueMap={},this.unitUniqueList.each(function(t){t&&(this.unitUniqueMap[t]=!0)}.bind(this)));var e=this.unitFlagMap,i=this.unitUniqueMap,s=t.distinguishedName&&e[t.distinguishedName]||t.levelName&&e[t.levelName]||t.id&&e[t.id]||t.unique&&e[t.unique]||t.unique&&i[t.unique];if(!s&&!t.unique&&t.distinguishedName){var o=t.distinguishedName.split("@");3===o.length&&o[1]&&i[o[1]]&&(s=!0)}return s},getUnitOrderNumber:function(t){return this.allIdentityInUnitObject[t.levelName].orderNumber},listAllUnitObject:function(t,e){for(var i="duty"===this.options.dutyUnitLevelBy?"matchUnitLevelName":"unitLevelName",s=[],o=0;o<t.length;o++)for(var n=t[o][i].split("/"),a=[],r=0;r<n.length;r++){a.push(n[r]);var l=a.join("/");s.contains(l)||s.push(l)}o2.Actions.load("x_organization_assemble_express").UnitAction.listObject({unitList:s},function(t){this.allUnitObject={},t.data.each(function(t){this.allUnitObject[t.levelName]=t}.bind(this)),e&&e()}.bind(this),null,!1)},listNestedUnitByIdentity:function(t){return this.listAllUnitObject(t),this._listNestedUnitByIdentity(t)},_listNestedUnitByIdentity:function(t){for(var e="duty"===this.options.dutyUnitLevelBy?"matchUnitLevelName":"unitLevelName",i={},s=0;s<t.length;s++){var o=!0;if(!this.isExcluded(t[s])){for(var n=t[s][e].split("/"),a=[],r=i,l=0;l<n.length;l++){a.push(n[l]);var c=a.join("/");if(this.isExcluded(this.allUnitObject[c]||{})){o=!1;break}r.unitList||(r.unitList=[]);for(var d=!1,h=0;h<r.unitList.length;h++)if(r.unitList[h].levelName==c){r=r.unitList[h],d=!0;break}if(!d){var u=this.allUnitObject[c]||{};u.matchLevelName=c,r.unitList.push(u),r=u}r.identityList||(r.identityList=[])}o&&r.identityList.push(t[s])}}return i},uniqueIdentity:function(t){var e={},i={},s=function(t,s){if(t.distinguishedName&&e[t.distinguishedName]||t.levelName&&e[t.levelName]||t.id&&e[t.id]||t.unique&&e[t.unique])return!0;var o="string"===typeOf(t)?t:t.distinguishedName||t.id||t.unique||t.employee||t.levelName;return e[o]=!0,i[o]=s+1,!1},o=function(t){var e=t.distinguishedName&&i[t.distinguishedName]||t.levelName&&i[t.levelName]||t.id&&i[t.id]||t.unique&&i[t.unique];return e||(e=0),e-1},n=[];if(t.identityList)for(var a=0;a<t.identityList.length;a++)if(s(t.identityList[a],a)){if("identityNumber"!==this.options.identitySortBy){var r=o(t.identityList[a]);if(r>-1){var l=t.identityList[r];l.otherMatchUnitDutyList||(l.otherMatchUnitDutyList=[]),l.otherMatchUnitDutyList.push({matchUnitDutyNumber:t.identityList[a].matchUnitDutyNumber,matchUnitDutyName:t.identityList[a].matchUnitDutyName})}}}else n.push(t.identityList[a]);if(t.identityList=n,this.options.isCheckStatus){var c=(t.matchLevelName||t.levelName||"").split("/"),d=[];for(a=0;a<c.length;a++){d.push(c[a]);var h=d.join("/"),u=this.allUnitObject[h];u&&(u.subNestedIdentityCount=(u.subNestedIdentityCount||0)+n.length)}}if(t.unitList)for(a=0;a<t.unitList.length;a++)this.uniqueIdentity(t.unitList[a])},createItemsSearchData:function(t){this.itemsSearchData?t&&t():(this.itemsSearchData=[],MWF.require("MWF.widget.PinYin",function(){var e=[],i=this;function s(t){t.identityList&&t.identityList.length&&t.identityList.each((function(t){!function(t){var s=t.distinguishedName||t.id||t.name||t.text;if(-1==e.indexOf(s)){var o=t.name||"";if(!o&&t.distinguishedName)o=t.distinguishedName.split("@")[0];var n=o.toPY().toLowerCase(),a=o.toPYFirst().toLowerCase();i.itemsSearchData.push({text:o,pinyin:n,firstPY:a,data:t}),e.push(s)}}(t)})),t.unitList&&t.unitList.length&&t.unitList.each((function(t){s(t)}))}this.dataTree.unitList.each(function(t){s(t)}.bind(this)),delete e,t&&t()}.bind(this)))},_scrollEvent:function(t){return!0},_getChildrenItemIds:function(){return null},_newItemCategory:function(t,e,i,s,o,n,a){return new MWF.xApplication.Selector.IdentityWidthDutyCategoryByUnit[t](e,i,s,o,n,a)},_listItemByKey:function(t,e,i){this.options.units.length&&(i={key:i,unitList:this.options.units}),this.orgAction.listIdentityByKey(function(e){t&&t.apply(this,[e])}.bind(this),e,i)},_getItem:function(t,e,i,s){"string"===typeOf(i)?this.orgAction.getIdentity(function(e){t&&t.apply(this,[e])}.bind(this),e,"string"===typeOf(i)?i:i.distinguishedName,s):t&&t.apply(this,[i])},_newItemSelected:function(t,e,i,s){return new MWF.xApplication.Selector.IdentityWidthDutyCategoryByUnit.ItemSelected(t,e,i,s)},_listItemByPinyin:function(t,e,i){this.options.units.length&&(i={key:i,unitList:this.options.units}),this.orgAction.listIdentityByPinyin(function(e){t&&t.apply(this,[e])}.bind(this),e,i)},_newItem:function(t,e,i,s,o,n){return new MWF.xApplication.Selector.IdentityWidthDutyCategoryByUnit.Item(t,e,i,s,o,n)},_newItemSearch:function(t,e,i,s){return new MWF.xApplication.Selector.IdentityWidthDutyCategoryByUnit.SearchItem(t,e,i,s)}}),MWF.xApplication.Selector.IdentityWidthDutyCategoryByUnit.Item=new Class({Extends:MWF.xApplication.Selector.IdentityWidthDuty.Item}),MWF.xApplication.Selector.IdentityWidthDutyCategoryByUnit.SearchItem=new Class({Extends:MWF.xApplication.Selector.IdentityWidthDuty.SearchItem}),MWF.xApplication.Selector.IdentityWidthDutyCategoryByUnit.ItemSelected=new Class({Extends:MWF.xApplication.Selector.IdentityWidthDuty.ItemSelected}),MWF.xApplication.Selector.IdentityWidthDutyCategoryByUnit.ItemCategory=new Class({Extends:MWF.xApplication.Selector.IdentityWidthDuty.ItemCategory,_getShowName:function(){return this.data.name},_addSelectedCount:function(t,e){var i=(this._getSelectedCount()||0)+t;this.selectedCount=i,this.checkCountAndStatus(i),e&&this.category&&this.category._addSelectedCount&&this.category._addSelectedCount(t,e)},_getTotalCount:function(){return this.data.subNestedIdentityCount},_getSelectedCount:function(){return"number"===typeOf(this.selectedCount)?this.selectedCount:0},_checkStatus:function(){},isExisted:function(t){if(!t)return!0;this.createdItemObject||(this.createdItemObject={});var e=this.createdItemObject;return!!(t.distinguishedName&&e[t.distinguishedName]||t.levelName&&e[t.levelName]||t.id&&e[t.id]||t.unique&&e[t.unique])||(this.createdItemObject["string"===typeOf(t)?t:t.distinguishedName||t.id||t.unique||t.employee||t.levelName]=!0,!1)},sortIdentityList:function(){if("identityNumber"===this.selector.options.identitySortBy)this.data.identityList.sort((function(t,e){return 0===t.orderNumber&&(t.orderNumber=-1),0===e.orderNumber&&(e.orderNumber=-1),(t.orderNumber||9999999)-(e.orderNumber||9999999)}));else{var t=function(t){var e="999";if(t.matchUnitDutyName){var i=this.selector.options.dutys.indexOf(t.matchUnitDutyName);i>-1&&(e=i.toString())}return"number"===typeOf(t.matchUnitDutyNumber)?e+=t.matchUnitDutyNumber.toString():e+="9999",e.toInt()}.bind(this),e=function(e){if(e.otherMatchUnitDutyList&&e.otherMatchUnitDutyList.length){var i=[t(e)];return e.otherMatchUnitDutyList.each((function(e){i.push(t(e))})),i.min()}return t(e)}.bind(this);this.data.identityList.sort((function(t,i){return e(t)-e(i)}))}},loadSub:function(t){this._loadSub(function(e){if(e&&(this.selector.options.showSelectedCount||this.selector.options.isCheckStatus)){var i=0;this.subCategorys.each((function(t){var e=t.subItems.filter((function(t){return t.isSelected}));i+=e.length}));var s=this.subItems.filter((function(t){return t.isSelected}));this.selectedCount=i+s.length,this.checkCountAndStatus(this.selectedCount)}t&&t()}.bind(this))},_loadSub:function(t){this.loaded?t&&t():(this.itemLoaded||(this.data.identityList&&this.data.identityList.length>0&&(this.sortIdentityList(),this.data.identityList.each(function(t){var e=this.selector._newItem(t,this.selector,this.children,this.level+1,this);this.selector.items.push(e),this.subItems&&this.subItems.push(e)}.bind(this))),this.itemLoaded=!0),this.categoryLoaded||(this.data.unitList&&this.data.unitList.length&&(this.data.unitList.sort((function(t,e){return 0===t.orderNumber&&(t.orderNumber=-1),0===e.orderNumber&&(e.orderNumber=-1),(t.orderNumber||9999999)-(e.orderNumber||9999999)})),this.data.unitList.each(function(t){var e=this.selector._newItemCategory("ItemCategory",t,this.selector,this.children,this.level+1,this);this.subCategorys.push(e)}.bind(this))),this.categoryLoaded=!0),this.loaded=!0,t&&t(!0))},loadCategoryChildren:function(t){this.categoryLoaded||(this.loadSub(),this.categoryLoaded=!0,this.itemLoaded=!0),t&&t()},loadItemChildren:function(t){this.itemLoaded||(this.data.identityList&&this.data.identityList.length>0&&(this.sortIdentityList(),this.data.identityList.each(function(t){var e=this.selector._newItem(t,this.selector,this.children,this.level+1,this);this.selector.items.push(e),this.subItems&&this.subItems.push(e)}.bind(this))),this.itemLoaded=!0),t&&t()},_hasChild:function(){return this.data.unitList&&this.data.unitList.length>0||this.data.identityList&&this.data.identityList.length>0},_hasChildCategory:function(){return this.data.unitList&&this.data.unitList.length>0},_hasChildItem:function(){return this.data.identityList&&this.data.identityList.length>0}}),MWF.xApplication.Selector.IdentityWidthDutyCategoryByUnit.ItemUnitCategory=new Class({Extends:MWF.xApplication.Selector.IdentityWidthDuty.ItemUnitCategory}),MWF.xApplication.Selector.IdentityWidthDutyCategoryByUnit.ItemGroupCategory=new Class({Extends:MWF.xApplication.Selector.IdentityWidthDuty.ItemGroupCategory}),MWF.xApplication.Selector.IdentityWidthDutyCategoryByUnit.Filter=new Class({Extends:MWF.xApplication.Selector.IdentityWidthDuty.Filter}),MWF.xApplication.Selector=MWF.xApplication.Selector||{},MWF.xDesktop.requireApp("Selector","Unit",null,!1),MWF.xApplication.Selector.UnitWithType=new Class({Extends:MWF.xApplication.Selector.Unit,options:{style:"default",count:0,units:[],unitType:"",values:[],zIndex:1e3,expand:!0,exclude:[],selectType:"unit",expandSubEnable:!0,selectAllEnable:!0},setInitTitle:function(){this.setOptions({title:MWF.xApplication.Selector.LP.selectUnit})},_init:function(){this.selectType="unit",this.className="UnitWithType"},loadSelectItems:function(t){if(this.options.disabled)this.afterLoadSelectItem();else{var e=this.afterLoadSelectItem.bind(this),i={};i.type=this.options.unitType,i.unitList=[],this.options.units.each(function(t){"string"===typeOf(t)?i.unitList.push(t):i.unitList.push(t.distinguishedName)}.bind(this)),this.orgAction.listUnitByType(function(t){t.data.length&&t.data.each(function(t){if(!this.isExcluded(t))if(this.options.expandSubEnable&&this.options.unitType&&-1===t.typeList.indexOf(this.options.unitType)){if(t.woSubDirectUnitList.length){var e=this._newItemCategory("ItemCategory",t,this,this.itemAreaNode);this.subCategorys.push(e)}}else{var i=this._newItem(t,this,this.itemAreaNode,1);this.items.push(i),this.subItems.push(i)}}.bind(this)),e()}.bind(this),e,i)}},_scrollEvent:function(t){return!0},_getChildrenItemIds:function(){return null},_newItemCategory:function(t,e,i,s,o,n,a){return new MWF.xApplication.Selector.UnitWithType[t](e,i,s,o,n,a)},_listItemByKey:function(t,e,i){if(this.options.expandSubEnable){if(i={key:i},this.options.units.length){var s=[];this.options.units.each((function(t){"string"===typeOf(t)&&s.push(t),"object"===typeOf(t)&&s.push(t.distinguishedName)})),i.unitList=s}this.options.unitType&&(i.type=this.options.unitType),this.orgAction.listUnitByKey(function(e){t&&t.apply(this,[e])}.bind(this),e,i)}else i?(this.initSearchArea(!0),this.searchInItems(i)):this.initSearchArea(!1)},_getItem:function(t,e,i,s){this.orgAction.getUnit(function(e){t&&t.apply(this,[e])}.bind(this),e,"string"===typeOf(i)?i:i.distinguishedName,s)},_newItemSelected:function(t,e,i,s){return new MWF.xApplication.Selector.UnitWithType.ItemSelected(t,e,i,s)},_listItemByPinyin:function(t,e,i){if(i={key:i},this.options.units.length){var s=[];this.options.units.each((function(t){"string"===typeOf(t)&&s.push(t),"object"===typeOf(t)&&s.push(t.distinguishedName)})),i.unitList=s}this.options.unitType&&(i.type=this.options.unitType),this.orgAction.listUnitByPinyininitial(function(e){t&&t.apply(this,[e])}.bind(this),e,i)},_newItem:function(t,e,i,s,o,n){return new MWF.xApplication.Selector.UnitWithType.Item(t,e,i,s,o,n)},_newItemSearch:function(t,e,i,s){return new MWF.xApplication.Selector.UnitWithType.SearchItem(t,e,i,s)}}),MWF.xApplication.Selector.UnitWithType.Item=new Class({Extends:MWF.xApplication.Selector.Unit.Item,_getShowName:function(){return this.isShowLevelName&&this.data.levelName?this.data.levelName:this.data.name},_getTtiteText:function(){return this.data.levelName||this.data.name},_setIcon:function(){var t=this.selector.options.style;this.iconNode.setStyle("background-image","url(../x_component_Selector/$Selector/"+t+"/icon/departmenticon.png)")},loadSubItem:function(){this.selector.options.expandSubEnable&&(this.isExpand=this.selector.options.expand,this.data.subDirectUnitCount&&(this.selector.options.expand?1===this.level?(this.levelNode.setStyles(this.selector.css.selectorItemLevelNode_expand),this.loadSubItems()):(this.isExpand=!1,this.levelNode.setStyles(this.selector.css.selectorItemLevelNode_collapse)):this.levelNode.setStyles(this.selector.css.selectorItemLevelNode_collapse),this.levelNode.addEvent("click",function(t){this.isExpand?(this.selector.fireEvent("collapse",[this]),this.children.setStyle("display","none"),this.levelNode.setStyles(this.selector.css.selectorItemLevelNode_collapse),this.isExpand=!1):(this.selector.fireEvent("expand",[this]),this.loadSubItems(),this.levelNode.setStyles(this.selector.css.selectorItemLevelNode_expand),this.isExpand=!0),t.stopPropagation()}.bind(this)),this.selectAllNode||this.selector.isFlatCategory||(this.selectAllNode=new Element("div",{styles:this.selector.css.selectorItemCategoryActionNode_selectAll,title:MWF.SelectorLP.selectChildren}).inject(this.textNode,"before"),this.selectAllNode.addEvent("click",(function(t){this.isSelectedAll?("all"===this.selector.options.selectAllRange?this.unselectAllNested(t,null,!0):this.unselectAll(t,null,!0),this.selector.fireEvent("unselectCatgory",[this]),this.selector.fireEvent("unselectCategory",[this])):("all"===this.selector.options.selectAllRange?this.selectAllNested(t,!0):this.selectAll(t,!0),this.selector.fireEvent("selectCatgory",[this]),this.selector.fireEvent("selectCategory",[this])),t.stopPropagation()})))))},loadSubItems:function(t){this.loaded||this.loading?this.children.setStyle("display","block"):(this.loading=!0,this.children||(this.children=new Element("div",{styles:this.selector.css.selectorItemCategoryChildrenNode}).inject(this.node,"after")),this.children.setStyle("display","block"),(this.data.woSubDirectUnitList||[]).each(function(e){if(!this.selector.isExcluded(e))if(this.selector.options.unitType&&-1===e.typeList.indexOf(this.selector.options.unitType)){if(e.woSubDirectUnitList.length){var i=this.selector._newItemCategory("ItemCategory",e,this.selector,this.children,this.level+1,this);this.subCategorys.push(i)}}else{var s=this.selector._newItem(e,this.selector,this.children,this.level+1,this);this.selector.items.push(s),this.subItems||(this.subItems=[]),this.subItems.push(s)}t&&t()}.bind(this)),this.loaded=!0,this.loading=!1)},postLoad:function(){},loadCategoryChildren:function(t){this.categoryLoaded||(this.data.woSubDirectUnitList.each(function(e){if(!this.selector.isExcluded(e))if(this.selector.options.unitType&&-1===e.typeList.indexOf(this.selector.options.unitType)){if(e.woSubDirectUnitList.length){var i=this.selector._newItemCategory("ItemCategory",e,this.selector,this.children,this.level+1,this);this.subCategorys.push(i)}}else;t&&t()}.bind(this)),this.categoryLoaded=!0)},loadItemChildren:function(t){this.itemLoaded?this.children.setStyle("display","block"):(this.children||(this.children=new Element("div",{styles:this.selector.css.selectorItemCategoryChildrenNode}).inject(this.selector.itemAreaNode)),this.children.setStyle("display","block"),this.data.woSubDirectUnitList.each(function(e){if(!(this.selector.isExcluded(e)||this.selector.options.unitType&&-1===e.typeList.indexOf(this.selector.options.unitType))){var i=this.selector._newItem(e,this.selector,this.children,this.level+1,this,!0);i.justItem=!0,i.load(),this.selector.items.push(i),this.subItems||(this.subItems=[]),this.subItems.push(i)}t&&t()}.bind(this)),this.itemLoaded=!0)}}),MWF.xApplication.Selector.UnitWithType.SearchItem=new Class({Extends:MWF.xApplication.Selector.UnitWithType.Item,load:function(){this.loadForNormal()},_getShowName:function(){return this.data.levelName||this.data.name},loadSubItems:function(t){}}),MWF.xApplication.Selector.UnitWithType.ItemSelected=new Class({Extends:MWF.xApplication.Selector.Unit.ItemSelected,_getTtiteText:function(){return this.data.levelName||this.data.name},_getShowName:function(){return this.data.name+(this.data.levelName?"("+this.data.levelName+")":"")},_setIcon:function(){var t=this.selector.options.style;this.iconNode.setStyle("background-image","url(../x_component_Selector/$Selector/"+t+"/icon/departmenticon.png)")}}),MWF.xApplication.Selector.UnitWithType.ItemCategory=new Class({Extends:MWF.xApplication.Selector.Unit.ItemCategory,loadSub:function(t){this.loaded||(this.data.woSubDirectUnitList.each(function(t){if(!this.selector.isExcluded(t))if(this.selector.options.unitType&&-1===t.typeList.indexOf(this.selector.options.unitType)){if(t.woSubDirectUnitList.length){var e=this.selector._newItemCategory("ItemCategory",t,this.selector,this.children,this.level+1,this);this.subCategorys.push(e)}}else{var i=this.selector._newItem(t,this.selector,this.children,this.level+1,this);this.selector.items.push(i),this.subItems&&this.subItems.push(i)}this.subItems&&this.subItems.length||this.selectAllNode&&this.selectAllNode.destroy()}.bind(this)),this.loaded=!0),t&&t()},afterLoad:function(){1===this.level&&this.clickItem();var t=!1;this.data.woSubDirectUnitList.each(function(e){this.selector.isExcluded(e)||this.selector.options.unitType&&-1===e.typeList.indexOf(this.selector.options.unitType)||(t=!0),!t&&this.selectAllNode&&this.selectAllNode.destroy()}.bind(this))},_hasChild:function(){return this.data.woSubDirectUnitList.length},_hasChildCategory:function(){return this.data.woSubDirectUnitList.length},_hasChildItem:function(){if("boolean"===typeOf(this.isHasChildItem))return this.isHasChildItem;this.isHasChildItem=!1;for(var t=this.data.woSubDirectUnitList||[],e=0;e<t.length;e++)if(!this.selector.options.unitType||-1!==t[e].typeList.indexOf(this.selector.options.unitType)){this.isHasChildItem=!0;break}return this.isHasChildItem},loadCategoryChildren:function(t){this.categoryLoaded||(this.data.woSubDirectUnitList.each(function(t){if(!this.selector.isExcluded(t))if(this.selector.options.unitType&&-1===t.typeList.indexOf(this.selector.options.unitType)){if(t.woSubDirectUnitList.length){var e=this.selector._newItemCategory("ItemCategory",t,this.selector,this.children,this.level+1,this);this.subCategorys.push(e)}}else;}.bind(this)),this.categoryLoaded=!0),t&&t()},loadItemChildren:function(t){this.itemLoaded||(this.data.woSubDirectUnitList.each(function(t){if(!(this.selector.isExcluded(t)||this.selector.options.unitType&&-1===t.typeList.indexOf(this.selector.options.unitType))){var e=this.selector._newItem(t,this.selector,this.children,this.level+1,this);this.selector.items.push(e),this.subItems&&this.subItems.push(e)}this.subItems&&this.subItems.length||this.selectAllNode&&this.selectAllNode.destroy()}.bind(this)),this.itemLoaded=!0),t&&t()}}),MWF.xApplication.Selector.UnitWithType.Filter=new Class({Implements:[Options,Events],options:{style:"default",units:[]},initialize:function(t,e){this.setOptions(e),this.value=t,this.orgAction=MWF.Actions.get("x_organization_assemble_control")},filter:function(t,e){this.value=t;var i=this.value;if(i={key:i},this.options.units.length){var s=[];this.options.units.each((function(t){"string"===typeOf(t)&&s.push(t),"object"===typeOf(t)&&s.push(t.distinguishedName)})),i.unitList=s}this.options.unitType&&(i.type=this.options.unitType),this.orgAction.listUnitByKey(function(t){data=t.data,e&&e(data)}.bind(this),failure,i)}}),MWF.xScript=MWF.xScript||{},MWF.xScript.Actions=MWF.xScript.Actions||{},MWF.require("MWF.xDesktop.Actions.RestActions",null,!1);var invoke=function(t){return function(e,i,s,o){return this.action.invoke({name:t,data:e,async:o,success:i,failure:s})}};MWF.xScript.Actions.UnitActions=new Class({initialize:function(){this.actionPath="/xScript/Actions/unitAction.json",this.action=new MWF.xDesktop.Actions.RestActions(this.actionPath,"x_organization_assemble_express")},listGroup:invoke("listGroup"),listSubGroupDirect:invoke("listSubGroupDirect"),listSubGroupNested:invoke("listSubGroupNested"),listSupGroupDirect:invoke("listSupGroupDirect"),listSupGroupNested:invoke("listSupGroupNested"),listGroupWithPerson:invoke("listGroupWithPerson"),groupHasRole:invoke("groupHasRole"),listRole:invoke("listRole"),listRoleWithPerson:invoke("listRoleWithPerson"),personHasRole:invoke("personHasRole"),listPerson:invoke("listPerson"),listPersonSubDirect:invoke("listPersonSubDirect"),listPersonSubNested:invoke("listPersonSubested"),listPersonSupDirect:invoke("listPersonSupDirect"),listPersonSupNested:invoke("listPersonSupNested"),listPersonWithGroup:invoke("listPersonWithGroup"),listPersonWithRole:invoke("listPersonWithRole"),listPersonWithIdentity:invoke("listPersonWithIdentity"),listPersonWithUnitDirect:invoke("listPersonWithUnitDirect"),listPersonWithUnitNested:invoke("listPersonWithUnitNested"),listPersonAllAttribute:invoke("listPersonAllAttribute"),listPersonWithAttributeValue:invoke("listPersonWithAttributeValue"),listPersonWithAttribute:invoke("listPersonWithAttribute"),appendPersonAttribute:invoke("appendPersonAttribute"),setPersonAttribute:invoke("setPersonAttribute"),getPersonAttribute:invoke("getPersonAttribute"),listPersonAttributeName:invoke("listPersonAttributeName"),listIdentity:invoke("listIdentity"),listIdentityWithPerson:invoke("listIdentityWithPerson"),listIdentityWithUnitDirect:invoke("listIdentityWithUnitDirect"),listIdentityWithUnitNested:invoke("listIdentityWithUnitNested"),listUnit:invoke("listUnit"),listUnitSubDirect:invoke("listUnitSubDirect"),listUnitSubNested:invoke("listUnitSubNested"),listUnitSupDirect:invoke("listUnitSupDirect"),listUnitSupNested:invoke("listUnitSupNested"),getUnitWithIdentityAndLevel:invoke("getUnitWithIdentityAndLevel"),getUnitWithIdentityAndType:invoke("getUnitWithIdentityAndType"),listUnitSupNestedWithIdentity:invoke("listUnitSupNestedWithIdentity"),listUnitWithIdentity:invoke("listUnitWithIdentity"),listUnitWithPerson:invoke("listUnitWithPerson"),listUnitSupNestedWithPerson:invoke("listUnitSupNestedWithPerson"),listUnitWithAttribute:invoke("listUnitWithAttribute"),listUnitWithDuty:invoke("listUnitWithDuty"),getDuty:invoke("getDuty"),listDutyNameWithIdentity:invoke("listDutyNameWithIdentity"),listDutyNameWithUnit:invoke("listDutyNameWithUnit"),listUnitAllDuty:invoke("listUnitAllDuty"),appendUnitAttribute:invoke("appendUnitAttribute"),setUnitAttribute:invoke("setUnitAttribute"),getUnitAttribute:invoke("getUnitAttribute"),listUnitAttributeName:invoke("listUnitAttributeName"),listUnitAllAttribute:invoke("listUnitAllAttribute")}),MWF.xScript=MWF.xScript||{},MWF.xScript.Actions=MWF.xScript.Actions||{},MWF.require("MWF.xDesktop.Actions.RestActions",null,!1),MWF.xScript.Actions.ScriptActions=new Class({initialize:function(){this.action=new MWF.xDesktop.Actions.RestActions("","x_processplatform_assemble_surface"),this.action.getActions=function(t){this.actions={getScriptByName:{uri:"/jaxrs/script/{name}/application/{applicationId}/imported"}},t&&t()}},getScriptByName:function(t,e,i,s,o,n){this.action.invoke({name:"getScriptByName",async:n,parameter:{applicationId:t,name:e},success:s,failure:o})},getScript:function(t,e,i,s){this.action.invoke({name:"getScript",async:s,parameter:{id:t},success:e,failure:i})}}),MWF.xScript=MWF.xScript||{},MWF.xScript.Actions=MWF.xScript.Actions||{},MWF.require("MWF.xDesktop.Actions.RestActions",null,!1),MWF.xScript.Actions.CMSScriptActions=new Class({initialize:function(){this.action=new MWF.xDesktop.Actions.RestActions("","x_cms_assemble_control"),this.action.getActions=function(t){this.actions={getScriptByName:{uri:"/jaxrs/script/{uniqueName}/app/{appId}/imported"}},t&&t()}},getScriptByName:function(t,e,i,s,o,n){this.action.invoke({name:"getScriptByName",async:n,parameter:{appId:t,uniqueName:e},success:s,failure:o})},getScript:function(t,e,i,s){this.action.invoke({name:"getScript",async:s,parameter:{id:t},success:e,failure:i})}}),MWF.xScript=MWF.xScript||{},MWF.xScript.Actions=MWF.xScript.Actions||{},MWF.require("MWF.xDesktop.Actions.RestActions",null,!1),MWF.xScript.Actions.PortalScriptActions=new Class({initialize:function(){this.action=new MWF.xDesktop.Actions.RestActions("","x_portal_assemble_surface"),this.action.getActions=function(t){this.actions={getScriptByName:{uri:"/jaxrs/script/portal/{portal}/name/{name}/imported"}},t&&t()}},getScriptByName:function(t,e,i,s,o,n){this.action.invoke({name:"getScriptByName",async:n,parameter:{portal:t,name:e},success:s,failure:o})},getScript:function(t,e,i,s){this.action.invoke({name:"getScript",async:s,parameter:{id:t},success:e,failure:i})}}),MWF.xScript=MWF.xScript||{},MWF.xScript.Environment=function(t){var i=t.data,s=t.form,o=t.forms;this.library=COMMON,this.power={isManager:MWF.AC.isProcessManager()||s.businessData.control.allowReroute,isReseter:s.businessData.control.allowReset,isDelete:s.businessData.control.allowDeleteWork,isPront:!0,isPrint:!0};this.setData=function(t){var e;this.data=(e=t,new MWF.xScript.JSONData(e,(function(t,e,i){for(var s={getKey:function(){return e},getParent:function(){return i}};s&&!o[s.getKey()];)s=s.getParent();s&&s.getKey()&&o[s.getKey()]&&o[s.getKey()].resetData()}),"",null,s)),this.data.save=function(t){s.saveFormData(t)}},this.setData(i),this.workContext={getWork:function(){return t.work||t.workCompleted},getActivity:function(){return t.activity||null},getTask:function(){return t.task||null},getTaskList:function(e,i){var s,o=e&&"function"===o2.typeOf(e)?e:null,n=i&&"function"===o2.typeOf(i)?i:null;return o2.Actions.get("x_processplatform_assemble_surface").listTaskByWork(t.work.id,(function(t){s=t.data,o&&o(s)}),n,!!o),s},getTaskListByJob:function(e,i){var s,o=e&&"function"===o2.typeOf(e)?e:null,n=i&&"function"===o2.typeOf(i)?i:null;return o2.Actions.get("x_processplatform_assemble_surface").listTaskByJob(t.work.job,(function(t){s=t.data,o&&o(s)}),n,!!o),s},getTaskCompletedList:function(e,i){var s,o=e&&"function"===o2.typeOf(e)?e:null,n=i&&"function"===o2.typeOf(i)?i:null;return o2.Actions.get("x_processplatform_assemble_surface").listTaskCompletedByWork(t.work.id,(function(t){s=t.data,o&&o(s)}),n,!!o),s},getTaskCompletedListByJob:function(e,i){var s,o=e&&"function"===o2.typeOf(e)?e:null,n=i&&"function"===o2.typeOf(i)?i:null;return o2.Actions.get("x_processplatform_assemble_surface").listTaskCompletedByJob(t.work.job,(function(t){s=t.data,o&&o(s)}),n,!!o),s},getReadList:function(e,i){var s,o=e&&"function"===o2.typeOf(e)?e:null,n=i&&"function"===o2.typeOf(i)?i:null;return o2.Actions.get("x_processplatform_assemble_surface").listReadByWork(t.work.id,(function(t){s=t.data,o&&o(s)}),n,!!o),s},getReadListByJob:function(e,i){var s,o=e&&"function"===o2.typeOf(e)?e:null,n=i&&"function"===o2.typeOf(i)?i:null;return o2.Actions.get("x_processplatform_assemble_surface").listReadByJob(t.work.job,(function(t){s=t.data,o&&o(s)}),n,!!o),s},getReadCompletedList:function(e,i){var s,o=e&&"function"===o2.typeOf(e)?e:null,n=i&&"function"===o2.typeOf(i)?i:null;return o2.Actions.get("x_processplatform_assemble_surface").listReadCompletedByWork(t.work.id,(function(t){s=t.data,o&&o(s)}),n,!!o),s},getReadCompletedListByJob:function(e,i){var s,o=e&&"function"===o2.typeOf(e)?e:null,n=i&&"function"===o2.typeOf(i)?i:null;return o2.Actions.get("x_processplatform_assemble_surface").listReadCompletedByJob(t.work.job,(function(t){s=t.data,o&&o(s)}),n,!!o),s},getJobTaskList:this.getTaskListByJob,getJobReadList:this.getReadListByJob,getJobTaskCompletedList:this.getTaskCompletedListByJob,getJobReadCompletedList:this.getReadCompletedListByJob,getControl:function(){return t.control},getWorkLogList:function(){return t.workLogList},getRecordList:function(){return t.recordList},getAttachmentList:function(){return t.attachmentList},getRouteList:function(){return t.task?t.task.routeNameList:null},getInquiredRouteList:function(){return null}},this.workContent=this.workContext;var n=function(t){if(t){t.creatorPersonDn=t.creatorPerson||"",t.creatorUnitDn=t.creatorUnit||"",t.creatorUnitDnList=t.creatorUnitList||"",t.creatorIdentityDn=t.creatorIdentity||"";MWF.defineProperties(t,{creatorPerson:{get:function(){return this.creatorPersonDn.substring(0,this.creatorPersonDn.indexOf("@"))}},creatorUnit:{get:function(){return this.creatorUnitDn.substring(0,this.creatorUnitDn.indexOf("@"))}},creatorDepartment:{get:function(){return this.creatorUnitDn.substring(0,this.creatorUnitDn.indexOf("@"))}},creatorIdentity:{get:function(){return this.creatorIdentityDn.substring(0,this.creatorIdentityDn.indexOf("@"))}},creatorCompany:{get:function(){return this.creatorUnitLevel?this.creatorUnitLevel.split("/")[0]:this.creatorUnitDn.substring(0,this.creatorUnitDn.indexOf("@"))}}})}return t};n(this.workContext.getWork()),function(t){if(t){t.personDn=t.person||"",t.unitDn=t.unit||"",t.unitDnList=t.unitList||"",t.identityDn=t.identity||"";MWF.defineProperties(t,{person:{get:function(){return this.personDn.substring(0,this.personDn.indexOf("@"))}},unit:{get:function(){return this.unitDn.substring(0,this.unitDn.indexOf("@"))}},department:{get:function(){return this.unitDn.substring(0,this.unitDn.indexOf("@"))}},identity:{get:function(){return this.identityDn.substring(0,this.identityDn.indexOf("@"))}},company:{get:function(){return this.unitList[0]}}})}}(n(this.workContext.getTask())),this.Dict=MWF.xScript.createDict((s.businessData.work||s.businessData.workCompleted).application);var a,r=null,l=function(){r||(MWF.require("MWF.xScript.Actions.UnitActions",null,!1),r=new MWF.xScript.Actions.UnitActions)},c=function(t){var e=typeOf(t);if("array"===e){var i=[];return t.each((function(t){i.push("object"===typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t)})),i}return["object"===e?t.distinguishedName||t.id||t.unique||t.name:t]};this.org={getGroup:function(t,e){l();var i={groupList:c(t)},s=null,o=r.listGroup(i,(function(t){return s=(s=t.data)&&1===s.length?s[0]:s,e&&"function"==o2.typeOf(e)?e(s):s}),null,!!e);return e?o:s},listSubGroup:function(t,e,i){l();var s,o={groupList:c(t)},n=null,a=function(t){return n=t.data,i&&"function"==o2.typeOf(i)?i(n):n};return s=e?r.listSubGroupNested(o,a,null,!!i):r.listSubGroupDirect(o,a,null,!!i),i?s:n},listSupGroup:function(t,e,i){l();var s={groupList:c(t)},o=null,n=function(t){return o=t.data,i&&"function"==o2.typeOf(i)?i(o):o};if(e)var a=r.listSupGroupNested(s,n,null,!!i);else a=r.listSupGroupDirect(s,n,null,!!i);return i?a:o},listGroupWithPerson:function(t,e){l();var i={personList:c(t)},s=null,o=r.listGroupWithPerson(i,(function(t){return s=t.data,e&&"function"==o2.typeOf(e)?e(s):s}),null,!!e);return e?o:s},groupHasRole:function(t,e,i){l(),nameFlag="object"===typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t;var s={group:nameFlag,roleList:c(e)},o=!1,n=r.groupHasRole(s,(function(t){return o=t.data.value,i&&"function"==o2.typeOf(i)?i(o):o}),null,!!i);return i?n:o},getRole:function(t,e){l();var i={roleList:c(t)},s=null,o=r.listRole(i,(function(t){return s=(s=t.data)&&1===s.length?s[0]:s,e&&"function"==o2.typeOf(e)?e(s):s}),null,!!e);return e?o:s},listRoleWithPerson:function(t,e){l();var i={personList:c(t)},s=null,o=r.listRoleWithPerson(i,(function(t){return s=t.data,e&&"function"==o2.typeOf(e)?e(s):s}),null,!!e);return e?o:s},personHasRole:function(t,e,i){l(),nameFlag="object"===typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t;var s={person:nameFlag,roleList:c(e)},o=!1,n=r.listRoleWithPerson(s,(function(t){return o=t.data.value,i&&"function"==o2.typeOf(i)?i(o):o}),null,!!i);return i?n:o},getPerson:function(t,e){l();var i={personList:c(t)},s=null,o=r.listPerson(i,(function(t){return s=(s=t.data)&&1===s.length?s[0]:s,e&&"function"==o2.typeOf(e)?e(s):s}),null,!!e);return e?o:s},listSubPerson:function(t,e,i){l();var s,o={personList:c(t)},n=null,a=function(t){return n=t.data,i&&"function"==o2.typeOf(i)?i(n):n};return s=e?r.listPersonSubNested(o,a,null,!!i):r.listPersonSubDirect(o,a,null,!!i),i?s:n},listSupPerson:function(t,e,i){l();var s,o={personList:c(t)},n=null,a=function(t){return n=t.data,i&&"function"==o2.typeOf(i)?i(n):n};return s=e?r.listPersonSupNested(o,a,null,!!i):r.listPersonSupDirect(o,a,null,!!i),i?s:n},listPersonWithGroup:function(t,e){l();var i={groupList:c(t)},s=null,o=r.listPersonWithGroup(i,(function(t){return s=t.data,e&&"function"==o2.typeOf(e)?e(s):s}),null,!!e);return e?o:s},listPersonWithRole:function(t,e){l();var i,s={roleList:c(t)},o=null;return i=r.listPersonWithRole(s,(function(t){return o=t.data,e&&"function"==o2.typeOf(e)?e(o):o}),null,!!e),e?i:o},listPersonWithIdentity:function(t,e){l();var i={identityList:c(t)},s=null,o=r.listPersonWithIdentity(i,(function(t){return s=t.data,e&&"function"==o2.typeOf(e)?e(s):s}),null,!!e);return e?o:s},getPersonWithIdentity:function(t,e){l();var i={identityList:c(t)},s=null,o=r.listPersonWithIdentity(i,(function(t){return s=(s=t.data)&&1===s.length?s[0]:s,e&&"function"==o2.typeOf(e)?e(s):s}),null,!!e);return e?o:s},listPersonWithUnit:function(t,e,i){l();var s,o={unitList:c(t)},n=null,a=function(t){return n=t.data,i&&"function"==o2.typeOf(i)?i(n):n};return s=e?r.listPersonWithUnitNested(o,a,null,!!i):r.listPersonWithUnitDirect(o,a,null,!!i),i?s:n},listPersonWithAttribute:function(t,e,i){l();var s={name:t,attribute:e},o=null,n=r.listPersonWithAttribute(s,(function(t){return o=t.data,i&&"function"==o2.typeOf(i)?i(o):o}),null,!!i);return i?n:o},listPersonNameWithAttribute:function(t,e,i){l();var s={name:t,attribute:e},o=null,n=r.listPersonWithAttributeValue(s,(function(t){return o=t.data.personList,i&&"function"==o2.typeOf(i)?i(o):o}),null,!!i);return i?n:o},appendPersonAttribute:function(t,e,i,s,o,n){l();var a={attributeList:i,name:e,person:"object"===typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t},c=null,d=r.appendPersonAttribute(a,(function(t){return c=t.data,n&&"function"==o2.typeOf(n)?n(c):c}),null,!!n);return n?d:c},setPersonAttribute:function(t,e,i,s,o,n){l();var a={attributeList:i,name:e,person:"object"===typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t},c=null,d=r.setPersonAttribute(a,(function(t){return c=t.data,n&&"function"==o2.typeOf(n)?n(c):c}),null,!!n);return n?d:c},getPersonAttribute:function(t,e,i){l();var s={name:e,person:"object"===typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t},o=null,n=r.getPersonAttribute(s,(function(t){return o=t.data.attributeList,i&&"function"==o2.typeOf(i)?i(o):o}),null,!!i);return i?n:o},listPersonAttributeName:function(t,e){l();var i={personList:c(t)},s=null,o=r.listPersonAttributeName(i,(function(t){return s=t.data.nameList,e&&"function"==o2.typeOf(e)?e(s):s}),null,!!e);return e?o:s},listPersonAllAttribute:function(t,e){l();var i={personList:c(t)},s=null,o=r.listPersonAllAttribute(i,(function(t){return s=t.data,e&&"function"==o2.typeOf(e)?e(s):s}),null,!!e);return e?o:s},getIdentity:function(t,e){l();var i={identityList:c(t)},s=null,o=r.listIdentity(i,(function(t){return s=(s=t.data)&&1===s.length?s[0]:s,e&&"function"==o2.typeOf(e)?e(s):s}),null,!!e);return e?o:s},listIdentityWithPerson:function(t,e){l();var i={personList:c(t)},s=null,o=r.listIdentityWithPerson(i,(function(t){return s=t.data,e&&"function"==o2.typeOf(e)?e(s):s}),null,!!e);return e?o:s},listIdentityWithUnit:function(t,e,i){l();var s={unitList:c(t)},o=null,n=r[e?"listIdentityWithUnitNested":"listIdentityWithUnitDirect"](s,(function(t){return o=t.data,i&&"function"==o2.typeOf(i)?i(o):o}),null,!!i);return n.name="org",i?n:o},getUnit:function(t,e){l();var i={unitList:c(t)},s=null,o=r.listUnit(i,(function(t){return s=(s=t.data)&&1===s.length?s[0]:s,e&&"function"==o2.typeOf(e)?e(s):s}),null,!!e);return e?o:s},listSubUnit:function(t,e,i){l();var s,o={unitList:c(t)},n=null,a=function(t){return n=t.data,i&&"function"==o2.typeOf(i)?i(n):n};return s=e?r.listUnitSubNested(o,a,null,!!i):r.listUnitSubDirect(o,a,null,!!i),i?s:n},listSupUnit:function(t,e,i){l();var s,o={unitList:c(t)},n=null,a=function(t){return n=t.data,i&&"function"==o2.typeOf(i)?i(n):n};return s=e?r.listUnitSupNested(o,a,null,!!i):r.listUnitSupDirect(o,a,null,!!i),i?s:n},getUnitByIdentity:function(t,e,i){l();var s,o,n,a="current";switch(e&&("string"===typeOf(e)&&(a="type"),"number"===typeOf(e)&&(a="level")),a){case"current":var d={identityList:c(t)};o=function(t){return s=(s=t.data)&&1===s.length?s[0]:s,i&&"function"==o2.typeOf(i)?i(s):s},n=r.listUnitWithIdentity(d,o,null,!!i);break;case"type":d={identity:"object"===typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t,type:e};o=function(t){return s=t.data,i&&"function"==o2.typeOf(i)?i(s):s},n=r.getUnitWithIdentityAndType(d,o,null,!!i);break;case"level":d={identity:"object"===typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t,level:e};o=function(t){return s=(s=t.data)&&1===s.length?s[0]:s,i&&"function"==o2.typeOf(i)?i(s):s},n=r.getUnitWithIdentityAndLevel(d,o,null,!!i)}return i?n:s},listAllSupUnitWithIdentity:function(t,e){l();var i={identityList:c(t)},s=null,o=r.listUnitSupNestedWithIdentity(i,(function(t){return s=t.data,e&&"function"==o2.typeOf(e)?e(s):s}),null,!!e);return e?o:s},listUnitWithPerson:function(t,e){l();var i={personList:c(t)},s=null,o=r.listUnitWithPerson(i,(function(t){return s=t.data,e&&"function"==o2.typeOf(e)?e(s):s}),null,!!e);return e?o:s},listAllSupUnitWithPerson:function(t,e){l();var i={personList:c(t)},s=null,o=r.listUnitSupNestedWithPerson(i,(function(t){return s=t.data,e&&"function"==o2.typeOf(e)?e(s):s}),null,!!e);return e?o:s},listUnitWithAttribute:function(t,e,i){l();var s={name:t,attribute:e},o=null;return promise=r.listUnitWithAttribute(s,(function(t){return o=t.data,i&&"function"==o2.typeOf(i)?i(o):o}),null,!!i),i?promise:o},listUnitWithDuty:function(t,e,i){l();var s={name:t,identity:"object"===typeOf(e)?e.distinguishedName||e.id||e.unique||e.name:e},o=null,n=r.listUnitWithDuty(s,(function(t){return o=t.data,i&&"function"==o2.typeOf(i)?i(o):o}),null,!!i);return i?n:o},getDuty:function(t,e,i){l();var s={name:t,unit:"object"===typeOf(e)?e.distinguishedName||e.id||e.unique||e.name:e},o=null,n=r.getDuty(s,(function(t){return o=t.data,i&&"function"==o2.typeOf(i)?i(o):o}),null,!!i);return i?n:o},listDutyNameWithIdentity:function(t,e){l();var i={identityList:c(t)},s=null,o=r.listDutyNameWithIdentity(i,(function(t){return s=t.data.nameList,e&&"function"==o2.typeOf(e)?e(s):s}),null,!!e);return e?o:s},listDutyNameWithUnit:function(t,e){l();var i={unitList:c(t)},s=null,o=r.listDutyNameWithUnit(i,(function(t){return s=t.data.nameList,e&&"function"==o2.typeOf(e)?e(s):s}),null,!!e);return e?o:s},listUnitAllDuty:function(t,e){l();var i={unitList:c(t)},s=null,o=r.listUnitAllDuty(i,(function(t){return s=t.data,e&&"function"==o2.typeOf(e)?e(s):s}),null,!!e);return e?o:s},listTopUnit:function(t){var e=MWF.Actions.get("x_organization_assemble_control"),i=null,s=e.listTopUnit((function(e){return i=e.data,t&&"function"==o2.typeOf(t)?t(i):i}),null,!!t);return t?s:i},appendUnitAttribute:function(t,e,i,s,o,n){l();var a={attributeList:i,name:e,unit:"object"===typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t},c=null,d=r.appendUnitAttribute(a,(function(t){return c=t.data,n&&"function"==o2.typeOf(n)?n(c):c}),null,!!n);return n?d:c},setUnitAttribute:function(t,e,i,s,o,n){l();var a={attributeList:i,name:e,unit:"object"===typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t},c=null,d=r.setUnitAttribute(a,(function(t){return c=t.data,n&&"function"==o2.typeOf(n)?n(c):c}),null,!!n);return n?d:c},getUnitAttribute:function(t,e,i){l();var s={name:e,unit:"object"===typeOf(t)?t.distinguishedName||t.id||t.unique||t.name:t},o=null,n=r.getUnitAttribute(s,(function(t){return o=t.data.attributeList,i&&"function"==o2.typeOf(i)?i(o):o}),null,!!i);return i?n:o},listUnitAttributeName:function(t,e){l();var i={unitList:c(t)},s=null,o=r.listUnitAttributeName(i,(function(t){return s=t.data.nameList,e&&"function"==o2.typeOf(e)?e(s):s}),null,!!e);return e?o:s},listUnitAllAttribute:function(t,e){l();var i={unitList:c(t)},s=null,o=r.listUnitAllAttribute(i,(function(t){return s=t.data,e&&"function"==o2.typeOf(e)?e(s):s}),null,!!e);return e?o:s}},this.Action=(a=[],function(t,e){var i=a[t]||(a[t]=new MWF.xDesktop.Actions.RestActions("",t,""));i.getActions=function(t){this.actions||(this.actions={}),Object.merge(this.actions,e),t&&t()},this.invoke=function(t){i.invoke(t)}}),this.service={jaxwsClient:{},jaxrsClient:{}};var d=null;this.view={lookup:function(t,e,i){var s={filterList:t.filter||null};MWF.Actions.load("x_query_assemble_surface").ViewAction.executeWithQuery(t.view,t.application,s,(function(t){var i={grid:t.data.grid||t.data.groupGrid,groupGrid:t.data.groupGrid};e&&e(i)}),null,i)},lookupV1:function(t,e){!function(t){d?t&&t():MWF.require("MWF.xDesktop.Actions.RestActions",(function(){(d=new MWF.xDesktop.Actions.RestActions("","x_processplatform_assemble_surface","")).getActions=function(t){this.actions={lookup:{uri:"/jaxrs/queryview/flag/{view}/application/flag/{application}/execute",method:"PUT"},getView:{uri:"/jaxrs/queryview/flag/{view}/application/flag/{application}"}},t&&t()},t&&t()}))}(function(){d.invoke({name:"lookup",async:!0,parameter:{view:t.view,application:t.application},success:function(t){var i={grid:t.data.grid,groupGrid:t.data.groupGrid};e&&e(i)}.bind(this)})}.bind(this))},select:function(t,e,i){if(t.view){var o={application:t.application||s.json.application,viewName:t.view||"",isTitle:!1===t.isTitle?"no":"yes",select:!1===t.isMulti?"single":"multi",filter:t.filter};i||(i={}),i.width=t.width,i.height=t.height,i.title=t.caption;var n=i.width||"700",a=i.height||"400";if(layout.mobile){var r=document.body.getSize();n=r.x,a=r.y,i.style="viewmobile"}n=n.toInt(),a=a.toInt();var l=((r=s.app.content.getSize()).x-n)/2,c=(r.y-a)/2;l<0&&(l=0),c<0&&(c=0),layout.mobile&&(l=20,c=0);var d=this;MWF.require("MWF.xDesktop.Dialog",function(){var t=new MWF.xDesktop.Dialog({title:i.title||"select view",style:i.style||"view",top:c,left:l-20,fromTop:c,fromLeft:l-20,width:n,height:a,html:"<div style='height: 100%;'></div>",maskNode:s.app.content,container:s.app.content,buttonList:[{text:MWF.LP.process.button.ok,action:function(){e&&e(d.view.getData()),this.close()}},{text:MWF.LP.process.button.cancel,action:function(){this.close()}}]});if(t.show(),layout.mobile){var r=t.node.getElement(".MWF_dialod_Action_back"),h=t.node.getElement(".MWF_dialod_Action_ok");r&&r.addEvent("click",function(e){t.close()}.bind(this)),h&&h.addEvent("click",function(i){e&&e(this.view.getData()),t.close()}.bind(this))}MWF.xDesktop.requireApp("query.Query","Viewer",function(){this.view=new MWF.xApplication.query.Query.Viewer(t.content.getFirst(),o,{style:"select"},s.app,s.Macro)}.bind(this))}.bind(this))}}},this.statement={execute:function(t,e,i){var s=this.parseParameter(t.parameter),o={filterList:this.parseFilter(t.filter,s),parameter:s};MWF.Actions.load("x_query_assemble_surface").StatementAction.executeV2(t.name,t.mode||"data",t.page||1,t.pageSize||20,o,(function(t){e&&e(t)}),null,i)},parseFilter:function(t,e){if("array"!==typeOf(t))return[];var i=[];return(t||[]).each(function(t){var s=t.path.replace(/\./g,"_"),o=t.value;"like"===t.comparison||"notLike"===t.comparison?("%"!==o.substr(0,1)&&(o="%"+o),"%"!==o.substr(o.length-1,1)&&(o+="%"),e[s]=o):("dateTimeValue"===t.formatType||"datetimeValue"===t.formatType?o="{ts '"+o+"'}":"dateValue"===t.formatType?o="{d '"+o+"'}":"timeValue"===t.formatType&&(o="{t '"+o+"'}"),e[s]=o),t.value=s,i.push(t)}.bind(this)),i},parseParameter:function(t){if("object"!==typeOf(t))return{};var e={};for(var i in t){var s=t[i];"date"===typeOf(s)&&(s="{ts '"+s.format("db")+"'}"),e[i]=s}return e},select:function(t,e,i){if(t.name){var o={statementId:t.name||"",isTitle:!1===t.isTitle?"no":"yes",select:!1===t.isMulti?"single":"multi",filter:t.filter,parameter:t.parameter};i||(i={}),i.width=t.width,i.height=t.height,i.title=t.caption;var n=i.width||"700",a=i.height||"400";if(layout.mobile){var r=document.body.getSize();n=r.x,a=r.y,i.style="viewmobile"}n=n.toInt(),a=a.toInt();var l=((r=s.app.content.getSize()).x-n)/2,c=(r.y-a)/2;l<0&&(l=0),c<0&&(c=0),layout.mobile&&(l=20,c=0);var d=this;MWF.require("MWF.xDesktop.Dialog",function(){var t=new MWF.xDesktop.Dialog({title:i.title||"select statement view",style:i.style||"view",top:c,left:l-20,fromTop:c,fromLeft:l-20,width:n,height:a,html:"<div style='height: 100%;'></div>",maskNode:s.app.content,container:s.app.content,buttonList:[{text:MWF.LP.process.button.ok,action:function(){e&&e(d.statement.getData()),this.close()}},{text:MWF.LP.process.button.cancel,action:function(){this.close()}}]});if(t.show(),layout.mobile){var r=t.node.getElement(".MWF_dialod_Action_back"),h=t.node.getElement(".MWF_dialod_Action_ok");r&&r.addEvent("click",function(e){t.close()}.bind(this)),h&&h.addEvent("click",function(i){e&&e(this.statement.getData()),t.close()}.bind(this))}MWF.xDesktop.requireApp("query.Query","Statement",function(){this.statement=new MWF.xApplication.query.Query.Statement(t.content.getFirst(),o,{style:"select"},s.app,s.Macro)}.bind(this))}.bind(this))}}},this.importer={upload:function(t,e,i){MWF.xDesktop.requireApp("query.Query","Importer",function(){new MWF.xApplication.query.Query.Importer(s.app.content,t,{},s.app,s.Macro).load()}.bind(this))},downloadTemplate:function(t,e){MWF.xDesktop.requireApp("query.Query","Importer",function(){new MWF.xApplication.query.Query.Importer(s.app.content,t,{},s.app,s.Macro).downloadTemplate(e)}.bind(this))}};var h=[],u=function(t,e,i){var o=t;"string"==typeOf(o)&&(o={name:o});var n=o.name,a=o.type&&o.application?o.type:"process",r=o.application||s.json.application,l=a+"-"+r+"-"+n;if(h.indexOf(l)>-1)e&&e.apply(this);else{var c;switch(a){case"portal":this.scriptActionPortal?c=this.scriptActionPortal:(MWF.require("MWF.xScript.Actions.PortalScriptActions",null,!1),c=this.scriptActionPortal=new MWF.xScript.Actions.PortalScriptActions);break;case"process":this.scriptActionProcess?c=this.scriptActionProcess:(MWF.require("MWF.xScript.Actions.ScriptActions",null,!1),c=this.scriptActionProcess=new MWF.xScript.Actions.ScriptActions);break;case"cms":this.scriptActionCMS?c=this.scriptActionCMS:(MWF.require("MWF.xScript.Actions.CMSScriptActions",null,!1),c=this.scriptActionCMS=new MWF.xScript.Actions.CMSScriptActions)}c.getScriptByName(r,n,h,function(t){t.data?(h.push(l),t.data.importedList.each((function(e){"portal"===a?(h.push(a+"-"+t.data.portal+"-"+e),t.data.portalName&&h.push(a+"-"+t.data.portalName+"-"+e),t.data.portalAlias&&h.push(a+"-"+t.data.portalAlias+"-"+e)):"cms"===a?(h.push(a+"-"+t.data.appId+"-"+e),t.data.appName&&h.push(a+"-"+t.data.appName+"-"+e),t.data.appAlias&&h.push(a+"-"+t.data.appAlias+"-"+e)):"process"===a&&(h.push(a+"-"+t.data.application+"-"+e),t.data.appName&&h.push(a+"-"+t.data.appName+"-"+e),t.data.appAlias&&h.push(a+"-"+t.data.appAlias+"-"+e))})),h=h.concat(t.data.importedList),MWF.Macro.exec(t.data.text,this),e&&e.apply(this)):e&&e.apply(this)}.bind(this),null,!!i)}};this.include=function(t,e,i){if("array"==o2.typeOf(t))if(i){var s=t.length,o=0;t.each(function(t){u.apply(this,[t,function(){++o>=s&&e&&e.apply(this)}.bind(this),!0])}.bind(this))}else t.each(function(t){u.apply(this,[t])}.bind(this)),e&&e.apply(this);else u.apply(this,[t,e,i])},this.define=function(t,e,i){var s=!0;!1===i&&(s=!1);var o={};o[t]={value:e,configurable:s},MWF.defineProperties(this,o)}.bind(this),this.wait=function(){resolve={cb:this.goon.bind(this)};var t=function(t){resolve.cb=t}.bind(this);return this.target.event_resolve=t,resolve},this.goon=function(){this.target.event_resolve=null},this.page=this.form={getInfor:function(){return t.formInfor},infor:t.formInfor,getApp:function(){return s.app},app:s.app,node:function(){return s.node},readonly:s.options.readonly,get:function(t){return s.all?s.all[t]:null},getField:function(t){return o[t]},getAction:function(){return s.workAction},getDesktop:function(){return s.app.desktop},getData:function(){return new MWF.xScript.JSONData(s.getData())},save:function(t,e){s.saveWork(t,e)},close:function(){s.closeWork()},pauseTask:function(){s.pauseTask()},resumeTask:function(){s.resumeTask()},verify:function(){return!(!s.formCustomValidation("","")||!s.formValidation("",""))},process:function(t){var e=s.getOpinion().medias;t?s.submitWork(t.routeName,t.opinion,e,t.callback,t.processor,null,t.appendTaskIdentityList,t.processorOrgList,t.callbackBeforeSave):s.processWork()},reset:function(t){t?s.resetWorkToPeson(t.names,t.opinion,t.keep,t.success,t.failure):s.businessData.control.allowReset&&s.resetWork()},retract:function(t){t?s.doRetractWork(t.success,t.failure):s.businessData.control.allowRetract&&s.retractWork()},addSplit:function(t){t?s.addSplitWork(t.value,t.trimExist,t.success,t.failure):s.businessData.control.allowAddSplit&&s.addSplit()},rollback:function(t){t?s.doRollbackActionInvoke(t.log,t.flow,t.success,t.failure):s.businessData.control.allowRollback&&s.rollback()},deleteWork:function(t){t?s.doDeleteWork(t.success,t.failure):s.businessData.control.allowDelete&&s.deleteWork()},confirm:function(t,i,o,n,a,r,l,c,d,h){if(arguments.length<=1||"string"===o2.typeOf(arguments[1])){var u=MWF.getCenter({x:n,y:a});e={event:{clientX:u.x,x:u.x,clientY:u.y,y:u.y}},s.confirm(t,e,i,o,n,a,r,l,c,d,h)}else e=arguments.length>1?arguments[1]:null,i=arguments.length>2?arguments[2]:null,o=arguments.length>3?arguments[3]:null,n=arguments.length>4?arguments[4]:null,a=arguments.length>5?arguments[5]:null,r=arguments.length>6?arguments[6]:null,l=arguments.length>7?arguments[7]:null,c=arguments.length>8?arguments[8]:null,d=arguments.length>9?arguments[9]:null,h=arguments.length>10?arguments[10]:null,s.confirm(t,e,i,o,n,a,r,l,c,d,h)},alert:function(t,e,i,o,n){s.alert(t,e,i,o,n)},notice:function(t,e,i,o,n,a){s.notice(t,e,i,o,n,a)},addEvent:function(t,e){s.addEvent(t,e)},print:function(t,e){if(arguments.length){var i=arguments.length>1?arguments[0]:null,o=arguments.length>1?arguments[1]:arguments[0];s.printWork(i,o)}else s.printWork()},openWindow:function(t,e){if(arguments.length){var i=arguments.length>1?arguments[0]:null,o=arguments.length>1?arguments[1]:arguments[0];s.openWindow(o,i)}else s.openWindow()},openWork:function(t,e,i,s){var o=s||{};return o.workId=t,o.workCompletedId=e,o.docTitle=i,o.appId="process.Work"+(o.workId||o.workCompletedId),layout.desktop.openApplication(this.event,"process.Work",o)},openJob:function(t,e,i){var o=null;if(o2.Actions.get("x_processplatform_assemble_surface").listWorkByJob(t,function(t){t.data&&(o=t.data)}.bind(this),null,!1),o){var n=o.workList.length+o.workCompletedList.length;if(n){if(!(n>1&&e)){if(o.workList.length){var a=o.workList[0];return this.openWork(a.id,null,a.title,i)}a=o.workCompletedList[0];return this.openWork(null,a.id,a.title,i)}var r=new Element("div",{styles:{padding:"20px",width:"500px"}}).inject(s.node);o.workList.each(function(t){var e=new Element("div",{styles:{background:"#ffffff","border-radius":"10px",clear:"both","margin-bottom":"10px",height:"40px",padding:"10px 10px"}}).inject(r),s="<div style='height: 40px; width: 40px; float: left; background: url(../x_component_process_Xform/$Form/default/icon/work.png) no-repeat center center'></div><div style='height: 40px; width: 40px; float: right'><div class='MWFAction' style='height: 20px; width: 40px; margin-top: 10px; border: 1px solid #999999; border-radius: 5px;text-align: center; cursor: pointer'>"+o2.LP.widget.open+"</div></div><div style='height: 20px; line-height: 20px; margin: 0px 40px'>"+t.title+"</div><div style='margin: 0px 40px'><div style='color:#999999; float: left; margin-right: 10px'>"+t.activityName+"</div><div style='color:#999999; float: left; margin-right: 10px'>"+t.activityArrivedTime+"</div><div style='color:#999999; float: left; margin-right: 10px'>"+(t.manualTaskIdentityText||"")+"</div></div>";e.set("html",s);var o=e.getElement(".MWFAction");o.store("work",t),o.addEvent("click",function(t){var e=t.target.retrieve("work");e&&this.openWork(e.id,null,e.title,i),c.close()}.bind(this))}.bind(this)),o.workCompletedList.each(function(t){var e=new Element("div",{styles:{background:"#ffffff","border-radius":"10px",clear:"both","margin-bottom":"10px",height:"40px",padding:"10px 10px"}}).inject(r),s="<div style='height: 40px; width: 40px; float: left; background: url(../x_component_process_Xform/$Form/default/icon/work.png) no-repeat center center'></div><div style='height: 40px; width: 40px; float: right'><div class='MWFAction' style='height: 20px; width: 40px; margin-top: 10px; border: 1px solid #999999; border-radius: 5px;text-align: center; cursor: pointer'>"+o2.LP.widget.open+"</div></div><div style='height: 20px; line-height: 20px; margin: 0px 40px'>"+t.title+"</div><div style='margin: 0px 40px'><div style='color:#999999; float: left; margin-right: 10px'>"+o2.LP.widget.workcompleted+"</div><div style='color:#999999; float: left; margin-right: 10px'>"+t.completedTime+"</div>";e.set("html",s);var o=e.getElement(".MWFAction");o.store("work",t),o.addEvent("click",function(t){var e=t.target.retrieve("work");e&&this.openWork(null,e.id,e.title,i),c.close()}.bind(this))}.bind(this));var l=r.getSize().y+20;l>600&&(l=600);var c=o2.DL.open({title:o2.LP.widget.choiceWork,style:"user",isResize:!1,content:r,buttonList:[{type:"cancel",text:o2.LP.widget.close,action:function(){c.close()}}]})}}},openDocument:function(t,e,i){var s=i||{};s.documentId=t,s.docTitle=e,layout.desktop.openApplication(this.event,"cms.Document",s)},openPortal:function(t,e,i){var s=MWF.Actions.get("x_portal_assemble_surface");s.getApplication(t,(function(t){t.data&&(e?s.getPageByName(e,t.data.id,(function(e){var s=e.data?e.data.id:"";layout.desktop.openApplication(null,"portal.Portal",{portalId:t.data.id,pageId:s,parameters:i,appId:i&&i.appId||"portal.Portal"+t.data.id+s})})):layout.desktop.openApplication(null,"portal.Portal",{portalId:t.data.id,parameters:i,appId:i&&i.appId||"portal.Portal"+t.data.id}))}))},openCMS:function(t){MWF.Actions.get("x_cms_assemble_control").getColumn(t,(function(t){t.data&&layout.desktop.openApplication(null,"cms.Module",{columnId:t.data.id,appId:"cms.Module"+t.data.id})}))},openProcess:function(t){MWF.Actions.get("x_processplatform_assemble_surface").getApplication(t,(function(t){t.data&&layout.desktop.openApplication(null,"process.Application",{id:t.data.id,appId:"process.Application"+t.data.id})}))},openApplication:function(t,e){layout.desktop.openApplication(null,t,e)},createDocument:function(t,e,i,o,n,a,r,l,c){var d,h,u=t;"object"==typeOf(t)&&(u=t.column,e=t.category,i=t.data,o=t.identity,n=t.callback,a=t.target,r=t.latest,l=t.selectColumnEnable,c=t.ignoreTitle,d=t.onAfterPublish,h=t.onPostPublish),a&&layout.app&&layout.app.inBrowser&&(layout.app.content.empty(),layout.app=null),MWF.xDesktop.requireApp("cms.Index","Newer",(function(){new MWF.xApplication.cms.Index.Newer(null,null,s.app,null,{documentData:i,identity:o,ignoreTitle:!0===c,ignoreDrafted:!1===r,selectColumnEnable:!e||!0===l,restrictToColumn:!!e&&!0!==l,categoryFlag:e,columnFlag:u,onStarted:function(t,e){n&&n()},onPostPublish:function(){h&&h()},onAfterPublish:function(){d&&d()}}).load()}))},startProcess:function(t,e,i,o,n,a,r){if(arguments.length>2)for(var l=2;l<arguments.length;l++)if("boolean"==typeOf(arguments[l])){a=arguments[l];break}a&&layout.app&&layout.app.inBrowser&&(layout.app.$openWithSelf=!0);MWF.Actions.get("x_processplatform_assemble_surface").getProcessByName(e,t,(function(t){t.data&&MWF.xDesktop.requireApp("process.TaskCenter","ProcessStarter",function(){new MWF.xApplication.process.TaskCenter.ProcessStarter(t.data,s.app,{workData:i,identity:o,latest:r,onStarted:function(t,e,i){if(t.work){var s={draft:t.work,appId:"process.Work"+(new o2.widget.UUID).toString(),desktopReload:!1};layout.desktop.openApplication(null,"process.Work",s)}else{var o=[];if(t.each(function(t){-1!=t.currentTaskIndex&&o.push(t.taskList[t.currentTaskIndex].work)}.bind(this)),1==o.length){s={workId:o[0],appId:o[0]};layout.desktop.openApplication(null,"process.Work",s)}}n&&n(t)}.bind(this)}).load()}.bind(this))}))}},Object.defineProperty(this.form,"readonly",{get:function(){return s.options.readonly}}),this.form.medias=[],this.target=t.target,this.event=t.event,this.status=t.status,this.session=layout.desktop.session,this.Actions=o2.Actions,this.query=function(t){if(t){var e=t.data||{};t.firstResult&&(e.firstResult=t.firstResult.toInt()),t.maxResults&&(e.maxResults=t.maxResults.toInt()),o2.Actions.get("x_query_assemble_surface").executeStatement(t.name,e,success,error,options.async)}},this.Table=MWF.xScript.createTable()},MWF.xScript.createTable=function(){return function(t){this.name=t,this.action=o2.Actions.get("x_query_assemble_surface"),this.listRowNext=function(t,e,i,s,o){this.action.listRowNext(this.name,t,e,i,s,o)},this.listRowPrev=function(t,e,i,s,o){this.action.listRowPrev(this.name,t,e,i,s,o)},this.listRowPrev=function(t,e,i,s,o){this.action.listRowPrev(this.name,t,e,i,s,o)},this.listRowSelectWhere=function(t,e,i,s){this.action.listRowSelectWhere(this.name,t,e,i,s)},this.listRowCountWhere=function(t,e,i,s){this.action.listRowCountWhere(this.name,t,e,i,s)},this.deleteRow=function(t,e,i,s){this.action.deleteRow(this.name,t,e,i,s)},this.deleteAllRow=function(t,e,i){this.action.deleteAllRow(this.name,t,e,i)},this.getRow=function(t,e,i,s){this.action.getRow(this.name,t,e,i,s)},this.insertRow=function(t,e,i,s){this.action.insertRow(this.name,t,e,i,s)},this.updateRow=function(t,e,i,s,o){this.action.updateRow(this.name,t,e,i,s,o)}}},MWF.xScript.JSONData=function(t,e,i,s,o){var n=function(t,e,i,s){return function(){return-1===["array","object"].indexOf(typeOf(t[i]))?t[i]:new MWF.xScript.JSONData(t[i],e,i,s,o)}},a=function(t,e,i,s){return function(o){t[i]=o,e&&e(t,i,s)}},r=typeOf(t);"object"!==r&&"array"!==r||function(){var r={};for(var l in t)r[l]={configurable:!0,enumerable:!0,get:n.apply(this,[t,e,l,this]),set:a.apply(this,[t,e,l,this])};r.length={get:function(){return Object.keys(t).length}},r.some={get:function(){return t.some}},MWF.defineProperties(this,r);var c={getKey:{value:function(){return i}},getParent:{value:function(){return s}},toString:{value:function(){return t.toString()}},setSection:{value:function(t,e){this.add(t,e,!0);try{var i=[this.getKey()];for(p=this.getParent();p&&p.getKey();)i.unshift(p.getKey()),p=p.getParent();i.length&&(o.sectionListObj[i.join(".")]=t)}catch(t){}}},add:{value:function(i,s,o){var r=!0,l=typeOf(t);if("array"===l){if(arguments.length<2?(t.push(i),s=i,i=t.length-1):i||0===i?r=!1:(t.push(s),i=t.length-1),r)(c={})[i]={configurable:!0,enumerable:!0,get:n.apply(this,[t,e,i,this]),set:a.apply(this,[t,e,i,this])},MWF.defineProperties(this,c);this[i]=s}else if("object"===l)if(this.hasOwnProperty(i))o&&(this[i]=s);else{var c;if(t[i]=s,r)(c={})[i]={configurable:!0,enumerable:!0,get:n.apply(this,[t,e,i,this]),set:a.apply(this,[t,e,i,this])},MWF.defineProperties(this,c);this[i]=s}return this[i]}},del:{value:function(e){return this.hasOwnProperty(e)?(t[e]="",this[e]="",this):null}}};MWF.defineProperties(this,c)}.apply(this)},MWF.xScript.dictLoaded||(MWF.xScript.dictLoaded={}),MWF.xScript.addDictToCache=function(t,e,i){e||(e="root"),0!==e.indexOf("root")&&(e="root."+e);var s=t.appType||"process",o=t.enableAnonymous||!1,n=[];t.application&&n.push(t.application),t.appId&&n.push(t.appId),t.appName&&n.push(t.appName),t.appAlias&&n.push(t.appAlias);var a=[];t.id&&a.push(t.id),t.name&&a.push(t.name),t.alias&&a.push(t.alias),(u={})[e]=i;for(var r=0;r<n.length;r++)for(var l=0;l<a.length;l++){var c=a[l]+s+n[r]+o;if(MWF.xScript.dictLoaded[c]){if(0===r&&0===l){MWF.xScript.setDictToCache(c,e,i);for(var d,h=e.split(/\./g),u=MWF.xScript.dictLoaded[c],p=0;p<h.length&&(d=0===p?h[0]:d+"."+h[p],!u[d]);p++);if(d){var m=d+".";Object.keys(u).each((function(t,e){0===t.indexOf(m)&&delete u[t]}))}}}else MWF.xScript.dictLoaded[c]=u}},MWF.xScript.getMatchedDict=function(t,e){e||(e="root"),0!==e.indexOf("root")&&(e="root."+e);var i=e.split(/\./g);if(MWF.xScript.dictLoaded[t]){for(var s,o,n=MWF.xScript.dictLoaded[t],a=Array.clone(i),r=0;r<i.length;r++)if(s=0===r?i[0]:s+"."+i[r],a.shift(),n[s]){o=n[s];break}return{dict:o,unmatchedPathList:a}}return{dict:null,unmatchedPathList:a}},MWF.xScript.insertDictToCache=function(t,e,i){if(MWF.xScript.dictLoaded[t]){var s=MWF.xScript.getMatchedDict(t,e),o=s.dict,n=s.unmatchedPathList;if(o){for(var a=0;a<n.length-1;a++)o[n[a]]||(o[n[a]]={}),o=o[n[a]];var r=n[n.length-1];o[r]?"array"===typeOf(o[r])&&o[r].push(i):o[r]=i}else MWF.xScript.dictLoaded[t][e]=i}else MWF.xScript.dictLoaded[t]={},MWF.xScript.dictLoaded[t][e]=i},MWF.xScript.setDictToCache=function(t,e,i){if(MWF.xScript.dictLoaded[t]){var s=MWF.xScript.getMatchedDict(t,e),o=s.dict,n=s.unmatchedPathList;if(o){for(var a=0;a<n.length-1;a++)o[n[a]]||(o[n[a]]={}),o=o[n[a]];o[n[n.length-1]]=i}else MWF.xScript.dictLoaded[t][e]=i}else MWF.xScript.dictLoaded[t]={},MWF.xScript.dictLoaded[t][e]=i},MWF.xScript.getDictFromCache=function(t,e){var i=MWF.xScript.getMatchedDict(t,e),s=i.dict,o=i.unmatchedPathList;if(s){for(var n=0;n<o.length;n++)if(!(s=s[o[n]]))return null;return s}return null},MWF.xScript.deleteDictToCache=function(t,e){var i=MWF.xScript.getMatchedDict(t,e),s=i.dict,o=i.unmatchedPathList;if(s){for(var n=0;n<o.length-1;n++)if(!(s=s[o[n]]))return;delete s[o[o.length-1]]}},MWF.xScript.createDict=function(t){return function(e){var i=e;"string"==typeOf(i)&&(i={name:i});var s=this.name=i.name,o=i.type&&i.application?i.type:"process",n=i.application||t,a=i.enableAnonymous||!1,r={appType:o,name:s,appId:n,enableAnonymous:a},l=s+o+n+a;if("cms"==o)var c=MWF.Actions.get("x_cms_assemble_control");else c=MWF.Actions.get("x_processplatform_assemble_surface");var d=function(t){return t.split(/\./g).map((function(t){return encodeURIComponent(t)})).join("/")};this.get=function(t,e,i,s,h){var u=null;if(!0===e&&(s=!0),!0===i&&(s=!0),!h){var p=MWF.xScript.getDictFromCache(l,t);if(p)return e&&"function"==o2.typeOf(e)&&e(p),s?Promise.resolve(p):p}var m,f=function(i){return u=i.data,MWF.xScript.addDictToCache(r,t,u),e&&"function"==o2.typeOf(e)&&(u=e(i.data)),u};if(t){var g=d(t);m=c[a&&"cms"==o?"getDictDataAnonymous":"getDictData"](encodeURIComponent(this.name),n,g,f,null,!!s,!1)}else m=c[a&&"cms"==o?"getDictRootAnonymous":"getDictRoot"](this.name,n,f,null,!!s,!1);return s?m:u},this.set=function(t,e,i,s){var o=d(t);return c.setDictData(encodeURIComponent(this.name),n,o,e,(function(s){if(MWF.xScript.setDictToCache(l,t,e),i)return i(s.data)}),(function(t,e,i){if(s)return s(t,e,i)}),!1,!1)},this.add=function(t,e,i,s){var o=d(t);return c.addDictData(encodeURIComponent(this.name),n,o,e,(function(s){if(MWF.xScript.insertDictToCache(l,t,e),i)return i(s.data)}),(function(t,e,i){if(s)return s(t,e,i)}),!1,!1)},this.delete=function(t,e,i){var s=d(t);return c.deleteDictData(encodeURIComponent(this.name),n,s,(function(i){if(MWF.xScript.deleteDictToCache(l,t),e)return e(i.data)}),(function(t,e,s){if(i)return i(t,e,s)}),!1,!1)},this.destory=this.delete}};var MTooltips=new Class({Extends:MWF.widget.Common,Implements:[Options,Events],options:{style:"",axis:"y",position:{x:"auto",y:"auto"},priorityOfAuto:{x:["center","right","left"],y:["middle","bottom","top"]},offset:{x:0,y:0},isFitToContainer:!0,event:"mouseenter",hiddenDelay:200,displayDelay:0,hasArrow:!0,isAutoShow:!0,isAutoHide:!0,hasMask:!0,hasCloseAction:!1,hideByClickBody:!1,overflow:"hidden"},initialize:function(t,e,i,s,o,n){o&&this.setOptions(o),this.container=t,this.target=e,this.targetCoordinates=n,this.app=i,i&&(this.lp=i.lp),this.data=s,this.path="../x_component_Template/$MTooltips/",this.target&&this.setTargetEvents(),this.fireEvent("postInitialize",[this])},setTargetEvents:function(){"click"==this.options.event?this.options.isAutoShow&&(this.targetClickFun=function(t){"display"===this.status?this.hide():this.load(),t.stopPropagation()}.bind(this),this.target.addEvents({mousedown:function(t){t.stopPropagation()},click:this.targetClickFun})):((this.options.isAutoHide||this.options.isAutoShow)&&(this.targetMouseenterFun=function(){this.timer_hide&&clearTimeout(this.timer_hide)}.bind(this),this.target.addEvents({mouseenter:this.targetMouseenterFun})),this.options.isAutoShow&&(this.targetMouseenterFun2=function(){"display"!=this.status&&(this.timer_show=setTimeout(this.load.bind(this),this.options.displayDelay))}.bind(this),this.target.addEvents({mouseenter:this.targetMouseenterFun2})),(this.options.isAutoHide||this.options.isAutoShow)&&(this.targetMouseleaveFun=function(){this.timer_show&&clearTimeout(this.timer_show)}.bind(this),this.target.addEvents({mouseleave:this.targetMouseleaveFun})),this.options.isAutoHide&&(this.targetMouseleaveFun2=function(){"display"==this.status&&(this.timer_hide=setTimeout(this.hide.bind(this),this.options.hiddenDelay))}.bind(this),this.target.addEvents({mouseleave:this.targetMouseleaveFun2})))},load:function(){this.fireEvent("queryLoad",[this]),this.isEnable()&&(this.node?this.show():this.create(),"click"==this.options.event&&(this.options.isAutoHide&&(this.options.hasMask||(this.containerMousedownFun=function(t){"display"===this.status&&this.hide(),t.stopPropagation()}.bind(this),this.container.addEvent("mousedown",this.containerMousedownFun),this.node.addEvent("mousedown",(function(t){t.stopPropagation()})))),this.options.hideByClickBody&&(this.bodyMousedownFun=function(t){"display"===this.status&&this.hide(),t.stopPropagation()}.bind(this),$(document.body).addEvent("mousedown",this.bodyMousedownFun),this.node.addEvent("mousedown",(function(t){t.stopPropagation()}))))),this.fireEvent("postLoad",[this])},hide:function(){this.node&&(this.node.setStyle("display","none"),this.status="hidden",this.maskNode&&this.maskNode.setStyle("display","none"),this.containerMousedownFun&&(this.container.removeEvent("mousedown",this.containerMousedownFun),this.containerMousedownFun=null),this.fireEvent("hide",[this]))},show:function(){this.status="display",this.maskNode&&this.maskNode.setStyle("display",""),this.node.setStyle("display",""),this.setCoondinates(),this.fireEvent("show",[this])},create:function(){this.status="display",this.fireEvent("queryCreate",[this]),this.loadStyle(),this.fireEvent("loadStyle",[this]),this.node=new Element("div.tooltipNode",{styles:this.nodeStyles}).inject(this.container),this.contentNode?this.contentNode.inject(this.node):(this.contentNode=new Element("div",{styles:this.contentStyles}).inject(this.node),this.contentNode.set("html",this._getHtml())),this._customNode(this.node,this.contentNode),this.options.hasArrow&&(this.arrowNode=new Element("div.arrowNode",{styles:this.arrowStyles}).inject(this.node)),this.options.hasCloseAction&&(this.closeActionNode=new Element("div",{styles:this.closeActionStyles,events:{click:function(){this.hide()}.bind(this)}}).inject(this.node)),this._loadCustom(function(){this.setCoondinates()}.bind(this)),"click"==this.options.event?this.options.isAutoHide&&(this.options.hasMask&&(this.maskNode=new Element("div.maskNode",{styles:this.maskStyles,events:{mouseover:function(t){t.stopPropagation()},mouseout:function(t){t.stopPropagation()},click:function(t){this.hide(),t.stopPropagation()}.bind(this)}}).inject(this.node,"before")),this.app&&(this.hideFun_resize=this.hide.bind(this),this.app.addEvent("resize",this.hideFun_resize))):((this.options.isAutoHide||this.options.isAutoShow)&&this.node.addEvents({mouseenter:function(){this.timer_hide&&clearTimeout(this.timer_hide)}.bind(this)}),this.options.isAutoHide&&this.node.addEvents({mouseleave:function(){this.timer_hide=setTimeout(this.hide.bind(this),this.options.hiddenDelay)}.bind(this)})),this.fireEvent("postCreate",[this])},loadStyle:function(){this.options.style&&(this.cssPath=this.path+this.options.style+"/css.wcss",this._loadCss()),this.nodeStyles={"font-size":"12px",position:"absolute","max-width":"500px","min-width":"260px","z-index":"11","background-color":"#fff",padding:"10px","border-radius":"8px","box-shadow":"0 0 18px 0 #999999","-webkit-user-select":"text","-moz-user-select":"text"},this.options.nodeStyles?this.nodeStyles=Object.merge(this.nodeStyles,this.options.nodeStyles):this.css&&this.css.nodeStyles&&(this.nodeStyles=this.css.nodeStyles),this.css&&this.css.contentStyles?this.contentStyles=this.css.contentStyles:this.contentStyles={width:"100%",height:"100%"},this.options.hasArrow&&(this.css&&this.css.arrowStyles?this.arrowStyles=this.css.arrowStyles:this.arrowStyles={width:"x"==this.options.axis?"9px":"17px",height:"x"==this.options.axis?"17px":"9px",position:"absolute",background:"no-repeat url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAAlCAYAAACgc9J8AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAP9JREFUeNq01oENhCAMBdCWuIgTuP8WOoGj9GhSDaeUfjiuCSEm+iKFVllESGNdVzrPk55xHIfewHnItm1MrVDMG/u+i0aeyWZp3R9CJRaBIWRB5YUHItAL80AEqmI1EIFcrAQ1rwjUxEoQgULsAue+2ayc/W83p5+z6RXggOO1WQGhrsFXP/Oip58tAaQTZ4QMbEbyEB2GCKEBdtpmru4NsC4aHg8PLJ/3lim2xDv02jYDz1kNQsGEQgiYeqAQBPuZQF1jFKqBYTn1RLK1D4+v3E3NGfgNkJlfdKi0XrUZgc1OWyt0Dwz/z37tGhA20s+WR4t+1iBbzTJyaD8CDAB7WgNSzh/AnwAAAABJRU5ErkJggg==)"}),"click"==this.options.event&&this.options.isAutoHide&&(this.css&&this.css.maskStyles?this.maskStyles=this.css.maskStyles:this.maskStyles={width:"100%",height:"100%",opacity:0,position:"absolute","background-color":"#fff",top:"0px",left:"0px"}),this.options.hasCloseAction&&(this.css&&this.css.closeActionStyles?this.closeActionStyles=this.css.closeActionStyles:this.closeActionStyles={width:"24px",height:"24px",position:"absolute",top:"0px",right:"0px",background:"url(../x_component_Template/$MTooltips/default/icon/off_gray.png) no-repeat center center",cursor:"pointer"})},isEnable:function(){return!this.disable},setCoondinates:function(){"x"==this.options.axis?this.setCoondinates_x():this.setCoondinates_y()},setCoondinates_x:function(){var t=this.target?this.target.getCoordinates(this.container):this.targetCoordinates,e=this.node;this.resetWidth&&(e.setStyles({overflow:"visible",width:"auto"}),this.arrowNode&&this.arrowNode.setStyle("display",""),this.resetWidth=!1);var i,s,o,n,a=this.container.getScroll(),r=this.container.getSize(),l=e.getSize(),c="NaN"!==parseFloat(this.options.offset.x).toString()?parseFloat(this.options.offset.x):0;if(c+=this.options.hasArrow?10:0,"left"==this.options.position.x)i=t.left-l.x-c,this.positionX="left",s="right";else if("right"==this.options.position.x)i=t.right+c,this.positionX="right",s="left";else{if((h=this.options.priorityOfAuto)&&h.x)for(var d=0;d<h.x.length;d++){if("left"==h.x[d]&&t.left-a.x>r.x-t.right){i=t.left-l.x-c,this.positionX="left",s="right";break}if("right"==h.x[d]&&r.x+a.x-t.right>l.x){i=t.right+c,this.positionX="right",s="left";break}}i||(t.left-a.x>r.x-t.right?(i=t.left-l.x-c,this.positionX="left",s="right"):(i=t.right+c,this.positionX="right",s="left"))}if("middle"==this.options.position.y)n=t.top+t.height/2-l.y/2,this.positionY="middle",o="middle";else if("top"==this.options.position.y)n=t.bottom-l.y,this.positionY="top",o="bottom";else if("bottom"==this.options.position.y)n=t.top,this.positionY="bottom",o="top";else{var h;if((h=this.options.priorityOfAuto)&&h.y)for(d=0;d<h.y.length;d++){if("middle"==h.y[d]&&t.top+t.height/2-l.y/2>a.y&&t.bottom-t.height/2+l.y/2-a.y<r.y){n=t.top+t.height/2-l.y/2,this.positionY="middle",o="middle";break}if("top"==h.y[d]&&t.top-a.y>r.y-t.bottom){n=t.bottom-l.y,this.positionY="top",o="bottom";break}if("bottom"==h.y[d]&&r.y+a.y-t.bottom>l.y){n=t.top,this.positionY="bottom",o="top";break}}n||(t.top+t.height/2-l.y/2>a.y&&t.bottom-t.height/2+l.y/2-a.y<r.y?(n=t.top+t.height/2-l.y/2,this.positionY="middle",o="middle"):t.top-a.y>r.y-t.bottom?(n=t.bottom-l.y,this.positionY="top",o="bottom"):(n=t.top,this.positionY="bottom",o="top"))}var u=0;if(this.options.isFitToContainer&&(n<a.y?(u=a.y-n,n=a.y):n+l.y>r.y+a.y&&(u=r.y+a.y-n-l.y,n=r.y+a.y-l.y)),"scroll"==this.options.overflow&&(i<0?(e.setStyles({overflow:"auto",width:l.x+i-c}),this.resetWidth=!0,i=0):i+l.x>r.x+a.x&&(e.setStyles({overflow:"auto",width:Math.abs(r.x+a.x-i+c)}),i-=c,this.resetWidth=!0)),this.resetWidth)this.arrowNode&&this.arrowNode.setStyle("display","none");else if(this.options.hasArrow&&this.arrowNode){"left"==s?this.arrowNode.setStyles({left:"-8px",right:"auto","background-position":"0px 0px"}):this.arrowNode.setStyles({left:"auto",right:"-8px","background-position":"-11px 0px"});var p=this.arrowNode.getSize().y/2,m=Math.min(t.height,l.y)/2-p,f=0,g=0;"middle"==o?this.arrowNode.setStyles({top:l.y/2-p-u+"px",bottom:"auto"}):"top"==o?((g=(g=this.node.getStyle("border-top-"+s+"-radius"))?parseInt(g):0)>m&&(f=g-m),this.arrowNode.setStyles({top:m+f-u+"px",bottom:"auto"})):((g=(g=this.node.getStyle("border-bottom-"+s+"-radius"))?parseInt(g):0)>m&&(f=g-m),this.arrowNode.setStyles({top:"auto",bottom:m+f+u+"px"}));var y=n;f&&("top"==o?y-=f:"bottom"==o&&(y+=f))}e.setStyles({left:i,top:y||n}),this.fireEvent("postSetCoondinates",[s,o])},setCoondinates_y:function(){var t=this.target?this.target.getCoordinates(this.container):this.targetCoordinates,e=this.node;this.resetHeight&&(e.setStyles({overflow:"visible",height:"auto"}),this.arrowNode&&this.arrowNode.setStyle("display",""),this.resetHeight=!1);var i,s,o,n,a=this.container.getScroll(),r=this.container.getSize(),l=e.getSize(),c="NaN"!==parseFloat(this.options.offset.y).toString()?parseFloat(this.options.offset.y):0;if(c+=this.options.hasArrow?10:0,"top"==this.options.position.y)i=t.top-l.y-c,this.positionY="top",o="bottom";else if("bottom"==this.options.position.y)i=t.bottom+c,this.positionY="bottom",o="top";else{if((h=this.options.priorityOfAuto)&&h.y)for(var d=0;d<h.y.length;d++){if("top"==h.y[d]&&t.top-a.y>r.y-t.bottom){i=t.top-l.y-c,this.positionY="top",o="bottom";break}if("bottom"==h.y[d]&&r.y+a.y-t.bottom>l.y){i=t.bottom+c,this.positionY="bottom",o="top";break}}i||(t.top-a.y>r.y-t.bottom?(i=t.top-l.y-c,this.positionY="top",o="bottom"):(i=t.bottom+c,this.positionY="bottom",o="top"))}if("center"==this.options.position.x)n=t.left+t.width/2-l.x/2,this.positionX="center",s="center";else if("left"==this.options.position.x)n=t.right-l.x,this.positionX="left",s="right";else if("right"==this.options.position.x)n=t.left,this.positionX="right",s="left";else{var h;if((h=this.options.priorityOfAuto)&&h.x)for(d=0;d<h.x.length;d++){if("center"==h.x[d]&&t.left+t.width/2-l.x/2>a.x&&t.right-t.width/2+l.x/2-a.x<r.x){n=t.left+t.width/2-l.x/2,this.positionX="center",s="center";break}if("left"==h.x[d]&&t.left-a.x>r.x-t.right){n=t.right-l.x,this.positionX="left",s="right";break}if("right"==h.x[d]&&r.x+a.x-t.right>l.x){n=t.left,this.positionX="right",s="left";break}}n||(t.left+t.width/2-l.x/2>a.x&&t.right-t.width/2+l.x/2-a.x<r.x?(n=t.left+t.width/2-l.x/2,this.positionX="center",s="center"):t.left-a.x>r.x-t.right?(n=t.right-l.x,this.positionX="left",s="right"):(n=t.left,this.positionX="right",s="left"))}var u=0;if(this.options.isFitToContainer&&(n<a.x?(u=a.x-n,n=a.x):n+l.x>r.x+a.x&&(u=r.x+a.x-n-l.x,n=r.x+a.x-l.x)),"scroll"==this.options.overflow&&(i<0?(e.setStyles({overflow:"auto",height:l.y+i-c}),this.resetHeight=!0,i=0):i+l.y>r.y+a.y&&(e.setStyles({overflow:"auto",height:Math.abs(r.y+a.y-i+c)}),i-=c,this.resetHeight=!0)),this.resetHeight)this.arrowNode&&this.arrowNode.setStyle("display","none");else if(this.options.hasArrow&&this.arrowNode){"top"==o?this.arrowNode.setStyles({top:"-8px",bottom:"auto","background-position":"0px -18px"}):this.arrowNode.setStyles({top:"auto",bottom:"-8px","background-position":"0px -28px"});var p=this.arrowNode.getSize().x/2,m=Math.min(t.width,l.x)/2-p,f=0,g=0;"center"==s?this.arrowNode.setStyles({left:l.x/2-p-u+"px",right:"auto"}):"left"==s?((g=(g=this.node.getStyle("border-"+o+"-left-radius"))?parseInt(g):0)>m&&(f=g-m),this.arrowNode.setStyles({left:m+f-u+"px",right:"auto"})):((g=(g=this.node.getStyle("border-"+o+"-right-radius"))?parseInt(g):0)>m&&(f=g-m),this.arrowNode.setStyles({left:"auto",right:m+f+u+"px"}));var y=n;f&&("left"==s?y-=f:"right"==s&&(y+=f))}e.setStyles({left:y||n,top:i}),this.fireEvent("postSetCoondinates",[s,o])},setPosition:function(){"x"==this.options.axis?this.setPosition_x():this.setPosition_y()},setPosition_x:function(){var t,e,i=this.target?this.target.getCoordinates(this.container):this.targetCoordinates,s=this.node,o=s.getSize(),n="NaN"!==parseFloat(this.options.offset.x).toString()?parseFloat(this.options.offset.x):0;n+=this.options.hasArrow?10:0,"left"===this.positionX?e=i.left-o.x-n:"bottom"===this.positionX&&(e=i.right+n),"top"===this.positionY?t=i.top-o.y:"bottom"===this.positionY?t=i.bottom:"middle"===this.positionX&&(t=i.top+i.height/2-o.y/2),s.setStyles({left:e,top:t})},setPosition_y:function(){var t,e,i=this.target?this.target.getCoordinates(this.container):this.targetCoordinates,s=this.node,o=s.getSize(),n="NaN"!==parseFloat(this.options.offset.y).toString()?parseFloat(this.options.offset.y):0;n+=this.options.hasArrow?10:0,"top"===this.positionY?t=i.top-o.y-n:"bottom"===this.positionY&&(t=i.bottom+n),"left"===this.positionX?e=i.right-o.x:"right"===this.positionX?e=i.left:"center"===this.positionX&&(e=i.left+i.width/2-o.x/2),s.setStyles({left:e,top:t})},destroy:function(){"click"==this.options.event&&this.app&&this.hideFun_resize&&this.app.removeEvent("resize",this.hideFun_resize),this.targetClickFun&&this.target.removeEvent("click",this.targetClickFun),this.targetMouseenterFun&&this.target.removeEvent("mouseenter",this.targetMouseenterFun),this.targetMouseenterFun2&&this.target.removeEvent("mouseenter",this.targetMouseenterFun2),this.targetMouseleaveFun&&this.target.removeEvent("mouseleave",this.targetMouseleaveFun),this.targetMouseleaveFun2&&this.target.removeEvent("mouseleave",this.targetMouseleaveFun2),this.node&&(this.node.destroy(),this.node=null),this.fireEvent("destroy",[this]),MWF.release(this)},_getHtml:function(){return""},_customNode:function(t,e){this.fireEvent("customContent",[e,t])},_setContent:function(t){this.contentNode=t,this.node&&(this.node.empty(),this.contentNode.inject(this.node))},_loadCustom:function(t){t&&t()}});MWF.xApplication.Template=MWF.xApplication.Template||{},MWF.xApplication.Template.MTooltips=MTooltips,MWF.xDesktop.requireApp("Template","MTooltips",null,!1);var MSelector=new Class({Extends:MWF.widget.Common,Implements:[Options,Events],options:{style:"default",width:"230px",height:"30px",defaultOptionLp:"请选择",trigger:"delay",isSetSelectedValue:!0,isChangeOptionStyle:!0,inputEnable:!1,isCreateReadNode:!0,emptyOptionEnable:!0,containerIsTarget:!1,tooltipWhenNoSelectValue:!1,hasScrollBar:!0,hideByClickBody:!1,textField:"",valueField:"",value:"",text:"",defaultVaue:"",selectValue:"",selectText:"",isEdited:!0,tooltipsOptions:{axis:"y",position:{x:"center",y:"bottom"},event:"click",hiddenDelay:200,displayDelay:0}},initialize:function(t,e,i,s,o){this.setOptions(e),(this.options.isEdited||this.options.isCreateReadNode)&&(this.path="../x_component_Template/$MSelector/",this.cssPath="../x_component_Template/$MSelector/"+this.options.style+"/css.wcss",this._loadCss(),s&&(this.css=Object.merge(Object.clone(this.css),s))),this.valSeparator=/,|;|\^\^|\|/,this.app=i,this.container=$(t),this.dropdownContainer=o||$(o)},load:function(t){this.options.isEdited?this.loadEdit(t):this.loadRead(t)},initPara:function(){if(this.itemNodeList=[],this.itemNodeObject={},this.value=this.options.value||this.options.text||this.options.defaultVaue,this.text=this.options.text||this.options.value||this.options.defaultVaue,this.textField=this.options.textField||this.options.valueField,this.valueField=this.options.valueField||this.options.textField,this.options.selectValue||this.options.selectText){this.textField="text",this.valueField="value";var t=this.options.selectValue,e=this.options.selectText;this.selectValues="array"==typeOf(t)?t:t.split(this.valSeparator),this.selectTexts="array"==typeOf(e)?e:e.split(this.valSeparator),this.data=[],this.options.emptyOptionEnable&&this.data.push({value:"",text:this.options.defaultOptionLp||""}),this.selectValues.each(function(t,e){this.data.push({value:t,text:this.selectTexts[e]})}.bind(this))}},loadRead:function(t){this.initPara();var e=function(){for(var e=0;e<this.data.length;e++){var i=this.data[e];if(this.options.text){if(i[this.textField]==this.options.text){this.value=i[this.valueField],this.text=this.options.text,this.currentItemData=i;break}}else if(this.options.value&&i[this.valueField]==this.options.value){this.value=this.options.value,this.text=i[this.textField],this.currentItemData=i;break}}this.loadReadNode(this.text),t&&t()}.bind(this);this.data?e():this._loadData(function(t){this.data=this.parseData(t),e()}.bind(this))},loadReadNode:function(t){this.fireEvent("loadReadNode",t),this.options.isCreateReadNode&&(this.node&&this.node.destroy(),this.node=new Element("div",{styles:this.css.readNode,text:t}).inject(this.container))},loadEdit:function(t){this.initPara(),this.node||(this.options.containerIsTarget?this.node=this.container:(this.node=new Element("div.selectNode",{styles:this.css.selectNode}).inject(this.container),this.node.setStyles({width:this.options.width,height:this.options.height}))),this.data?(this.createDefaultItem(),this.loadContent(this.data),this.fireEvent("postLoad",[this])):this._loadData(function(t){this.data=this.parseData(t),this.createDefaultItem(),this.loadContent(this.data),this.fireEvent("postLoad",[this])}.bind(this)),t&&t()},resetOptions:function(){this.contentTooltip&&(this.contentTooltip.destroy(),this.contentTooltip=null),this.node&&this.node.empty(),this.data=null,this.load()},addOption:function(t,e){var i={};i[this.textField]=t,i[this.valueField]=e,this.data.push(i),this.contentTooltip&&this.contentTooltip.createItem(i)},deleteOption:function(t){for(var e=0;e<this.itemNodeList.length;e++){var i=this.itemNodeList[e];if(i.retrieve("data")[this.valueField]==t){this.itemNodeList.erase(i),i.destroy();break}}if(this.itemNodeObject[t]&&delete this.itemNodeObject[t],this.data)for(e=0;e<this.data.length;e++){var s=this.data[e];s[this.valueField]==t&&this.data.erase(s)}},loadContent:function(t){if(!this.contentTooltip){var e=parseInt(this.options.width)+"px";this.css.tooltipNode.width=e,this.css.tooltipNode["max-width"]=e;var i=Object.merge({hideByClickBody:this.options.hideByClickBody,nodeStyles:this.css.tooltipNode,onPostLoad:function(){this.selectArrowNode&&this.selectArrowNode.setStyles(this.css.selectArrowNode_up),this.inputNode&&this.inputNode.focus();for(var t,e=this.node.getParent();e;)t=e.getStyle("z-index"),e=t&&"NaN"!==parseFloat(t).toString()?null:e.getParent();for(t&&"NaN"!==parseFloat(t).toString()?this.contentTooltip.node.setStyle("z-index",parseFloat(t)+1):this.contentTooltip.node.setStyle("z-index","auto"),e=this.node.getParent();e;){var i=e.getStyle("overflow"),s=e.getStyle("overflow-y");"auto"===i||"scroll"===i||"auto"===s||"scroll"===s?(this.scrollFun=function(t){this.contentTooltip.setPosition()}.bind(this),this.scrollParentNode=e,e.addEvent("scroll",this.scrollFun),e=null):e=e.getParent()}}.bind(this),onPostInitialize:function(){"immediately"==this.options.trigger&&this.contentTooltip.load()}.bind(this),onHide:function(){this.status="hidden",this.selectArrowNode&&this.selectArrowNode.setStyles(this.css.selectArrowNode),this.scrollParentNode&&this.scrollFun&&this.scrollParentNode.removeEvent("scroll",this.scrollFun)}.bind(this)},this.options.tooltipsOptions);this.contentTooltip=new MSelector.Tootips(this.dropdownContainer||this.app.content,this.node,this.app,t,i),this.contentTooltip.selector=this}},setWidth:function(t){this.options.width=t,this.contentTooltip&&(this.contentTooltip.options.nodeStyles.width=t,this.contentTooltip.options.nodeStyles["max-width"]=t,this.contentTooltip.nodeStyles&&(this.contentTooltip.nodeStyles.width=t,this.contentTooltip.nodeStyles["max-width"]=t),this.contentTooltip.node&&(this.contentTooltip.node.setStyle("width",t),this.contentTooltip.node.setStyle("max-width",t))),this.node&&this.node.setStyle("width",t),this.selectValueNode.setStyle("width",parseInt(t)-25)},createDefaultItem:function(){if(!this.options.containerIsTarget){this.selectValueNode=new Element("div.selectValueNode",{styles:this.css.selectValueNode}).inject(this.node),this.selectValueNode.setStyles({width:parseInt(this.options.width)-parseInt(this.options.height)-10+"px",height:this.options.height,"line-height":this.options.height});var t=this._getData(this.options.value),e=t?t[this.textField]:this.options.value;this.options.inputEnable?(this.inputNode=new Element("input",{value:e||this.options.defaultOptionLp,styles:this.css.inputNode}).inject(this.selectValueNode),this.inputNode.addEvents({focus:function(){this.inputNode.get("value")==this.options.defaultOptionLp&&this.inputNode.set("value","")}.bind(this),blur:function(){var t=!1,e=this.inputNode.get("value");if(""==e)this.inputNode.set("value",this.options.defaultOptionLp);else{for(var i=0;i<this.data.length;i++){var s=this.data[i];if(s[this.textField]==e){var o=this.itemNodeObject[s[this.valueField]];this.setCurrentItem(o),t=!0;break}}t||this.cancelCurrentItem()}}.bind(this)})):this.selectValueNode.set("text",e||this.options.defaultOptionLp),this.selectArrowNode=new Element("div.selectArrowNode",{styles:this.css.selectArrowNode}).inject(this.node),this.selectArrowNode.setStyles({width:this.options.height,height:this.options.height})}},setCurrentItem:function(t){var e=t.retrieve("data");this.currentItemNode&&this.currentItemNode.setStyles(this.css.listItemNode),this.currentItemNode=t,this.currentItemData=e,this.currentItemText=t.get("text"),this.options.isChangeOptionStyle&&t.setStyles(this.css.listItemNode_current),this.options.isSetSelectedValue&&this.selectValueNode&&(this.options.inputEnable?this.inputNode.set("value",e[this.textField]):this.selectValueNode.set("text",e[this.textField]))},cancelCurrentItem:function(){this.currentItemNode&&this.currentItemNode.setStyles(this.css.listItemNode),this.currentItemNode=null,this.currentItemData=null,this.currentItemText=null},parseData:function(t){if("string"==typeOf(t[0])){var e=[];return this.textField="text",this.valueField="value",this.options.emptyOptionEnable&&e.push({value:"",text:this.options.defaultOptionLp||""}),t.each(function(t){e.push({value:t,text:t})}.bind(this)),e}if(this.options.emptyOptionEnable&&this.textField){var i={};i[this.textField]=this.options.defaultOptionLp||"",this.valueField!=this.textField&&(i[this.valueField]=""),t.unshift(i)}return t},destroy:function(){this.node&&this.node.destroy(),this.contentTooltip&&this.contentTooltip.destroy()},showTooltip:function(){this.contentTooltip.load()},hide:function(){this.status="hidden",this.selectArrowNode&&this.selectArrowNode.setStyles(this.css.selectArrowNode),this.contentTooltip&&this.contentTooltip.hide()},setValue:function(t){if(this.options.isEdited){var e=this.itemNodeObject[t];if(e)this.setCurrentItem(e);else if(this.options.inputEnable){(i=this._getData(t))?this.inputNode.set("value",i[this.textField]):this.inputNode.set("value",t)}else{if(this.options.isSetSelectedValue&&this.selectValueNode)(i=this._getData(t))?this.selectValueNode.set("text",i[this.textField]):this.selectValueNode.set("text",t||""),this.value=t}}else{var i;(i=this._getData(t))?this.loadReadNode(i[this.textField]):this.loadReadNode(t)}},get:function(){return{value:this.getValue(),text:this.getText()}},getValue:function(){return this.options.isEdited?this.currentItemData&&this.valueField?this.currentItemData[this.valueField]:this.inputNode?this.inputNode.get("value"):this.value:this.value},getText:function(){if(this.options.isEdited){if(this.currentItemData&&this.textField)return this.currentItemData[this.textField];if(this.inputNode){var t=this._getData(this.inputNode.get("value"),"text");return t?t[this.textField]:this.inputNode.get("value")}return this.text}return this.text},getData:function(){if(this.currentItemData)return this.currentItemData;if(this.inputNode)return this.inputNode.get("value");if(!this.options.text||!this.options.value)return null;for(var t=0;t<this.data.length;t++){var e=this.data[t];if(this.options.text){if(e[this.textField]==this.options.text)return e}else if(this.options.value&&e[this.valueField]==this.options.value)return e}return null},_getData:function(t,e){for(var i=0;i<this.data.length;i++){var s=this.data[i];if("text"==e){if(s[this.textField]==t)return s}else if(s[this.valueField]==t)return s}return null},_selectItem:function(t,e,i){},_loadData:function(t){this.fireEvent("loadData",t)},_postCreateItem:function(t,e){}});MSelector.Tootips=new Class({Extends:MTooltips,options:{axis:"y",position:{x:"center",y:"bottom"},event:"click",hiddenDelay:200,displayDelay:0,hasArrow:!1},_customNode:function(t,e){this.data&&this.data.length>0?this.createItemList(this.data,e):this.selector.options.tooltipWhenNoSelectValue&&this.createNoSelectValueNode(e)},createNoSelectValueNode:function(t){var e=this.selector;this.css=e.css,e.selectArrowNode&&e.selectArrowNode.setStyles(this.css.selectArrowNode_up),e.listContentNode=new Element("div.listContentNode",{styles:this.css.listContentNode}).inject(t),e.listNode=new Element("div.listNode",{styles:this.css.listNode}).inject(e.listContentNode);var i=new Element("div.listItemNode",{styles:this.css.listItemNode,text:e.options.tooltipWhenNoSelectValue}).inject(e.listNode),s=parseFloat(e.options.height)+"px";i.setStyles({height:s,"line-height":s})},createItemList:function(t,e){t=t||[];var i=this.selector;this.css=i.css,i.selectArrowNode&&i.selectArrowNode.setStyles(this.css.selectArrowNode_up),i.listContentNode=new Element("div.listContentNode",{styles:this.css.listContentNode}).inject(e),i.listNode=new Element("div.listNode",{styles:this.css.listNode}).inject(i.listContentNode),i.options.hasScrollBar&&i.setScrollBar(i.listNode),t.each(function(t){this.createItem(t)}.bind(this))},createItem:function(t){var e=this.selector;if(e.listNode){var i=new Element("div.listItemNode",{styles:this.css.listItemNode,text:t[e.textField]}).inject(e.listNode);i.setStyles({height:e.options.height,"line-height":e.options.height}),t&&i.store("data",t),i.addEvents({mousedown:function(t){t.stopPropagation()},click:function(t){var e=this.obj,i=this.itemNode.retrieve("data");e.selector.setCurrentItem(this.itemNode),e.selector._selectItem(this.itemNode,i,t),e.selector.fireEvent("selectItem",[this.itemNode,i,t]),e.hide(),t.stopPropagation()}.bind({obj:this,itemNode:i}),mouseover:function(){this.obj.selector.currentItemNode==this.itemNode&&this.obj.selector.options.isChangeOptionStyle||this.itemNode.setStyles(this.obj.selector.css.listItemNode_over)}.bind({obj:this,itemNode:i}),mouseout:function(){this.obj.selector.currentItemNode==this.itemNode&&this.obj.selector.options.isChangeOptionStyle||this.itemNode.setStyles(this.obj.selector.css.listItemNode)}.bind({obj:this,itemNode:i})}),e.itemNodeList.push(i),e.itemNodeObject[t[e.valueField]]=i;var s=!1;e.currentItemData?s=t[e.valueField]==e.currentItemData[e.valueField]:e.value?s=t[e.valueField]==e.value:e.text&&(s=t[e.textField]==e.text),s&&e.setCurrentItem(i),e.fireEvent("postCreateItem",[i,t]),e._postCreateItem(i,t)}}}),MWF.xApplication.Template=MWF.xApplication.Template||{},MWF.xApplication.Template.MSelector=MSelector,MWF.xAction.RestActions.Action.x_organization_assemble_authentication=new Class({Extends:MWF.xAction.RestActions.Action,login:function(t,e,i,s){this.action.invoke({name:"login",data:t,success:function(t,s){"anonymous"!=t.data.tokenType?e&&e(t):i&&i(null,s,t.message)},failure:i,async:s})},loginByCaptcha:function(t,e,i,s){layout.config.publicKey?o2.load("../o2_lib/jsencrypt/jsencrypt.js",function(){var o=new JSEncrypt;o.setPublicKey("-----BEGIN PUBLIC KEY-----"+layout.config.publicKey+"-----END PUBLIC KEY-----"),t.password=o.encrypt(t.password),t.isEncrypted="y",this.action.invoke({name:"loginByCaptcha",data:t,success:function(t,s){"anonymous"!=t.data.tokenType?e&&e(t):i&&i(null,s,t.message)},failure:i,async:s})}.bind(this)):this.action.invoke({name:"loginByCaptcha",data:t,success:function(t,s){"anonymous"!=t.data.tokenType?e&&e(t):i&&i(null,s,t.message)},failure:i,async:s})},getAuthentication:function(t,e,i){this.action.invoke({name:"getAuthentication",success:function(i,s){"anonymous"!==i.data.tokenType||layout.anonymous?(i.data&&!i.data.roleList&&(i.data.roleList=[]),t&&t(i)):e&&e(null,s,i.message)},failure:e,async:i})}}),MWF.xAction.RestActions.Action.x_processplatform_assemble_surface=new Class({Extends:MWF.xAction.RestActions.Action,exportView:function(t,e,i){this.action.invoke({name:"exportView",async:!0,data:i,parameter:{flag:e,applicationFlag:t},success:function(t){var e=this.action.actions.exportViewResult.uri;e=e.replace("{flag}",t.data.id),window.open(o2.filterUrl(this.action.address+e,"_blank"))}.bind(this)})},saveDictionary:function(t,e,i){t.id?this.updateDictionary(t,e,i):this.addDictionary(t,e,i)},updateDictionary:function(t,e,i){this.action.invoke({name:"updataDictionary",data:t,parameter:{applicationDictFlag:t.id,applicationFlag:t.application},success:e,failure:i})},addDictionary:function(t,e,i){t.id||this.getUUID(function(s){t.id=s,this.action.invoke({name:"addDictionary",data:t,success:e,failure:i})}.bind(this))},removeWork:function(t,e,i,s,o,n){i?this.action.invoke({name:"removeAllWork",async:n,parameter:{id:t,applicationId:e},success:s,failure:o}):this.action.invoke({name:"removeWork",async:n,parameter:{id:t,applicationId:e},success:s,failure:o})},getAttachmentData:function(t,e){this.action.getActions(function(){var i=this.action.actions.getAttachmentData.uri;i=(i=i.replace("{id}",encodeURIComponent(t))).replace("{workid}",encodeURIComponent(e)),window.open(o2.filterUrl(this.action.address+i))}.bind(this))},getWorkcompletedAttachmentData:function(t,e){this.action.getActions(function(){var i=this.action.actions.getWorkcompletedAttachmentData.uri;i=(i=i.replace("{id}",encodeURIComponent(t))).replace("{workCompletedId}",encodeURIComponent(e)),window.open(o2.filterUrl(this.action.address+i))}.bind(this))},getAttachmentStream:function(t,e){this.action.getActions(function(){var i=this.action.actions.getAttachmentStream.uri;i=(i=i.replace("{id}",encodeURIComponent(t))).replace("{workid}",encodeURIComponent(e)),window.open(o2.filterUrl(this.action.address+i))}.bind(this))},getWorkcompletedAttachmentStream:function(t,e){this.action.getActions(function(){var i=this.action.actions.getWorkcompletedAttachmentStream.uri;i=(i=i.replace("{id}",encodeURIComponent(t))).replace("{workCompletedId}",encodeURIComponent(e)),window.open(o2.filterUrl(this.action.address+i))}.bind(this))},getAttachmentUrl:function(t,e,i){this.action.getActions(function(){var s=this.action.actions.getAttachmentData.uri;s=(s=s.replace("{id}",encodeURIComponent(t))).replace("{workid}",encodeURIComponent(e)),i&&i(o2.filterUrl(this.action.address+s))}.bind(this))},getAttachmentWorkcompletedUrl:function(t,e,i){this.action.getActions(function(){var s=this.action.actions.getWorkcompletedAttachmentData.uri;s=(s=s.replace("{id}",encodeURIComponent(t))).replace("{workCompletedId}",encodeURIComponent(e)),i&&i(o2.filterUrl(this.action.address+s))}.bind(this))},getWorkDataByPath:function(t,e,i,s,o){var n=e.replace(/\./g,"/");t.workCompleted?this.action.invoke({name:"getWorkcompletedDataByPath",async:o,parameter:{id:t.workCompleted,path:n},success:i,failure:s,urlEncode:!1}):this.action.invoke({name:"getWorkDataByPath",async:o,parameter:{id:t.work,path:n},success:i,failure:s,urlEncode:!1})},getJobDataByPath:function(t,e,i,s,o){var n=e.replace(/\./g,"/");this.action.invoke({name:"getJobDataByPath",async:o,parameter:{id:t,path:n},success:i,failure:s,urlEncode:!1})},startWork:function(t,e,i,s,o){var n=i,a=s,r=t,l=e;"string"===o2.typeOf(t)&&(n=t,a=e,r=i,l=s),this.getProcess(n,function(t){"draft"==t.data.defaultStartMode?this.draw(n,a,r,l,o):this.createtWork(n,a,r,l,o)}.bind(this),l,o)}}),MWF.xAction.RestActions.Action.x_cms_assemble_control=new Class({Extends:MWF.xAction.RestActions.Action,getUUID:function(t){var e="";return this.action.invoke({name:"getId",async:!1,parameter:{count:"1"},success:function(i){e=i.data[0],t&&t(e)},failure:null}),e},saveColumn:function(t,e,i){t.isNewColumn?this.addColumn(t,e,i):this.updateColumn(t,e,i)},addColumn:function(t,e,i){this.action.invoke({name:"addColumn",data:t,success:e,failure:i})},updateColumn:function(t,e,i){this.action.invoke({name:"updateColumn",data:t,parameter:{id:t.id},success:e,failure:i})},updataColumnIcon:function(t,e,i,s,o){this.action.invoke({name:"updataColumnIcon",parameter:{id:t},data:s,file:o,success:e,failure:i})},listCategory:function(t,e,i,s){var o=this;this.action.invoke({name:"listCategory",parameter:{appId:t},async:s,success:function(t){o.transCategoryData(t),e.call(this,t)},failure:i})},listCategoryByPublisher:function(t,e,i,s){var o=this;this.action.invoke({name:"listCategoryByPublisher",parameter:{appId:t},async:s,success:function(t){o.transCategoryData(t),e.call(this,t)},failure:i})},getCategory:function(t,e,i,s){var o=this;this.action.invoke({name:"getCategory",parameter:{id:t},success:function(t){o.transCategoryData(t),e.call(this,t)},failure:i,async:s})},saveCategory:function(t,e,i){t.isNew?this.addCategory(t,e,i):this.updateCategory(t,e,i)},addCategory:function(t,e,i){this.action.invoke({name:"addCategory",data:t,success:e,failure:i})},updateCategory:function(t,e,i){this.action.invoke({name:"updateCategory",data:t,parameter:{id:t.id},success:e,failure:i})},transCategoryData:function(t){var e=function(t){t.name||(t.name=t.categoryName),t.alias||(t.alias=t.categoryAlias),t.categoryName||(t.categoryName=t.name),t.categoryAlias||(t.categoryAlias=t.alias)};t.data?"array"==typeOf(t.data)?t.data.each((function(t){e(t)})):e(t.data):t.data=[]},saveFile:function(t,e,i,s){t.id?this.updataFile(t.id,t,e,i,s):this.getUUID(function(o){t.id=o,this.addFile(t,e,i,s)}.bind(this),!1)},saveForm:function(t,e,i,s,o){t.isNewForm?this.addForm(t,e,i,s,o):this.updateForm(t,e,i,s,o)},updateForm:function(t,e,i,s,o){var n,a;t&&(n=MWF.encodeJsonString(JSON.encode(t))),e&&(a=MWF.encodeJsonString(JSON.encode(e)));var r=null;t&&t.json.includeScripts&&t.json.includeScripts.length&&(r={},t.json.includeScripts.each((function(t){r[t.id]="process"===t.appType?"processPlatform":t.appType})));var l=null;e&&e.json.includeScripts&&e.json.includeScripts.length&&(l={},e.json.includeScripts.each((function(t){l[t.id]="process"===t.appType?"processPlatform":t.appType})));var c={id:t.json.id,name:t.json.name,alias:t.json.name,description:t.json.description,appId:t.json.application,formFieldList:i,relatedScriptMap:r,relatedFormList:t&&t.json.subformList?t.json.subformList:[],mobileRelatedScriptMap:l,mobileRelatedFormList:e&&e.json.subformList?e.json.subformList:[]};t&&(c.data=n),e&&(c.mobileData=a),this.action.invoke({name:"updataForm",data:c,parameter:{id:t.json.id},success:s,failure:o})},addForm:function(t,e,i,s,o){var n,a;if(t.json.id){t&&(n=MWF.encodeJsonString(JSON.encode(t))),e&&!e.json.id&&(e.json.id=t.json.id),e&&(a=MWF.encodeJsonString(JSON.encode(e)));var r={id:t.json.id,name:t.json.name,alias:t.json.name,description:t.json.description,appId:t.json.application,formFieldList:i};t&&(r.data=n),e&&(r.mobileData=a),this.action.invoke({name:"addForm",data:r,parameter:{id:t.json.categoryId},success:s,failure:o})}else this.getUUID(function(r){t.json.id=r,t&&(n=MWF.encodeJsonString(JSON.encode(t))),e&&!e.json.id&&(e.json.id=r),e&&(a=MWF.encodeJsonString(JSON.encode(e)));var l=null;t&&t.json.includeScripts&&t.json.includeScripts.length&&(l={},t.json.includeScripts.each((function(t){l[t.id]="process"===t.appType?"processPlatform":t.appType})));var c=null;e&&e.json.includeScripts&&e.json.includeScripts.length&&(c={},e.json.includeScripts.each((function(t){c[t.id]="process"===t.appType?"processPlatform":t.appType})));var d={id:t.json.id,name:t.json.name,alias:t.json.name,description:t.json.description,appId:t.json.application,formFieldList:i,relatedScriptMap:l,relatedFormList:t&&t.json.subformList?t.json.subformList:[],mobileRelatedScriptMap:c,mobileRelatedFormList:e&&e.json.subformList?e.json.subformList:[]};t&&(d.data=n),e&&(d.mobileData=a),this.action.invoke({name:"addForm",data:d,parameter:{id:t.json.id},success:s,failure:o})}.bind(this))},addFormTemplate:function(t,e,i,s,o){var n,a;this.getUUID(function(r){if(i.id=r,t){var l=Object.clone(t);l.json.id=r,l.json.name=i.name,n=MWF.encodeJsonString(JSON.encode(l))}if(e){var c=Object.clone(e);c.json.id=r,c.json.name=i.name,a=MWF.encodeJsonString(JSON.encode(c))}t&&(i.data=n),e&&(i.mobileData=a),this.action.invoke({name:"addFormTemplate",data:i,success:s,failure:o})}.bind(this))},saveDictionary:function(t,e,i){t.id||t.appDictId?this.updateDictionary(t,e,i):this.addDictionary(t,e,i)},updateDictionary:function(t,e,i){t.alias&&""!=t.alias||(t.alias=t.name),this.action.invoke({name:"updataDictionary",data:t,parameter:{appDictId:t.id},success:e,failure:i})},addDictionary:function(t,e,i){t.id||this.getUUID(function(s){t.id=s,t.appDictId=s,t.alias&&""!=t.alias||(t.alias=t.name),this.action.invoke({name:"addDictionary",data:t,parameter:{appDictId:t.id},success:e,failure:i})}.bind(this))},getScript:function(t,e,i,s){var o=this;this.action.invoke({name:"getScript",async:s,parameter:{id:t},success:function(t){o.transScriptData(t),e.call(this,t)},failure:i})},getScriptByName:function(t,e,i,s,o){var n=this;this.action.invoke({name:"getScriptByName",async:o,parameter:{name:t,appId:e},success:function(t){n.transScriptData(t),i.call(this,t)},failure:s})},saveScript:function(t,e,i){t.isNewScript?this.addScript(t,e,i):this.updateScript(t,e,i)},updateScript:function(t,e,i){this.transScriptData(t,"send"),this.action.invoke({name:"updataScript",data:t,parameter:{id:t.id},success:e,failure:i})},addScript:function(t,e,i){this.transScriptData(t,"send");t.id?this.action.invoke({name:"addScript",data:t,success:e,failure:i}):this.getUUID(function(s){t.id=s,this.action.invoke({name:"addScript",data:t,success:e,failure:i})}.bind(this))},transScriptData:function(t,e){var i=function(t){e&&"send"==e?(t.appId||(t.appId=t.application),t.appName||(t.appName=t.applicationName),t.application&&delete t.application,t.applicationName&&delete t.applicationName):(t.appId||(t.appId=t.application),t.appName||(t.appName=t.applicationName),t.application||(t.application=t.appId),t.applicationName||(t.application=t.appName))};"array"==typeOf(t)?t.each((function(t){i(t)})):i(t)},saveView:function(t,e,i){t.isNew?this.addView(t,e,i):this.updateView(t,e,i)},addView:function(t,e,i){this.action.invoke({name:"addView",data:t,success:e,failure:i})},updateView:function(t,e,i){this.action.invoke({name:"updateView",data:t,parameter:{id:t.id},success:e,failure:i})},saveViewColumn:function(t,e,i,s){t.isNew?this.addViewColumn(t,e,i,s):this.updateViewColumn(t,e,i,s)},saveCategoryView:function(t,e,i,s){t.isNew?this.addViewColumn(t,e,i,s):this.updateViewColumn(t,e,i,s)},saveQueryView:function(t,e,i,s){t.isNewView?(t.isNewView=!1,this.addQueryView(t,e,i,s)):this.updateQueryView(t,e,i,s)},addQueryView:function(t,e,i,s){var o=t.data,n=JSON.encode(t.data);t.data=n,o.id?(this.action.invoke({name:"addQueryView",data:t,success:e,failure:i,async:s}),t.data=o):this.getUUID(function(n){t.id=n,this.action.invoke({name:"addQueryView",data:t,success:e,failure:i,async:s}),t.data=o}.bind(this))},updateQueryView:function(t,e,i,s){var o=t.data,n=JSON.encode(t.data);t.data=n,this.action.invoke({name:"updateQueryView",data:t,async:s,parameter:{id:t.id},success:e,failure:i}),t.data=o},saveDocument:function(t,e,i,s){t.isNewDocument?this.addDocument(t,e,i,s):this.updateDocument(t,e,i,s)},addDocument:function(t,e,i,s){delete t.attachmentList,this.action.invoke({name:"addDocument",data:t,success:e,failure:i,async:s})},updateDocument:function(t,e,i,s){delete t.attachmentList,this.action.invoke({name:"updateDocument",data:t,parameter:{id:t.id},success:e,failure:i,async:s})},saveData:function(t,e,i,s,o){s.isNew?this.addData(t,e,i,s,o):this.updateData(t,e,i,s,o)},uploadAttachment:function(t,e,i,s,o){this.action.invoke({name:"uploadAttachment",parameter:{id:t},data:s,file:o,success:e,failure:i})},replaceAttachment:function(t,e,i,s,o,n){this.action.invoke({name:"replaceAttachment",parameter:{documentid:e,id:t},data:o,file:n,success:i,failure:s})},getAttachmentData:function(t,e){this.action.getActions(function(){var i=this.action.actions.getAttachmentData.uri;i=(i=i.replace("{id}",encodeURIComponent(t))).replace("{documentid}",encodeURIComponent(e)),window.open(o2.filterUrl(this.action.address+i))}.bind(this))},getAttachmentStream:function(t,e){this.action.getActions(function(){var i=this.action.actions.getAttachmentStream.uri;i=(i=i.replace("{id}",encodeURIComponent(t))).replace("{documentid}",encodeURIComponent(e)),window.open(o2.filterUrl(this.action.address+i))}.bind(this))},getAttachmentUrl:function(t,e,i){this.action.getActions(function(){var s=this.action.actions.getAttachmentData.uri;s=(s=s.replace("{id}",encodeURIComponent(t))).replace("{documentid}",encodeURIComponent(e)),i&&i(o2.filterUrl(this.action.address+s))}.bind(this))},convertLocalImageToBase64:function(t,e,i,s,o){this.action.invoke({name:"convertLocalImageToBase64",parameter:{size:t},data:s,file:o,success:e,failure:i})},getImageUrl:function(t,e,i){this.action.getActions(function(){var s=this.action.actions.getImage.uri;s=(s=s.replace("{id}",encodeURIComponent(t))).replace("{documentid}",encodeURIComponent(e)),i&&i(o2.filterUrl(this.action.address+s))}.bind(this))},listDocumentFilterNext:function(t,e,i,s,o,n){i&&!i.documentType&&(i.documentType="全部"),this.action.invoke({name:"listDocumentFilterNext",async:n,data:i,parameter:{id:t,count:e},success:s,failure:o})},listDocumentFilterPrev:function(t,e,i,s,o,n){i&&!i.documentType&&(i.documentType="全部"),this.action.invoke({name:"listDocumentFilterPrev",async:n,data:i,parameter:{id:t,count:e},success:s,failure:o})},listDraftNext:function(t,e,i,s,o,n){i&&!i.documentType&&(i.documentType="全部"),this.action.invoke({name:"listDraftNext",async:n,data:i,parameter:{id:t,count:e},success:s,failure:o})},listDraftPrev:function(t,e,i,s,o,n){i&&!i.documentType&&(i.documentType="全部"),this.action.invoke({name:"listDraftPrev",async:n,data:i,parameter:{id:t,count:e},success:s,failure:o})},importDocumentFormExcel:function(t,e,i,s,o){this.action.invoke({name:"importDocumentFormExcel",parameter:{categoryId:t},data:s,file:o,success:e,failure:i})},getCategoryByAlias:function(t,e,i){var s=this;this.action.invoke({name:"getCategoryByAlias",parameter:{alias:t},success:function(t){s.transCategoryData(t),e.call(this,t)},failure:i})},batchModifyData:function(t,e,i,s){this.action.invoke({name:"batchModifyData",data:{docIds:t,dataChanges:e},success:i,failure:s})}}),MWF.xAction.RestActions.Action.x_organization_assemble_control=new Class({Extends:MWF.xAction.RestActions.Action,savePerson:function(t,e,i){t.id?this.updatePerson(t.id,t,e,i):this.addPerson(t,e,i)},listPersonByPinyin:function(t,e,i,s){var o={};"string"===typeOf(i)?o.key=i:o=i,this.action.invoke({name:"listPersonByPinyin",async:s,data:o,success:t,failure:e})},listPersonByPinyininitial:function(t,e,i,s){var o={};"string"===typeOf(i)?o.key=i:o=i,this.action.invoke({name:"listPersonByPinyininitial",async:s,data:o,success:t,failure:e})},listPersonByKey:function(t,e,i,s){var o={};"string"===typeOf(i)?o.key=i:o=i,this.action.invoke({name:"listPersonByKey",async:s,data:o,success:t,failure:e})},getPersonIcon:function(t){var e="/jaxrs/person/{flag}/icon";return e=e.replace("{flag}",t),this.action.getAddress(),o2.filterUrl(this.action.address+e+"?"+(new Date).getTime())},savePersonAttribute:function(t,e,i){t.id?this.updatePersonAttribute(t.id,t,e,i):this.addPersonAttribute(t,e,i)},saveIdentity:function(t,e,i){t.id?this.updateIdentity(t.id,t,e,i):this.addIdentity(t,e,i)},listIdentityByKey:function(t,e,i,s){var o={};"string"===typeOf(i)?o.key=i:o=i,this.action.invoke({name:"listIdentityByKey",async:s,data:o,success:t,failure:e})},listIdentityByPinyin:function(t,e,i,s){var o={};"string"===typeOf(i)?o.key=i:o=i,this.action.invoke({name:"listIdentityByPinyin",async:s,data:o,success:t,failure:e})},listIdentityByPinyininitial:function(t,e,i,s){var o={};"string"===typeOf(i)?o.key=i:o=i,this.action.invoke({name:"listIdentityByPinyininitial",async:s,data:o,success:t,failure:e})},saveRole:function(t,e,i){t.id?this.updateRole(t.id,t,e,i):this.addRole(t,e,i)},listRoleByPinyin:function(t,e,i,s){var o={};"string"===typeOf(i)?o.key=i:o=i,this.action.invoke({name:"listRoleByKey",async:s,data:o,success:t,failure:e})},listRoleByPinyininitial:function(t,e,i,s){var o={};"string"===typeOf(i)?o.key=i:o=i,this.action.invoke({name:"listRoleByPinyininitial",async:s,data:o,success:t,failure:e})},listRoleByKey:function(t,e,i,s){var o={};"string"===typeOf(i)?o.key=i:o=i,this.action.invoke({name:"listRoleByKey",async:s,data:o,success:t,failure:e})},saveGroup:function(t,e,i){t.id?this.updateGroup(t.id,t,e,i):this.addGroup(t,e,i)},listGroupByKey:function(t,e,i,s){var o={};"string"===typeOf(i)?o.key=i:o=i,this.action.invoke({name:"listGroupByKey",async:s,data:o,success:t,failure:e})},listGroupByPinyin:function(t,e,i,s){var o={};"string"===typeOf(i)?o.key=i:o=i,this.action.invoke({name:"listGroupByPinyin",async:s,data:o,success:t,failure:e})},listGroupByPinyininitial:function(t,e,i,s){var o={};"string"===typeOf(i)?o.key=i:o=i,this.action.invoke({name:"listGroupByPinyininitial",async:s,data:o,success:t,failure:e})},saveUnit:function(t,e,i){t.id?this.updateUnit(t.id,t,e,i):this.addUnit(t,e,i)},listUnitByKey:function(t,e,i,s){var o={};"string"===typeOf(i)?o.key=i:o=i,this.action.invoke({name:"listUnitByKey",async:s,data:o,success:t,failure:e})},listUnitByPinyin:function(t,e,i,s){var o={};"string"===typeOf(i)?o.key=i:o=i,this.action.invoke({name:"listUnitByPinyin",async:s,data:o,success:t,failure:e})},listUnitByPinyininitial:function(t,e,i,s){var o={};"string"===typeOf(i)?o.key=i:o=i,this.action.invoke({name:"listUnitByPinyininitial",async:s,data:o,success:t,failure:e})},saveUnitattribute:function(t,e,i){t.id?this.updateUnitattribute(t.id,t,e,i):this.addUnitattribute(t,e,i)},saveUnitduty:function(t,e,i){t.id?this.updateUnitduty(t.id,t,e,i):this.addUnitduty(t,e,i)}}),MWF.xAction.RestActions.Action.x_query_assemble_surface=new Class({Extends:MWF.xAction.RestActions.Action,saveRow:function(t,e,i,s,o){e.id?this.action.invoke({name:"updateRow",async:o,parameter:{tableFlag:t,id:e.id},data:e,success:i,failure:s}):this.action.invoke({name:"insertRow",async:o,parameter:{tableFlag:t},data:e,success:i,failure:s})}}),MWF.xAction.RestActions.Action.x_organization_assemble_personal=new Class({Extends:MWF.xAction.RestActions.Action,changePassword:function(t,e,i,s,o,n){var a={oldPassword:t,newPassword:e,confirmPassword:i};this.action.invoke({name:"changePassword",async:n,data:a,success:s,failure:o})},getPersonIcon:function(t){return this.action.getAddress(),o2.filterUrl(this.action.address+"/jaxrs/person/icon?"+(new Date).getTime())},getIcon:function(t){var e="/jaxrs/icon/"+t;return this.action.getAddress(),this.action.address+e+"?"+(new Date).getTime()},createEmPower:function(t,e,i,s){this.action.invoke({name:"createEmPower",async:s,data:t,success:e,failure:i})},editEmPower:function(t,e,i,s,o){this.action.getAddress(),this.action.invoke({name:"editEmPower",parameter:{id:t},async:o,data:e,success:i,failure:s})},deleteEmPower:function(t,e,i,s){this.action.invoke({name:"deleteEmPower",parameter:{id:t},async:s,success:e,failure:i})},listToCurrentPersonPaging:function(t,e,i,s,o,n){this.action.invoke({name:"listToCurrentPersonPaging",parameter:{page:t,size:e},data:{key:i},async:n,success:s,failure:o})},listWithCurrentPersonPaging:function(t,e,i,s,o,n){this.action.invoke({name:"listWithCurrentPersonPaging",parameter:{page:t,size:e},data:{key:i},async:n,success:s,failure:o})}});var actionJson={authentication:{uri:"/jaxrs/authentication",method:"GET"},login:{uri:"/jaxrs/authentication",method:"POST"},loginAdmin:{uri:"/jaxrs/authentication/administrator",method:"POST"},logout:{uri:"/jaxrs/authentication",method:"DELETE"},getLoginMode:{uri:"/jaxrs/authentication/mode"},getAuthentication:{uri:"/jaxrs/authentication"},loginByPassword:{uri:"/jaxrs/authentication",method:"POST"},getLoginCaptcha:{uri:"/jaxrs/authentication/captcha/width/{width}/height/{height}"},loginByCaptcha:{uri:"/jaxrs/authentication/captcha",method:"POST"},createCredentialCode:{uri:"/jaxrs/authentication/code/credential/{credential}"},checkCredential:{uri:"/jaxrs/authentication/check/credential/{credential}"},loginByCode:{uri:"/jaxrs/authentication/code",method:"POST"},getLoginBind:{uri:"/jaxrs/authentication/bind"},checkBindStatus:{uri:"/jaxrs/authentication/bind/meta/{meta}"},getOauthServer:{uri:"/jaxrs/authentication/oauth/name/{name}",method:"GET"},listOauthServer:{uri:"/jaxrs/authentication/oauth/list",method:"GET"},qywxOauthServer:{uri:"/jaxrs/authentication/oauth/qywx/config",method:"GET"},dingdingOauthServer:{uri:"/jaxrs/authentication/oauth/dingding/config",method:"GET"},loginOauthServer:{uri:"/jaxrs/authentication/oauth/login/name/{name}/code/{code}/redirecturi/{redirectUri}",method:"GET"},loginOauthQywxServer:{uri:"/jaxrs/authentication/oauth/login/qywx/code/{code}",method:"GET"},loginOauthDingdingServer:{uri:"/jaxrs/authentication/oauth/login/dingding/code/{code}",method:"GET"},oauthBind:{uri:"/jaxrs/authentication/oauth/bind/name/{name}/code/{code}/redirecturi/{redirectUri}",method:"GET"},clazz:"x_organization_assemble_authentication"};o2.xAction.RestActions.Action.x_organization_assemble_authentication||(o2.xAction.RestActions.Action.x_organization_assemble_authentication=new Class({Extends:o2.xAction.RestActions.Action})),o2.Actions.actions.x_organization_assemble_authentication=new o2.xAction.RestActions.Action.x_organization_assemble_authentication("x_organization_assemble_authentication",actionJson);actionJson={getApplication:{uri:"/jaxrs/application/{id}"},listApplication:{uri:"/jaxrs/application/list"},listApplications:{uri:"/jaxrs/application/list"},getApplicationIcon:{uri:"/jaxrs/application/{id}/icon"},listWorkNext:{uri:"/jaxrs/work/list/{id}/next/{count}/application/{applicationId}"},listWorkPrev:{uri:"/jaxrs/work/list/{id}/prev/{count}/application/{applicationId}"},listProcessCount:{uri:"/jaxrs/work/list/count/application/{applicationId}/process"},listWorkNextManage:{uri:"/jaxrs/work/list/{id}/next/{count}/application/{applicationId}/manage"},listWorkPrevManage:{uri:"/jaxrs/work/list/{id}/prev/{count}/application/{applicationId}/manage"},listProcessCountManage:{uri:"/jaxrs/work/list/count/application/{applicationId}/process/manage"},listProcessManage:{uri:"/jaxrs/work/list/count/application/{applicationId}/process/manage"},listWorkCreator:{uri:"/jaxrs/work/list/{id}/next/{count}/creator/current"},listWorkCreatorFilter:{uri:"/jaxrs/work/list/{id}/next/{count}/creator/current/filter",method:"POST"},listAssignments:{uri:"/jaxrs/work/{id}/assignment/manage"},listRelatives:{uri:"/jaxrs/work/{id}/relative/manage"},listWorkByJob:{uri:"/jaxrs/job/{job}/find/work/workcompleted"},listAssignmentByWork:{uri:"/jaxrs/work/{id}/assignment/manage"},listWorkFilter:{uri:"/jaxrs/work/list/{id}/next/{count}/application/{applicationId}/filter",method:"POST"},listFilterAttribute:{uri:"/jaxrs/work/filter/attribute/application/{applicationId}"},listWorkFilterManage:{uri:"/jaxrs/work/list/{id}/next/{count}/application/{applicationId}/filter/manage",method:"POST"},listFilterAttributeManage:{uri:"/jaxrs/work/filter/attribute/application/{applicationId}/manage"},listWorkCompletedNext:{uri:"/jaxrs/workcompleted/list/{id}/next/{count}/application/{applicationId}"},listWorkCompletedPrev:{uri:"/jaxrs/workcompleted/list/{id}/prev/{count}/application/{applicationId}"},listWorkCompletedProcess:{uri:"/jaxrs/workcompleted/list/count/application/{applicationId}/process"},listWorkCompletedNextManage:{uri:"/jaxrs/workcompleted/list/{id}/next/{count}/application/{applicationId}/manage"},listWorkCompletedPrevManage:{uri:"/jaxrs/workcompleted/list/{id}/prev/{count}/application/{applicationId}/manage"},listWorkCompletedProcessManage:{uri:"/jaxrs/workcompleted/list/count/application/{applicationId}/process/manage"},listWorkCompletedFilter:{uri:"/jaxrs/workcompleted/list/{id}/next/{count}/application/{applicationId}/filter",method:"POST"},listWorkCompletedFilterAttribute:{uri:"/jaxrs/workcompleted/filter/attribute/application/{applicationId}"},listWorkCompletedFilterManage:{uri:"/jaxrs/workcompleted/list/{id}/next/{count}/application/{applicationId}/filter/manage",method:"POST"},listWorkCompletedFilterAttributeManage:{uri:"/jaxrs/workcompleted/filter/attribute/application/{applicationId}/manage"},listWorkCompletedAssignments:{uri:"/jaxrs/workcompleted/{id}/assignment/manage"},removeAllWork:{uri:"/jaxrs/work/{id}/relative/manage",method:"DELETE"},removeWork:{uri:"/jaxrs/work/{id}/single/manage",method:"DELETE"},removeWorkCompleted:{uri:"/jaxrs/workcompleted/{id}/delete/manage",method:"DELETE"},resetTask:{uri:"/jaxrs/task/{id}/reset/manage",method:"PUT"},flowTask:{uri:"/jaxrs/task/{id}/processing/manage",method:"PUT"},resetRead:{uri:"/jaxrs/read/{id}/reset/manage",method:"PUT"},flagRead:{uri:"/jaxrs/read/{id}/processing/manage",method:"PUT"},flowWork:{uri:"/jaxrs/work/{id}/processing",method:"PUT"},getWork:{uri:"/jaxrs/work/{id}/manage"},getWorkCompleted:{uri:"/jaxrs/workcompleted/{id}/manage"},getWorkContent:{uri:"/jaxrs/work/{id}"},getWorkInfor:{uri:"/jaxrs/work/{id}"},checkDraft:{uri:"/jaxrs/work/{id}/close/check",method:"GET"},removeTask:{uri:"/jaxrs/task/{id}/manage",method:"DELETE"},removeDone:{uri:"/jaxrs/taskcompleted/{id}/manage",method:"DELETE"},removeRead:{uri:"/jaxrs/read/{id}/manage",method:"DELETE"},removeReaded:{uri:"/jaxrs/readcompleted/{id}/manage",method:"DELETE"},listDictionary:{uri:"/jaxrs/applicationdict/list/application/{application}"},getDictionary:{uri:"/jaxrs/applicationdict/{applicationDict}/application/{applicationFlag}"},updataDictionary:{uri:"/jaxrs/applicationdict/{applicationDictFlag}/application/{applicationFlag}",method:"PUT"},getDictRoot:{uri:"/jaxrs/applicationdict/{applicationDict}/application/{application}/data"},getDictData:{uri:"/jaxrs/applicationdict/{applicationDict}/application/{application}/{path}/data"},setDictData:{uri:"/jaxrs/applicationdict/{applicationDict}/application/{application}/{path}/data",method:"PUT"},addDictData:{uri:"/jaxrs/applicationdict/{applicationDict}/application/{application}/{path}/data",method:"POST"},deleteDictData:{uri:"/jaxrs/applicationdict/{applicationDict}/application/{application}/{path}/data",method:"DELETE"},listSerialNumber:{uri:"/jaxrs/serialnumber/list/application/{application}"},getSerialNumber:{uri:"/jaxrs/serialnumber/{id}"},deleteSerialNumber:{uri:"/jaxrs/serialnumber/{id}",method:"DELETE"},updateSerialNumber:{uri:"/jaxrs/serialnumber/{id}",method:"PUT"},getRerouteTo:{uri:"/jaxrs/process/{flag}/allowrerouteto"},rerouteWork:{uri:"/jaxrs/work/{id}/reroute/activity/{activityId}/activitytype/{type}",method:"PUT"},listView:{uri:"/jaxrs/queryview/list/application/flag/{application}"},loadView:{uri:"/jaxrs/queryview/flag/{flag}/application/flag/{application}/execute",method:"PUT"},exportView:{uri:"/jaxrs/queryview/flag/{flag}/application/flag/{applicationFlag}/excel",method:"PUT"},exportViewResult:{uri:"/jaxrs/queryview/excel/result/{flag}"},listStat:{uri:"/jaxrs/querystat/list/application/flag/{application}"},loadStat:{uri:"/jaxrs/querystat/flag/{flag}/application/flag/{application}/execute",method:"PUT"},press:{uri:"/jaxrs/taskcompleted/press/work/{work}"},pauseTask:{uri:"/jaxrs/task/v2/{id}/pause"},resumeTask:{uri:"/jaxrs/task/v2/{id}/resume"},getCount:{uri:"/jaxrs/work/count/{credential}"},listApplicationStartable:{uri:"/jaxrs/application/list/complex"},listWorkByCreator:{uri:"/jaxrs/work/list/creator"},startWork:{uri:"/jaxrs/work/process/{processId}",method:"POST"},processWork:{uri:"/jaxrs/work/{id}/processing",method:"PUT"},createtWork:{uri:"/jaxrs/work/process/{processId}",method:"POST"},draw:{uri:"/jaxrs/draft/process/{processFlag}",method:"POST"},saveDraft:{uri:"/jaxrs/draft",method:"PUT"},getDraft:{uri:"/jaxrs/draft/{id}"},listDraftNext:{uri:"/jaxrs/draft/list/{id}/next/{count}"},listDraftPrev:{uri:"/jaxrs/draft/list/{id}/prev/{count}"},listDraftPage:{uri:"/jaxrs/draft/list/my/paging/{page}/size/{size}",method:"POST"},listDraftApplication:{uri:"/jaxrs/draft/list/count/application"},startDraft:{uri:"/jaxrs/draft/{id}/start"},deleteDraftWork:{uri:"/jaxrs/draft/{id}",method:"DELETE"},getTask:{uri:"/jaxrs/task/{id}"},saveTask:{uri:"/jaxrs/task/{id}",method:"POST"},deleteTask:{uri:"/jaxrs/task/{id}",method:"DELETE"},listTask:{uri:"/jaxrs/task/list"},listTaskNext:{uri:"/jaxrs/task/list/{id}/next/{count}"},listTaskNextByApp:{uri:"/jaxrs/task/list/{id}/next/{count}/application/{application}"},listTaskFilterCount:{uri:"/jaxrs/task/filter/attribute"},listTaskFilterCountFilter:{uri:"/jaxrs/task/filter/attribute/filter",method:"POST"},listTaskMyFilterPaging:{uri:"/jaxrs/task/list/my/filter/{page}/size/{size}",method:"POST"},listTaskMyPaging:{uri:"/jaxrs/task/list/my/paging/{page}/size/{size}"},getTaskCountFilter:{uri:"/jaxrs/task/count/filter",method:"POST"},getTaskCount:{uri:"/jaxrs/task/count/{name}"},listTaskFilter:{uri:"/jaxrs/task/list/{id}/next/{count}/filter",method:"POST"},listTaskPrev:{uri:"/jaxrs/task/list/{id}/prev/{count}"},processTask:{uri:"/jaxrs/task/{id}/processing",method:"POST"},listTaskCompletedNext:{uri:"/jaxrs/taskcompleted/list/{id}/next/{count}"},listTaskCompletedNextByApp:{uri:"/jaxrs/taskcompleted/list/{id}/next/{count}/application/{application}"},listTaskCompletedPrev:{uri:"/jaxrs/taskcompleted/list/{id}/prev/{count}"},getSimpleJobByTask:{uri:"/jaxrs/task/{id}/reference"},listTaskApplication:{uri:"/jaxrs/task/list/count/application"},listTaskCompletedApplication:{uri:"/jaxrs/taskcompleted/list/count/application"},listTaskCompletedFilterCount:{uri:"/jaxrs/taskcompleted/filter/attribute"},listTaskCompletedFilterCountFilter:{uri:"/jaxrs/taskcompleted/filter/attribute/filter",method:"POST"},listTaskCompletedMyFilterPaging:{uri:"/jaxrs/taskcompleted/list/my/filter/{page}/size/{size}",method:"POST"},listTaskCompletedMyPaging:{uri:"/jaxrs/taskcompleted/list/my/paging/{page}/size/{size}"},listTaskCompletedFilter:{uri:"/jaxrs/taskcompleted/list/{id}/next/{count}/filter",method:"POST"},getSimpleJobByTaskCompleted:{uri:"/jaxrs/taskcompleted/{id}/reference"},getTaskCompleted:{uri:"/jaxrs/taskcompleted/{id}"},listReadApplication:{uri:"/jaxrs/read/list/count/application"},listReadFilter:{uri:"/jaxrs/read/list/{id}/next/{count}/filter",method:"POST"},listReadNext:{uri:"/jaxrs/read/list/{id}/next/{count}"},getSimpleJobByRead:{uri:"/jaxrs/read/{id}/reference"},listReadFilterCount:{uri:"/jaxrs/read/filter/attribute"},listReadFilterCountFilter:{uri:"/jaxrs/read/filter/attribute/filter",method:"POST"},listReadMyFilterPaging:{uri:"/jaxrs/read/list/my/filter/{page}/size/{size}",method:"POST"},listReadMyPaging:{uri:"/jaxrs/read/list/my/paging/{page}/size/{size}"},getReadCount:{uri:"/jaxrs/read/count/{name}"},setReaded:{uri:"/jaxrs/read/{id}/processing",method:"POST"},getRead:{uri:"/jaxrs/read/{id}"},listReadedApplication:{uri:"/jaxrs/readcompleted/list/count/application"},listReadedFilter:{uri:"/jaxrs/readcompleted/list/{id}/next/{count}/filter",method:"POST"},listReadedNext:{uri:"/jaxrs/readcompleted/list/{id}/next/{count}"},getSimpleJobByReaded:{uri:"/jaxrs/readcompleted/{id}/reference"},getReaded:{uri:"/jaxrs/readcompleted/{id}"},listReadedFilterCount:{uri:"/jaxrs/readcompleted/filter/attribute"},listReadedFilterCountFilter:{uri:"/jaxrs/readcompleted/filter/attribute/filter",method:"POST"},listReadedMyFilterPaging:{uri:"/jaxrs/readcompleted/list/my/filter/{page}/size/{size}",method:"POST"},listReadedMyPaging:{uri:"/jaxrs/readcompleted/list/my/paging/{page}/size/{size}"},listReviewApplication:{uri:"/jaxrs/review/list/count/application"},listReviewFilter:{uri:"/jaxrs/review/list/{id}/next/{count}/filter",method:"POST"},listReviewNext:{uri:"/jaxrs/review/list/{id}/next/{count}"},getSimpleJobByReview:{uri:"/jaxrs/review/{id}/reference"},getReview:{uri:"/jaxrs/review/{id}"},listReviewFilterCount:{uri:"/jaxrs/review/filter/attribute"},listReviewFilterCountFilter:{uri:"/jaxrs/review/filter/attribute/filter",method:"POST"},listReviewMyFilterPaging:{uri:"/jaxrs/review/list/my/filter/{page}/size/{size}",method:"POST"},listReviewMyPaging:{uri:"/jaxrs/review/list/my/paging/{page}/size/{size}"},manageDeleteReview:{uri:"/jaxrs/review/{id}/application/{applicationFlag}/manage",method:"DELETE"},addWorkCompletedReview:{uri:"/jaxrs/review/create/workcompleted",method:"POST"},addWorkReview:{uri:"/jaxrs/review/create/work",method:"POST"},getJobByTask:{uri:"/jaxrs/work/task/{id}/complex"},getJobByWork:{uri:"/jaxrs/work/{id}/complex"},getJobByWorkMobile:{uri:"/jaxrs/work/{id}/complex/mobile"},getLogWithWork:{uri:"/jaxrs/worklog/list/work/{workId}"},getWorkData:{uri:"/jaxrs/data/work/{id}",method:"GET"},getWorkDataByPath:{uri:"/jaxrs/data/work/{id}/{path}",method:"GET"},getWorkcompletedDataByPath:{uri:"/jaxrs/data/workcompleted/{id}/{path}",method:"GET"},getJobDataByPath:{uri:"/jaxrs/data/job/{id}/{path}",method:"GET"},getWorkcompletedData:{uri:"/jaxrs/data/workcompleted/{id}",method:"GET"},saveData:{uri:"/jaxrs/data/work/{id}",method:"PUT"},saveSectionData:{uri:"/jaxrs/data/section/work/{id}",method:"PUT"},saveWorkCompletedData:{uri:"/jaxrs/data/workcompleted/{id}",method:"PUT"},getJobByWorkCompleted:{uri:"/jaxrs/workcompleted/{id}/complex"},getJobByWorkCompletedMobile:{uri:"/jaxrs/workcompleted/{id}/complex/mobile"},uploadAttachment:{uri:"/jaxrs/attachment/upload/work/{id}",method:"POST",enctype:"formData"},uploadAttachmentByWorkCompleted:{uri:"/jaxrs/attachment/upload/workcompleted/{id}",method:"POST",enctype:"formData"},V2UploadWorkOrWorkCompleted:{uri:"/jaxrs/attachment/v2/upload/workorworkcompleted/{workOrWorkCompleted}",method:"POST",enctype:"formData"},replaceAttachment:{uri:"/jaxrs/attachment/update/{id}/work/{workid}",method:"POST",enctype:"formData"},getAttachmentData:{uri:"/jaxrs/attachment/download/{id}/work/{workid}",method:"GET"},getWorkcompletedAttachmentData:{uri:"/jaxrs/attachment/download/{id}/workcompleted/{workCompletedId}",method:"GET"},getAttachmentStream:{uri:"/jaxrs/attachment/download/{id}/work/{workid}/stream",method:"GET"},getWorkcompletedAttachmentStream:{uri:"/jaxrs/attachment/download/{id}/workcompleted/{workCompletedId}/stream",method:"GET"},getAttachment:{uri:"/jaxrs/attachment/{id}/work/{workid}"},getAttachmentWorkcompleted:{uri:"/jaxrs/attachment/{id}/workcompleted/{workCompletedId}"},deleteAttachment:{uri:"/jaxrs/attachment/{id}/work/{workid}",method:"DELETE"},deleteWorkCompletedAttachment:{uri:"/jaxrs/attachment/{id}/workcompleted/{workCompletedId}",method:"DELETE"},configAttachment:{uri:"/jaxrs/attachment/edit/{id}/work/{workId}",method:"PUT"},getAttachmentOCR:{uri:"/jaxrs/attachment/{id}/work/{workId}/text"},setAttachmentOCR:{uri:"/jaxrs/attachment/edit/{id}/work/{workId}/text",method:"PUT"},listWorkAttachments:{uri:"/jaxrs/attachment/list/work/{workId}"},listWorkCompletedAttachments:{uri:"/jaxrs/attachment/list/workcompleted/{workCompletedId}"},retractWork:{uri:"/jaxrs/work/{id}/retract",method:"PUT"},resetWork:{uri:"/jaxrs/task/{id}/reset",method:"PUT"},deleteWork:{uri:"/jaxrs/work/{id}",method:"DELETE"},abandoned:{uri:"/jaxrs/snap/work/{workId}/type/abandoned"},getJobByWorkAssignForm:{uri:"/jaxrs/work/{id}/complex/appoint/form/{formTag}"},getJobByWorkAssignFormMobile:{uri:"/jaxrs/work/{id}/complex/appoint/form/{formTag}/mobile"},getJobByWorkCompletedAssignForm:{uri:"/jaxrs/workcompleted/{id}/complex/appoint/form/{formTag}"},getJobByWorkCompletedAssignFormMobile:{uri:"/jaxrs/workcompleted/{id}/complex/appoint//form/{formTag}/mobile"},lookupView:{uri:"/jaxrs/view/{id}"},getView:{uri:"/jaxrs/view/{id}"},getForm:{uri:"/jaxrs/form/{id}/application/{applicationFlag}"},getFormMobile:{uri:"/jaxrs/form/{id}/application/{applicationFlag}/mobile"},getScript:{uri:"/jaxrs/script/{flag}/application/{applicationFlag}"},getScriptByName:{uri:"/jaxrs/script/{name}/application/{applicationId}",method:"POST"},getFormV2:{uri:"/jaxrs/form/v2/{id}?t={tag}"},getFormV2Mobile:{uri:"/jaxrs/form/v2/{id}/mobile?t={tag}"},getScriptByNameV2:{uri:"/jaxrs/script/{flag}/application/{applicationFlag}/imported"},sendReaderByWork:{uri:"/jaxrs/read/work/{workId}",method:"POST"},sendReaderByWorkCompleted:{uri:"/jaxrs/read/workcompleted/{workCompletedId}",method:"POST"},copyAttachmentToWork:{uri:"/jaxrs/attachment/copy/work/{workId}",method:"POST"},listProcess:{uri:"/jaxrs/process/list/application/{applicationFlag}"},getProcess:{uri:"/jaxrs/process/{id}/complex"},getProcessByName:{uri:"/jaxrs/process/{flag}/application/{applicationFlag}"},readFile:{uri:"/jaxrs/file/{flag}/application/{applicationFlag}/content"},listFile:{uri:"/jaxrs/file/list/application/{applicationFlag}"},changeSite:{uri:"/jaxrs/attachment/{id}/work/{workId}/change/site/{site}"},addSplit:{uri:"/jaxrs/work/{id}/add/split",method:"PUT"},loadWork:{uri:"/jaxrs/work/workorworkcompleted/{workOrWorkCompleted}"},getWorkLog:{uri:"/jaxrs/worklog/list/workorworkcompleted/{workOrWorkCompleted}"},getRecordLog:{uri:"/jaxrs/record/list/workorworkcompleted/{workOrWorkCompleted}"},listAttachments:{uri:"/jaxrs/attachment/list/workorworkcompleted/{workOrWorkCompleted}"},listTaskcompleted:{uri:"/jaxrs/taskcompleted/list/workorworkcompleted/{workOrWorkCompleted}"},listReadcompleted:{uri:"/jaxrs/readcompleted/list/workorworkcompleted/{workOrWorkCompleted}"},getWorkControl:{uri:"/jaxrs/control/workorworkcompleted/{workOrWorkCompleted}"},getWorkForm:{uri:"/jaxrs/form/workorworkcompleted/{workOrWorkCompleted}"},getWorkFormMobile:{uri:"/jaxrs/form/workorworkcompleted/{workOrWorkCompleted}/mobile"},loadWorkV2:{uri:"/jaxrs/work/v2/workorworkcompleted/{workOrWorkCompleted}"},lookupFormWithWork:{uri:"/jaxrs/form/v2/lookup/workorworkcompleted/{workOrWorkCompleted}"},lookupFormWithWorkMobile:{uri:"/jaxrs/form/v2/lookup/workorworkcompleted/{workOrWorkCompleted}/mobile"},listTaskByJob:{uri:"/jaxrs/task/list/job/{job}"},listTaskCompletedByJob:{uri:"/jaxrs/taskcompleted/list/job/{job}"},listReadByJob:{uri:"/jaxrs/read/list/job/{job}"},listReadCompletedByJob:{uri:"/jaxrs/readcompleted/list/job/{job}"},listTaskByWork:{uri:"/jaxrs/task/list/work/{work}"},listTaskCompletedByWork:{uri:"/jaxrs/taskcompleted/list/work/{work}"},listReadByWork:{uri:"/jaxrs/read/list/work/{work}"},listReadCompletedByWork:{uri:"/jaxrs/readcompleted/list/work/{work}"},rollback:{uri:"/jaxrs/work/{id}/rollback",method:"PUT"},rollbackWorkcompleted:{uri:"/jaxrs/workcompleted/{flag}/rollback",method:"PUT"},setTaskOpinion:{uri:"/jaxrs/task/{id}/opinion/manage",method:"PUT"},setTaskCompletedOpinion:{uri:"/jaxrs/taskcompleted/{id}/opinion/manage",method:"PUT"},setReadOpinion:{uri:"/jaxrs/read/{id}/opinion/manage",method:"PUT"},setReadCompletedOpinion:{uri:"/jaxrs/readcompleted/{id}/opinion/manage",method:"PUT"},manageListTaskFilterByPage:{uri:"/jaxrs/task/list/filter/{page}/size/{pageSize}/manage",method:"POST"},manageListTaskDoneFilterByPage:{uri:"/jaxrs/taskcompleted/list/filter/{page}/size/{pageSize}/manage",method:"POST"},manageListReadFilterByPage:{uri:"/jaxrs/read/list/filter/{page}/size/{pageSize}/manage",method:"POST"},manageListReadDoneFilterByPage:{uri:"/jaxrs/readcompleted/list/filter/{page}/size/{pageSize}/manage",method:"POST"},manageListWorkFilterByPage:{uri:"/jaxrs/work/list/filter/{page}/size/{pageSize}/manage",method:"POST"},manageListWorkCompletedFilterByPage:{uri:"/jaxrs/workcompleted/list/filter/{page}/size/{pageSize}/manage",method:"POST"},docToWord:{uri:"/jaxrs/attachment/doc/to/word/workorworkcompleted/{workId}",method:"POST"},getRouteSelectConfig:{uri:"/jaxrs/route/{id}/selectconfig"},listRoute:{uri:"/jaxrs/route/list",method:"PUT"},getRoute:{uri:"/jaxrs/route/{id}"},getReadRecord:{uri:"/jaxrs/readrecord/list/workorworkcompleted/{workOrWorkCompleted}"},clazz:"x_processplatform_assemble_surface"};o2.xAction.RestActions.Action.x_processplatform_assemble_surface||(o2.xAction.RestActions.Action.x_processplatform_assemble_surface=new Class({Extends:o2.xAction.RestActions.Action})),o2.Actions.actions.x_processplatform_assemble_surface=new o2.xAction.RestActions.Action.x_processplatform_assemble_surface("x_processplatform_assemble_surface",actionJson);actionJson={addPerson:{uri:"/jaxrs/person",method:"POST"},getPerson:{uri:"/jaxrs/person/{id}"},updatePerson:{uri:"/jaxrs/person/{id}",method:"PUT"},removePerson:{uri:"/jaxrs/person/{id}",method:"DELETE"},deletePerson:{uri:"/jaxrs/person/{id}",method:"DELETE"},listPersonDirect:{uri:"/jaxrs/person/list/group/{id}/sub/direct"},listPersonNested:{uri:"/jaxrs/person/list/group/{id}/sub/nested"},listPersonByPinyin:{uri:"/jaxrs/person/list/like/pinyin",method:"PUT"},listPersonByPinyininitial:{uri:"/jaxrs/person/list/pinyininitial",method:"PUT"},listPersonByKey:{uri:"/jaxrs/person/list/like",method:"PUT"},changePersonIcon:{uri:"/jaxrs/person/{id}/icon",method:"PUT",enctype:"formData"},getPersonIcon:{uri:"/jaxrs/person/{flag}/icon"},listPersonNext:{uri:"/jaxrs/person/list/{id}/next/{count}"},listPersonPrev:{uri:"/jaxrs/person/list/{id}/prev/{count}"},changePassword:{uri:"/jaxrs/person/{name}/set/password",method:"PUT"},resetPassword:{uri:"/jaxrs/person/{flag}/reset/password"},addPersonAttribute:{uri:"/jaxrs/personattribute",method:"POST"},getPersonAttribute:{uri:"/jaxrs/personattribute/{id}"},updatePersonAttribute:{uri:"/jaxrs/personattribute/{id}",method:"PUT"},removePersonAttribute:{uri:"/jaxrs/personattribute/{id}",method:"DELETE"},deletePersonAttribute:{uri:"/jaxrs/personattribute/{id}",method:"DELETE"},listPersonAttribute:{uri:"/jaxrs/personattribute/list/person/{id}"},addIdentity:{uri:"/jaxrs/identity",method:"POST"},getIdentity:{uri:"/jaxrs/identity/{id}"},updateIdentity:{uri:"/jaxrs/identity/{id}",method:"PUT"},removeIdentity:{uri:"/jaxrs/identity/{id}",method:"DELETE"},deleteIdentity:{uri:"/jaxrs/identity/{id}",method:"DELETE"},orderIdentity:{uri:"/jaxrs/identity/{flag}/order/before/{followFlag}"},listIdentityByPinyin:{uri:"/jaxrs/identity/list/like/pinyin",method:"PUT"},listIdentityByPinyininitial:{uri:"/jaxrs/identity/list/pinyininitial",method:"PUT"},listIdentityByKey:{uri:"/jaxrs/identity/list/like",method:"PUT"},listIdentityByPerson:{uri:"/jaxrs/identity/list/person/{id}"},listIdentityWithUnit:{uri:"/jaxrs/identity/list/unit/{unit}"},listIdentityWithDuty:{uri:"/jaxrs/identity/list/unitduty/name/{flag}"},listIdentityNext:{uri:"/jaxrs/identity/list/{id}/next/{count}"},listIdentityPrev:{uri:"/jaxrs/identity/list/{id}/prev/{count}"},listIdentityWidthUnitWithDutyName:{uri:"/jaxrs/identity/list/{unit}/unitduty/name/{duty}"},addRole:{uri:"/jaxrs/role",method:"POST"},getRole:{uri:"/jaxrs/role/{id}"},updateRole:{uri:"/jaxrs/role/{id}",method:"PUT"},removeRole:{uri:"/jaxrs/role/{id}",method:"DELETE"},deleteRole:{uri:"/jaxrs/role/{id}",method:"DELETE"},listRoleByPinyin:{uri:"/jaxrs/role/list/like/pinyin",method:"PUT"},listRoleByPinyininitial:{uri:"/jaxrs/role/list/pinyininitial",method:"PUT"},listRoleByKey:{uri:"/jaxrs/role/list/like",method:"PUT"},listRoleByGroup:{uri:"/jaxrs/role/list/group/{id}"},listRoleByPerson:{uri:"/jaxrs/role/list/person/{id}"},listRoleNext:{uri:"/jaxrs/role/list/{id}/next/{count}"},listRolePrev:{uri:"/jaxrs/role/list/{id}/prev/{count}"},addGroup:{uri:"/jaxrs/group",method:"POST"},getGroup:{uri:"/jaxrs/group/{id}"},updateGroup:{uri:"/jaxrs/group/{id}",method:"PUT"},removeGroup:{uri:"/jaxrs/group/{id}",method:"DELETE"},deleteGroup:{uri:"/jaxrs/group/{id}",method:"DELETE"},listGroupByPinyin:{uri:"/jaxrs/group/list/like/pinyin",method:"PUT"},listGroupByPinyininitial:{uri:"/jaxrs/group/list/pinyininitial",method:"PUT"},listGroupByKey:{uri:"/jaxrs/group/list/like",method:"PUT"},listGroupDirectByPerson:{uri:"/jaxrs/group/list/person/{id}/sup/direct"},listGroupNestedByPerson:{uri:"/jaxrs/group/list/person/{id}/sup/nested"},listSubGroupDirect:{uri:"/jaxrs/group/list/{id}/sub/direct"},listSubGroupNested:{uri:"/jaxrs/group/list/{id}/sub/nested"},listSupGroupDirect:{uri:"/jaxrs/group/list/{id}/sup/direct"},listSupGroupNested:{uri:"/jaxrs/group/list/{id}/sup/nested"},listGroupNext:{uri:"/jaxrs/group/list/{id}/next/{count}"},listGroupPrev:{uri:"/jaxrs/group/list/{id}/prev/{count}"},addUnit:{uri:"/jaxrs/unit",method:"POST"},getUnit:{uri:"/jaxrs/unit/{id}"},updateUnit:{uri:"/jaxrs/unit/{id}",method:"PUT"},removeUnit:{uri:"/jaxrs/unit/{id}",method:"DELETE"},deleteUnit:{uri:"/jaxrs/unit/{id}",method:"DELETE"},listUnitByPinyin:{uri:"/jaxrs/unit/list/like/pinyin",method:"PUT"},listUnitByPinyininitial:{uri:"/jaxrs/unit/list/pinyininitial",method:"PUT"},listUnitByKey:{uri:"/jaxrs/unit/list/like",method:"PUT"},listTopUnit:{uri:"/jaxrs/unit/list/top"},listUnitByType:{uri:"/jaxrs/unit/list/unit/type",method:"PUT"},listUnitType:{uri:"/jaxrs/unit/list/type"},listUnitNext:{uri:"/jaxrs/unit/list/{id}/next/{count}"},listUnitPrev:{uri:"/jaxrs/unit/list/{id}/prev/{count}"},listSubUnitDirect:{uri:"/jaxrs/unit/list/{id}/sub/direct"},listSubUnitNested:{uri:"/jaxrs/unit/list/{id}/sub/nested"},listSubUnitNestedByType:{uri:"/jaxrs/unit/list/{flag}/sub/direct/type/{type}"},getSupUnitDirect:{uri:"/jaxrs/unit/{id}/sup/direct"},listSupUnitNested:{uri:"/jaxrs/unit/list/{id}/sup/nested"},listSupUnitNestedByType:{uri:"/jaxrs/unit/list/{flag}/sup/nested/type/{type}"},getUnitWithIdentityWithLevel:{uri:"/jaxrs/unit/identity/{id}/level/{level}"},getUnitWithIdentityWithType:{uri:"/jaxrs/unit/identity/{id}/type/{type}"},addUnitattribute:{uri:"/jaxrs/unitattribute",method:"POST"},getUnitattribute:{uri:"/jaxrs/unitattribute/{id}"},updateUnitattribute:{uri:"/jaxrs/unitattribute/{id}",method:"PUT"},removeUnitattribute:{uri:"/jaxrs/unitattribute/{id}",method:"DELETE"},deleteUnitattribute:{uri:"/jaxrs/unitattribute/{id}",method:"DELETE"},listUnitattribute:{uri:"/jaxrs/unitattribute/list/unit/{id}"},listUnitattributeNext:{uri:"/jaxrs/unitattribute/list/{id}/next/{count}"},listUnitattributePrev:{uri:"/jaxrs/unitattribute/list/{id}/prev/{count}"},addUnitduty:{uri:"/jaxrs/unitduty",method:"POST"},getUnitduty:{uri:"/jaxrs/unitduty/{id}"},updateUnitduty:{uri:"/jaxrs/unitduty/{id}",method:"PUT"},removeUnitduty:{uri:"/jaxrs/unitduty/{id}",method:"DELETE"},deleteUnitduty:{uri:"/jaxrs/unitduty/{id}",method:"DELETE"},listUnitdutyName:{uri:"/jaxrs/unitduty/distinct/name"},listUnitdutyNameByKey:{uri:"/jaxrs/unitduty/distinct/name/like/{key}"},listUnitdutyByKey:{uri:"/jaxrs/unitduty/distinct/name/like/{key}"},listUnitdutyByIdentity:{uri:"/jaxrs/unitduty/list/identity/{flag}"},listUnitdutyByUnit:{uri:"/jaxrs/unitduty/list/unit/{flag}"},listUnitdutyByName:{uri:"/jaxrs/unitduty/list/name/{name}"},listUnitdutyNext:{uri:"/jaxrs/unitduty/list/{id}/next/{count}"},listUnitdutyPrev:{uri:"/jaxrs/unitduty/list/{id}/prev/{count}"},getImportPersonTemplate:{uri:"/jaxrs/inputperson/template"},getImportPersonResault:{uri:"/jaxrs/inputperson/result/flag/{flag}"},importPerson:{uri:"/jaxrs/inputperson",method:"POST",enctype:"formData"},wipeAll:{uri:"/jaxrs/inputperson/wipe"},clazz:"x_organization_assemble_control"};o2.xAction.RestActions.Action.x_organization_assemble_control||(o2.xAction.RestActions.Action.x_organization_assemble_control=new Class({Extends:o2.xAction.RestActions.Action})),o2.Actions.actions.x_organization_assemble_control=new o2.xAction.RestActions.Action.x_organization_assemble_control("x_organization_assemble_control",actionJson);actionJson={getQuery:{uri:"/jaxrs/query/{flag}"},listQuery:{uri:"/jaxrs/query/list"},listQueryByKey:{uri:"/jaxrs/query/list/key/{key}"},getStatById:{uri:"/jaxrs/stat/{id}"},getStat:{uri:"/jaxrs/stat/flag/{flag}/query/{queryFlag}"},listStat:{uri:"/jaxrs/stat/list/query/{queryFlag}"},loadStatById:{uri:"/jaxrs/stat/{id}/execute",method:"PUT"},loadStat:{uri:"/jaxrs/stat/flag/{flag}/query/{queryFlag}/execute",method:"PUT"},getViewById:{uri:"/jaxrs/view/{id}"},getView:{uri:"/jaxrs/view/flag/{flag}/query/{queryFlag}"},listView:{uri:"/jaxrs/view/list/query/{queryFlag}"},loadViewById:{uri:"/jaxrs/view/{id}/execute",method:"PUT"},loadView:{uri:"/jaxrs/view/flag/{flag}/query/{queryFlag}/execute",method:"PUT"},bundleView:{uri:"/jaxrs/view/{id}/bundle",method:"PUT"},getTableById:{uri:"/jaxrs/table/{id}"},exportViewWithQuery:{uri:"/jaxrs/view/flag/{flag}/query/{queryFlag}/excel",method:"PUT"},exportView:{uri:"/jaxrs/view/{id}/excel",method:"PUT"},getViewExcel:{uri:"/jaxrs/view/excel/result/{flag}"},search:{uri:"/jaxrs/segment/key/{key}"},listSearchEntry:{uri:"/jaxrs/segment/list/entry",method:"POST"},executeStatement:{uri:"/jaxrs/statement/{flag}/execute/page/{page}/size/{size}",method:"POST"},listRowNext:{uri:"/jaxrs/table/list/{tableFlag}/row/{id}/next/{count}"},listRowPrev:{uri:"/jaxrs/table/list/{tableFlag}/row/{id}/prev/{count}"},listRowSelectWhere:{uri:"/jaxrs/table/list/{tableFlag}/row/select/where/{where}"},listRowCountWhere:{uri:"/jaxrs/table/{tableFlag}/row/count/where/{where}"},getRow:{uri:"/jaxrs/table/{tableFlag}/row/{id}"},updateRow:{uri:"/jaxrs/table/{tableFlag}/row/{id}",method:"PUT"},insertRow:{uri:"/jaxrs/table/{tableFlag}/row",method:"POST"},countRowWhere:{uri:"/jaxrs/table/{tableFlag}/row/count/where/{where}"},deleteRow:{uri:"/jaxrs/table/{tableFlag}/row/{id}",method:"DELETE"},deleteAllRow:{uri:"/jaxrs/table/{tableFlag}/row/delete/all",method:"DELETE"},calculateNeural:{uri:"/jaxrs/neural/list/calculate/model/{modelFlag}/work/{workId}"},executImportModel:{uri:"/jaxrs/importmodel/{id}/execute",method:"POST"},listImportModel:{uri:"/jaxrs/importmodel/list/query/{queryFlag}"},getImportModelById:{uri:"/jaxrs/importmodel/{id}"},getImportModel:{uri:"/jaxrs/importmodel/flag/{flag}/query/{queryFlag}"},getUUID:{uri:"/jaxrs/importmodel/uuid"},getImportModelRecord:{uri:"/jaxrs/importmodel/record/{recordId}"},getImportModelRecordStatus:{uri:"/jaxrs/importmodel/record/{recordId}/status"},listImportModelRecord:{uri:"/jaxrs/importmodel/list/record/paging/{page}/size/{size}",method:"POST"},listImportModelRecordItem:{uri:"/jaxrs/importmodel/list/record/item/paging/{page}/size/{size}",method:"POST"},clazz:"x_query_assemble_surface"};o2.xAction.RestActions.Action.x_query_assemble_surface||(o2.xAction.RestActions.Action.x_query_assemble_surface=new Class({Extends:o2.xAction.RestActions.Action})),o2.Actions.actions.x_query_assemble_surface=new o2.xAction.RestActions.Action.x_query_assemble_surface("x_query_assemble_surface",actionJson);actionJson={listApplication:{uri:"/jaxrs/appinfo/list/user/view/all"},listCMSApplication:{uri:"/jaxrs/appinfo/list/user/view/all"},getApplication:{uri:"/jaxrs/appinfo/{id}"},getCMSApplication:{uri:"/jaxrs/appinfo/{id}"},listAllAppType:{uri:"/jaxrs/appinfo/list/appType"},listAllAppTypeByManager:{uri:"/jaxrs/appinfo/list/appType/manager"},listWhatICanManageWithAppType:{uri:"/jaxrs/appinfo/list/manage/type/{appType}"},listWhatICanViewWithAppType:{uri:"/jaxrs/appinfo/list/user/view/all/type/{appType}"},listCMSCategory:{uri:"/jaxrs/categoryinfo/list/view/app/{appId}/all"},getCMSForm:{uri:"/jaxrs/form/{id}"},listApplicationView:{uri:"/jaxrs/queryview/list/all"},listCMSApplicationView:{uri:"/jaxrs/queryview/list/all"},getId:{uri:"/jaxrs/uuid/random"},listColumn:{uri:"/jaxrs/appinfo/list/user/view/all"},listColumnByPublish:{uri:"/jaxrs/appinfo/list/user/publish"},listColumnByAdmin:{uri:"/jaxrs/appinfo/list/admin"},getColumn:{uri:"/jaxrs/appinfo/{id}"},getColumnByName:{uri:"/jaxrs/appinfo/{id}"},addColumn:{uri:"/jaxrs/appinfo",method:"POST"},removeColumn:{uri:"/jaxrs/appinfo/{id}",method:"DELETE"},updateColumn:{uri:"/jaxrs/appinfo",method:"POST"},getColumnIcon:{uri:"/jaxrs/appinfo/{id}/icon"},updataColumnIcon:{uri:"/jaxrs/appinfo/{id}/icon/size/72",method:"POST",enctype:"formData"},listAllCategory:{uri:"/jaxrs/categoryinfo/list/all"},listCategory:{uri:"/jaxrs/categoryinfo/list/view/app/{appId}/all"},listCategoryByPublisher:{uri:"/jaxrs/categoryinfo/list/publish/app/{appId}"},addCategory:{uri:"/jaxrs/categoryinfo",method:"POST"},getCategory:{uri:"/jaxrs/categoryinfo/{id}"},updateCategory:{uri:"/jaxrs/categoryinfo",method:"POST"},removeCategory:{uri:"/jaxrs/categoryinfo/{id}",method:"DELETE"},saveCategoryExtContent:{uri:"/jaxrs/categoryinfo/extContent",method:"POST"},saveCategoryImportView:{uri:"/jaxrs/categoryinfo/bind/{categoryId}/view",method:"PUT"},listAllForm:{uri:"/jaxrs/form/list/all"},listForm:{uri:"/jaxrs/form/list/app/{appId}"},getForm:{uri:"/jaxrs/form/{id}"},getFormWithColumn:{uri:"/jaxrs/form/{formFlag}/appinfo/{appFlag}"},addForm:{uri:"/jaxrs/form",method:"POST"},removeForm:{uri:"/jaxrs/form/{id}",method:"DELETE"},updataForm:{uri:"/jaxrs/form/{id}",method:"PUT"},getFormByAnonymous:{uri:"/jaxrs/anonymous/form/{id}"},listFormFieldWithForm:{uri:"/jaxrs/form/list/{id}/formfield"},listFormFieldWithColumn:{uri:"/jaxrs/form/list/formfield/appInfo/{appId}"},getFormV2:{uri:"/jaxrs/form/v2/{id}?t={tag}"},getFormMobileV2:{uri:"/jaxrs/form/v2/{id}/mobile?t={tag}"},getFormAnonymousV2:{uri:"/jaxrs/anonymous/form/v2/{id}?t={tag}"},getFormMobileAnonymousV2:{uri:"/jaxrs/anonymous/form/v2/{id}/mobile?t={tag}"},lookupFormWithDocV2:{uri:"/jaxrs/form/v2/lookup/document/{docId}"},lookupFormWithDocMobileV2:{uri:"/jaxrs/form/v2/lookup/document/{docId}/mobile"},lookupFormWithDocAnonymousV2:{uri:"/jaxrs/anonymous/form/v2/lookup/document/{docId}"},lookupFormWithDocMobileAnonymousV2:{uri:"/jaxrs/anonymous/form/v2/lookup/document/{docId}/mobile"},getFormTemplate:{uri:"/jaxrs/templateform/{id}"},deleteFormTemplate:{uri:"/jaxrs/templateform/{id}",method:"DELETE"},addFormTemplate:{uri:"/jaxrs/templateform",method:"POST"},listFormTemplate:{uri:"/jaxrs/templateform/list"},listFormTemplateCategory:{uri:"/jaxrs/templateform/list/category"},listFormTemplatByCategory:{uri:"/jaxrs/templateform/list/category",method:"PUT"},listDictionary:{uri:"/jaxrs/design/appdict/list/appInfo/{appId}"},getDictionary:{uri:"/jaxrs/design/appdict/{appDictId}"},addDictionary:{uri:"/jaxrs/design/appdict",method:"POST"},removeDictionary:{uri:"/jaxrs/design/appdict/{appDictId}",method:"DELETE"},updataDictionary:{uri:"/jaxrs/design/appdict/{appDictId}",method:"PUT"},getDictRoot:{uri:"/jaxrs/surface/appdict/{appDictId}/appInfo/{appId}/data"},getDictData:{uri:"/jaxrs/surface/appdict/{appDictId}/appInfo/{appId}/{path}/data"},setDictData:{uri:"/jaxrs/surface/appdict/{appDictId}/appInfo/{appId}/{path}/data",method:"PUT"},addDictData:{uri:"/jaxrs/surface/appdict/{appDictId}/appInfo/{appId}/{path}/data",method:"POST"},deleteDictData:{uri:"/jaxrs/surface/appdict/{appDictId}/appInfo/{appId}/{path}/data",method:"DELETE"},getDictRootAnonymous:{uri:"/jaxrs/anonymous/surface/appdict/{appDictId}/appInfo/{appId}/data"},getDictDataAnonymous:{uri:"/jaxrs/anonymous/surface/appdict/{appDictId}/appInfo/{appId}/{path}/data"},listScript:{uri:"/jaxrs/script/list/app/{appId}"},getScript:{uri:"/jaxrs/script/{id}"},addScript:{uri:"/jaxrs/script",method:"POST"},removeScript:{uri:"/jaxrs/script/{id}",method:"DELETE"},deleteScript:{uri:"/jaxrs/script/{id}",method:"DELETE"},updataScript:{uri:"/jaxrs/script/{id}",method:"PUT"},getScriptByName:{uri:"/jaxrs/script/list/app/{appId}/name/{name}"},getScriptByNameV2:{uri:"/jaxrs/script/{uniqueName}/app/{flag}/imported"},listAppByManager:{uri:"/jaxrs/appinfo/list/manage"},isAppInfoManager:{uri:"/jaxrs/permission/appInfo/{id}/manageable"},isCategoryInfoManagers:{uri:"/jaxrs/permission/categoryInfo/{id}/manageable"},listAppInfoManagers:{uri:"/jaxrs/permission/appInfo/{id}/managers"},listAppInfoPublishers:{uri:"/jaxrs/permission/appInfo/{id}/publishers"},listAppInfoViewers:{uri:"/jaxrs/permission/appInfo/{id}/viewers"},listCategoryInfoManagers:{uri:"/jaxrs/permission/category/{id}/managers"},listCategoryInfoPublishers:{uri:"/jaxrs/permission/category/{id}/publishers"},listCategoryInfoViewers:{uri:"/jaxrs/permission/category/{id}/viewers"},saveAppInfoManager:{uri:"/jaxrs/permission/manager/appInfo/{id}",method:"POST"},saveAppInfoPublisher:{uri:"/jaxrs/permission/publisher/appInfo/{id}",method:"POST"},saveAppInfoViewer:{uri:"/jaxrs/permission/viewer/appInfo/{id}",method:"POST"},saveCategoryInfoManager:{uri:"/jaxrs/permission/manager/categoryInfo/{id}",method:"POST"},saveCategoryInfoPublisher:{uri:"/jaxrs/permission/publisher/categoryInfo/{id}",method:"POST"},saveCategoryInfoViewer:{uri:"/jaxrs/permission/viewer/categoryInfo/{id}",method:"POST"},listView:{uri:"/jaxrs/view/list/app/{appId}"},listViewByCategory:{uri:"/jaxrs/view/list/category/{categoryId}"},listViewByForm:{uri:"/jaxrs/view/list/form/{formId}"},getView:{uri:"/jaxrs/view/{id}"},addView:{uri:"/jaxrs/view",method:"POST"},updateView:{uri:"/jaxrs/view/{id}",method:"PUT"},deleteView:{uri:"/jaxrs/view/{id}",method:"DELETE"},listViewColumn:{uri:"/jaxrs/viewfieldconfig/list/view/{viewId}"},getViewColumn:{uri:"/jaxrs/viewfieldconfig/{id}"},addViewColumn:{uri:"/jaxrs/viewfieldconfig",method:"POST"},updateViewColumn:{uri:"/jaxrs/viewfieldconfig/{id}",method:"PUT"},deleteViewColumn:{uri:"/jaxrs/viewfieldconfig/{id}",method:"DELETE"},listCategoryViewByView:{uri:"/jaxrs/viewcategory/list/view/{viewId}"},listCategoryViewByCategory:{uri:"/jaxrs/viewcategory/list/category/{categoryId}"},getCategoryView:{uri:"/jaxrs/viewfieldconfig/{id}"},addCategoryView:{uri:"/jaxrs/viewcategory",method:"POST"},updateCategoryView:{uri:"/jaxrs/viewcategory/{id}",method:"PUT"},deleteCategoryView:{uri:"/jaxrs/viewcategory/{id}",method:"DELETE"},listQueryView:{uri:"/jaxrs/queryview/design/list/application/{applicationId}"},listQueryViewNextPage:{uri:"/jaxrs/queryview/design/list/{id}/next/{count}"},listQueryViewPrevPage:{uri:"/jaxrs/queryview/design/list/{id}/prev/{count}"},getQueryView:{uri:"/jaxrs/queryview/design/{id}"},addQueryView:{uri:"/jaxrs/queryview/design",method:"POST"},updateQueryView:{uri:"/jaxrs/queryview/design/{id}",method:"PUT"},deleteQueryView:{uri:"/jaxrs/queryview/design/{id}",method:"DELETE"},getQueryViewContent:{uri:"/jaxrs/queryview/design/flag/{flag}"},loadQueryView:{uri:"/jaxrs/queryview/design/flag/{flag}/simulate",method:"PUT"},getDocument:{uri:"/jaxrs/document/{id}"},getDocumentControl:{uri:"/jaxrs/document/{id}/control"},viewDocument:{uri:"/jaxrs/document/{id}/view"},getDocumentByAnonymous:{uri:"/jaxrs/anonymous/document/{id}/view"},addDocument:{uri:"/jaxrs/document",method:"POST"},updateDocument:{uri:"/jaxrs/document",method:"POST"},removeDocument:{uri:"/jaxrs/document/{id}",method:"DELETE"},publishDocument:{uri:"/jaxrs/document/publish/{id}",method:"PUT"},cancelPublishDocument:{uri:"/jaxrs/document/publish/{id}/cancel",method:"PUT"},archiveDocument:{uri:"/jaxrs/document/achive/{id}",method:"PUT"},redraftDocument:{uri:"/jaxrs/document/draft/{id}",method:"PUT"},publishDocumentComplex:{uri:"/jaxrs/document/publish/content",method:"PUT"},moveDocumentToCategory:{uri:"/jaxrs/document/category/change",method:"PUT"},getData:{uri:"/jaxrs/data/document/{id}"},addData:{uri:"/jaxrs/data/document/{id}",method:"POST"},updateData:{uri:"/jaxrs/data/document/{id}",method:"PUT"},listAttachment:{uri:"/jaxrs/fileinfo/list/document/{documentid}"},listAttachmentByAnonymous:{uri:"/jaxrs/anonymous/fileinfo/list/document/{documentId}"},getAttachment:{uri:"/jaxrs/fileinfo/{id}/document/{documentid}"},deleteAttachment:{uri:"/jaxrs/fileinfo/{id}",method:"DELETE"},configAttachment:{uri:"/jaxrs/fileinfo/edit/{id}/doc/{docId}",method:"PUT"},uploadAttachment:{uri:"/jaxrs/fileinfo/upload/document/{id}",method:"POST",enctype:"formData"},replaceAttachment:{uri:"/jaxrs/fileinfo/update/document/{documentid}/attachment/{id}",method:"POST",enctype:"formData"},getAttachmentData:{uri:"/jaxrs/fileinfo/download/document/{id}",method:"GET"},getAttachmentStream:{uri:"/jaxrs/fileinfo/download/document/{id}/stream",method:"GET"},getInternetImageBaseBase64:{uri:"/jaxrs/image/encode/base64",method:"POST"},convertLocalImageToBase64:{uri:"/servlet/image/encode/base64/size/{size}",method:"POST",enctype:"formData"},getSubjectAttachmentBase64:{uri:"/jaxrs/fileinfo/{id}/binary/base64/{size}"},listFile:{uri:"/jaxrs/file/list/appInfo/{applicationFlag}"},getFile:{uri:"/jaxrs/file/{id}"},addFile:{uri:"/jaxrs/file",method:"POST"},removeFile:{uri:"/jaxrs/file/{id}",method:"DELETE"},deleteFile:{uri:"/jaxrs/file/{id}",method:"DELETE"},updataFile:{uri:"/jaxrs/file/{id}",method:"PUT"},getFileByName:{uri:"/jaxrs/file/appInfo/{applicationId}/name/{name}"},downloadFile:{uri:"/jaxrs/file/{id}/download"},downloadWithApp:{uri:"/jaxrs/file/{flag}/appInfo/{applicationFlag}/download"},readFileById:{uri:"/jaxrs/file/{id}/content"},uploadFile:{uri:"/jaxrs/file/{id}/upload",method:"POST",enctype:"formData"},copyFile:{uri:"/jaxrs/file/{flag}/appInfo/{appInfoFlag}"},readFile:{uri:"/jaxrs/file/{flag}/appInfo/{applicationFlag}/content"},saveImage:{uri:"/jaxrs/document/pic",method:"POST"},getImage:{uri:"/jaxrs/document/pic/{id}"},listImage:{uri:"/jaxrs/document/pic/doc/{documentid}"},removeImage:{uri:"/jaxrs/document/pic/{id}",method:"DELETE"},getImageByDocument:{uri:"/servlet/document/{documentid}/mainpic",method:"PUT"},getReadedCount:{uri:"/jaxrs/document/{id}/view/count"},listReadedLog:{uri:"/jaxrs/viewrecord/document/{docId}/filter/list/{id}/next/{count}",method:"GET"},listDocumentAll:{uri:"/jaxrs/document/list/category/{categoryId}"},listDocumentFilterNext:{uri:"/jaxrs/document/filter/list/{id}/next/{count}",method:"PUT"},listDocumentFilterPrev:{uri:"/jaxrs/document/filter/list/{id}/prev/{count}",method:"PUT"},listViewDataNext:{uri:"/jaxrs/view/viewdata/list/{id}/next/{count}",method:"POST"},listDraftNext:{uri:"/jaxrs/document/draft/list/{id}/next/{count}",method:"PUT"},listDraftPrev:{uri:"/jaxrs/document/draft/list/{id}/prev/{count}",method:"PUT"},listDraftFilterAttribute:{uri:"/jaxrs/searchfilter/list/draft/filter"},listPublishFilterAttribute:{uri:"/jaxrs/searchfilter/list/publish/filter"},listArchiveFilterAttribute:{uri:"/jaxrs/searchfilter/list/archive/filter"},listCategoryDraftFilterAttribute:{uri:"/jaxrs/searchfilter/list/draft/filter/category/{categoryId}"},listCategoryPublishFilterAttribute:{uri:"/jaxrs/searchfilter/list/publish/filter/category/{categoryId}"},listCategoryArchiveFilterAttribute:{uri:"/jaxrs/searchfilter/list/archive/filter/category/{categoryId}"},achiveDocument:{uri:"/jaxrs/document/achive/{id}",method:"PUT"},importDocumentFormExcel:{uri:"/jaxrs/document/import/category/{categoryId}",method:"POST",enctype:"formData"},deleteDocumentWithBatchName:{uri:"/jaxrs/document/batch/{batchId}",method:"DELETE"},checkImportStatus:{uri:"/jaxrs/document/batch/{batchName}/status"},checkAllImportStatus:{uri:"/jaxrs/document/batch/status"},getColumnByAlias:{uri:"/jaxrs/appinfo/alias/{alias}"},getCategoryByAlias:{uri:"/jaxrs/categoryinfo/alias/{alias}"},batchModifyData:{uri:"/jaxrs/document/batch/data/modify",method:"PUT"},listCommentNextWithFilter:{uri:"/jaxrs/comment/list/{id}/next/{count}",method:"PUT"},listCommentPageWithFilter:{uri:"/jaxrs/comment/list/{page}/size/{size}",method:"PUT"},listCommentPrevWithFilter:{uri:"/jaxrs/comment/list/{id}/prev/{count}",method:"PUT"},deleteComment:{uri:"/jaxrs/comment/{id}",method:"DELETE"},saveComment:{uri:"/jaxrs/comment",method:"POST"},clazz:"x_cms_assemble_control"};o2.xAction.RestActions.Action.x_cms_assemble_control||(o2.xAction.RestActions.Action.x_cms_assemble_control=new Class({Extends:o2.xAction.RestActions.Action})),o2.Actions.actions.x_cms_assemble_control=new o2.xAction.RestActions.Action.x_cms_assemble_control("x_cms_assemble_control",actionJson);actionJson={collectConnected:{uri:"/jaxrs/collect/connect"},getCollectConfig:{uri:"/jaxrs/collect"},disconnect:{uri:"/jaxrs/collect/disconnect"},collectValidate:{uri:"/jaxrs/collect/validate"},updateCollect:{uri:"/jaxrs/collect",method:"PUT"},updateUnitCollect:{uri:"/jaxrs/collect/updateUnit",method:"PUT"},deleteCollect:{uri:"/jaxrs/collect/name/{name}/mobile/{mobile}/code/{code}",method:"DELETE"},createCollect:{uri:"/jaxrs/collect",method:"POST"},collectValidateInput:{uri:"/jaxrs/collect/validate/direct",method:"PUT"},getCode:{uri:"/jaxrs/collect/code/mobile/{mobile}"},codeValidate:{uri:"/jaxrs/collect/validate/codeanswer",method:"PUT"},resetPassword:{uri:"/jaxrs/collect/resetpassword",method:"PUT"},nameExist:{uri:"/jaxrs/collect/name/{name}/exist"},passwordValidate:{uri:"/jaxrs/collect/validate/password",method:"PUT"},listModuleCategory:{uri:"/jaxrs/module/list/category"},listModule:{uri:"/jaxrs/module/list",method:"PUT"},compareModule:{uri:"/jaxrs/module/{id}/compare"},importModule:{uri:"/jaxrs/module/write/{flag}",method:"PUT"},compareUpload:{uri:"/jaxrs/module/compare/upload",method:"PUT",enctype:"formData"},outputStructure:{uri:"/jaxrs/module/output/structure"},removeStructure:{uri:"/jaxrs/module/remove/structure/{id}",method:"DELETE"},outputCreate:{uri:"/jaxrs/module/output",method:"PUT"},output:{uri:"/jaxrs/module/output",method:"PUT"},download:{uri:"/jaxrs/module/output/{flag}/file"},listStructure:{uri:"/jaxrs/module/output/list/structure"},getCollect:{uri:"/jaxrs/config/collect"},getPerson:{uri:"/jaxrs/config/person"},getToken:{uri:"/jaxrs/config/token"},getPortal:{uri:"/jaxrs/config/portal"},setCollect:{uri:"/jaxrs/config/collect",method:"PUT"},setPerson:{uri:"/jaxrs/config/person",method:"PUT"},setToken:{uri:"/jaxrs/config/token",method:"PUT"},setPortal:{uri:"/jaxrs/config/portal",method:"PUT"},getCenterServer:{uri:"/jaxrs/config/centerserver"},setCenterServer:{uri:"/jaxrs/config/centerserver",method:"PUT"},getProxy:{uri:"/jaxrs/config/proxy"},setProxy:{uri:"/jaxrs/config/proxy",method:"PUT"},mobile_defaultStyle:{uri:"/jaxrs/appstyle/default/style"},mobile_currentStyle:{uri:"/jaxrs/appstyle/current/style"},imageLaunchLogo:{uri:"/jaxrs/appstyle/image/launch/logo",method:"PUT",enctype:"formData"},imageLaunchLogoErase:{uri:"/jaxrs/appstyle/image/launch/logo/erase"},imageLoginAvatar:{uri:"/jaxrs/appstyle/image/login/avatar",method:"PUT",enctype:"formData"},imageLoginAvatarErase:{uri:"/jaxrs/appstyle/image/login/avatar/erase"},imageMenuLogoBlur:{uri:"/jaxrs/appstyle/image/menu/logo/blur",method:"PUT",enctype:"formData"},imageMenuLogoBlurErase:{uri:"/jaxrs/appstyle/image/menu/logo/blur/erase"},imageMenuLogoFocus:{uri:"/jaxrs/appstyle/image/menu/logo/focus",method:"PUT",enctype:"formData"},imageMenuLogoFocusErase:{uri:"/jaxrs/appstyle/image/menu/logo/focus/erase"},imagePeopleAvatarDefault:{uri:"/jaxrs/appstyle/image/people/avatar/default",method:"PUT",enctype:"formData"},imagePeopleAvatarDefaultErase:{uri:"/jaxrs/appstyle/image/people/avatar/default/erase"},imageProcessDefault:{uri:"/jaxrs/appstyle/image/process/default",method:"PUT",enctype:"formData"},imageProcessDefaultErase:{uri:"/jaxrs/appstyle/image/process/default/erase"},imageSetupAboutLogo:{uri:"/jaxrs/appstyle/image/setup/about/logo",method:"PUT",enctype:"formData"},imageSetupAboutLogoErase:{uri:"/jaxrs/appstyle/image/setup/about/logo/erase"},setAppStyle:{uri:"/jaxrs/appstyle",method:"PUT"},listAgent:{uri:"/jaxrs/agent"},createAgent:{uri:"/jaxrs/agent",method:"POST"},updateAgent:{uri:"/jaxrs/agent/{flag}",method:"PUT"},updateAgentByUploadFile:{uri:"/jaxrs/agent/{flag}/file",method:"PUT",enctype:"formData"},deleteAgent:{uri:"/jaxrs/agent/{flag}",method:"DELETE"},getAgent:{uri:"/jaxrs/agent/{flag}"},disableAgent:{uri:"/jaxrs/agent/{flag}/disable"},enableAgent:{uri:"/jaxrs/agent/{flag}/enable"},executeAgent:{uri:"/jaxrs/agent/{flag}/execute"},listInvoke:{uri:"/jaxrs/invoke"},createInvoke:{uri:"/jaxrs/invoke",method:"POST"},updateInvoke:{uri:"/jaxrs/invoke/{flag}",method:"PUT"},updateInvokeByUploadFile:{uri:"/jaxrs/invoke/{flag}/file",method:"PUT",enctype:"formData"},deleteInvoke:{uri:"/jaxrs/invoke/{flag}",method:"DELETE"},getInvoke:{uri:"/jaxrs/invoke/{flag}"},executeInvoke:{uri:"/jaxrs/invoke/{flag}/execute",method:"POST"},executeToken:{uri:"/jaxrs/invoke/{flag}/client/{client}/token/{token}/execute",method:"POST"},listPromptErrorLog:{uri:"/jaxrs/prompterrorlog/list/{id}/next/{count}"},listPromptErrorLogWithDate:{uri:"/jaxrs/prompterrorlog/list/{id}/next/{count}/date/{date}"},listUnexpectedErrorLog:{uri:"/jaxrs/unexpectederrorlog/list/{id}/next/{count}"},listUnexpectedErrorLogWithDate:{uri:"/jaxrs/unexpectederrorlog/list/{id}/next/{count}/date/{date}"},listWarnLog:{uri:"/jaxrs/warnlog/list/{id}/next/{count}"},listWarnLogWithDate:{uri:"/jaxrs/warnlog/list/{id}/next/{count}/date/{date}"},listSystemLog:{uri:"/jaxrs/warnlog/view/system/log/tag/{tag}"},echo:{uri:"/jaxrs/echo"}};o2.xAction.RestActions.Action.x_program_center||(o2.xAction.RestActions.Action.x_program_center=new Class({Extends:o2.xAction.RestActions.Action})),o2.Actions.actions.x_program_center=new o2.xAction.RestActions.Action.x_program_center("x_program_center",actionJson);actionJson={changePassword:{uri:"/jaxrs/person/password",method:"PUT"},getPerson:{uri:"/jaxrs/person"},updatePerson:{uri:"/jaxrs/person",method:"PUT"},changeIcon:{uri:"/jaxrs/person/icon",method:"PUT",enctype:"formData"},checkPassword:{uri:"/jaxrs/reset/check/password/{password}"},getPersonIcon:{uri:"/jaxrs/person/icon"},getIcon:{uri:"/jaxrs/icon/{person}"},getRegisterMode:{uri:"/jaxrs/regist/mode"},getRegisterCaptcha:{uri:"/jaxrs/regist/captcha/width/{width}/height/{height}"},createRegisterCode:{uri:"/jaxrs/regist/code/mobile/{mobile}"},checkRegisterName:{uri:"/jaxrs/regist/check/name/{name}"},checkRegisterPassword:{uri:"/jaxrs/regist/check/password/{password}"},checkRegisterMobile:{uri:"/jaxrs/regist/check/mobile/{mobile}"},register:{uri:"/jaxrs/regist",method:"POST"},resetPassword:{uri:"/jaxrs/reset",method:"PUT"},checkCredentialOnResetPassword:{uri:"/jaxrs/reset/check/credential/{credential}"},checkPasswordOnResetPassword:{uri:"/jaxrs/reset/check/password/{password}"},createCodeOnResetPassword:{uri:"/jaxrs/reset/code/credential/{credential}"},getUserData:{uri:"/jaxrs/custom/{name}"},putUserData:{uri:"/jaxrs/custom/{name}",method:"PUT"},deleteUserData:{uri:"/jaxrs/custom/{name}",method:"DELETE"},getPublicUserData:{uri:"/jaxrs/definition/{name}"},putPublicUserData:{uri:"/jaxrs/definition/{name}",method:"PUT"},deletePublicUserData:{uri:"/jaxrs/definition/{name}",method:"DELETE"},getMyEmPower:{uri:"/jaxrs/empower/list/currentperson",method:"GET"},getReceiveEmPower:{uri:"/jaxrs/empower/list/to",method:"GET"},createEmPower:{uri:"/jaxrs/empower",method:"POST"},editEmPower:{uri:"/jaxrs/empower/{id}",method:"PUT"},deleteEmPower:{uri:"/jaxrs/empower/{id}",method:"DELETE"},getMyEmPowerLog:{uri:"/jaxrs/empowerlog/list/currentperson",method:"GET"},getReceiveEmPowerLog:{uri:"/jaxrs/empowerlog/list/to",method:"GET"},listToCurrentPersonPaging:{uri:"/jaxrs/empowerlog/list/to/currentperson/paging/{page}/size/{size}",method:"POST"},listWithCurrentPersonPaging:{uri:"/jaxrs/empowerlog/list/currentperson/paging/{page}/size/{size}",method:"POST"},clazz:"x_organization_assemble_personal"};o2.xAction.RestActions.Action.x_organization_assemble_personal||(o2.xAction.RestActions.Action.x_organization_assemble_personal=new Class({Extends:o2.xAction.RestActions.Action})),o2.Actions.actions.x_organization_assemble_personal=new o2.xAction.RestActions.Action.x_organization_assemble_personal("x_organization_assemble_personal",actionJson),layout=window.layout||{},layout.desktop=layout,layout.desktop.type="app";var locate=window.location;layout.protocol=locate.protocol,layout.inBrowser=!0,layout.session=layout.session||{},layout.debugger=-1!==locate.href.toString().indexOf("debugger"),layout.anonymous=-1!==locate.href.toString().indexOf("anonymous"),o2.xApplication=o2.xApplication||{},o2.xDesktop=o2.xDesktop||{},o2.xDesktop.requireApp=function(t,e,i,s){o2.requireApp(t,e,i,s)},function(t){t.readys=[],t.addReady=function(){for(var e=0;e<arguments.length;e++)"function"===o2.typeOf(arguments[e])&&(t.isReady?arguments[e].apply(window):t.readys.push(arguments[e]))};var e=function(e){(function(t){return!(!window.o2android||!window.o2android.openO2Work)&&(t.workId?window.o2android.openO2Work(t.workId,"",t.title||t.docTitle||""):t.workCompletedId&&window.o2android.openO2Work("",t.workCompletedId,t.title||t.docTitle||""),!0)})(e)||function(t){return!!(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.openO2Work)&&(t.workId?window.webkit.messageHandlers.openO2Work.postMessage({work:t.workId,workCompleted:"",title:t.title||t.docTitle||""}):t.workCompletedId&&window.webkit.messageHandlers.openO2Work.postMessage({work:"",workCompleted:t.workCompletedId,title:t.title||t.docTitle||""}),!0)}(e)||function(e){var i=new URI(window.location.href).getData("redirectlink");i=i?encodeURIComponent(i):encodeURIComponent(locate.pathname+locate.search);var s="../x_desktop/workmobilewithaction.html".toURI();e.draft?s="../x_desktop/workmobilewithaction.html?"+("draft="+encodeURIComponent(JSON.stringify(e.draft))):s=s.setData(e).toString();var o=e.jobid||e.jobId||e.job;o&&(s+=(-1!=s.indexOf("?")?"&":"?")+"jobid="+o),s+=i?"&redirectlink="+i:"",s+=t.debugger?"&debugger":"",window.location=o2.filterUrl(s)}(e)},i=function(i,s,o){switch(i){case"process.Work":e(s);break;case"cms.Document":!function(e,i,s){var o="object"===typeOf(i)?i.docTitle||i.title:"";o=o||"";var n="app="+encodeURIComponent(e)+"&status="+encodeURIComponent(s?JSON.encode(s):"")+"&option="+encodeURIComponent(i?JSON.encode(i):"");window.o2android&&window.o2android.openO2CmsDocument?window.o2android.openO2CmsDocument(i.documentId,o):window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.openO2CmsDocument?window.webkit.messageHandlers.openO2CmsDocument.postMessage({docId:i.documentId,docTitle:o}):window.location=o2.filterUrl("../x_desktop/appMobile.html?"+n+(t.debugger?"&debugger":""))}(i,s,o);break;case"cms.Module":!function(e,i,s){var o="app="+encodeURIComponent(e)+"&status="+encodeURIComponent(s?JSON.encode(s):"")+"&option="+encodeURIComponent(i?JSON.encode(i):"");window.o2android&&window.o2android.openO2CmsApplication?window.o2android.openO2CmsApplication(i.columnId,i.title||""):window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.openO2CmsApplication?window.webkit.messageHandlers.openO2CmsApplication.postMessage(i.columnId):window.location=o2.filterUrl("../x_desktop/appMobile.html?"+o+(t.debugger?"&debugger":""))}(i,s,o);break;case"Meeting":!function(e,i,s){var o="app="+encodeURIComponent(e)+"&status="+encodeURIComponent(s?JSON.encode(s):"")+"&option="+encodeURIComponent(i?JSON.encode(i):"");window.o2android&&window.o2android.openO2Meeting?window.o2android.openO2Meeting(""):window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.openO2Meeting?window.webkit.messageHandlers.openO2Meeting.postMessage(""):window.location=o2.filterUrl("../x_desktop/appMobile.html?"+o+(t.debugger?"&debugger":""))}(i,s,o);break;case"Calendar":!function(e,i,s){var o="app="+encodeURIComponent(e)+"&status="+encodeURIComponent(s?JSON.encode(s):"")+"&option="+encodeURIComponent(i?JSON.encode(i):"");window.o2android&&window.o2android.openO2Calendar?window.o2android.openO2Calendar(""):window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.openO2Calendar?window.webkit.messageHandlers.openO2Calendar.postMessage(""):window.location=o2.filterUrl("../x_desktop/appMobile.html?"+o+(t.debugger?"&debugger":""))}(i,s,o);break;case"process.TaskCenter":!function(e,i,s){var o="app="+encodeURIComponent(e)+"&status="+encodeURIComponent(s?JSON.encode(s):"")+"&option="+encodeURIComponent(i?JSON.encode(i):""),n=(i&&i.navi?i.navi:"task").toLowerCase();"done"===n&&(n="taskCompleted"),"readed"===n&&(n="readCompleted"),window.o2android&&window.o2android.openO2WorkSpace?window.o2android.openO2WorkSpace(n):window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.openO2WorkSpace?window.webkit.messageHandlers.openO2WorkSpace.postMessage(n):window.location=o2.filterUrl("../x_desktop/appMobile.html?"+o+(t.debugger?"&debugger":""))}(i,s,o);break;default:var n=new URI(window.location.href),a=n.getData("option"),r=n.getData("status");window.location=o2.filterUrl("../x_desktop/appMobile.html?app="+i+"&option="+(a||"")+"&status="+(r||"")+(t.debugger?"&debugger":""))}};t.openApplication=function(e,s,o,n,a,r,l){if("@url"===s.substring(0,4)){var c=s.replace(/\@url\:/i,""),d=new Element("a",{href:c,target:"_blank"});return d.click(),d.destroy(),d=null,!0}if(t.app){if(!t.mobile)return function(e,i,s){i&&delete i.docTitle;var o="app="+encodeURIComponent(e)+"&status="+encodeURIComponent(s?JSON.encode(s):"")+"&option="+encodeURIComponent(i?JSON.encode(i):"");switch(e){case"process.Work":var n="../x_desktop/work.html".toURI();n=i.draft?"../x_desktop/app.html?"+o:n.setData(i).toString();var a=i.jobid||i.jobId||i.job;return a&&(n+=(-1!=n.indexOf("?")?"&":"?")+"jobid="+a),n+=t.debugger?"&debugger":"",t.app.$openWithSelf?window.location=o2.filterUrl(n):window.open(o2.filterUrl(n),o);case"cms.Document":return n=(n="../x_desktop/cmsdoc.html".toURI()).setData(i).toString(),n+=t.debugger?"&debugger":"",t.app.$openWithSelf?window.location=o2.filterUrl(n):window.open(o2.filterUrl(n),o);default:return t.app.$openWithSelf?window.location=o2.filterUrl("../x_desktop/app.html?"+o+(t.debugger?"&debugger":"")):window.open(o2.filterUrl("../x_desktop/app.html?"+o+(t.debugger?"&debugger":"")),o)}}(s,o,n);i(s,o,n)}else{var h=s.split("."),u=h[h.length-1];!function(t,e,i){var s=t.split("."),o=o2.xApplication;s.each(function(t,e){e<s.length-1?o[t]=o[t]||{}:o[t]=o[t]||{options:Object.clone(o2.xApplication.Common.options)},o=o[t]}.bind(this)),o.options||(o.options=Object.clone(o2.xApplication.Common.options));o2.xDesktop.requireApp(t,"lp."+o2.language,{onFailure:function(){o2.xDesktop.requireApp(t,"lp.zh-cn",null,!1)}.bind(this)},!1),o2.xDesktop.requireApp(t,i,(function(){e&&e(o)}))}(s,function(i){var s=o&&o.appId?o.appId:i.options.multitask?"":u;s&&t.desktop.apps&&t.desktop.apps[s]?t.desktop.apps[s].setCurrent():(o&&(o.appId=s),function(e,i,s,o,n,a,r,l){o?o.event=e:o={event:e};var c=new i.Main(t.desktop,o);if(c.desktop=t.desktop,c.status=n,c.inBrowser=!(!a&&!t.inBrowser),"layout"===t.desktop.type){if(c.appId=o.appId?o.appId:i.options.multitask?s+"-"+new o2.widget.UUID:s,c.options.appId=c.appId,t.desktop.createTaskItem&&(r||(r=t.desktop.createTaskItem(c)),c.taskitem=r,c.taskitem.app=c),c.isLoadApplication=!0,c.load(!l),t.desktop.apps||(t.desktop.apps={}),t.desktop.apps[c.appId])t.desktop.apps[c.appId];else t.desktop.apps[c.appId]=c;t.desktop.appArr.push(c),t.desktop.appCurrentList.push(c),l||(t.desktop.currentApp=c)}else c.load(!0),t.app=c;var d=document.getElementById("appContentMask");d&&d.destroy()}(e,i,u,o||{appId:s},n,a,r,l))}.bind(this))}},t.refreshApp=function(e){var i=e.recordStatus(),s=new URI(window.location.href),o=s.getData("app"),n=s.getData("option"),a=s.getData("status");i&&(a=JSON.encode(i));var r=s.get("port"),l=s.get("scheme")+"://"+s.get("host")+(r&&"80"!=r?":"+r+"/":"")+s.get("directory")+s.get("file")+"?app="+encodeURIComponent(o)+"&status="+encodeURIComponent(a)+"&option="+encodeURIComponent(n?JSON.encode(n):"")+(t.debugger?"&debugger":"");l=o2.filterUrl(l),window.location=l},t.load=function(e,i,s){t.apps=[],t.node=$("layout")||$("appContent")||document.body;var o=e,n=s,a=i,r=window.opener;if(r)try{o||(o=r.layout.desktop.openBrowserApp),n||(n=r.layout.desktop.openBrowserStatus),a||(a=r.layout.desktop.openBrowserOption)}catch(t){}t.openApplication(null,o,a||{},n)},t.getFormDesignerStyle=function(t){this.formDesignerStyle?t&&t():(this.formDesignerStyle="default",MWF.UD.getData("formDesignerStyle",function(e){if(e.data){var i=JSON.decode(e.data);this.formDesignerStyle=i.style}t&&t()}.bind(this)))}}(layout),o2.addReady((function(){window.Element&&Element.implement({makeLnk:function(t){}}),layout.desktop.addEvent=function(t,e,i){window.addEvent(t,e,i)},layout.desktop.addEvents=function(t){window.addEvents(t)};var t=window.$?$("loaddingArea"):null,e=0,i=window.document&&document.body?document.body.getSize():null,s=function(){t&&(t.destroy(),t=null)},o=function(o){if(t)if(o)t.setStyles({width:i.x+"px"}),window.setTimeout(s,500);else{var n=++e/4*i.x;t.setStyles({width:n+"px"}),e>=4&&window.setTimeout(s,500)}},n=function(t,e){layout.serviceAddressList=t,layout.centerServer=e,layout.desktop.serviceAddressList=t,layout.desktop.centerServer=e},a=function(t){if("auto"===layout.config.app_protocol&&(layout.config.app_protocol=window.location.protocol),layout.config.configMapping&&(layout.config.configMapping[window.location.host]||layout.config.configMapping[window.location.hostname])){var e=layout.config.configMapping[window.location.host]||layout.config.configMapping[window.location.hostname];e.servers?(layout.serviceAddressList=e.servers,layout.desktop.serviceAddressList=e.servers,e.center&&(center="array"===o2.typeOf(e.center)?e.center[0]:e.center),layout.centerServer=center,layout.desktop.centerServer=center,t&&t()):(e.center&&(layout.config.center="array"===o2.typeOf(e.center)?e.center:[e.center]),o2.xDesktop.getServiceAddress(layout.config,function(e,i){n(e,i),o(),t&&t()}.bind(this)))}else o2.xDesktop.getServiceAddress(layout.config,function(e,i){n(e,i),o(),t&&t()}.bind(this))},r=function(){var t=new URI(window.location.href).get("data");if(t[o2.tokenName]){Cookie.dispose(o2.tokenName);var e=window.location.host,i=null;/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/.test(e)?i=e:e.indexOf(".")>0&&(i=e.substring(e.indexOf("."))),i?Cookie.write(o2.tokenName,t[o2.tokenName],{domain:i,path:"/"}):Cookie.write(o2.tokenName,t[o2.tokenName])}layout.sessionPromise=new Promise((function(t,e){o2.Actions.get("x_organization_assemble_authentication").getAuthentication(function(e){if(e.data.language&&e.data.language!==o2.languageName){o2.language=e.data.language.toLowerCase(),o2.languageName=e.data.language;var i="../x_desktop/js/base_lp_"+o2.language+(o2.session.isDebugger?"":".min")+".js";o2.load(i,{reload:!0},(function(){t&&t(e.data)}))}else t&&t(e.data)}.bind(this),function(t,i,s){e&&e({xhr:t,text:i,error:s})}.bind(this))})),layout.sessionPromise.then((function(t){layout.user=t,layout.session=layout.session||{},layout.session.user=t,layout.session.token=t.token,layout.desktop.session=layout.session}),(function(){if(layout.anonymous){var t={name:"anonymous",roleList:[]};layout.user=t,layout.session=layout.session||{},layout.session.user=t,layout.session.token=t.token,layout.desktop.session=layout.session}else o(!0),layout.yqwx?layout.openLoginQywx():layout.openLogin()})),function(t){for(t&&(layout.user=t.data,layout.session=layout.session||{},layout.session.user=t.data,layout.session.token=t.data.token,layout.desktop.session=layout.session),o(!0),layout.isReady=!0;layout.readys&&layout.readys.length;)layout.readys.shift().apply(window)}(),layout.openLogin=function(){layout.desktop.type="app",layout.app=null;var t=$("appContent")||$("layout");t&&t.empty(),layout.authentication=new o2.xDesktop.Authentication({style:"flat",onLogin:r.bind(layout)}),layout.authentication.loadLogin(document.body);var e=$("browser_loading");e&&e.fade("out")},layout.openLoginQywx=function(){console.log("开始login。。。。。。。。。。。。。");var t=locate.href.toURI();console.log("执行单点。。。。。。。。。。");var e=new MWF.xDesktop.Actions.RestActions("","x_organization_assemble_authentication","");e.getActions=function(t){this.actions={sso:{uri:"/jaxrs/qiyeweixin/code/{code}",method:"GET"}},t&&t()},e.invoke({name:"sso",async:!0,parameter:{code:t.getData("code")},success:function(t){console.log("单点成功。"),console.log(t),layout.session.user=t.data,r()}.bind(this),failure:function(t,e,i){var s=document.getElementById("loaddingArea");s&&s.destroy(),document.id("layout").set("html","<div>企业微信单点异常！</div>")}.bind(this)})}};layout.config=null;var l=!1,c=!1,d=!1,h="../x_desktop/js/base_lp_"+o2.language+(o2.session.isDebugger?"":".min")+".js";o2.session.isDebugger&&(o2.session.isMobile||layout.mobile)&&o2.load("../o2_lib/eruda/eruda.js");var u=function(){o(),c=!0;o2.require(["o2.xDesktop.$all"],{onSuccess:function(){d=!0,l&&d&&c&&a((function(){r()}))},onEvery:function(){o()}})};o2.LP?u():o2.load(h,u),o2.getJSON("../x_desktop/res/config/config.json",(function(t){o(),layout.config=t,o2.tokenName=t.tokenName||"x-token",(l=!0)&&d&&c&&a((function(){r()}))}))}));
//# sourceMappingURL=base_work.min.js.map