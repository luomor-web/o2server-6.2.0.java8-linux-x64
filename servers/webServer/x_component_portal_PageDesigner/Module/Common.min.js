MWF.xApplication.portal.PageDesigner.Module.Common=MWF.PCCommon=new Class({Extends:MWF.FCDiv,Implements:[Options,Events],options:{style:"default",propertyPath:"../x_component_portal_PageDesigner/Module/Common/common.html"},initialize:function(e,t){this.setOptions(t),this.path="../x_component_portal_PageDesigner/Module/Common/",this.cssPath="../x_component_portal_PageDesigner/Module/Common/"+this.options.style+"/css.wcss",this._loadCss(),this.moduleType="container",this.moduleName="common",this.Node=null,this.form=e},_setNodeProperty:function(){this.node.store("module",this),-1==this.form.moduleList.indexOf(this)&&this.form.moduleList.push(this),-1==this.form.moduleNodeList.indexOf(this.node)&&this.form.moduleNodeList.push(this.node),-1==this.form.moduleContainerNodeList.indexOf(this.node)&&this.form.moduleContainerNodeList.push(this.node),this.node.store("module",this),this._setEditStyle_custom("innerHTML")},_setEditStyle_custom:function(e,t,s){if("tagName"===e){var o=this.json.tagName.toString().toLowerCase();if(o!==this.node.tagName.toString().toLowerCase()){for(var i=new Element(o).inject(this.node,"before"),n=this.node.childNodes,r=0;r<n.length;r++)i.appendChild(n[r]);this.node.destroy(),this.node=i,this.node.set("mwftype","common"),this.node.set("id",this.json.id),this.isSetEvents=!1,this._initModule();var a=this.json.name||this.json.id,l=l=this.json.tagName+"(Common)";this.treeNode.setText("<"+l+"> "+a)}}if("innerHTML"===e)try{if(this.json.innerHTML){for(n=this.node.childNodes,r=0;r<n.length;r++)n[r].nodeType===Node.ELEMENT_NODE?n[r].get("MWFtype")||(n[r].destroy(),r--):(n[r].removeNode?n[r].removeNode():n[r].parentNode.removeChild(n[r]),r--);this.node.appendHTML(this.json.innerHTML)}}catch(e){}},setPropertiesOrStyles:function(e,t){if("styles"==e)try{this.setCustomStyles()}catch(e){}if("properties"===e)try{t&&Object.each(t,function(e,t){this.node.removeProperty(t)}.bind(this)),Object.each(this.json.properties,function(e,t){"href"===t.toString().toLowerCase()?this.node.setProperty(t,"#"):"target"===t.toString().toLowerCase()?this.node.removeProperty("target"):this.node.setProperty(t,e)}.bind(this))}catch(e){}},setCustomStyles:function(){var e=this.node.getStyle("border");this.node.clearStyles();var t=this.node.getStyles("display","padding");this.node.setStyles(this.css.moduleNode);var s=Object.clone(this.json.styles);"inline"===t.display.toString().toLowerCase()&&(s.display||(s.display="inline-block"),s.padding||s["padding-left"]||s["padding-right"]||(s.padding="0px 2px")),"button"===this.json.tagName&&(s["min-height"]||(s["min-height"]="20px")),this.initialStyles&&this.node.setStyles(this.initialStyles),this.node.setStyle("border",e),s&&Object.each(s,function(e,t){if(-1!=e.indexOf("x_processplatform_assemble_surface")||-1!=e.indexOf("x_portal_assemble_surface")){var s=MWF.Actions.getHost("x_processplatform_assemble_surface"),o=MWF.Actions.getHost("x_portal_assemble_surface");-1!==e.indexOf("/x_processplatform_assemble_surface")?e=e.replace("/x_processplatform_assemble_surface",s+"/x_processplatform_assemble_surface"):-1!==e.indexOf("x_processplatform_assemble_surface")&&(e=e.replace("x_processplatform_assemble_surface",s+"/x_processplatform_assemble_surface")),-1!==e.indexOf("/x_portal_assemble_surface")?e=e.replace("/x_portal_assemble_surface",o+"/x_portal_assemble_surface"):-1!==e.indexOf("x_portal_assemble_surface")&&(e=e.replace("x_portal_assemble_surface",o+"/x_portal_assemble_surface")),e=o2.filterUrl(e)}t.test(/^border\w*/gi)||t&&("display"===t.toString().toLowerCase()?"none"===e.toString().toLowerCase()?this.node.setStyle("opacity",.3):(this.node.setStyle("opacity",1),this.node.setStyle(t,e)):this.node.setStyle(t,e))}.bind(this))}});