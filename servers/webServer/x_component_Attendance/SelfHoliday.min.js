MWF.xDesktop.requireApp("Attendance","Explorer",null,!1),MWF.xDesktop.requireApp("Selector","package",null,!1),MWF.xDesktop.requireApp("Template","Explorer",null,!1),MWF.xApplication.Attendance.SelfHoliday=new Class({Extends:MWF.xApplication.Attendance.Explorer,Implements:[Options,Events],initialize:function(e,t,i,l){this.setOptions(l),this.app=t,this.path="/x_component_Attendance/$SelfHoliday/",this.cssPath="/x_component_Attendance/$SelfHoliday/"+this.options.style+"/css.wcss",this._loadCss(),this.actions=i,this.node=$(e),this.initData(),this.personActions||(this.personActions=new MWF.xAction.org.express.RestActions)},load:function(){this.loadToolbar(),this.loadFilter(),this.loadContentNode(),this.loadView(),this.setNodeScroll()},loadFilter:function(){this.fileterNode=new Element("div.fileterNode",{styles:this.css.fileterNode}).inject(this.node),this._loadFilterContent()},exportExcel:function(){new MWF.xApplication.Attendance.SelfHoliday.ExportExcelForm(this).edit()},_loadFilterContent:function(){var e=MWF.xApplication.Attendance.LP,t=this;this.fileterNode.set("html","<table bordr='0' cellpadding='5' cellspacing='0' styles='formTable'><tr>    <td styles='formTableTitle' lable='q_topUnitName'></td>    <td styles='formTableValue' item='q_topUnitName'></td>    <td styles='formTableTitle' lable='q_unitName'></td>    <td styles='formTableValue' item='q_unitName'></td>    <td styles='formTableTitle' lable='q_empName'></td>    <td styles='formTableValue' item='q_empName'></td>    <td styles='formTableTitle' lable='startdateString'></td>    <td styles='formTableValue' item='startdateString'></td>    <td styles='formTableTitle' lable='enddateString'></td>    <td styles='formTableValue' item='enddateString'></td>    <td styles='formTableValue' item='action'></td></tr></table>"),MWF.xDesktop.requireApp("Template","MForm",function(){this.filter=new MForm(this.fileterNode,{},{style:"filter",isEdited:!0,itemTemplate:{q_topUnitName:{text:e.selectCompany,type:"org",orgType:"unit",style:{"min-width":"200px"},event:{change:function(e,t){}}},q_unitName:{text:e.selectDepartment,type:"org",orgType:"unit",style:{"min-width":"250px"}},q_empName:{text:e.selectPerson,type:"org",orgType:"person",style:{"min-width":"100px"}},startdateString:{text:e.startTime,tType:"date",style:{border:"1px solid rgb(153, 153, 153)",background:'url("../x_component_Template/$MForm/default/icon/calendar.png") 98% center no-repeat',"border-radius":"3px","box-shadow":"rgb(204, 204, 204) 0px 0px 6px",height:"26px",width:"100px"}},enddateString:{text:e.endTime,tType:"date",style:{border:"1px solid rgb(153, 153, 153)",background:'url("../x_component_Template/$MForm/default/icon/calendar.png") 98% center no-repeat',"border-radius":"3px","box-shadow":"rgb(204, 204, 204) 0px 0px 6px",height:"26px",width:"100px"}},action:{type:"button",value:e.query,event:{click:function(){var e=t.filter.getResult(!0,",",!0,!0,!0);this.loadView(e)}.bind(this)}}}},this.app,this.css),this.filter.load()}.bind(this),!0)},loadView:function(e){this.elementContentNode.empty(),this.view=new MWF.xApplication.Attendance.SelfHoliday.View(this.elementContentNode,this.app,this,this.viewData,this.options.searchKey),this.view.filterData=e,this.view.load(),this.setContentSize()},createDocument:function(){this.view&&this.view._createDocument()}}),MWF.xApplication.Attendance.SelfHoliday.View=new Class({Extends:MWF.xApplication.Attendance.Explorer.View,_createItem:function(e){return new MWF.xApplication.Attendance.SelfHoliday.Document(this.table,e,this.explorer,this)},_getCurrentPageData:function(e,t){t||(t=20);var i=this.items.length?this.items[this.items.length-1].data.id:"(0)",l=this.filterData||{};this.actions.listSelfHolidayFilterNext(i,t,l,(function(t){e&&e(t)}))},_removeDocument:function(e,t){this.actions.deleteSelfHoliday(e.id,function(e){this.explorer.view.reload(),this.app.notice(this.app.lp.deleteDocumentOK,"success")}.bind(this))},_createDocument:function(){new MWF.xApplication.Attendance.SelfHoliday.Form(this.explorer).create()},_openDocument:function(e){new MWF.xApplication.Attendance.SelfHoliday.Form(this.explorer,e).open()}}),MWF.xApplication.Attendance.SelfHoliday.Document=new Class({Extends:MWF.xApplication.Attendance.Explorer.Document}),MWF.xApplication.Attendance.SelfHoliday.ExportExcelForm=new Class({Extends:MWF.xApplication.Attendance.Explorer.PopupForm,_createTableContent:function(){var e=MWF.xApplication.Attendance.LP,t="<table width='100%' bordr='0' cellpadding='5' cellspacing='0' styles='formTable'><tr><td colspan='2' styles='formTableHead'>"+e.exportEmployeeHolidayRecord+"</td></tr><tr>    <td styles='formTableTitle' lable='startDate'></td>    <td styles='formTableValue' item='startDate'></td></tr><tr>    <td styles='formTableTitle' lable='endDate'></td>    <td styles='formTableValue' item='endDate'></td></tr></table>";this.formTableArea.set("html",t),MWF.xDesktop.requireApp("Template","MForm",function(){this.form=new MForm(this.formTableArea,{q_empName:layout.desktop.session.user.distinguishedName},{isEdited:!0,itemTemplate:{startDate:{text:e.startTime,tType:"date"},endDate:{text:e.endTime,tType:"date"}}},this.app),this.form.load()}.bind(this),!0)},_ok:function(e,t){this.app.restActions.exportSelfHoliday(e.startDate,e.endDate,function(e){t&&t(e)}.bind(this)),this.close()}}),MWF.xApplication.Attendance.SelfHoliday.Form=new Class({Extends:MWF.xApplication.Attendance.Explorer.PopupForm,options:{width:600,height:450,hasTop:!0,hasBottom:!0,title:"",draggable:!0,closeAction:!0},_createTableContent:function(){var e=MWF.xApplication.Attendance.LP,t="<table width='100%' bordr='0' cellpadding='5' cellspacing='0' styles='formTable'><tr><td colspan='2' styles='formTableHead'>"+e.employeeHolidayRecord+"</td></tr><tr><td styles='formTabelTitle' lable='unitName'></td>    <td styles='formTableValue' item='unitName'></td></tr><tr><td styles='formTabelTitle' lable='employeeName'></td>    <td styles='formTableValue' item='employeeName'></td></tr><tr><td styles='formTabelTitle' lable='leaveType'></td>    <td styles='formTableValue' item='leaveType'></td></tr><tr><td styles='formTabelTitle' lable='startTime'></td>    <td styles='formTableValue' item='startTime'></td></tr><tr><td styles='formTabelTitle' lable='endTime'></td>    <td styles='formTableValue' item='endTime'></td></tr><tr><td styles='formTabelTitle' lable='leaveDayNumber'></td>    <td styles='formTableValue' item='leaveDayNumber'></td></tr></table>";this.formTableArea.set("html",t),MWF.xDesktop.requireApp("Template","MForm",function(){this.form=new MForm(this.formTableArea,this.data,{isEdited:this.isEdited||this.isNew,itemTemplate:{unitName:{text:e.unit,type:"org",orgType:"unit",notEmpty:!0},employeeName:{text:e.employeeName,type:"org",orgType:"person",notEmpty:!0},leaveType:{text:e.leaveType1,type:"select",notEmpty:!0,selectValue:e.leaveTypeSelectText1},startTime:{text:e.startTime,tType:"datetime",notEmpty:!0},endTime:{text:e.endTime,tType:"datetime",notEmpty:!0},leaveDayNumber:{text:e.leaveDayCount,tType:"number",notEmpty:!0}}},this.app),this.form.load()}.bind(this),!0)},_ok:function(e,t){this.app.restActions.saveSelfHoliday(e,function(e){t&&t(e)}.bind(this))}});