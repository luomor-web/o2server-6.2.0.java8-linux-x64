MWF.xDesktop.requireApp("Attendance","Explorer",null,!1),MWF.xDesktop.requireApp("Selector","package",null,!1),MWF.xApplication.Attendance.PeopleDingdingDetail=new Class({Extends:MWF.widget.Common,Implements:[Options,Events],options:{style:"default"},initialize:function(t,e,i,n){this.setOptions(n),this.app=e,this.path="../x_component_Attendance/$PeopleDetail/",this.cssPath="../x_component_Attendance/$PeopleDetail/"+this.options.style+"/css.wcss",this._loadCss(),this.actions=i,this.node=$(t)},load:function(){this.loadTab()},loadTab:function(){this.tabNode=new Element("div",{styles:this.css.tabNode}).inject(this.node),this.detailArea=new Element("div",{styles:this.css.tabPageContainer}).inject(this.tabNode),this.detailStaticArea=new Element("div",{styles:this.css.tabPageContainer}).inject(this.tabNode),MWF.require("MWF.widget.Tab",function(){this.tabs=new MWF.widget.Tab(this.tabNode,{style:"attendance"}),this.tabs.load(),this.detailPage=this.tabs.addTab(this.detailArea,this.app.lp.personSigninDetail,!1),this.detailPage.contentNodeArea.set("class","detailPage"),this.detailPage.addEvent("show",function(){this.detailExplorer||(this.detailExplorer=new MWF.xApplication.Attendance.PeopleDingdingDetail.Explorer(this.detailArea,this),this.detailExplorer.load())}.bind(this)),this.detailStaticPage=this.tabs.addTab(this.detailStaticArea,this.app.lp.personSigninStatic,!1),this.detailStaticPage.contentNodeArea.set("class","detailStaticPage"),this.detailStaticPage.addEvent("show",function(){this.detailStaticExplorer||(this.detailStaticExplorer=new MWF.xApplication.Attendance.PeopleDingdingDetail.DetailStaticExplorer(this.detailStaticArea,this),this.detailStaticExplorer.load())}.bind(this)),this.tabs.pages[0].showTab()}.bind(this))}}),MWF.xApplication.Attendance.PeopleDingdingDetail.Explorer=new Class({Extends:MWF.xApplication.Attendance.Explorer,Implements:[Options,Events],initialize:function(t,e,i){this.setOptions(i),this.parent=e,this.app=e.app,this.css=e.css,this.path=e.path,this.actions=e.actions,this.node=$(t),this.initData(),this.peopleActions||(this.peopleActions=new MWF.xAction.org.express.RestActions)},initData:function(){this.toolItemNodes=[]},reload:function(){this.node.empty(),this.load()},load:function(){this.loadFilter(),this.loadContentNode(),this.setNodeScroll()},loadFilter:function(){var t=MWF.xApplication.Attendance.LP;this.fileterNode=new Element("div.fileterNode",{styles:this.css.fileterNode}).inject(this.node);this.fileterNode.set("html","<table width='100%' bordr='0' cellpadding='5' cellspacing='0' styles='filterTable'><tr>    <td styles='filterTableValue' lable='person'></td>    <td styles='filterTableTitle' item='person'></td>    <td styles='filterTableTitle' lable='year'></td>    <td styles='filterTableValue' item='year'></td>    <td styles='filterTableTitle' lable='month'></td>    <td styles='filterTableValue' item='month'></td>    <td styles='filterTableTitle' lable='day'></td>    <td styles='filterTableValue' item='day'></td>    <td styles='filterTableTitle' lable='checkType'></td>    <td styles='filterTableValue' item='checkType'></td>    <td styles='filterTableTitle' lable='timeResult'></td>    <td styles='filterTableValue' item='timeResult'></td>    <td styles='filterTableValue' item='action'></td></tr></table>"),MWF.xDesktop.requireApp("Template","MForm",function(){this.form=new MForm(this.fileterNode,{},{isEdited:!0,itemTemplate:{person:{text:t.person,type:"org",orgType:"person",notEmpty:!0,style:{"min-width":"100px"}},year:{text:t.annuaal,type:"select",selectValue:function(){for(var t=[],e=(new Date).getFullYear(),i=0;i<6;i++)t.push(e--);return t},event:{change:function(t,e){var i=this.getDateSelectValue();t.form.getItem("day").resetItemOptions(i,i)}.bind(this)}},month:{text:t.months,type:"select",defaultValue:function(){var t=((new Date).getMonth()+1).toString();return 1==t.length?"0"+t:t},selectValue:["","01","02","03","04","05","06","07","08","09","10","11","12"],event:{change:function(t,e){var i=this.getDateSelectValue();t.form.getItem("day").resetItemOptions(i,i)}.bind(this)}},day:{text:t.date,type:"select",selectValue:this.getDateSelectValue.bind(this)},checkType:{text:t.signinType,type:"select",selectValue:["","OnDuty","OffDuty"],selectText:t.signinTypeSelectText},timeResult:{text:t.signinResult,type:"select",selectValue:["","Normal","Early","Late","SeriousLate","Absenteeism","NotSigned"],selectText:t.signinResultSelectText},action:{value:t.query,type:"button",className:"filterButton",event:{click:function(){var t=this.form.getResult(!0,",",!0,!0,!1);t&&(t.day&&""!=t.day&&(t.q_date=t.year+"-"+t.month+"-"+t.day),this.loadView(t))}.bind(this)}}}},this.app,this.css),this.form.load()}.bind(this),!0)},getDateSelectValue:function(){if(this.form)var t=parseInt(this.form.getItem("year").getValue()),e=parseInt(this.form.getItem("month").getValue())-1;else t=(new Date).getFullYear(),e=(new Date).getMonth();var i=new Date(t,e,1),n=[];for(n.push("");i.getMonth()===e;){var l=i.getDate().toString();1==l.length&&(l="0"+l),n.push(l),i.setDate(i.getDate()+1)}return n},loadContentNode:function(){this.elementContentNode=new Element("div",{styles:this.css.elementContentNode}).inject(this.node),this.app.addEvent("resize",function(){this.setContentSize()}.bind(this))},loadView:function(t){this.elementContentNode.empty(),this.view&&delete this.view,this.view=new MWF.xApplication.Attendance.PeopleDingdingDetail.View(this.elementContentNode,this.app,this),this.view.filterData=t,this.view.listItemUrl=this.path+"listItem_dingding.json",this.view.load(),this.setContentSize()},setContentSize:function(){var t=this.parent.tabs?this.parent.tabs.tabNodeContainer.getSize():{x:0,y:0},e=this.fileterNode?this.fileterNode.getSize():{x:0,y:0},i=this.parent.node.getSize(),n=this.elementContentNode.getStyle("padding-top").toFloat(),l=this.elementContentNode.getStyle("padding-bottom").toFloat(),a=i.y-t.y-n-l-e.y-20;this.elementContentNode.setStyle("height",a+"px"),this.pageCount=(a/40).toInt()+5,this.view&&this.view.items.length<this.pageCount&&this.view.loadElementList(this.pageCount-this.view.items.length)}}),MWF.xApplication.Attendance.PeopleDingdingDetail.SelfHoliday=new Class({Extends:MWF.xApplication.Attendance.PeopleDingdingDetail.Explorer,loadView:function(t){this.elementContentNode.empty(),this.view&&delete this.view,this.view=new MWF.xApplication.Attendance.PeopleDingdingDetail.SelfHolidayView(this.elementContentNode,this.app,this),this.view.filterData=t,this.view.load(),this.setContentSize()}}),MWF.xApplication.Attendance.PeopleDingdingDetail.DetailStaticExplorer=new Class({Extends:MWF.xApplication.Attendance.PeopleDingdingDetail.Explorer,loadFilter:function(){var t=MWF.xApplication.Attendance.LP;this.fileterNode=new Element("div.fileterNode",{styles:this.css.fileterNode}).inject(this.node);this.fileterNode.set("html","<table width='100%' bordr='0' cellpadding='5' cellspacing='0' style='width: 460px;font-size: 14px;color:#666'><tr>    <td styles='filterTableValue' lable='q_empName'></td>    <td styles='filterTableTitle' item='q_empName'></td>    <td styles='filterTableTitle' lable='cycleYear'></td>    <td styles='filterTableValue' item='cycleYear'></td>    <td styles='filterTableTitle' lable='cycleMonth'></td>    <td styles='filterTableValue' item='cycleMonth'></td>    <td styles='filterTableValue' item='action'></td></tr></table>"),MWF.xDesktop.requireApp("Template","MForm",function(){this.form=new MForm(this.fileterNode,{},{isEdited:!0,itemTemplate:{q_empName:{text:t.person,type:"org",orgType:"person",notEmpty:!0,style:{"min-width":"100px"}},cycleYear:{text:t.annuaal,type:"select",selectValue:function(){for(var t=[],e=(new Date).getFullYear(),i=0;i<6;i++)t.push(e--);return t}},cycleMonth:{text:t.months,type:"select",defaultValue:function(){var t=((new Date).getMonth()+1).toString();return 1==t.length?"0"+t:t},selectValue:["","01","02","03","04","05","06","07","08","09","10","11","12"]},action:{value:t.query,type:"button",className:"filterButton",event:{click:function(){var t=this.form.getResult(!0,",",!0,!0,!1);t&&this.loadView(t)}.bind(this)}}}},this.app,this.css),this.form.load()}.bind(this),!0)},loadView:function(t){this.elementContentNode.empty(),this.view&&delete this.view,this.view=new MWF.xApplication.Attendance.PeopleDingdingDetail.DetailStaticView(this.elementContentNode,this.app,this),this.view.filterData=t,this.view.listItemUrl=this.path+"listItem_dingding_detailStatic.json",this.view.load(),this.setContentSize()}}),MWF.xApplication.Attendance.PeopleDingdingDetail.SelfHolidayStaticExplorer=new Class({Extends:MWF.xApplication.Attendance.PeopleDingdingDetail.Explorer,loadView:function(t){this.elementContentNode.empty(),this.view&&delete this.view,this.view=new MWF.xApplication.Attendance.PeopleDingdingDetail.SelfHolidayStaticView(this.elementContentNode,this.app,this),this.view.filterData=t,this.view.load(),this.setContentSize()}}),MWF.xApplication.Attendance.PeopleDingdingDetail.View=new Class({Extends:MWF.xApplication.Attendance.Explorer.View,_createItem:function(t){return new MWF.xApplication.Attendance.PeopleDingdingDetail.Document(this.table,t,this.explorer,this)},_getCurrentPageData:function(t,e){e||(e=20);var i=this.items.length?this.items[this.items.length-1].data.id:"(0)",n=this.filterData||{};o2.Actions.load("x_attendance_assemble_control").DingdingAttendanceAction.listNextDingdingAttendance(i,e,n,function(e){t&&t(e)}.bind(this))},_removeDocument:function(t,e){},_createDocument:function(){},_openDocument:function(t){}}),MWF.xApplication.Attendance.PeopleDingdingDetail.SelfHolidayView=new Class({Extends:MWF.xApplication.Attendance.Explorer.View,_createItem:function(t){return new MWF.xApplication.Attendance.PeopleDingdingDetail.SelfHolidayDocument(this.table,t,this.explorer,this)},_getCurrentPageData:function(t,e){var i=this.filterData||{};this.actions.listDetailFilter(i,function(e){t&&t(e)}.bind(this))},_removeDocument:function(t,e){},_createDocument:function(){},_openDocument:function(t){}}),MWF.xApplication.Attendance.PeopleDingdingDetail.DetailStaticView=new Class({Extends:MWF.xApplication.Attendance.Explorer.View,_createItem:function(t){return new MWF.xApplication.Attendance.PeopleDingdingDetail.DetailStaticDocument(this.table,t,this.explorer,this)},_getCurrentPageData:function(t,e){var i=this.filterData||{};o2.Actions.load("x_attendance_assemble_control").DingdingAttendanceStatisticAction.personMonth(i.q_empName,i.cycleYear,i.cycleMonth,function(e){t&&t(e)}.bind(this))},_removeDocument:function(t,e){},_createDocument:function(){},_openDocument:function(t){}}),MWF.xApplication.Attendance.PeopleDingdingDetail.SelfHolidayStaticView=new Class({Extends:MWF.xApplication.Attendance.Explorer.View,_createItem:function(t){return new MWF.xApplication.Attendance.PeopleDingdingDetail.SelfHolidayStaticDocument(this.table,t,this.explorer,this)},_getCurrentPageData:function(t,e){var i=this.filterData||{};this.actions.listDetailFilter(i,function(e){t&&t(e)}.bind(this))},_removeDocument:function(t,e){},_createDocument:function(){},_openDocument:function(t){}}),MWF.xApplication.Attendance.PeopleDingdingDetail.Document=new Class({Extends:MWF.xApplication.Attendance.Explorer.Document}),MWF.xApplication.Attendance.PeopleDingdingDetail.SelfHolidayDocument=new Class({Extends:MWF.xApplication.Attendance.Explorer.Document}),MWF.xApplication.Attendance.PeopleDingdingDetail.DetailStaticDocument=new Class({Extends:MWF.xApplication.Attendance.Explorer.Document}),MWF.xApplication.Attendance.PeopleDingdingDetail.SelfHolidayStaticDocument=new Class({Extends:MWF.xApplication.Attendance.Explorer.Document});