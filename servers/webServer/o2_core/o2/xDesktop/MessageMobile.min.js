MWF.xDesktop.MessageMobile=new Class({Implements:[Options,Events],options:{css:{messageContainerNode:{width:"100%",position:"absolute","z-index":5e5,top:"0px",left:"0px","background-color":"#FFF",overflow:"hidden"},messageContentNode:{overflow:"hidden"},messageHideContentNode:{height:"10px","line-height":"6px","text-align":"center",display:"none","border-bottom":"1px solid #999","background-color":"#EEE"},messageItemNode:{padding:"5px",overflow:"hidden","border-bottom":"1px solid #CCC",background:"transparent",cursor:"default"},messageItemTopNode:{height:"24px","line-height":"24px","font-size":"16px",color:"#4387cd"},messageItemCloseNode:{height:"30px",width:"16px",float:"right",cursor:"pointer",background:"url("+MWF.defaultPath+"/xDesktop/$Layout/default/message/close.png) no-repeat center center"},messageItemSubjectNode:{height:"24px","margin-right":"18px"},messageItemContentNode:{overflow:"hidden",color:"#333","font-size":"12px","line-height":"20px"},messageItemBottomNode:{height:"24px","font-size":"12px","line-height":"24px"},messageItemDateNode:{color:"#666"}}},initialize:function(t){this.setOptions(t),this.container=$(document.body),this.css=this.options.css,this.isShow=!1,this.isMorph=!1},load:function(){this.node=new Element("div",{styles:this.css.messageContainerNode}),this.node.inject(this.container),this.contentNode=new Element("div",{styles:this.css.messageContentNode}).inject(this.node),this.hideNode=new Element("div",{styles:this.css.messageHideContentNode,text:"——"}).inject(this.node),this.hideNode.addEvent("click",this.hide.bind(this)),this.setPosition()},show:function(){this.isMorph||(this.isMorph=!0,this.morph||(this.morph=new Fx.Morph(this.node,{duration:"200",transition:Fx.Transitions.Sine.easeOut})),this.node.setStyle("display","block"),this.hideNode.setStyle("display","block"),this.setPosition(),this.morph.start({top:"0px"}).chain(function(){this.isShow=!0,this.isMorph=!1}.bind(this)))},hide:function(){if(!this.isMorph){this.isMorph=!0,this.morph||(this.morph=new Fx.Morph(this.node,{duration:"200",transition:Fx.Transitions.Sine.easeOut}));this.node.getPosition();var t=0-this.node.getSize().y;this.morph.start({top:t+"px"}).chain(function(){this.node.setStyle("display","none"),this.isShow=!1,this.isMorph=!1}.bind(this))}},addMessage:function(t){var e=new MWF.xDesktop.MessageMobile.Item(this,t);return this.isShow||this.setPosition(),e},setPosition:function(){if(!this.isShow){var t=0-this.node.getSize().y;this.node.setStyle("top",t+"px")}},addTooltip:function(t){}}),MWF.xDesktop.MessageMobile.Item=new Class({initialize:function(t,e){this.message=t,this.container=this.message.contentNode,this.css=this.message.css,this.msg=e,this.load()},load:function(){this.node=new Element("div",{styles:this.css.messageItemNode}),this.topNode=new Element("div",{styles:this.css.messageItemTopNode}).inject(this.node),this.closeNode=new Element("div",{styles:this.css.messageItemCloseNode}).inject(this.topNode),this.subjectNode=new Element("div",{styles:this.css.messageItemSubjectNode}).inject(this.topNode),this.contentNode=new Element("div",{styles:this.css.messageItemContentNode}).inject(this.node),this.bottomNode=new Element("div",{styles:this.css.messageItemBottomNode}).inject(this.node),this.dateNode=new Element("div",{styles:this.css.messageItemDateNode}).inject(this.bottomNode),this.subjectNode.set({text:this.msg.subject,title:this.msg.subject}),this.contentNode.set({html:this.msg.content}),this.contentNode.set({title:this.contentNode.get("text")}),this.dateNode.set("text",(new Date).format("db")),this.node.inject(this.container,"top"),this.setEvent()},setEvent:function(){this.closeNode.addEvents({click:function(){this.close()}.bind(this)})},close:function(t){var e=new Fx.Morph(this.node,{duration:"200"}),s=this.node.getSize();this.node.setStyle("height",s.y+"px"),e.start({opacity:0,height:"0px"}).chain(function(){this.node.destroy()}.bind(this))},closeItem:function(t){var e=new Fx.Morph(this.node,{duration:"200"}),s=this.node.getSize();this.node.setStyle("height",s.y+"px"),e.start({opacity:0,height:"0px"}).chain(function(){this.node.destroy(),t&&t()}.bind(this))}});