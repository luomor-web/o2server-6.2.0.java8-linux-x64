o2.widget=o2.widget||{},o2.require("o2.widget.JavascriptEditor",null,!1),o2.widget.CssEditor=new Class({Implements:[Options,Events],Extends:o2.widget.JavascriptEditor,options:{type:"ace",title:"CssEditor",style:"default",option:{value:"",mode:"css",lineNumbers:!0}},initialize:function(t,i){this.setOptions(i),this.editorClass=o2.widget[this.options.type],this.node=$(t)},loadAce:function(t){this.editorClass.load(function(){ace.require("ace/ext/language_tools");this.editor=ace.edit(this.node),this.editor.session.setMode("ace/mode/css"),this.editor.setTheme("ace/theme/"+this.theme),this.editor.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),this.options.option.value&&this.editor.setValue(this.options.option.value),this.focus(),this.editor.commands.addCommand({name:"save",bindKey:{win:"Ctrl-S",mac:"Command-S"},exec:function(t){this.fireEvent("save")}.bind(this),readOnly:!1}),this.editor.commands.addCommand({name:"help",bindKey:{win:"Ctrl-Q|Ctrl-Alt-Space|Ctrl-Space|Alt-/",mac:"Command-Q"},exec:function(t,i,e){this.fireEvent("reference",[t,i,e])}.bind(this),readOnly:!1}),this.editor.commands.addCommand({name:"format",bindKey:{win:"Ctrl-Alt-i|Ctrl-Alt-f",mac:"Command-i|Command-f"},exec:function(t,i,e){o2.load("JSBeautifier_css",function(){t.setValue(css_beautify(t.getValue()))}.bind(this))}.bind(this),readOnly:!1}),this.node.addEvent("keydown",(function(t){t.stopPropagation()})),this.fireEvent("postLoad"),t&&t()}.bind(this))},loadCodeMirror:function(t){this.fireEvent("queryLoad")&&this.editorClass.load(function(){this.editorClass.loadJavascript(function(i){this.options.option.mode="css",this.editor=CodeMirror(this.node,this.options.option),this.editor.setSize("100%","100%"),this.fireEvent("postLoad"),t&&t()}.bind(this))}.bind(this))}});