o2.widget=o2.widget||{},o2.require("o2.widget.ScriptArea",null,!1),o2.widget.CssArea=new Class({Implements:[Options,Events],Extends:o2.widget.ScriptArea,options:{title:"CssArea",style:"default",helpStyle:"default",maxObj:document.body,isload:!1,key:"code"},initialize:function(e,t){this.setOptions(t),this.node=$(e),this.container=new Element("div"),this.path=o2.session.path+"/widget/$CssArea/",this.cssPath=o2.session.path+"/widget/$CssArea/"+this.options.style+"/css.wcss",this._loadCss()},toJson:function(){return this.editor?{code:this.editor.getValue(),html:this.editor.getValue()}:this.contentCode},createContent:function(e){if(this.contentNode=new Element("div",{styles:this.css.contentNode}).inject(this.container),this.resizeContentNodeSize(),this.contentCode=e,e&&e.code||this.referenceNode.setStyle("background","url("+o2.session.path+"/widget/$ScriptArea/"+this.options.style+"/icon/reference_empty.png) center center no-repeat"),this.options.isload)this.loadEditor(e);else{var t=new Element("div",{styles:this.css.inforNode,text:o2.LP.widget.clickToEditCss}).inject(this.contentNode),i=this;t.addEvent("click",(function(){this.destroy(),i.loadEditor(e)}))}},loadEditor:function(e){var t=e?e.code:"";t=t||"",this.jsEditor=new o2.widget.JavascriptEditor(this.contentNode,{option:{mode:"css",value:t,lineNumbers:!1},onPostLoad:function(){this.editor=this.jsEditor.editor,this.editor.id="2",this.jsEditor.addEditorEvent("change",function(){this.fireEvent("change")}.bind(this)),this.jsEditor.addEditorEvent("blur",function(){this.fireEvent("blur")}.bind(this)),this.jsEditor.resize(),this.fireEvent("postLoad")}.bind(this),onSave:function(){this.fireEvent("change"),this.fireEvent("save")}.bind(this)}),this.jsEditor.load(),this.createScriptReferenceMenu(),this.jsEditor.addEvent("reference",function(e,t,i){this.scriptReferenceMenu?this.showReferenceMenu():this.createScriptReferenceMenu(this.showReferenceMenu.bind(this))}.bind(this)),this.referenceNode.setStyle("background","url("+o2.session.path+"/widget/$ScriptArea/"+this.options.style+"/icon/reference.png) center center no-repeat")}});