MWF.xApplication.BAM.summary=MWF.xApplication.BAM.summary||{},MWF.xDesktop.requireApp("BAM","summary.TaskCompletedContent",null,!1),MWF.xApplication.BAM.summary.WorkCompletedContent=new Class({Extends:MWF.xApplication.BAM.summary.TaskCompletedContent,Implements:[Options,Events],options:{style:"default"},initialize:function(t,a,i,s){this.setOptions(s),this.summary=t,this.app=this.summary.app,this.css=this.app.css,this.lp=this.app.lp,this.container=$(a),this.category="application",this.data=this.summary.categoryData,this.maxColumn=10,this.barOptions={style:"work"},this.load()},load:function(){this.loadArea(this.lp.workCompleted),this.loadBarData(this.loadBar.bind(this))},loadCategory:function(){var t=new MWF.widget.UUID,a="<input name='"+t+"TaskRankCategory' type='radio' value='application' checked>"+this.lp.application+"<input name='"+t+"TaskRankCategory' type='radio' value='process'>"+this.lp.process;this.categoryNode.set("html",a);var i=this;this.categoryNode.getElements("input").addEvent("click",(function(){i.category=this.value,i.reload()}))},reloadMaxChart:function(){this.node.inject(this.maxNode),this.node.setStyles(this.css.taskContentNode_max),this.chartAreaNode.setStyles(this.css.contentChartAreaNode_max),this.actionNode.setStyles(this.css.taskRankActionNode_max);var t=this.chartAreaNode.getSize(),a=t.y-80;this.countNode.setStyle("height",a+"px"),this.expiredNode.setStyle("height",a+"px"),this.expiredCountNode.setStyle("height",a+"px"),this.timeoutRateNode&&this.timeoutRateNode.setStyle("height",a+"px"),this.timelinessRateNode&&this.timelinessRateNode.setStyle("height",a+"px"),this.maxColumn=Math.round(t.x/40),this.barOptions={marginBottom:100,delay:10,style:"work_max"},this.reload()},loadBar:function(){MWF.require("MWF.widget.chart.Bar",function(){this.countPage.addEvent("show",function(){this.countBar?this.countBar.transition():this.countBar=this.loadBarChart(this.countNode,this[this.category+"Data"].workCompletedCount.slice(0,this.maxColumn),this.barOptions)}.bind(this)),this.expiredPage.addEvent("show",function(){this.elapsedBar?this.elapsedBar.transition():this.elapsedBar=this.loadBarChart(this.expiredNode,this[this.category+"Data"].workCompletedDuration.slice(0,this.maxColumn),this.barOptions)}.bind(this)),this.expiredCountPage.addEvent("show",function(){this.elapsedCountBar?this.elapsedCountBar.transition():this.elapsedCountBar=this.loadBarChart(this.expiredCountNode,this[this.category+"Data"].workCompletedElapsedCount.slice(0,this.maxColumn),this.barOptions)}.bind(this)),this.timeoutRatePage.addEvent("show",function(){if(this.timeoutRateBar)this.timeoutRateBar.transition();else{var t=this.barOptions?Object.clone(this.barOptions):{};t.tickFormat=".0%",t.dataFormat=".1%",this.timeoutRateBar=this.loadBarChart(this.timeoutRateNode,this[this.category+"Data"].workTimeoutRate.slice(0,this.maxColumn),t)}}.bind(this)),this.timelinessRatePage.addEvent("show",function(){if(this.timelinessRateBar)this.timelinessRateBar.transition();else{var t=this.barOptions?Object.clone(this.barOptions):{};t.tickFormat=".0%",t.dataFormat=".1%",this.timelinessRateBar=this.loadBarChart(this.timelinessRateNode,this[this.category+"Data"].workTimelinessRate.slice(0,this.maxColumn),t)}}.bind(this)),this.countPage.isShow?this.countPage.showIm():this.countPage.showTabIm()}.bind(this))},loadApplicationData:function(t){this.applicationData||(this.applicationData=this.app.actions.getWorkCompletedContentData(this.summary.categoryData.application||[])),t&&t()},loadProcessData:function(t){this.processData||(this.processData=this.app.actions.getWorkCompletedContentData(this.summary.categoryData.process||[])),t&&t()},loadActivityData:function(t){this.activityData||(this.activityData=this.app.actions.getWorkCompletedContentData(this.summary.categoryData.activity||[],(function(t){return t.processName+"-"+t.name}))),t&&t()}});