MWF.xApplication.Forum=MWF.xApplication.Forum||{},MWF.xApplication.ForumSection=MWF.xApplication.ForumSection||{},MWF.require("MWF.widget.O2Identity",null,!1),MWF.xDesktop.requireApp("Forum","Common",null,!1),MWF.xDesktop.requireApp("Forum","lp."+MWF.language,null,!1),MWF.xDesktop.requireApp("Template","Explorer",null,!1),MWF.xDesktop.requireApp("Forum","Access",null,!1),MWF.xDesktop.requireApp("Forum","TopNode",null,!1),MWF.xApplication.ForumSection.options={multitask:!0,executable:!0},MWF.xApplication.ForumSection.Main=new Class({Extends:MWF.xApplication.Common.Main,Implements:[Options,Events],options:{style:"default",name:"ForumSection",icon:"icon.png",width:"1230",height:"700",isResize:!0,isMax:!0,title:MWF.xApplication.ForumSection.LP.title,hasTop:!0,naviMode:!1,hasBreadCrumb:!0,autoWidth:!1,sectionId:""},onQueryLoad:function(){this.lp=MWF.xApplication.Forum.LP},onQueryClose:function(){this.clearContent()},loadApplication:function(t){this.userName=layout.desktop.session.user.distinguishedName,this.restActions=MWF.Actions.get("x_bbs_assemble_control"),this.path="../x_component_ForumSection/$Main/"+this.options.style+"/",this.createNode(),this.loadApplicationContent()},loadController:function(t){this.access=new MWF.xApplication.Forum.Access(this.restActions,this.lp),t&&t()},createNode:function(){this.content.setStyle("overflow","hidden"),this.node=new Element("div",{styles:this.css.node}).inject(this.content)},clearContent:function(){this.node.empty()},loadApplicationContent:function(){!this.options.sectionId&&this.status&&this.status.sectionId&&(this.options.sectionId=this.status.sectionId),this.loadController(function(){this.access.login(function(){this.loadApplicationLayout()}.bind(this))}.bind(this))},reloadAllParents:function(){var t="Forum";this.desktop.apps[t]&&this.desktop.apps[t].reload&&this.desktop.apps[t].reload(),t="ForumCategory"+this.sectionData.forumId,this.desktop.apps[t]&&this.desktop.apps[t].reload&&this.desktop.apps[t].reload()},reload:function(){this.status={sectionId:this.options.sectionId,viewPageNum:this.explorer.view.getCurrentPageNum(),noteHidden:this.noteNodeHidden},this.clearContent(),this.contentContainerNode=new Element("div.contentContainerNode",{styles:this.options.autoWidth?this.css.contentContainerNode_inContainer:this.css.contentContainerNode}).inject(this.node),this.createTopNode(),this.createMiddleNode()},loadApplicationLayout:function(){this.contentContainerNode=new Element("div.contentContainerNode",{styles:this.options.autoWidth?this.css.contentContainerNode_inContainer:this.css.contentContainerNode}).inject(this.node),this.options.sectionId?this.restActions.listSectionPermission(this.options.sectionId,function(t){this.sectionPermission=t.data,this.isAdmin=this.sectionPermission.subjectManageAble,this.restActions.getSection(this.options.sectionId,function(t){this.sectionData=t.data;var e=this.inBrowser&&MWFForum.getSystemConfigValue(MWFForum.BBS_TITLE_TAIL)||"";this.setTitle(this.sectionData.sectionName+e),this.createTopNode(),this.createMiddleNode()}.bind(this))}.bind(this)):this.close()},loadTopObject:function(t){this.options.hasTop&&(this.topObject=new MWF.xApplication.Forum.TopNode(this.contentContainerNode,this,this,{type:this.options.style,naviModeEnable:!0,naviMode:t})).load()},createTopNode:function(){if(this.loadTopObject(!1),this.options.hasBreadCrumb){var t=this.topNode=new Element("div.topNode",{styles:this.options.autoWidth?this.css.topNode_inContainer:this.css.topNode}).inject(this.contentContainerNode),e=this.breadCrumbNode=new Element("div.topTitleMiddleNode",{styles:this.css.topTitleMiddleNode}).inject(t);new Element("div.topItemTitleNode",{styles:this.css.topItemTitleNode,text:MWFForum.getBBSName()||MWF.xApplication.Forum.LP.title}).inject(e).addEvent("click",function(){if(this.options.naviMode&&this.forumNavi)this.forumNavi.goto(MWFForum.NaviType.main);else{this.desktop.apps.Forum?this.desktop.apps.Forum.setCurrent():this.desktop.openApplication(null,"Forum",{appId:"Forum"}),this.close()}}.bind(this));new Element("div.topItemSepNode",{styles:this.css.topItemSepNode,text:">"}).inject(e);new Element("div.topItemTitleNode",{styles:this.css.topItemTitleNode,text:this.sectionData.forumName}).inject(e).addEvent("click",function(){if(this.obj.options.naviMode&&this.obj.forumNavi)this.obj.forumNavi.goto(MWFForum.NaviType.category,this.forumId);else{var t="ForumCategory"+this.forumId;this.obj.desktop.apps[t]?this.obj.desktop.apps[t].setCurrent():this.obj.desktop.openApplication(null,"ForumCategory",{categoryId:this.forumId,appId:t}),this.obj.inBrowser||this.obj.close()}}.bind({obj:this,forumId:this.sectionData.forumId})),new Element("div.topItemSepNode",{styles:this.css.topItemSepNode,text:">"}).inject(e),new Element("div.topItemTitleNode",{styles:this.css.topItemTitleLastNode,text:this.sectionData.sectionName}).inject(e)}if(this.sectionData.sectionNotice){var i=new Element("div",{styles:this.css.topRightNode}).inject(t);i.addEvents({click:function(){this.noteNodeHidden?(this.noteNode.setStyle("display",""),this.topRightIconNode.setStyles(this.css.topRightIconNode),this.noteNodeHidden=!1):(this.noteNode.setStyle("display","none"),this.topRightIconNode.setStyles(this.css.topRightIconDownNode),this.noteNodeHidden=!0)}.bind(this)});this.topRightIconNode=new Element("div",{styles:this.css.topRightIconNode}).inject(i);this.status&&this.status.noteHidden&&(this.topRightIconNode.setStyles(this.css.topRightIconDownNode),this.noteNodeHidden=!0)}},createMiddleNode:function(){this.middleNode=new Element("div.middleNode",{styles:this.options.autoWidth?this.css.middleNode_inContainer:this.css.middleNode}).inject(this.contentContainerNode),this.createSectionNode(),this.createNoteNode(),this._createMiddleNode(),this.options.naviMode||(this.addEvent("resize",function(){this.setContentSize()}.bind(this)),this.setContentSize())},openNavi:function(){MWF.xDesktop.requireApp("Forum","NaviMode",null,!1),this.clearContent(),this.contentContainerNode=new Element("div.contentContainerNode",{styles:this.css.contentContainerNode}).inject(this.node),this.loadTopObject(!0),this.middleNode=new Element("div.middleNode",{styles:this.css.middleNode}).inject(this.contentContainerNode),this.contentNode=new Element("div.contentNode",{styles:this.css.contentNode}).inject(this.middleNode),this.navi=new MWF.xApplication.Forum.NaviMode(this,this.contentNode,{type:MWFForum.NaviType.section,id:this.sectionData.id}),this.navi.load()},closeNavi:function(){this.navi&&this.navi.close()},colorRgba:function(t,e){var i=t.toLowerCase();if(i&&/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(i)){if(4===i.length){for(var o="#",s=1;s<4;s+=1)o+=i.slice(s,s+1).concat(i.slice(s,s+1));i=o}var n=[];for(s=1;s<7;s+=2)n.push(parseInt("0x"+i.slice(s,s+2)));return"rgba("+n.join(",")+","+e+")"}return i},createSectionNode:function(){var t=MWF.xApplication.Forum.ForumSetting[this.sectionData.forumId].forumColor,e=new Element("div.sectionNode",{styles:this.options.autoWidth?this.css.sectionNode_inContainer:this.css.sectionNode}).inject(this.middleNode);e.setStyle("background-color",this.colorRgba(t,"0.05"));var i=new Element("div.sectionLeftNode",{styles:this.css.sectionLeftNode}).inject(e),o=new Element("div.sectionLeftIconNode",{styles:this.css.sectionLeftIconNode}).inject(i),s=(new Element("img",{styles:this.css.sectionLeftIcon,src:this.sectionData.icon?"data:image/png;base64,"+this.sectionData.icon:"../x_component_Forum/$Setting/default/sectionIcon/forum_icon.png"}).inject(o),new Element("div.sectionLeftContent",{styles:this.css.sectionLeftContent}).inject(i)),n=new Element("div.sectionTopDiv",{styles:this.css.sectionTopDiv}).inject(s),a=new Element("div.sectionTopInfor",{styles:this.css.sectionTopInfor,text:this.lp.subject+"："+this.sectionData.subjectTotal+"，"+this.lp.replyCount+"："+this.sectionData.replyTotal}).inject(n),c=new Element("div.sectionLeftDiv",{styles:this.css.sectionLeftDiv}).inject(s);new Element("div.sectionLeftMemo",{styles:this.css.sectionLeftMemo,text:this.sectionData.sectionDescription}).inject(c);n=new Element("div.sectionTopDiv",{styles:this.css.sectionTopDiv}).inject(s),new Element("div.sectionTopInfor",{styles:this.css.sectionTopInfor,text:this.lp.moderatorNames+"："}).inject(n),a=new Element("div.sectionTopInfor",{styles:this.css.sectionTopInfor}).inject(n),this.createPersonNode(a,this.sectionData.moderatorNames)},createNoteNode:function(){if(this.sectionData.sectionNotice&&""!=this.sectionData.sectionNotice.trim()){var t=this.noteNode=new Element("div.noteNode",{styles:this.css.noteNode}).inject(this.middleNode),e=new Element("div.noteTopNode",{styles:this.css.noteTopNode}).inject(t),i=new Element("div.noteTopContent",{styles:this.css.noteTopContent}).inject(e);new Element("div.noteIcon",{styles:this.css.noteIcon}).inject(i),new Element("div.noteTopText",{styles:this.css.noteTopText,text:this.lp.sectionNotice}).inject(i),new Element("div.noteContent",{styles:this.css.noteContent,html:this.sectionData.sectionNotice}).inject(t);this.status&&this.status.noteHidden&&t.setStyle("display","none")}},_createMiddleNode:function(){this.contentDiv=new Element("div.contentDiv",{styles:this.css.contentDiv}).inject(this.middleNode),this.contentDiv&&this.contentDiv.empty(),this.explorer&&(this.explorer.destroy(),delete this.explorer),this.explorer=new MWF.xApplication.ForumSection.Explorer(this.contentDiv,this,this,{style:this.options.style,viewPageNum:this.status&&this.status.viewPageNum?this.status.viewPageNum:1}),this.explorer.load()},setContentSize:function(){var t=this.content.getSize(),e=this.contentContainerNode.getStyle("padding-top").toFloat(),i=this.contentContainerNode.getStyle("padding-bottom").toFloat(),o=t.y-0-e-i;this.contentContainerNode.setStyle("height",o+"px")},openLoginForm:function(){MWF.require("MWF.xDesktop.Authentication",null,!1);var t=new MWF.xDesktop.Authentication({style:"flat",popupStyle_password:"o2platformSignupFlat",onPostOk:function(){window.location.reload()}},this);t.popupOptions={draggable:!0,closeAction:!0,hasMask:!0,relativeToApp:!0,width:"420",height:"640"},t.openLoginForm()},openSignUpForm:function(){MWF.require("MWF.xDesktop.Authentication",null,!1);var t=new MWF.xDesktop.Authentication({style:"flat",popupStyle_password:"o2platformSignupFlat",onPostOk:function(){}},this);t.popupOptions={draggable:!0,closeAction:!0,hasMask:!0,relativeToApp:!0,width:"420",height:"640"},t.openSignUpForm()},recordStatus:function(){return{sectionId:this.options.sectionId,viewPageNum:this.explorer.view.getCurrentPageNum(),noteHidden:this.noteNodeHidden}},openPerson:function(t){if(t&&""!=t){var e="ForumPerson"+t;this.desktop.apps[t]?this.desktop.apps[t].setCurrent():this.desktop.openApplication(null,"ForumPerson",{personName:t,appId:e})}else;},createPersonNode:function(t,e){var i="string"===typeOf(e)?e.split(","):e;i.each(function(e,o){if(e){var s=new Element("span",{text:e.split("@")[0],styles:this.css.person}).inject(t);s.addEvents({mouseover:function(){this.node.setStyles(this.obj.css.person_over)}.bind({node:s,obj:this}),mouseout:function(){this.node.setStyles(this.obj.css.person)}.bind({node:s,obj:this}),click:function(){this.obj.openPerson(this.userName)}.bind({userName:e,obj:this})}),o!=i.length-1&&new Element("span",{text:"、"}).inject(t)}}.bind(this))},destroy:function(){this.clearContent()},clearContent:function(){this.explorer&&this.explorer.destroy(),this.setContentSizeFun&&this.removeEvent("resize",this.setContentSizeFun),this.scrollBar&&this.scrollBar.scrollVAreaNode&&this.scrollBar.scrollVAreaNode.destroy(),this.scrollBar&&delete this.scrollBar,this.contentContainerNode&&this.contentContainerNode.destroy()}}),MWF.xApplication.ForumSection.Explorer=new Class({Extends:MWF.widget.Common,Implements:[Options,Events],options:{style:"default",viewPageNum:1},initialize:function(t,e,i,o){this.setOptions(o),this.container=t,this.parent=i,this.app=e,this.css=this.parent.css,this.lp=this.app.lp},load:function(){this.container.empty(),this.loadToolbar(),this.viewContainerTop=Element("div",{styles:this.css.viewContainerTop}).inject(this.container),this.viewContainer=Element("div",{styles:this.css.viewContainer}).inject(this.container),this.viewContainerPrime=Element("div",{styles:this.css.viewContainer}).inject(this.container),this.loadToolbar(),this.loadView()},destroy:function(){this.resizeWindowFun&&this.app.removeEvent("resize",this.resizeWindowFun),this.view.destroy(),this.view.refreshInterval&&clearInterval(this.view.refreshInterval)},loadToolbar:function(){var t=new Element("div",{styles:this.css.toolbar}).inject(this.container);if(this.toolbarTop?this.toolbarBottom=t:this.toolbarTop=t,this.app.sectionPermission.subjectPublishAble){var e=new Element("div",{styles:this.css.toolbarActionNode,text:this.lp.createSubject}).inject(t);e.addEvents({mouseover:function(){this.node.setStyles(this.obj.css.toolbarActionNode_over)}.bind({obj:this,node:e}),mouseout:function(){this.node.setStyles(this.obj.css.toolbarActionNode)}.bind({obj:this,node:e}),click:function(){this.app.access.isAnonymousDynamic()?this.app.openLoginForm(function(){this.createSubject()}.bind(this)):this.createSubject()}.bind(this)})}new Element("div",{styles:this.css.fileterNode}).inject(t);var i=new Element("div",{styles:this.css.fileterNode}).inject(t);this.pagingBarTop?this.pagingBarBottom=i:this.pagingBarTop=i},loadView:function(){this.view=new MWF.xApplication.ForumSection.View(this.viewContainer,this.app,this,{templateUrl:this.parent.path+"listItem.json",pagingEnable:!0,onPostCreateViewBody:function(){this.app.fireEvent("postCreateViewBody")}.bind(this),pagingPar:{hasReturn:!this.app.naviMode,currentPage:this.options.viewPageNum,countPerPage:30,onPostLoad:function(t){t.nextPageNode&&t.nextPageNode.inject(this.toolbarBottom,"before")}.bind(this),onPageReturn:function(t){this.app.desktop.apps.Forum?this.app.desktop.apps.Forum.setCurrent():this.app.desktop.openApplication(null,"Forum",{appId:"Forum"}),this.app.close()}.bind(this)}}),this.view.filterData={sectionId:this.app.sectionData.id,withTopSubject:!0},this.view.pagingContainerTop=this.pagingBarTop,this.view.pagingContainerBottom=this.pagingBarBottom,this.view.load()},reloadView:function(){this.viewPrime&&this.viewPrime.destroy(),this.viewContainer.setStyle("display",""),this.viewContainerTop.setStyle("display",""),this.viewContainerPrime.setStyle("display","none"),this.loadView()},loadPrimeView:function(){this.view&&this.view.destroy(),this.viewTop&&this.viewTop.destroy(),this.viewContainer.setStyle("display","none"),this.viewContainerTop.setStyle("display","none"),this.viewContainerPrime.setStyle("display",""),this.viewPrime=new MWF.xApplication.ForumSection.PrimeView(this.viewContainerPrime,this.app,this,{templateUrl:this.parent.path+"listItemPrime.json",pagingEnable:!0,pagingPar:{hasReturn:!this.app.naviMode,currentPage:1,countPerPage:30,onPostLoad:function(t){t.nextPageNode&&t.nextPageNode.inject(this.toolbarBottom,"before")}.bind(this),onPageReturn:function(t){this.app.desktop.apps.Forum?this.app.desktop.apps.Forum.setCurrent():this.app.desktop.openApplication(null,"Forum",{appId:"Forum"}),this.app.close()}.bind(this)}}),this.viewPrime.filterData={sectionId:this.app.sectionData.id},this.viewPrime.pagingContainerTop=this.pagingBarTop,this.viewPrime.pagingContainerBottom=this.pagingBarBottom,this.viewPrime.load()},resizeWindow:function(){var t=this.app.content.getSize();this.viewContainer.setStyles({height:t.y-121+"px"})},createSubject:function(){var t="ForumDocument"+this.app.sectionData.id;this.app.desktop.apps[t]?this.app.desktop.apps[t].setCurrent():this.app.desktop.openApplication(null,"ForumDocument",{sectionId:this.app.sectionData.id,appId:t,isNew:!0,isEdited:!0,onPostPublish:function(){}.bind(this)})}}),MWF.xApplication.ForumSection.TopView=new Class({Extends:MWF.xApplication.Template.Explorer.ComplexView,_createDocument:function(t,e){return new MWF.xApplication.ForumSection.TopDocument(this.viewNode,t,this.explorer,this,null,e)},_getCurrentPageData:function(t,e){e||(e=30);this.filterData;this.page?this.page++:this.page=1,this.actions.listTopSubject(this.app.sectionData.id,function(e){e.data||(e.data=[]),t&&t(e)}.bind(this))},_removeDocument:function(t,e){this.actions.deleteSubject(t.id,function(t){this.reload(),this.app.reloadAllParents(),this.app.notice(this.app.lp.deleteDocumentOK,"success")}.bind(this))},_create:function(){},_openDocument:function(t,e){var i="ForumDocument"+t.id;this.app.desktop.apps[i]?this.app.desktop.apps[i].setCurrent():this.app.desktop.openApplication(null,"ForumDocument",{sectionId:t.sectionId,id:t.id,appId:i,isEdited:!1,isNew:!1,index:e})},_queryCreateViewNode:function(){},_postCreateViewNode:function(t){},_queryCreateViewHead:function(){},_postCreateViewHead:function(t){t.getElements("[lable='prime']")[0].addEvent("click",function(){this.explorer.loadPrimeView()}.bind(this))}}),MWF.xApplication.ForumSection.TopDocument=new Class({Extends:MWF.xApplication.Template.Explorer.ComplexDocument,_queryCreateDocumentNode:function(t){},_postCreateDocumentNode:function(t,e){},open:function(t){this.view._openDocument(this.data,this.index)},edit:function(){var t="ForumDocument"+this.data.id;this.app.desktop.apps[t]?this.app.desktop.apps[t].setCurrent():this.app.desktop.openApplication(null,"ForumDocument",{sectionId:this.data.sectionId,id:this.data.id,appId:t,isEdited:!0,isNew:!1,index:this.index})}}),MWF.xApplication.ForumSection.View=new Class({Extends:MWF.xApplication.Template.Explorer.ComplexView,refreshNewSubject:function(){this.refreshTr&&this.refreshTr.destroy(),this.refreshInterval&&clearInterval(this.refreshInterval),this.refreshInterval=setInterval(function(){this.actions.listSubjectFilterPage(1,1,this.filterData||{},function(t){t.count||(t.count=0);var e=this.laterRefreshCount||this.dataCount;t.count>e&&(this.laterRefreshCount=t.count,this.createRefreshTr(t.count))}.bind(this))}.bind(this),6e5)},createRefreshTr:function(t){this.refreshTr&&this.refreshTr.destroy();var e=this.refreshTr=new Element("tr.refreshTrNode",{styles:this.css.refreshTrNode}).inject(this.headNode,"after"),i=this.refreshTd=new Element("td.refreshTdNode",{width:"60%",styles:this.css.refreshTdNode}).inject(e);new Element("div",{styles:this.css.refreshNode,text:this.lp.newSubjectPublishedText.replace("{count}",t-this.dataCount)}).inject(i).addEvent("click",function(){this.gotoPage(1)}.bind(this));i=new Element("td.refreshTdNode",{styles:this.css.refreshTdNode,width:"12%"}).inject(e),i=new Element("td.refreshTdNode",{styles:this.css.refreshTdNode,width:"7%"}).inject(e),i=new Element("td.refreshTdNode",{styles:this.css.refreshTdNode,width:"7%"}).inject(e),i=new Element("td.refreshTdNode",{styles:this.css.refreshTdNode,width:"14%"}).inject(e)},_createDocument:function(t,e){return new MWF.xApplication.ForumSection.Document(this.viewNode,t,this.explorer,this,null,e)},_getCurrentPageData:function(t,e,i){this.clearBody(),e||(e=30),i||(i=1),this.topSepTr&&this.topSepTr.destroy();var o=this.filterData||{};this.actions.listSubjectFilterPage(i,e,o,function(e){e.data||(e.data=[]),e.count||(e.count=0),this.refreshNewSubject(),t&&t(e)}.bind(this))},_removeDocument:function(t,e){this.actions.deleteSubject(t.id,function(t){this.reload(),this.app.reloadAllParents(),this.app.notice(this.app.lp.deleteDocumentOK,"success")}.bind(this))},_create:function(){},_openDocument:function(t,e){var i="ForumDocument"+t.id;this.app.desktop.apps[i]?this.app.desktop.apps[i].setCurrent():this.app.desktop.openApplication(null,"ForumDocument",{sectionId:t.sectionId,id:t.id,appId:i,isEdited:!1,isNew:!1,index:e})},_queryCreateViewNode:function(){},_postCreateViewNode:function(t){},_queryCreateViewHead:function(){},_postCreateViewHead:function(t){t.getElements("[lable='prime']")[0].addEvent("click",function(){this.explorer.loadPrimeView()}.bind(this))}}),MWF.xApplication.ForumSection.Document=new Class({Extends:MWF.xApplication.Template.Explorer.ComplexDocument,_queryCreateDocumentNode:function(t){},_postCreateDocumentNode:function(t,e){if(1!=this.index&&!e.isTopSubject){var i=this.view.items[this.index-1];if(i&&i.data.isTopSubject){var o=this.view.topSepTr=new Element("tr",{styles:this.css.documentNode_empty}).inject(t,"before");new Element("td",{colspan:5}).inject(o)}}},open:function(t){this.view._openDocument(this.data,this.index)},edit:function(){var t="ForumDocument"+this.data.id;this.app.desktop.apps[t]?this.app.desktop.apps[t].setCurrent():this.app.desktop.openApplication(null,"ForumDocument",{sectionId:this.data.sectionId,id:this.data.id,appId:t,isEdited:!0,isNew:!1,index:this.index})}}),MWF.xApplication.ForumSection.PrimeView=new Class({Extends:MWF.xApplication.Template.Explorer.ComplexView,_createDocument:function(t,e){return new MWF.xApplication.ForumSection.PrimeDocument(this.viewNode,t,this.explorer,this,null,e)},_getCurrentPageData:function(t,e,i){this.clearBody(),e||(e=30),i||(i=1);var o=this.filterData||{};this.actions.listCreamSubjectFilterPage(i,e,o,function(e){e.data||(e.data=[]),e.count||(e.count=0),t&&t(e)}.bind(this))},_removeDocument:function(t,e){this.actions.deleteSubject(t.id,function(t){this.reload(),this.app.reloadAllParents(),this.app.notice(this.app.lp.deleteDocumentOK,"success")}.bind(this))},_create:function(){},_openDocument:function(t,e){var i="ForumDocument"+t.id;this.app.desktop.apps[i]?this.app.desktop.apps[i].setCurrent():this.app.desktop.openApplication(null,"ForumDocument",{sectionId:t.sectionId,id:t.id,appId:i,isEdited:!1,isNew:!1,index:e})},_queryCreateViewNode:function(){},_postCreateViewNode:function(t){},_queryCreateViewHead:function(){},_postCreateViewHead:function(t){t.getElements("[lable='allSubject']")[0].addEvent("click",function(){this.explorer.reloadView()}.bind(this))}}),MWF.xApplication.ForumSection.PrimeDocument=new Class({Extends:MWF.xApplication.Template.Explorer.ComplexDocument,_queryCreateDocumentNode:function(t){},_postCreateDocumentNode:function(t,e){},open:function(t){this.view._openDocument(this.data,this.index)},edit:function(){var t="ForumDocument"+this.data.id;this.app.desktop.apps[t]?this.app.desktop.apps[t].setCurrent():this.app.desktop.openApplication(null,"ForumDocument",{sectionId:this.data.sectionId,id:this.data.id,appId:t,isEdited:!0,isNew:!1,index:this.index})}});