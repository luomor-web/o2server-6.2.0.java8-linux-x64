MWF.xApplication.Minder=MWF.xApplication.Minder||{},MWF.xDesktop.requireApp("Template","Explorer",null,!1),MWF.xDesktop.requireApp("Template","MPopupForm",null,!1),MWF.xDesktop.requireApp("Template","MTooltips",null,!1),MWF.require("MWF.widget.O2Identity",null,!1),MWF.xApplication.Minder.FolderSelector=new Class({Extends:MTooltips,options:{style:"",axis:"y",position:{x:"right",y:"auto"},event:"click",hiddenDelay:200,displayDelay:0,hasArrow:!1,overflow:"scroll",nodeStyles:{"font-size":"12px",position:"absolute","max-width":"500px","min-width":"260px","z-index":"11","background-color":"#fff",padding:"5px","border-radius":"4px","box-shadow":"0 0 4px 0 #999999","-webkit-user-select":"text","-moz-user-select":"text"}},_loadCustom:function(t){this.treeNode=new Element("div.treeNode",{styles:{position:"relative",overflow:"hidden","min-width":"395px","box-shadow":"0 1px 3px 0 rgba(0,0,0,0.25)",float:"left","background-color":"#F8F8F8"}}).inject(this.contentNode),this.tree=new MWF.xApplication.Minder.Tree({app:this.app},this.treeNode,{style:"default",defaultNode:this.options.defaultNode||"root",onPostLoad:function(){t&&t()}.bind(this),onSelect:function(t){this.fireEvent("select",t.data),this.hide()}.bind(this),minWidth:425,maxWidth:425})}}),MWF.xApplication.Minder.Tree=new Class({Extends:MWF.widget.Common,Implements:[Options,Events],options:{style:"default",defaultNode:"root",minWidth:null,maxWidth:null},initialize:function(t,e,i){this.setOptions(i),this.explorer=t,this.app=t.app,this.node=$(e),this.cssPath="../x_component_Minder/$Common/"+this.options.style+"/css.wcss",this.load()},load:function(){this._loadCss();this.treeContentNode=new Element("div",{styles:this.css.treeContentNode}).inject(this.node);var t={id:"root",name:"根目录",orderNumber:"1",description:""};this.app.restActions.listMyFolder(function(e){t.children=e.data,this.loadTreeNode(t),this.fireEvent("postLoad")}.bind(this),function(){this.fireEvent("postLoad")}.bind(this),!0)},loadTreeNode:function(t){this.treeNode=new MWF.xApplication.Minder.Tree.Node(this,this.treeContentNode,t,{style:this.options.style,isCurrent:this.options.defaultNode==t.id,minWidth:this.options.minWidth,maxWidth:this.options.maxWidth})},reload:function(){this.node.empty(),this.load()},getCurrentNode:function(){return this.currentItem},getCurrentFolderData:function(){var t=this.getCurrentNode();return t?t.data:{}},getCurrentFolderId:function(){var t=this.getCurrentNode();return t?t.data.id:""}}),MWF.xApplication.Minder.Tree.Node=new Class({Implements:[Options,Events],options:{style:"default",isCurrent:!1,isExpanded:!0,level:0,minWidth:null,maxWidth:null},initialize:function(t,e,i,s){this.setOptions(s),this.tree=t,this.explorer=t.explorer,this.app=t.app,this.css=this.tree.css,this.data=i,this.node=$(e),this.load()},load:function(){var t=this;this.itemNode=new Element("div.treeItemNode",{styles:this.css.treeItemNode}).inject(this.node),this.itemNode.setStyle("padding-left",12*this.options.level+10+"px"),this.itemExpendNode=new Element("div.treeItemExpendNode",{styles:this.css.emptyExpendNode}).inject(this.itemNode),this.data.children&&this.data.children.length&&this.itemExpendNode.addEvent("click",(function(e){t.options.isExpanded?t.collapse():t.expand(),e.stopPropagation()})),this.itemIconNode=new Element("div.treeItemIconNode",{styles:this.css.treeItemIconNode}).inject(this.itemNode),this.itemTextNode=new Element("div.treeItemTextNode",{styles:this.css.treeItemTextNode,text:this.data.name}).inject(this.itemNode),this.setTextNodeWidth(),this.itemNode.addEvents({mouseover:function(){t.options.isCurrent||(this.setStyles(t.css.treeItemNode_over),t.itemIconNode.setStyles(t.css.treeItemIconNode_over))},mouseout:function(){t.options.isCurrent||(this.setStyles(t.css.treeItemNode),t.itemIconNode.setStyles(t.css.treeItemIconNode))},click:function(){t.tree.fireEvent("select",t),t.setCurrent()}}),this.data.children&&(this.treeContentNode=new Element("div.treeContentNode",{styles:this.css.treeContentNode}).inject(this.node),this.children=[],this.data.children.each((function(e){t.children.push(t.getTreeNode(e))}))),this.options.isCurrent&&this.setCurrent(),this.data.children&&this.data.children.length&&(this.options.isExpanded?this.expand():this.collapse())},setTextNodeWidth:function(){this.options.minWidth&&this.itemTextNode.setStyle("min-width",this.options.minWidth-12*this.options.level-10-80+"px"),this.options.maxWidth&&this.itemTextNode.setStyle("max-width",this.options.maxWidth-12*this.options.level-10-80+"px")},getTreeNode:function(t){return new MWF.xApplication.Minder.Tree.Node(this.tree,this.treeContentNode,t,{style:this.options.style,level:this.options.level+1,isCurrent:this.tree.options.defaultNode==t.id,minWidth:this.options.minWidth,maxWidth:this.options.maxWidth})},cancelCurrent:function(){this.itemNode.setStyles(this.css.treeItemNode),this.itemIconNode.setStyles(this.css.treeItemIconNode),this.data.children&&this.data.children.length>0&&(this.options.isExpanded?this.itemExpendNode.setStyles(this.css.treeItemExpendNode):this.itemExpendNode.setStyles(this.css.treeItemCollapseNode)),this._cancelCurrent(),this.options.isCurrent=!1,this.tree.currentItem=null},_cancelCurrent:function(){},setCurrent:function(){this.tree.currentItem&&this.tree.currentItem.cancelCurrent(),this.itemNode.setStyles(this.css.treeItemNode_selected),this.itemIconNode.setStyles(this.css.treeItemIconNode_selected),this.data.children&&this.data.children.length>0&&(this.options.isExpanded?this.itemExpendNode.setStyles(this.css.treeItemExpendNode_selected):this.itemExpendNode.setStyles(this.css.treeItemCollapseNode_selected)),this.options.isCurrent=!0,this.tree.currentItem=this,this._setCurrent()},_setCurrent:function(){},expand:function(){this.options.isCurrent?this.itemExpendNode.setStyles(this.css.treeItemExpendNode_selected):this.itemExpendNode.setStyles(this.css.treeItemExpendNode),this.treeContentNode&&this.treeContentNode.setStyle("display",""),this.options.isExpanded=!0},collapse:function(){this.options.isCurrent?this.itemExpendNode.setStyles(this.css.treeItemCollapseNode_selected):this.itemExpendNode.setStyles(this.css.treeItemCollapseNode),this.treeContentNode&&this.treeContentNode.setStyle("display","none"),this.options.isExpanded=!1}}),MWF.xApplication.Minder.ShareForm=new Class({Extends:MPopupForm,Implements:[Options,Events],options:{style:"minder",width:700,height:"400",hasTop:!0,hasIcon:!1,draggable:!0,title:"脑图分享"},_createTableContent:function(){this.formTableArea.set("html","<table width='100%' bordr='0' cellpadding='7' cellspacing='0' styles='formTable' style='margin-top: 20px; '><tr><td styles='formTableTitle' lable='fileName' width='18%'></td>    <td styles='formTableValue14' item='fileName'></td></tr><tr><td styles='formTableTitle' lable='shareTo' width='18%'></td>    <td styles='formTableValue14' item='shareTo'></td></tr><tr><td styles='formTableTitle' width='18%'></td>    <td styles='formTableValue14'>邀请其他人查看此文档</td></tr></table>"),this.form=new MForm(this.formTableArea,this.data||{},{isEdited:!0,style:"minder",hasColon:!0,itemTemplate:{fileName:{text:"脑图名称",type:"innerHTML",value:function(){var t=[];return this.checkedItemData.each((function(e){t.push(e.name)})),t.join("<br>")}.bind(this)},shareTo:{type:"org",orgType:["person","unit","group"],text:"分享对象",notEmpty:!0,count:0,style:{"min-height":"100px"}}}},this.app),this.form.load()},_createBottomContent:function(){(this.isNew||this.isEdited)&&(this.okActionNode=new Element("button.inputOkButton",{styles:this.css.inputOkButton,text:"确定"}).inject(this.formBottomNode),this.okActionNode.addEvent("click",function(t){this.share(t)}.bind(this))),this.cancelActionNode=new Element("button.inputCancelButton",{styles:this.isEdited||this.isNew||this.getEditPermission()?this.css.inputCancelButton:this.css.inputCancelButton_long,text:"关闭"}).inject(this.formBottomNode),this.cancelActionNode.addEvent("click",function(t){this.close(t)}.bind(this))},share:function(){var t=this.form.getResult(!0,null,!0,!1,!0);if(t){var e={sharePersons:[],shareUnits:[],shareGroups:[]};t.shareTo.each(function(t){switch(t.substr(t.length-1,1).toLowerCase()){case"p":e.sharePersons.push(t);break;case"u":e.shareUnits.push(t);break;case"g":e.shareGroups.push(t)}}.bind(this));var i=0;this.checkedItemData.each(function(t){this.app.restActions.shareMind(t.id,e,function(){++i==this.checkedItemData.length&&(this.app.notice("分享成功！"),this.close())}.bind(this))}.bind(this))}}}),MWF.xApplication.Minder.NewNameForm=new Class({Extends:MPopupForm,Implements:[Options,Events],options:{style:"minder",width:700,height:"300",hasTop:!0,hasIcon:!1,draggable:!0,title:"新建脑图"},_createTableContent:function(){this.formTableArea.set("html","<table width='100%' bordr='0' cellpadding='7' cellspacing='0' styles='formTable' style='margin-top: 20px; '><tr><td styles='formTableTitle' lable='folder' width='25%'></td>    <td styles='formTableValue14' item='folder' colspan='3'></td></tr><tr><td styles='formTableTitle' lable='name' width='25%'></td>    <td styles='formTableValue14' item='name' colspan='3'></td></tr></table>");var t=this.explorer.getCurrentFolderData?this.explorer.getCurrentFolderData():{};this.folderId=t.id||"root",this.form=new MForm(this.formTableArea,this.data||{},{isEdited:!0,style:"minder",hasColon:!0,itemTemplate:{folder:{text:"选择文件夹",notEmpty:!0,attr:{readonly:!0},defaultValue:t.name||"根目录"},name:{text:"脑图名称",notEmpty:!0}}},this.app),this.form.load(),this.loadFolderSelect()},_createBottomContent:function(){(this.isNew||this.isEdited)&&(this.okActionNode=new Element("button.inputOkButton",{styles:this.css.inputOkButton,text:"确定"}).inject(this.formBottomNode),this.okActionNode.addEvent("click",function(t){this.save(t)}.bind(this))),this.cancelActionNode=new Element("button.inputCancelButton",{styles:this.isEdited||this.isNew||this.getEditPermission()?this.css.inputCancelButton:this.css.inputCancelButton_long,text:"关闭"}).inject(this.formBottomNode),this.cancelActionNode.addEvent("click",function(t){this.close(t)}.bind(this))},save:function(){var t=this.form.getResult(!0,null,!0,!1,!0);t&&(t.content='{"root":{"data":{"text":"'+t.name+'"},"children":[]}}',t.folderId=this.folderId,this.app.restActions.saveMind(t,function(e){this.app.desktop.openApplication(null,"MinderEditor",{folderId:t.folderId,minderName:t.name,id:e.data.id,isEdited:!0,isNew:!1}),this.explorer.currentView&&this.explorer.currentView.reload(),this.close()}.bind(this)))},loadFolderSelect:function(){this.folderSelect=new MWF.xApplication.Minder.FolderSelector(this.app.content,this.form.getItem("folder").getElements()[0],this.app,{},{defaultNode:this.folderId,onSelect:function(t){this.form.getItem("folder").setValue(t.name),this.folderId=t.id}.bind(this)})}}),MWF.xApplication.Minder.FolderForm=new Class({Extends:MPopupForm,Implements:[Options,Events],options:{style:"minder",width:700,height:"200",hasTop:!0,hasIcon:!1,draggable:!0,title:"新建目录"},_createTableContent:function(){this.formTableArea.set("html","<table width='100%' bordr='0' cellpadding='7' cellspacing='0' styles='formTable' style='margin-top: 20px; '><tr><td styles='formTableTitle' lable='name' width='25%'></td>    <td styles='formTableValue14' item='name' colspan='3'></td></tr></table>"),this.form=new MForm(this.formTableArea,this.data||{},{isEdited:!0,style:"minder",hasColon:!0,itemTemplate:{name:{text:"名称",notEmpty:!0}}},this.app),this.form.load()},_createBottomContent:function(){(this.isNew||this.isEdited)&&(this.okActionNode=new Element("button.inputOkButton",{styles:this.css.inputOkButton,text:"确定"}).inject(this.formBottomNode),this.okActionNode.addEvent("click",function(t){this.save(t)}.bind(this))),this.cancelActionNode=new Element("button.inputCancelButton",{styles:this.isEdited||this.isNew||this.getEditPermission()?this.css.inputCancelButton:this.css.inputCancelButton_long,text:"关闭"}).inject(this.formBottomNode),this.cancelActionNode.addEvent("click",function(t){this.close(t)}.bind(this))},save:function(){var t=this.form.getResult(!0,null,!0,!1,!0);t&&(this.isNew&&(t.parentId=this.explorer.getCurrentFolderId()),this.app.restActions.saveFolder(t,function(t){this.explorer.tree.reload(),this.close()}.bind(this)))}}),MWF.xApplication.Minder.ReNameForm=new Class({Extends:MPopupForm,Implements:[Options,Events],options:{style:"minder",width:700,height:"200",hasTop:!0,hasIcon:!1,draggable:!0,title:"重命名脑图",id:""},_createTableContent:function(){this.formTableArea.set("html","<table width='100%' bordr='0' cellpadding='7' cellspacing='0' styles='formTable' style='margin-top: 20px; '><tr><td styles='formTableTitle' lable='name' width='25%'></td>    <td styles='formTableValue14' item='name' colspan='3'></td></tr></table>"),this.form=new MForm(this.formTableArea,this.data||{},{isEdited:!0,style:"minder",hasColon:!0,itemTemplate:{name:{text:"名称",notEmpty:!0}}},this.app),this.form.load()},_createBottomContent:function(){(this.isNew||this.isEdited)&&(this.okActionNode=new Element("button.inputOkButton",{styles:this.css.inputOkButton,text:"确定"}).inject(this.formBottomNode),this.okActionNode.addEvent("click",function(t){this.save(t)}.bind(this))),this.cancelActionNode=new Element("button.inputCancelButton",{styles:this.isEdited||this.isNew||this.getEditPermission()?this.css.inputCancelButton:this.css.inputCancelButton_long,text:"关闭"}).inject(this.formBottomNode),this.cancelActionNode.addEvent("click",function(t){this.close(t)}.bind(this))},save:function(){var t=this.form.getResult(!0,null,!0,!1,!0);t&&this.app.restActions.getMind(this.options.id,function(e){var i=e.data;i.name=t.name,this.app.restActions.saveMind(i,function(t){this.app.notice("重命名成功"),this.explorer.currentView.reload(),this.close()}.bind(this))}.bind(this))}}),MWF.xApplication.Minder.Toolbar=new Class({Extends:MWF.widget.Common,Implements:[Options,Events],options:{style:"default",availableTool:[["createMinder","createFolder"],["rename","recycle"],["share"]],viewType:"list"},initialize:function(t,e,i){this.container=t,this.explorer=e,this.app=e.app,this.lp=e.app.lp,this.iconPath="../x_component_Minder/$Common/"+this.options.style+"/icon_tool/",this.cssPath="../x_component_Minder/$Common/"+this.options.style+"/css.wcss",this.setOptions(i),this.tools={createMinder:{action:"createMinder",text:"新建脑图",icon:"createminder"},createFolder:{action:"createFolder",text:"新建目录",icon:"createfolder"},rename:{action:"rename",text:"重命名",icon:"rename"},recycle:{action:"recycle",text:"删除",icon:"recycle"},destroyFromRecycle:{action:"destroyFromRecycle",text:"彻底删除",icon:"delete"},delete:{action:"delete",text:"彻底删除",icon:"delete"},share:{action:"share",text:"分享",icon:"share"},restore:{action:"restore",text:"恢复",icon:"restore"}}},load:function(){this._loadCss(),this.node=new Element("div",{styles:this.css.toolbarNode}).inject(this.container),this.options.availableTool.each(function(t){var e=new Element("div",{styles:this.css.toolgroupNode}).inject(this.node),i=t.length;t.each(function(t,s){var n;n=1==i?"toolItemNode_single":0==s?"toolItemNode_left":s+1==i?"toolItemNode_right":"toolItemNode_center";var o=this.tools[t];new Element("div",{styles:this.css[n],text:o.text,events:{click:function(t){this[o.action](t)}.bind(this),mouseover:function(t){t.target.setStyles(this.css.toolItemNode_over),t.target.setStyle("background-image","url("+this.iconPath+o.icon+"_active.png)")}.bind(this),mouseout:function(t){t.target.setStyles(this.css.toolItemNode_normal),t.target.setStyle("background-image","url("+this.iconPath+o.icon+".png)")}.bind(this)}}).inject(e).setStyle("background-image","url("+this.iconPath+o.icon+".png)")}.bind(this))}.bind(this)),this.loadRightNode()},createMinder:function(){new MWF.xApplication.Minder.NewNameForm(this.explorer,{},{},{app:this.app}).edit()},createFolder:function(){new MWF.xApplication.Minder.FolderForm(this.explorer,{},{},{app:this.app}).create()},rename:function(){var t=this.explorer.currentView.getCheckedItemData();0!=t.length?new MWF.xApplication.Minder.ReNameForm(this.explorer,{name:t[0].name},{id:t[0].id},{app:this.app}).edit():this.app.notice("请先选择文件","error")},recycle:function(t){var e=this,i=this.explorer.currentView.getCheckedItemIds();0!=i.length?this.app.confirm("warn",t,"删除文件确认","是否删除选中的"+i.length+"个文件？删除的文件会放到回收站。",350,120,(function(){var t=0;i.each(function(s){e.app.restActions.recycleMind(s,(function(){t++,i.length==t&&(e.app.notice("成功删除"+t+"个文件，您可以从回收站找到文件。"),e.explorer.currentView.reload())}))}.bind(this)),this.close()}),(function(){this.close()})):this.app.notice("请先选择文件","error")},delete:function(t){var e=this,i=this.explorer.currentView.getCheckedItemIds();0!=i.length?this.app.confirm("warn",t,"彻底删除文件确认","删除的文件无法恢复！是否彻底删除选中的"+i.length+"个文件？",350,120,(function(){var t=0;i.each(function(s){e.app.restActions.deleteMind(s,(function(){t++,i.length==t&&(e.app.notice("成功删除"+t+"个文件"),e.explorer.currentView.reload())}))}.bind(this)),this.close()}),(function(){this.close()})):this.app.notice("请先选择文件","error")},destroyFromRecycle:function(t){var e=this,i=this.explorer.currentView.getCheckedItemIds();0!=i.length?this.app.confirm("warn",t,"彻底删除文件确认","删除的文件无法恢复！是否彻底删除选中的"+i.length+"个文件？",350,120,(function(){var t=0;i.each(function(s){e.app.restActions.destroyFromRecycle(s,(function(){t++,i.length==t&&(e.app.notice("成功删除"+t+"个文件"),e.explorer.currentView.reload())}))}.bind(this)),this.close()}),(function(){this.close()})):this.app.notice("请先选择文件","error")},restore:function(){var t=this,e=this.explorer.currentView.getCheckedItemIds();if(0!=e.length){var i=0;e.each(function(s){t.app.restActions.restoreMind(s,(function(){i++,e.length==i&&(t.app.notice("成功恢复"+i+"个文件"),t.explorer.currentView.reload())}))}.bind(this))}else this.app.notice("请先选择文件","error")},loadRightNode:function(){this.toolabrRightNode=new Element("div",{styles:this.css.toolabrRightNode}).inject(this.node),this.loadSearch(),this.loadListType()},loadSearch:function(){this.searchBarAreaNode=new Element("div",{styles:this.css.searchBarAreaNode}).inject(this.toolabrRightNode),this.searchBarNode=new Element("div",{styles:this.css.searchBarNode}).inject(this.searchBarAreaNode),this.searchBarInputBoxNode=new Element("div",{styles:this.css.searchBarInputBoxNode}).inject(this.searchBarNode),this.searchBarInputNode=new Element("input",{type:"text",placeHolder:this.lp.searchKey,styles:this.css.searchBarInputNode}).inject(this.searchBarInputBoxNode),this.searchBarResetActionNode=new Element("div",{styles:this.css.searchBarResetActionNode}).inject(this.searchBarInputBoxNode),this.searchBarResetActionNode.setStyle("display","none"),this.searchBarActionNode=new Element("div",{styles:this.css.searchBarActionNode}).inject(this.searchBarNode);this.searchBarActionNode.addEvent("click",function(){this.search()}.bind(this)),this.searchBarResetActionNode.addEvent("click",function(){this.reset()}.bind(this)),this.searchBarInputNode.addEvents({keydown:function(t){13==t.code&&(this.search(),t.preventDefault())}.bind(this)})},getListType:function(){return this.viewType||this.options.viewType},loadListType:function(){this.listViewTypeNode=new Element("div",{styles:this.css["list"==this.options.viewType?"listViewTypeNode_active":"listViewTypeNode"],events:{click:function(){this.viewType="list",this.listViewTypeNode.setStyles(this.css.listViewTypeNode_active),this.tileViewTypeNode.setStyles(this.css.tileViewTypeNode),this.explorer.loadList(this.explorer.currentView.filterData)}.bind(this)}}).inject(this.toolabrRightNode),this.tileViewTypeNode=new Element("div",{styles:this.css["list"!=this.options.viewType?"tileViewTypeNode_active":"tileViewTypeNode"],events:{click:function(){this.viewType="tile",this.listViewTypeNode.setStyles(this.css.listViewTypeNode),this.tileViewTypeNode.setStyles(this.css.tileViewTypeNode_active),this.explorer.loadList(this.explorer.currentView.filterData)}.bind(this)}}).inject(this.toolabrRightNode)},search:function(){var t=this.searchBarInputNode.get("value"),e=Object.clone(this.explorer.currentView.filterData);t?e.name=t:e.name&&delete e.name,this.explorer.loadList(e)},share:function(){var t=this.explorer.currentView.getCheckedItemData();if(0!=t.length){var e=new MWF.xApplication.Minder.ShareForm(this.explorer,{},{},{app:this.app});e.checkedItemData=t,e.edit()}else this.app.notice("请先选择文件","error")}}),MWF.xApplication.Minder.List=new Class({Extends:MWF.xApplication.Template.Explorer.ComplexView,options:{scrollEnable:!0,scrollType:"window"},_createDocument:function(t,e){return new MWF.xApplication.Minder.Document(this.viewNode,t,this.explorer,this,null,e)},_getCurrentPageData:function(t,e){e||(e=30);var i=this.items.length?this.items[this.items.length-1].data.id:"(0)",s=this.filterData||{};this.sortType&&this.sortField&&(s.orderField=this.sortField,s.orderType=this.sortType),this.actions.listNextMindWithFilter(i,e,s,(function(e){e.data||(e.data=[]),t&&t(e)}))},_removeDocument:function(t,e){this.actions.deleteSubject(t.id,function(t){this.reload(),this.app.notice(this.app.lp.deleteDocumentOK,"success")}.bind(this))},_create:function(){},_openDocument:function(t,e){var i="MinderEditor"+t.id;this.app.desktop.apps[i]?this.app.desktop.apps[i].setCurrent():this.app.desktop.openApplication(null,"MinderEditor",{appId:i,folderId:t.folderId,id:t.id,isEdited:!0,isNew:!1})},_queryCreateViewNode:function(){},_postCreateViewNode:function(t){},_queryCreateViewHead:function(){},_postCreateViewHead:function(t){var e=t.getElement("[item='selectAll']");e&&e.addEvent("click",function(){this.selectedAll?(this.selectAllCheckbox_custom(!1),this.selectedAll=!1,e.setStyles(this.css.tileSelectAllNode)):(this.selectAllCheckbox_custom(!0),this.selectedAll=!0,e.setStyles(this.css.tileSelectAllNode_selected))}.bind(this))},getCheckedItemData:function(){if("tile"==this.viewType)var t=this.getCheckedItems_custom();else t=this.getCheckedItems();var e=[];return t.each((function(t){e.push(t.data)})),e},getCheckedItemIds:function(){if("tile"==this.viewType)var t=this.getCheckedItems_custom();else t=this.getCheckedItems();var e=[];return t.each((function(t){e.push(t.data.id)})),e},selectAllCheckbox_custom:function(t){this.items.each(function(e){e.setSelect(t)}.bind(this))},getCheckedItems_custom:function(){var t=[];return this.items.each(function(e){e.selected&&t.push(e)}.bind(this)),t}}),MWF.xApplication.Minder.Document=new Class({Extends:MWF.xApplication.Template.Explorer.ComplexDocument,mouseoverDocument:function(){(this.node.setStyles(this.css.tileNode_over),this.selected)||this.node.getElement("[item=select]").setStyle("display","")},mouseoutDocument:function(){(this.node.setStyles(this.css.tileNode),this.selected)||this.node.getElement("[item=select]").setStyle("display","none")},_queryCreateDocumentNode:function(t){},_postCreateDocumentNode:function(t,e){var i=t.getElement("[item=select]");(i&&i.addEvent("click",function(t){this.setSelect(!this.selected),t.stopPropagation()}.bind(this)),e.icon)?t.getElement("[item=thumbnail]").set("src",MWF.xDesktop.getImageSrc(e.icon)):t.getElement("[item=thumbnail]").set("src",this.app.path+this.view.options.style+"/icon/default_thumbnail.png")},setSelect:function(t){var e=this.node.getElement("[item=select]");t?(this.selected=!0,e.setStyles(this.css.tileItemSelectNode_selected)):(this.selected=!1,e.setStyles(this.css.tileItemSelectNode))},open:function(t){this.view._openDocument(this.data,this.index)},edit:function(t){var e="MinderEditor"+this.data.id,i=this.app.desktop.apps[e];i?(i.setCurrent(),t&&i.openMainMenu(t)):this.app.desktop.openApplication(null,"MinderEditor",{appId:e,folderId:this.data.folderId,id:this.data.id,isEdited:!0,isNew:!1,menuAction:t})},remove:function(){},showFileVersion:function(t){this.edit("openFileVersion"),t.stopPropagation()},showShareRecord:function(t){this.edit("openShare"),t.stopPropagation()}}),MWF.xApplication.Minder.ShareTooltip=new Class({Extends:MTooltips,options:{style:"",axis:"y",position:{x:"auto",y:"auto"},event:"mouseenter",hiddenDelay:200,displayDelay:0,overflow:"scroll"},_getHtml:function(){var t=this.data,e="font-size:14px;color:#333",i="font-size:14px;color:#666;padding-right:20px";t.name,this.getCn(t.sharePersonList),this.getCn(t.shareUnitList),this.getCn(t.shareGroupList);return""}}),MWF.xApplication.Minder.ShareRecordForm=new Class({Extends:MPopupForm,Implements:[Options,Events],options:{style:"minder",width:"80%",height:"80%",hasTop:!0,hasIcon:!1,draggable:!0,title:"分享记录"},_createTableContent:function(){},_createBottomContent:function(){this.cancelActionNode=new Element("button.inputCancelButton",{styles:this.css.inputCancelButton_long,text:"关闭"}).inject(this.formBottomNode),this.cancelActionNode.addEvent("click",function(t){this.close(t)}.bind(this))}});