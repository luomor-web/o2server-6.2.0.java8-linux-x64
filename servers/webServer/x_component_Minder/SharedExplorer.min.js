MWF.xDesktop.requireApp("Template","Explorer",null,!1),MWF.xDesktop.requireApp("Template","MForm",null,!1),MWF.xDesktop.requireApp("Minder","Common",null,!1),MWF.xApplication.Minder.SharedExplorer=new Class({Extends:MWF.widget.Common,Implements:[Options,Events],options:{style:"default",defaultTreeNode:"root",defaultViewType:"list"},initialize:function(t,e,i){this.setOptions(i),this.path="../x_component_Minder/$MineExplorer/",this.cssPath="../x_component_Minder/$MineExplorer/"+this.options.style+"/css.wcss",this._loadCss(),this.app=e,this.container=$(t)},load:function(){this.rightNode=new Element("div.rightNode",{styles:this.css.rightNode}).inject(this.container),this.toolbarNode=new Element("div",{styles:this.css.toolbarNode}).inject(this.rightNode),this.toolbar=new MWF.xApplication.Minder.Toolbar(this.toolbarNode,this,{availableTool:[["createMinder"],["rename","recycle"],["share"]],viewType:this.options.defaultViewType}),this.toolbar.load(),this.listNode=new Element("div",{styles:this.css.listNode}).inject(this.rightNode),this.loadList({}),this.resizeContent(),this.resizeFun=this.resizeContent.bind(this),this.app.addEvent("resize",this.resizeFun)},destroy:function(){this.container.empty(),this.app.removeEvent("resize",this.resizeFun)},resizeContent:function(){var t=this.app.content.getSize();this.rightNode.setStyle("width",t.x-70),this.listNode.setStyle("height",t.y-92),this.listNode.setStyle("width",t.x-113),this.toolbarNode.setStyle("width",t.x-70)},loadList:function(t){this.currentView&&this.currentView.destroy(),this.currentView=new MWF.xApplication.Minder.SharedExplorer.List(this.listNode,this.app,this,{templateUrl:this.path+this.options.style+("list"==this.getViewType()?"/listItem_shared.json":"/tileItem.json"),scrollEnable:!0}),this.currentView.viewType=this.getViewType(),this.currentView.filterData=t,this.currentView.load()},getViewType:function(){return this.toolbar.getListType()},getCurrentFolderId:function(){return this.tree.getCurrentFolderId()},recordStatus:function(){return{defaultViewType:this.getViewType()}}}),MWF.xApplication.Minder.SharedExplorer.List=new Class({Extends:MWF.xApplication.Minder.List,options:{scrollEnable:!0,scrollType:"window"},_createDocument:function(t,e){return new MWF.xApplication.Minder.Document(this.viewNode,t,this.explorer,this,null,e)},_getCurrentPageData:function(t,e){e||(e=30);var i=this.items.length?this.items[this.items.length-1].data.id:"(0)",s=this.filterData||{};this.sortType&&this.sortField&&(s.orderField=this.sortField,s.orderType=this.sortType),this.actions.listMySharedMind(i,e,s,(function(e){e.data||(e.data=[]),t&&t(e)}))}});