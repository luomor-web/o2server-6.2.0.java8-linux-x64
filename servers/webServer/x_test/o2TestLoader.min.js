function o2TestLoader(){layout.debugger=!0,o2.session.isDebugger=!0,window.Element&&Element.implement({makeLnk:function(o){}}),layout.desktop.addEvent=function(o,t,n){window.addEvent(o,t,n)},layout.desktop.addEvents=function(o){window.addEvents(o)};window.document&&document.body&&document.body.getSize();var o=function(o,t){layout.serviceAddressList=o,layout.centerServer=t,layout.desktop.serviceAddressList=o,layout.desktop.centerServer=t},t=function(t){if("auto"===layout.config.app_protocol&&(layout.config.app_protocol=window.location.protocol),layout.config.configMapping&&(layout.config.configMapping[window.location.host]||layout.config.configMapping[window.location.hostname])){var n=layout.config.configMapping[window.location.host]||layout.config.configMapping[window.location.hostname];n.servers?(layout.serviceAddressList=n.servers,layout.desktop.serviceAddressList=n.servers,n.center&&(center="array"===o2.typeOf(n.center)?n.center[0]:n.center),layout.centerServer=center,layout.desktop.centerServer=center,t&&t()):(n.center&&(layout.config.center="array"===o2.typeOf(n.center)?n.center:[n.center]),o2.xDesktop.getServiceAddress(layout.config,function(n,e){o(n,e),t&&t()}.bind(this)))}else o2.xDesktop.getServiceAddress(layout.config,function(n,e){o(n,e),t&&t()}.bind(this))},n=function(){var o=function(o){for(o&&(layout.user=o.data,layout.session=layout.session||{},layout.session.user=o.data,layout.session.token=o.data.token,layout.desktop.session=layout.session);layout.readys&&layout.readys.length;)layout.readys.shift().apply(window)};layout.sessionPromise=new Promise((function(o,t){o2.Actions.get("x_organization_assemble_authentication").getAuthentication(function(t){o&&o(t.data)}.bind(this),function(o,n,e){t&&t({xhr:o,text:n,error:e})}.bind(this))})),layout.sessionPromise.then((function(t){layout.user=t,layout.session=layout.session||{},layout.session.user=t,layout.session.token=t.token,layout.desktop.session=layout.session,o()}),(function(){if(layout.anonymous){var t={name:"anonymous",roleList:[]};layout.user=t,layout.session=layout.session||{},layout.session.user=t,layout.session.token=t.token,layout.desktop.session=layout.session,o()}else o2Unit.username?o2.Actions.load("x_organization_assemble_authentication").AuthenticationAction.login({credential:o2Unit.username,password:o2Unit.password},function(t){o(t)}.bind(this),function(o,t,n){layout.openLogin()}.bind(this)):layout.openLogin()})),layout.openLogin=function(){layout.desktop.type="app",layout.app=null;var o=$("appContent")||$("layout");o&&o.empty(),layout.authentication=new o2.xDesktop.Authentication({style:"flat",onLogin:n.bind(layout)}),layout.authentication.loadLogin(document.body);var t=$("browser_loading");t&&t.fade("out")}},e=!1,i=!1,s=!1,a=!1,u=o2.session.path+"/lp/"+o2.language+".js";o2.session.isDebugger&&(o2.session.isMobile||layout.mobile)&&o2.load("../o2_lib/eruda/eruda.js");var l=function(){i=!0;o2.require(["o2.widget.Common","o2.widget.Dialog","o2.widget.UUID","o2.xDesktop.Common","o2.xDesktop.Actions.RestActions","o2.xAction.RestActions","o2.xDesktop.Access","o2.xDesktop.Dialog","o2.xDesktop.Menu","o2.xDesktop.UserData","o2.xDesktop.Authentication","o2.xDesktop.Dialog","o2.xDesktop.Window"],{onSuccess:function(){s=!0,e&&s&&i&&a&&t((function(){n()}))}});o2.requireApp([["Template","MPopupForm"],["Common",""]],null,(function(){a=!0,e&&s&&i&&a&&t((function(){n()}))}))};o2.LP?l():o2.load(u,l),(e=!0)&&s&&i&&a&&t((function(){n()}))}o2Unit={init:function(o,t){this.username=o.username,this.password=o.password,layout.anonymous=!0===o.anonymous,this.mode=o.mode||"spa",o2.addReady(o2TestLoader),layout.addReady(function(){this["load_"+this.mode]((function(){t&&t.apply(window)}))}.bind(this))},load_spa:function(o){document.body.appendHTML('<div id="layout_main" style="overflow: hidden; height: 100%; background-position-x: center; background-size: cover;">\n        <div id="layout_top_shim"></div>\n        <div id="layout_top"></div>\n        <div id="layout_desktop">\n            <div id="desktop_content"></div>\n            <div id="desktop_navi"></div>\n        </div>\n    </div>'),layout.inBrowser=!1,layout.desktop.type="layout",layout.viewMode="Default";var t=function(){layout.userLayout={},layout.userLayout.apps={},MWF.require("MWF.xDesktop.Default",(function(){layout.desktop=new MWF.xDesktop.Default("layout_main",{}),layout.desktop.load((function(){o&&o()})),layout.desktop.openApplication||(layout.desktop.openApplication=layout.openApplication),layout.desktop.refreshApp||(layout.desktop.refreshApp=layout.refreshApp)}))};layout.session&&layout.session.user?t():layout.sessionPromise&&layout.sessionPromise.then((function(){t()}),(function(){}))},load_mpa:function(o){document.body.appendHTML('<div id="appContent" style="overflow: hidden; height:100%; background-color:#EEE"></div>'),o&&o()},openApplication:function(o,t,n){var e=n||{};e.onPostLoadApplication=function(){this.runPostLoadApplication=!0,o&&o()},e.postLoad=function(){this.runPostLoadApplication||o&&o()};var i=Array.from(arguments);i.shift(),i.unshift(null),n||i.push(e),layout.openApplication.apply(layout,i)}};