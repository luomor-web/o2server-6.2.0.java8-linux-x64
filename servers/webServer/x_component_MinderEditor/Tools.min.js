MWF.xApplication.MinderEditor=MWF.xApplication.MinderEditor||{},!("innerText"in document.createElement("a"))&&"getSelection"in window&&(HTMLElement.prototype.__defineGetter__("innerText",(function(){var e,t,n=window.getSelection(),r=[];for(t=0;t<n.rangeCount;t++)r[t]=n.getRangeAt(t);for(n.removeAllRanges(),n.selectAllChildren(this),e=n.toString(),n.removeAllRanges(),t=0;t<r.length;t++)n.addRange(r[t]);return e})),HTMLElement.prototype.__defineSetter__("innerText",(function(e){this.innerHTML=(e||"").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>")}))),function(){var e=MWF.xApplication.MinderEditor.KeyMap={Shift:16,Control:17,Alt:18,CapsLock:20,BackSpace:8,Tab:9,Enter:13,Esc:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,Insert:45,Left:37,Up:38,Right:39,Down:40,Direction:{37:1,38:1,39:1,40:1},Del:46,NumLock:144,Cmd:91,CmdFF:224,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"`":192,"=":187,"-":189,"/":191,".":190};for(var t in e)e.hasOwnProperty(t)&&(e[t.toLowerCase()]=e[t]);var n="a".charCodeAt(0);"abcdefghijklmnopqrstuvwxyz".split("").forEach((function(t){e[t]=t.charCodeAt(0)-n+65}));var r=9;do{e[r.toString()]=r+48}while(--r)}(),MWF.xApplication.MinderEditor.Key=function(){function e(e){return"string"==typeof e?(t=0,e.toLowerCase().split(/\s*\+\s*/).forEach((function(e){switch(e){case"ctrl":case"cmd":t|=4096;break;case"alt":t|=8192;break;case"shift":t|=16384;break;default:t|=MWF.xApplication.MinderEditor.KeyMap[e]}})),t):function(e){var t=0;(e.ctrlKey||e.metaKey)&&(t|=4096);e.altKey&&(t|=8192);e.shiftKey&&(t|=16384);if(-1===[16,17,18,91].indexOf(e.keyCode)){if(229===e.keyCode&&e.keyIdentifier)return t|=parseInt(e.keyIdentifier.substr(2),16);t|=e.keyCode}return t}(e);var t}this.hash=e,this.is=function(t,n){return t&&n&&e(t)==e(n)}},MWF.xApplication.MinderEditor.Format=function(e,t){return"object"!=typeof t&&(t=[].slice.call(arguments,1)),String(e).replace(/\{(\w+)\}/gi,(function(e,n){return t[n]||n}))},MWF.xApplication.MinderEditor.Debug=function(e){if(this.flaged=-1!=window.location.search.indexOf(e)){var t=function(e){for(var t=0,n=0;n<e.length;n++)t+=e.charCodeAt(n);return t}(e)%360,n=MWF.xApplication.MinderEditor.Format("background: hsl({0}, 50%, 80%); color: hsl({0}, 100%, 30%); padding: 2px 3px; margin: 1px 3px 0 0;border-radius: 2px;",t),r="background: none; color: black;";this.log=function(){var t=MWF.xApplication.MinderEditor.Format.apply(null,arguments);console.log(MWF.xApplication.MinderEditor.Format("%c{0}%c{1}",e,t),n,r)}}else this.log=function(){}},MWF.xApplication.MinderEditor.JsonDiff=function(e,t){
/*!
     * https://github.com/Starcounter-Jack/Fast-JSON-Patch
     * json-patch-duplex.js 0.5.0
     * (c) 2013 Joachim Wester
     * MIT license
     */
var n=Object.keys?Object.keys:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};function r(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function i(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):e}var o=[];return function e(t,o,a,c){for(var l=n(o),p=n(t),d=!1,f=p.length-1;f>=0;f--){var s=t[h=p[f]];if(o.hasOwnProperty(h)){var u=o[h];"object"==typeof s&&null!=s&&"object"==typeof u&&null!=u?e(s,u,a,c+"/"+r(h)):s!=u&&(!0,a.push({op:"replace",path:c+"/"+r(h),value:i(u)}))}else a.push({op:"remove",path:c+"/"+r(h)}),d=!0}if(d||l.length!=p.length)for(f=0;f<l.length;f++){var h=l[f];t.hasOwnProperty(h)||a.push({op:"add",path:c+"/"+r(h),value:i(o[h])})}}(e,t,o,""),o};