MWF.xApplication.Selector=MWF.xApplication.Selector||{},MWF.xDesktop.requireApp("Selector","Person",null,!1),MWF.xApplication.Selector.FormStyle=new Class({Extends:MWF.xApplication.Selector.Person,options:{style:"default",count:0,title:"",values:[],names:[],expand:!1,mode:"pc",forceSearchInItem:!0},setInitTitle:function(){this.options.title||this.setOptions({title:MWF.xApplication.Selector.LP.selectFormStyle})},_init:function(){this.selectType="formstyle",this.className="FormStyle"},loadSelectItems:function(t){MWF.getJSON("../x_component_process_FormDesigner/Module/Form/skin/config.json",{onSuccess:function(t){var e=[];Object.each(t,function(t,i){t.mode.contains(this.options.mode)&&e.push({name:t.name,id:i})}.bind(this));this._newItemCategory({name:MWF.SelectorLP.systemStyle,id:"stystem",subItemList:e},this,this.itemAreaNode),t={};var i=[];o2.Actions.load("x_processplatform_assemble_designer").ScriptAction.listPaging(1,1e3,{},function(e){for(var s in e.data.each(function(e){t[e.application]||(t[e.application]={name:e.applicationName,applicationName:e.applicationName,appName:e.applicationName,application:e.application,appId:e.application},t[e.application].scriptList=[]),e.appName=e.applicationName,e.appId=e.application,e.type="script",t[e.application].scriptList.push(e)}.bind(this)),t)t[s].scriptList&&t[s].scriptList.length&&(t[s].scriptList.sort((function(t,e){return(t.name||"").localeCompare(e.name||"")})),i.push(t[s]));i.sort((function(t,e){return(t.name||"").localeCompare(e.name||"")}));this._newItemCategory({name:MWF.SelectorLP.customStyle,id:"script",applicationList:i},this,this.itemAreaNode)}.bind(this))}.bind(this)})},_scrollEvent:function(t){return!0},_getChildrenItemIds:function(t){return t.scriptList||t.subItemList||t.applicationList},_newItemCategory:function(t,e,i,s){return new MWF.xApplication.Selector.FormStyle.ItemCategory(t,e,i,s)},_listItemByKey:function(t,e,i){return!1},_getItem:function(t,e,i,s){this.queryAction.getTable(function(e){t&&t.apply(this,[e])}.bind(this),e,"string"===typeOf(i)?i:i.id,s)},_newItemSelected:function(t,e,i){return new MWF.xApplication.Selector.FormStyle.ItemSelected(t,e,i)},_listItemByPinyin:function(t,e,i){return!1},_newItem:function(t,e,i,s){return new MWF.xApplication.Selector.FormStyle.Item(t,e,i,s)}}),MWF.xApplication.Selector.FormStyle.Item=new Class({Extends:MWF.xApplication.Selector.Person.Item,_getShowName:function(){return this.data.name},_setIcon:function(){this.iconNode.setStyle("background-image","url(../x_component_Selector/$Selector/default/icon/attr.png)")},loadSubItem:function(){return!1},checkSelectedSingle:function(){this.selector.options.values.filter(function(t,e){return"object"===typeOf(t)&&this.data.id&&t.id?this.data.id===t.id:"string"===typeOf(t)&&(this.data.id===t||this.data.name===t)}.bind(this)).length&&this.selectedSingle()},checkSelected:function(){var t=this.selector.selectedItems.filter(function(t,e){if(t.data.id&&this.data.id)return t.data.id===this.data.id}.bind(this));t.length&&(t[0].addItem(this),this.selectedItem=t[0],this.setSelected())}}),MWF.xApplication.Selector.FormStyle.ItemSelected=new Class({Extends:MWF.xApplication.Selector.Person.ItemSelected,_getShowName:function(){return this.data.name},_setIcon:function(){this.iconNode.setStyle("background-image","url(../x_component_Selector/$Selector/default/icon/attr.png)")},check:function(){if(this.selector.items.length){var t=this.selector.items.filter(function(t,e){if(t.data.id&&this.data.id)return t.data.id===this.data.id}.bind(this));this.items=t,t.length&&t.each(function(t){t.selectedItem=this,t.setSelected()}.bind(this))}}}),MWF.xApplication.Selector.FormStyle.ItemCategory=new Class({Extends:MWF.xApplication.Selector.Person.ItemCategory,clickItem:function(t){if(this._hasChild()){var e=!this.loaded;this.loadSub(function(){e&&this._hasChild()?this.selector.isFlatCategory||(this.children.setStyles({display:"block",height:"auto"}),this.actionNode.setStyles(this.selector.css.selectorItemCategoryActionNode_expand),this.isExpand=!0):"none"===this.children.getStyle("display")?(this.children.setStyles({display:"block",height:"auto"}),this.actionNode.setStyles(this.selector.css.selectorItemCategoryActionNode_expand),this.isExpand=!0):(this.children.setStyles({display:"none",height:"0px"}),this.actionNode.setStyles(this.selector.css.selectorItemCategoryActionNode_collapse),this.isExpand=!1);t&&t()}.bind(this))}},loadSub:function(t){this.loaded||(this.data.subItemList&&this.data.subItemList.each(function(t,e){var i=this.selector._newItem(t,this.selector,this.children,this.level+1,this);this.selector.items.push(i),this.subItems&&this.subItems.push(i)}.bind(this)),this.data.scriptList&&this.data.scriptList.each(function(t,e){var i=this.selector._newItem(t,this.selector,this.children,this.level+1,this);this.selector.items.push(i),this.subItems&&this.subItems.push(i)}.bind(this)),this.data.applicationList&&this.data.applicationList.each(function(t,e){var i=this.selector._newItemCategory(t,this.selector,this.children,this.level+1,this);this.subCategorys.push(i)}.bind(this)),this.loaded=!0),t&&t()},_getShowName:function(){return this.data.name},_getTtiteText:function(){return this.data.name},createNode:function(){this.node=new Element("div",{styles:this.selector.css.selectorItemCategory_department}).inject(this.container)},_setIcon:function(){this.iconNode.setStyle("background-image","url(../x_component_Selector/$Selector/default/icon/applicationicon.png)")},_hasChild:function(){return this.data.scriptList&&this.data.scriptList.length||this.data.subItemList&&this.data.subItemList.length||this.data.applicationList&&this.data.applicationList.length},afterLoad:function(){this._hasChild()&&this.clickItem()},check:function(){}});