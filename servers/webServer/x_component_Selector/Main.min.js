MWF.require("MWF.widget.JsonTemplate",null,!1),MWF.xApplication.Selector.Main=new Class({Extends:MWF.xApplication.Common.Main,Implements:[Options,Events],options:{style:"default",name:"Selector",icon:"icon.png",width:"800",height:"700",isResize:!1,isMax:!1,title:""},onQueryLoad:function(){this.setOptions({title:MWF.xApplication.Selector.LP.title}),this.lp=MWF.xApplication.Selector.LP},loadApplication:function(t){this.node=new Element("div",{styles:{padding:"20px","text-align":"center"}}).inject(this.content),this.optionsNode=new Element("textarea",{styles:{width:"90%",display:"block",height:"160px"}}).inject(this.node);var e=new Element("div",{styles:{height:"30px","margin-top":"10px","text-align":"left"}}).inject(this.node);this.buttonNode=new Element("button",{text:"select",styles:{width:"150px",height:"30px"}}).inject(e),this.buttonMobileNode=new Element("button",{text:"selectMobile",styles:{width:"150px",height:"30px"}}).inject(e),this.resaultNode=new Element("div",{styles:{height:"410px",overflow:"auto","margin-top":"10px","background-color":"#ffffff",border:"1px solid #666666",display:"block"}}).inject(this.node);this.optionsNode.set("value",'{\n\t"count": 0, \n\t"type": "identity", \n\t"title": "Select Person",\n\t"groups": [], \n\t"roles": [],\n\t"dutys" : [], \n\t"units": [],\n\t"unitType": "",\n\t"values": []\n}'),this.buttonNode.addEvent("click",function(){this.select()}.bind(this)),this.buttonMobileNode.addEvent("click",function(){this.selectMobile()}.bind(this))},select:function(t){var e=this.optionsNode.get("value"),i=JSON.decode(e);i.values.length||(i.values=this.values||[]),i.onComplete=function(e){var i=[];this.values=[],e.each(function(t){this.values.push(t.data.distinguishedName||t.data.name),i.push(t.data)}.bind(this)),this.resaultNode.empty(),MWF.require("MWF.widget.JsonParse",function(){new MWF.widget.JsonParse(i,this.resaultNode,null).load()}.bind(this)),t&&t()}.bind(this),i.onCancel=function(){t&&t()},MWF.xDesktop.requireApp("Selector","package",function(){new MWF.O2Selector(this.content,i)}.bind(this))},selectMobile:function(){layout.mobile||(layout.mobile=!0),this.select(function(){layout.mobile=!1}.bind(this))}});