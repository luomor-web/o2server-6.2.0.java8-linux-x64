MWF.xDesktop.requireApp("process.Xform","$Module",null,!1),MWF.require("MWF.widget.Tab",null,!1),MWF.xApplication.process.Xform.Tab=MWF.APPTab=new Class({Extends:MWF.APP$Module,_loadUserInterface:function(){this.elements=[],this.containers=[];var t="form";layout.mobile&&(t="mobileForm"),this.tab=new MWF.widget.Tab(this.node,{style:t}),this._setTabWidgetStyles(),this.tab.tabNodeContainer=this.node.getFirst("div"),this.tab.contentNodeContainer=this.tab.tabNodeContainer.getNext("div");var e,o=this.tab.tabNodeContainer.getLast();if(o&&o.hasClass("tabNodeContainerLeft")){this.tab.tabNodeContainerRight=this.tab.tabNodeContainer.getFirst(),this.tab.tabNodeContainerLeft=o,this.tab.tabNodeContainerArea=o.getFirst();var s=this.node.getElement(".MWFMenu");s&&s.destroy(),this.tab.load(),e=this.tab.tabNodeContainerArea.getChildren("div")}else e=this.tab.tabNodeContainer.getChildren("div"),this.tab.load();var n=this.tab.contentNodeContainer.getChildren("div");e.each(function(t,e){this.tab.rebuildTab(n[e],n[e].getFirst(),t)}.bind(this)),this.tab.pages[0]._showTab(),this.loadSubModule()},loadSubModule:function(){this.tab.pages.each(function(t){var e=t.tabNode,o=this.form._getDomjson(e),s=this,n=this.form._loadModule(o,e,(function(){this.tab=s}));if(this.elements.push(n),this.form.modules.push(n),t.isShow)this.showContentModule.call(t,this);else if(this.json.isDelay){var i=this;t.showContentModuleFun=function(){i.showContentModule.call(t,i)},t.addEvent("show",t.showContentModuleFun)}else this.showContentModule.call(t,this)}.bind(this))},showContentModule:function(t){var e=this.contentNode;e.isLoadModule=!0,json=t.form._getDomjson(e),tab=t,module=t.form._loadModule(json,e,(function(){this.tab=tab})),t.containers.push(module),t.form.modules.push(module),this.showContentModuleFun&&this.removeEvent("show",this.showContentModuleFun)},_setTabWidgetStyles:function(){this.json.tabNodeContainer&&(this.tab.css.tabNodeContainer=Object.clone(this.json.tabNodeContainer)),this.json.contentNodeContainer&&(this.tab.css.contentNodeContainer=Object.clone(this.json.contentNodeContainer)),this.tab.css.tabNode=Object.clone(this.json.tabStyles),this.tab.css.tabTextNode=Object.clone(this.json.tabTextStyles),this.tab.css.tabNodeCurrent=Object.clone(this.json.tabCurrentStyles),this.tab.css.tabTextNodeCurrent=Object.clone(this.json.tabTextCurrentStyles)}}),MWF.xApplication.process.Xform.tab$Page=MWF.APPTab$Page=new Class({Extends:MWF.APP$Module}),MWF.xApplication.process.Xform.tab$Content=MWF.APPTab$Content=new Class({Extends:MWF.APP$Module,_loadUserInterface:function(){this.form._loadModules(this.node)}});