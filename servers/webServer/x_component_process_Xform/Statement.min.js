MWF.xDesktop.requireApp("process.Xform","$Module",null,!1),MWF.xApplication.process.Xform.Statement=MWF.APPStatement=new Class({Extends:MWF.APP$Module,options:{moduleEvents:["load","beforeLoadView","loadView","queryLoad","postLoad","select","openDocument"]},_loadUserInterface:function(){MWF.xDesktop.requireApp("query.Query","Statement",null,!1),this.node.empty()},_afterLoaded:function(){this.json.queryStatement&&this.loadView()},reload:function(){this.view&&(this.view.loadViewRes&&this.view.loadViewRes.res&&this.view.loadViewRes.res.isRunning()&&this.view.loadViewRes.res.cancel(),this.view.getViewRes&&this.view.getViewRes.res&&this.view.getViewRes.res.isRunning()&&this.view.getViewRes.res.cancel()),this.node.empty(),this.loadView()},active:function(){this.view?this.view.loadingAreaNode||this.view.loadView():this.loadView()},loadView:function(){if(!this.json.queryStatement)return"";var e=null;this.json.filterList&&this.json.filterList.length&&(e=[],this.json.filterList.each(function(t){t.value=this.form.Macro.exec(t.code.code,this),e.push(t)}.bind(this)));var t={application:this.json.queryStatement?this.json.queryStatement.appName:this.json.application,statementName:this.json.queryStatement?this.json.queryStatement.name:this.json.statementName,statementId:this.json.queryStatement?this.json.queryStatement.id:this.json.statementId,isTitle:this.json.isTitle||"yes",select:this.json.select||"none",titleStyles:this.json.titleStyles,itemStyles:this.json.itemStyles,isExpand:this.json.isExpand||"no",showActionbar:"show"===this.json.actionbar,filter:e,defaultSelectedScript:this.json.defaultSelectedScript?this.json.defaultSelectedScript.code:null,selectedAbleScript:this.json.selectedAbleScript?this.json.selectedAbleScript.code:null};this.fireEvent("beforeLoadView",[t]),this.view=new MWF.xApplication.query.Query.Statement(this.node,t,{isload:"no"!==this.json.loadView,resizeNode:"auto"!==this.node.getStyle("height").toString().toLowerCase()&&this.node.getStyle("height").toInt()>0,onLoadView:function(){this.fireEvent("loadView")}.bind(this),onSelect:function(){this.fireEvent("select")}.bind(this),onOpenDocument:function(e,t){this.openOptions={options:e,item:t},this.fireEvent("openDocument"),this.openOptions=null}.bind(this)},this.form.app,this.form.Macro)},getData:function(){if(this.view.selectedItems.length){var e=[];return this.view.selectedItems.each((function(t){e.push(t.data)})),e}return[]}});