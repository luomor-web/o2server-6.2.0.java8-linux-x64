MWF.xDesktop.requireApp("process.ProcessDesigner","Property",null,!1),MWF.xApplication.process.ProcessDesigner.Activity=new Class({initialize:function(t,s){this.data=t,this.process=s,this.paper=this.process.paper,this.data.edition||(this.data.edition=(new o2.widget.UUID).toString()),this.routes=[],this.fromRoutes=[],this.setType(),this.setStyle(),this.setSize(),this.getPoint(),this.selectedMultiStatus=!1,this.positionLoaded=!1},setType:function(){this.type="activity",this.data.type="activity"},setStyle:function(){this.style=this.process.css.activity.default},setSize:function(){var t=MWF.getTextSize(this.data.name,this.style.text);this.width=t.x+38,this.width=this.width<100?100:this.width,this.height=40},getPoint:function(){this.paperSize=$(this.paper.canvas).getParent().getSize(),this.paperOriginalSize={x:.99*this.paperSize.x,y:.99*this.paperSize.y};var t=this.paperSize.y,s=this.paperSize.x;this.top=t/2,this.left=s/2,this.center={x:this.left,y:this.top},this.point={x:this.left-this.width/2,y:this.top-this.height/2}},resetPoint:function(){this.center={x:this.point.x+this.width/2,y:this.point.y+this.height/2}},checkUUID:function(){for(var t=0;t<this.routes.length;t++)delete this.process.routes[this.routes[t].data.id],delete this.process.routeDatas[this.routes[t].data.id],this.routes[t].data.id=this.process.checkUUIDs.pop().id,this.routes[t].data.process=this.process.process.id,this.setRouteData(this.routes[t].data.id,t),this.routes[t].data.activity=this.routes[t].toActivity.data.id,this.process.routes[this.routes[t].data.id]=this.routes[t],this.process.routeDatas[this.routes[t].data.id]=this.routes[t].data},loaded:function(t){this.positionLoaded&&t&&t()},load:function(t){this.process.isNewProcess&&(this.data.createTime=(new Date).format("db"),this.data.updateTime=(new Date).format("db")),this.draw(),this.setActivityPosition(function(){this.positionLoaded=!0,this.loaded(t)}.bind(this)),this.setEvent(),this.process.activityListNode&&this.addToActivityList()},addToActivityList:function(){this.listItem=new MWF.APPPD.Activity.List(this),this.listItem.load()},create:function(t){this.point=t||{x:100,y:100},this.center={x:this.point.x+this.width/2,y:this.point.y+this.height/2},this.draw(),this.setEvent(),this.process.activityListNode&&this.addToActivityList()},setEvent:function(){this.process.options.isView||(this.set.drag(function(t,s,i,e,h){h.rightClick||(this.process.selectedActivitys.length?(this.noselected=!0,this.process.selectedActivitys.each((function(h){h.activityMove(t,s,i,e)}))):this.activityMove(t,s,i,e))}.bind(this),function(t,s,i){i.rightClick||(this.process.selectedActivitys.length?this.process.selectedActivitys.each((function(t){t.activityMoveStart()})):this.activityMoveStart())}.bind(this),function(t){t.rightClick||(this.process.selectedActivitys.length?this.process.selectedActivitys.each((function(t){t.activityMoveEnd()})):this.activityMoveEnd())}.bind(this)),this.set.click(function(t){this.process.isCreateRoute?this.checkCreateRoute():this.process.selectedActivitys.length&&(this.noselected||this.process.currentSelected!=this&&this.selected(),this.noselected=!1),t.stopPropagation()}.bind(this)),this.set.dblclick(function(){this.quickCreateRoute()}.bind(this)),this.set.mousedown(function(t){this.process.isCreateRoute?this.checkCreateRoute():this.process.selectedActivitys.length||this.process.currentSelected!=this&&this.selected(),t.stopPropagation()}.bind(this)),this.set.hover(this.mouseHover.bind(this),function(){(this.process.isCreateRoute||this.process.isCopyRoute||this.process.isChangeRouteTo||this.process.isChangeRouteFrom)&&this.shap.attr(this.style.shap)}.bind(this)),this.set.mouseup(function(){this.mouseUp()}.bind(this)))},mouseHover:function(){(this.process.isCreateRoute||this.process.isCopyRoute||this.process.isChangeRouteTo||this.process.isChangeRouteFrom)&&this.shap.attr({"stroke-width":"2"})},mouseUp:function(){this.process.isChangeRouteTo&&(this.process.currentChangeRoute.setActivity(this,null),this.process.currentChangeRoute.isBack=!1,this.process.currentChangeRoute.positionPoints=this.process.currentChangeRoute.getRoutePoint(),this.process.currentChangeRoute.reload(),this.process.isChangeRouteTo=!1,this.process.currentChangeRoute=null),this.process.isChangeRouteFrom&&(this.process.currentChangeRoute.setActivity(null,this),this.process.currentChangeRoute.isBack=!1,this.process.currentChangeRoute.positionPoints=this.process.currentChangeRoute.getRoutePoint(),this.process.currentChangeRoute.reload(),this.process.isChangeRouteFrom=!1,this.process.currentChangeRoute=null),this.shap.attr(this.style.shap)},quickCreateRoute:function(){this.process.createRoute(),this.process.routeCreateFromActivity(this)},checkCreateRoute:function(){this.process.isCreateRoute&&(this.process.currentCreateRoute.fromActivity?this.process.routeCreateToActivity(this):this.process.routeCreateFromActivity(this));this.process.isCopyRoute&&this.process.routeAddFromActivity(this)},draw:function(){this.set=this.paper.set(),this.shap=this.createShap(),this.text=this.createText(),this.icon=this.createIcon(),this.set.push(this.shadow,this.shap,this.text,this.icon)},redraw:function(){this.setSize(),this.resetPoint(),this.shap&&this.redrawShap(),this.text&&this.redrawText(),this.icon&&this.redrawIcon(),this.bBox&&this.redrawBox(),this.listItem&&this.redrawListItem(),this.redrawRoute()},careteShadow:function(){var t;return(t=this.shap.glow({width:10,fill:!0,opacity:.2,offsetx:0,offsety:0,color:"#aaa"})).data("bind",this),t},createShap:function(){var t;return(t=this.paper.rectPath(this.point.x,this.point.y,this.width,this.height,this.style.shap.radius)).attr(this.style.shap),t.data("bind",this),t},createText:function(){var t=this.getTextIconPoint();return text=this.paper.text(t.tatt.x,t.tatt.y,this.data.name),text.attr(this.style.text),"none"==this.style.text.display&&text.hide(),text},createIcon:function(){var t=this.getTextIconPoint(),s=this.paper.image(this.style.icon.src,t.iatt.x,t.iatt.y,16,16);return s.attr(this.style.icon.attr),s},redrawShap:function(){var t=MWFRaphael.getRectPath(this.point.x,this.point.y,this.width,this.height,this.style.shap.radius);this.shap.attr("path",t)},redrawText:function(){var t=this.getTextIconPoint();this.text.attr({x:t.tatt.x,y:t.tatt.y,text:this.data.name})},redrawIcon:function(){var t=this.getTextIconPoint();this.icon.attr({x:t.iatt.x,y:t.iatt.y})},redrawBox:function(){this.set.exclude(this.bBox),this.bBox.remove(),this.bBox=null;var t=this.set.getBBox();this.bBox=this.paper.rectPath(t.x-3,t.y-3,t.width+6,t.height+6,0),this.bBox.attr(this.process.css.activity.box),this.set.push(this.bBox)},redrawListItem:function(){this.listItem.row.tds[1].set("text",this.data.name)},loadRoutes:function(){this.getRoutedata().each(function(t){this.process.routes[t]&&(this.routes.push(this.process.routes[t]),this.process.routes[t].setActivity(null,this),this.process.routes[t].load())}.bind(this))},getRoutedata:function(){return this.data.routeList||(this.data.routeList=[]),this.data.routeList=this.data.routeList.clean(),this.data.routeList},setRouteData:function(t,s){var i=s||0==s?s:null;(this.data.routeList||(this.data.routeList=[]),null!=i&&i<=this.data.routeList.length)?-1==this.data.routeList.indexOf(t)&&(this.data.routeList[i]=t):-1==this.data.routeList.indexOf(t)&&this.data.routeList.push(t)},removeRouteData:function(t){this.data.routeList||(this.data.routeList=[]),this.data.routeList.erase(t)},redrawRoute:function(t){this.routes.each((function(s){s.reload(t,null)})),this.fromRoutes.each((function(s){s.reload(null,t)}))},activityMove:function(t,s,i,e){this.set.isFront||(this.set.toFront(),this.set.isFront=!0),this.set.ox+t<0&&(t=0-this.set.ox),this.set.ox+t+this.width>this.paperSize.x&&(this.paperSize.x=this.set.ox+t+this.width,this.paper.setSize(this.paperSize.x,this.paperSize.y),$(this.paper.canvas).getParent().setStyle("width",this.paperSize.x+"px")),this.set.oy+s<0&&(s=0-this.set.oy),this.set.oy+s+this.height>this.paperSize.y&&(this.paperSize.y=this.set.oy+s+this.height,this.paper.setSize(this.paperSize.x,this.paperSize.y),$(this.paper.canvas).getParent().setStyle("height",this.paperSize.y+"px"));var h=Raphael.snapTo(10,this.set.ox+t+this.width/2,10),o=Raphael.snapTo(10,this.set.oy+s+this.height/2,10);if(t=h-this.set.ox-this.width/2,s=o-this.set.oy-this.height/2,path=Raphael.transformPath(this.set.shapPath,"t"+t+","+s),this.shap.attr("path",path),this.bBox){var r=this.shap.getBBox();boxPath=MWFRaphael.getRectPath(r.x-3,r.y-3,r.width+6,r.height+6,0),this.bBox.attr("path",boxPath)}this.point={x:this.set.ox+t,y:this.set.oy+s},this.center={x:this.set.ox+t+this.width/2,y:this.set.oy+s+this.height/2};var a=this.getMoveTextIconPoint();this.text.attr(a.tatt),this.icon.attr(a.iatt),this.routes.each(function(i){-1!=this.process.selectedActivitys.indexOf(i.toActivity)&&i.corners.each(function(e,h){var o=e.data("point"),r=o.x.toFloat()+t.toFloat(),a=o.y.toFloat()+s.toFloat(),n=MWFRaphael.getRectPath(r-2.5,a-2.5,5,5,0);e.attr("path",n),i.positionPoints[h]={x:r,y:a}}.bind(this))}.bind(this)),this.set.movex=t,this.set.movey=s,this.redrawRoute(),this.paper.safari()},activityMoveStart:function(){this.set.isFront=!1;var t=this.shap.getBBox();this.set.ox=t.x,this.set.oy=t.y,this.set.movex=0,this.set.movey=0,this.set.animate({"fill-opacity":.5},500),this.set.shapPath=this.shap.attr("path"),this.bBox&&(this.set.boxPath=this.bBox.attr("path")),this.routes.each(function(t){-1!=this.process.selectedActivitys.indexOf(t.toActivity)&&t.corners.each(function(s,i){var e=t.positionPoints[i];s.data("point",e)}.bind(this))}.bind(this))},activityMoveEnd:function(){this.center.x=this.center.x.toInt(),this.center.y=this.center.y.toInt(),this.data.position=this.center.x+","+this.center.y,this.set.animate({"fill-opacity":1},500)},setActivityPosition:function(t){var s,i;if(this.data.position){var e=this.data.position.split(/(?:,\s*){1}|(?:;\s*){1}/g);s=e[0],i=e[1]}else{var h=Math.random();s=((this.paperSize.x-300)*h).toInt();var o=Math.random();i=((this.paperSize.y-300)*o).toInt(),this.data.position=s+","+i}this.reSizePaper(s,i),this.setPosition(s.toFloat(),i.toFloat(),null,t)},reSizePaper:function(t,s){s=s.toFloat()+this.height.toFloat(),(t=t.toFloat()+this.width.toFloat())>this.paperSize.x&&(this.paper.setSize(.99*t,this.paperSize.y),$(this.paper.canvas).getParent().setStyle("width",t+"px"),this.paperSize.x=t),s>this.paperSize.y&&(this.paper.setSize(.99*this.paperSize.x,s),$(this.paper.canvas).getParent().setStyle("height",s+"px"),this.paperSize.y=s)},setPosition:function(t,s,i,e){t=t.toFloat(),s=s.toFloat(),i||(i=300);var h=t-this.center.x.toFloat(),o=s-this.center.y.toFloat();this.center={x:t,y:s},this.point={x:t-this.width/2,y:s-this.height/2};var r=this.shap.attr("path"),a=(r=Raphael.transformPath(r,"t"+h+","+o),this.getTextIconPoint());this.shap.animate({path:r},i,"<>",e),this.text.animate(a.tatt,i,"<>"),this.icon.animate(a.iatt,i,"<>")},getTextIconPoint:function(){return{tatt:{x:this.center.x+10,y:this.center.y},iatt:{x:this.center.x-this.width/2+8,y:this.center.y-8}}},getMoveTextIconPoint:function(){return this.getTextIconPoint()},showProperty:function(){this.property?this.property.show():(this.property=new MWF.APPPD.Activity.Property(this,{onPostLoad:function(){this.property.show()}.bind(this)}),this.property.load())},selectedMulti:function(){if(!this.bBox){var t=this.shap.getBBox();this.bBox=this.paper.rectPath(t.x-3,t.y-3,t.width+6,t.height+6,0),this.bBox.attr(this.process.css.activity.box),this.set.push(this.bBox)}this.process.selectedActivitys.push(this),this.process.selectedActivityDatas.push(this.data),this.listItem&&this.listItem.listUnSelected(),this.property&&this.property.hide(),this.selectedMultiStatus=!0},unSelectedMulti:function(){this.bBox&&(this.set.exclude(this.bBox),this.bBox.remove(),this.bBox=null),this.selectedMultiStatus=!1},selected:function(){try{this.process.designer.paperInNode.focus()}catch(t){}this.activitySelected(),this.listItem&&this.listItem.listSelected(),window.setTimeout(function(){this.showProperty()}.bind(this),10)},unSelected:function(){this.activityUnSelected(),this.listItem&&this.listItem.listUnSelected(),this.property&&this.property.hide()},showQuickAction:function(){this.getQuickActionJson(function(){this.quickActionJson.each(function(t,s){var i=this.point.y-20,e=this.point.x+20*s;this.paper.image(this.process.path+this.process.options.style+"/quickAction/"+t.icon,e,i,16,16).toFront()}.bind(this))}.bind(this))},getQuickActionJson:function(t){this.quickActionJson?t&&t():MWF.getJSON(this.process.path+"action.json",{onSuccess:function(s){var i=s.default,e=s[this.type];this.quickActionJson=i.concat(e),t&&t()}.bind(this),onerror:function(t){this.notice(t,"error")}.bind(this),onRequestFailure:function(t){this.notice(t.responseText,"error")}.bind(this)})},activitySelected:function(){if(this.process.unSelectedAll(),!this.bBox){var t=this.shap.getBBox();this.bBox=this.paper.rectPath(t.x-3,t.y-3,t.width+6,t.height+6,0),this.bBox.attr(this.process.css.activity.box),this.set.push(this.bBox)}this.process.currentSelected=this},activityUnSelected:function(){this.process.currentSelected=null,this.bBox&&(this.set.exclude(this.bBox),this.bBox.remove(),this.bBox=null)},addRouteData:function(t){-1==this.data.routeList.indexOf(t)&&this.data.routeList.push(t)},destroy:function(){"begin"==this.type&&(this.process.begin=null,this.process.process.begin=null),this.routes.each((function(t){t.destroy()})),this.fromRoutes.each((function(t){t.destroy()})),this.listItem&&this.listItem.row.tr.destroy();var t={};for(aid in this.process[this.type+"s"])aid!=this.data.id?t[aid]=this.process[this.type+"s"][aid]:this.process[this.type+"s"][aid]=null;this.process[this.type+"s"]=null,this.process[this.type+"s"]=t,this.process.activitys.erase(this),this.process.process[this.type+"List"]&&this.process.process[this.type+"List"].erase(this.data),this.set.remove()}}),MWF.APPPD.Activity.SingleRouter=new Class({Extends:MWF.APPPD.Activity,getRoutedata:function(){return this.data.route||(this.data.route=""),[this.data.route]},setRouteData:function(t){this.data.route||(this.data.route=""),this.data.route=t},removeRouteData:function(t){this.data.route=""},quickCreateRoute:function(){this.routes.length||(this.process.createRoute(),this.process.routeCreateFromActivity(this))},checkCreateRoute:function(){this.process.isCreateRoute&&(this.process.currentCreateRoute.fromActivity?this.process.routeCreateToActivity(this):this.routes.length||this.process.routeCreateFromActivity(this));this.process.isCopyRoute&&(this.routes.length||this.process.routeAddFromActivity(this))},mouseHover:function(){this.process.isCreateRoute&&(this.process.currentCreateRoute.fromActivity?this.shap.attr({"stroke-width":"2"}):this.routes.length||this.shap.attr({"stroke-width":"2"}));this.process.isChangeRouteTo&&this.shap.attr({"stroke-width":"2"}),(this.process.isChangeRouteFrom||this.process.isCopyRoute)&&(this.routes.length||this.shap.attr({"stroke-width":"2"}))},mouseUp:function(){this.process.isChangeRouteTo&&(this.process.currentChangeRoute.setActivity(this,null),this.process.currentChangeRoute.isBack=!1,this.process.currentChangeRoute.positionPoints=this.process.currentChangeRoute.getRoutePoint(),this.process.currentChangeRoute.reload(),this.process.isChangeRouteTo=!1,this.process.currentChangeRoute=null),this.process.isChangeRouteFrom&&(this.routes.length||(this.process.currentChangeRoute.setActivity(null,this),this.process.currentChangeRoute.isBack=!1,this.process.currentChangeRoute.positionPoints=this.process.currentChangeRoute.getRoutePoint(),this.process.currentChangeRoute.reload(),this.process.isChangeRouteFrom=!1,this.process.currentChangeRoute=null)),this.shap.attr(this.style.shap)},addRouteData:function(t){this.data.route||(this.data.route=t)}}),MWF.APPPD.Activity.Circle=new Class({Extends:MWF.APPPD.Activity,setSize:function(){if("none"==this.style.text.display)this.width=this.style.shap.width,this.height=this.style.shap.height,this.radius=this.style.shap.radius;else{var t=MWF.getTextSize(this.data.name,this.style.text);this.radius=t.x/2+10,this.radius=this.radius<20?20:this.radius,this.width=this.height=2*this.radius}},reSizePaper:function(t,s){s=s.toFloat()+this.height.toFloat()/2,(t=t.toFloat()+this.width.toFloat()/2)>this.paperSize.x&&(this.paper.setSize(.99*t,this.paperSize.y),$(this.paper.canvas).getParent().setStyle("width",t+"px"),this.paperSize.x=t),s>this.paperSize.y&&(this.paper.setSize(.99*this.paperSize.x,s),$(this.paper.canvas).getParent().setStyle("height",s+"px"),this.paperSize.y=s)},resetPoint:function(){this.point={x:this.center.x-this.width/2,y:this.center.y-this.height/2}},createShap:function(){var t;return(t=this.paper.circlePath(this.center.x,this.center.y,this.radius)).attr(this.style.shap),t.data("bind",this),t},redrawText:function(){return!0},redrawShap:function(){var t=MWFRaphael.getCirclePath(this.center.x,this.center.y,this.radius);this.shap.attr("path",t)},getOffset:function(){return{tx:6,ty:0,ix:-8,iy:-8}},getTextIconPoint:function(){var t=this.getOffset();return"none"==this.style.text.display?{tatt:{x:this.center.x+t.tx,y:this.center.y+t.ty},iatt:{x:this.center.x+t.ix,y:this.center.y+t.iy}}:{tatt:{x:this.center.x+6,y:this.center.y},iatt:{x:this.center.x-this.width/2,y:this.center.y-8}}},getMoveOffset:function(){return{tx:6,ty:0,ix:-9,iy:-9}},getMoveTextIconPoint:function(){var t=this.getMoveOffset();return"none"==this.style.text.display?{tatt:{x:this.center.x+t.tx,y:this.center.y+t.ty},iatt:{x:this.center.x+t.ix,y:this.center.y+t.iy}}:{tatt:{x:this.center.x+6,y:this.center.y},iatt:{x:this.center.x-this.width/2,y:this.center.y-8}}}}),MWF.APPPD.Activity.Circle.SingleRouter=new Class({Extends:MWF.APPPD.Activity.Circle,getRoutedata:function(){return this.data.route||(this.data.route=""),[this.data.route]},setRouteData:function(t){this.data.route||(this.data.route=""),this.data.route=t},removeRouteData:function(t){this.data.route=""},quickCreateRoute:function(){this.routes.length||(this.process.createRoute(),this.process.routeCreateFromActivity(this))},checkCreateRoute:function(){this.process.isCreateRoute&&(this.process.currentCreateRoute.fromActivity?this.process.routeCreateToActivity(this):this.routes.length||this.process.routeCreateFromActivity(this));this.process.isCopyRoute&&(this.routes.length||this.process.routeAddFromActivity(this))},mouseHover:function(){this.process.isCreateRoute&&(this.process.currentCreateRoute.fromActivity?this.shap.attr({"stroke-width":"2"}):this.routes.length||this.shap.attr({"stroke-width":"2"}));this.process.isChangeRouteTo&&this.shap.attr({"stroke-width":"2"}),(this.process.isChangeRouteFrom||this.process.isCopyRoute)&&(this.routes.length||this.shap.attr({"stroke-width":"2"}))},mouseUp:function(){this.process.isChangeRouteTo&&(this.process.currentChangeRoute.setActivity(this,null),this.process.currentChangeRoute.isBack=!1,this.process.currentChangeRoute.positionPoints=this.process.currentChangeRoute.getRoutePoint(),this.process.currentChangeRoute.reload(),this.process.isChangeRouteTo=!1,this.process.currentChangeRoute=null),this.process.isChangeRouteFrom&&(this.routes.length||(this.process.currentChangeRoute.setActivity(null,this),this.process.currentChangeRoute.isBack=!1,this.process.currentChangeRoute.positionPoints=this.process.currentChangeRoute.getRoutePoint(),this.process.currentChangeRoute.reload(),this.process.isChangeRouteFrom=!1,this.process.currentChangeRoute=null)),this.shap.attr(this.style.shap)},addRouteData:function(t){this.data.route||(this.data.route=t)}}),MWF.APPPD.Activity.Circle.NoRouter=new Class({Extends:MWF.APPPD.Activity.Circle,quickCreateRoute:function(){return!1},checkCreateRoute:function(){this.process.isCreateRoute&&(this.process.currentCreateRoute.fromActivity&&this.process.routeCreateToActivity(this))},mouseHover:function(){this.process.isCreateRoute&&(this.process.currentCreateRoute.fromActivity&&this.shap.attr({"stroke-width":"2"}));this.process.isChangeRouteTo&&this.shap.attr({"stroke-width":"2"})},mouseUp:function(){this.process.isChangeRouteTo&&(this.process.currentChangeRoute.setActivity(this,null),this.process.currentChangeRoute.isBack=!1,this.process.currentChangeRoute.positionPoints=this.process.currentChangeRoute.getRoutePoint(),this.process.currentChangeRoute.reload(),this.process.isChangeRouteTo=!1,this.process.currentChangeRoute=null),this.shap.attr(this.style.shap)},addRouteData:function(t){}}),MWF.APPPD.Activity.Diamond=new Class({Extends:MWF.APPPD.Activity,setSize:function(){var t=MWF.getTextSize(this.data.name,this.style.text);this.width=t.x+80,this.width=this.width<120?120:this.width,this.height=.4*this.width},createShap:function(){var t;return(t=this.paper.diamond(this.point.x,this.point.y,this.width,this.height,this.style.shap.radiusX,this.style.shap.radiusY)).attr(this.style.shap),t.data("bind",this),t},redrawShap:function(){var t=MWFRaphael.getDiamondPath(this.point.x,this.point.y,this.width,this.height,this.style.shap.radiusX,this.style.shap.radiusY);this.shap.attr("path",t)},getTextIconPoint:function(){return{tatt:{x:this.center.x+6,y:this.center.y+1},iatt:{x:this.center.x-this.width/2+28,y:this.center.y-9}}}}),function(){var t=function(t,s){return new Class({Extends:t,setType:function(){this.type=s,this.data.type=s},setStyle:function(){this.style=this.process.css.activity[s]}})};MWF.APPPD.Activity.Begin=new t(MWF.APPPD.Activity.Circle.SingleRouter,"begin"),MWF.APPPD.Activity.End=new t(MWF.APPPD.Activity.Circle.NoRouter,"end"),MWF.APPPD.Activity.Cancel=new t(MWF.APPPD.Activity.Circle.NoRouter,"cancel"),MWF.APPPD.Activity.Manual=new t(MWF.APPPD.Activity,"manual"),MWF.APPPD.Activity.Condition=new t(MWF.APPPD.Activity.Diamond,"condition"),MWF.APPPD.Activity.Choice=new t(MWF.APPPD.Activity.Diamond,"choice"),MWF.APPPD.Activity.Split=new t(MWF.APPPD.Activity.Circle.SingleRouter,"split"),MWF.APPPD.Activity.Parallel=new t(MWF.APPPD.Activity.Circle,"parallel"),MWF.APPPD.Activity.Merge=new t(MWF.APPPD.Activity.Circle.SingleRouter,"merge"),MWF.APPPD.Activity.Embed=new t(MWF.APPPD.Activity.SingleRouter,"embed"),MWF.APPPD.Activity.Delay=new t(MWF.APPPD.Activity.Circle.SingleRouter,"delay"),MWF.APPPD.Activity.Invoke=new t(MWF.APPPD.Activity.SingleRouter,"invoke"),MWF.APPPD.Activity.Service=new t(MWF.APPPD.Activity.SingleRouter,"service"),MWF.APPPD.Activity.Agent=new t(MWF.APPPD.Activity.SingleRouter,"agent"),MWF.APPPD.Activity.Message=new t(MWF.APPPD.Activity.SingleRouter,"message")}(),MWF.xApplication.process.ProcessDesigner.Activity.List=new Class({initialize:function(t){this.activity=t,this.process=t.process,this.paper=this.activity.process.paper},load:function(){var t="begin"==this.activity.type?" ":'<img src="../x_component_process_ProcessDesigner/$Process/default/icon/copy.png" />';this.row=this.process.activityTable.push([{content:" ",properties:{styles:this.activity.style.listIcon}},{content:this.activity.data.name,properties:{styles:this.process.css.list.listText}},{content:t,properties:{styles:this.process.css.list.listIcon,events:{click:this.copyActivity.bind(this)}}},{content:'<img src="../x_component_process_ProcessDesigner/$Process/default/icon/delete.png" />',properties:{styles:this.process.css.list.listIcon,events:{click:this.deleteActivity.bind(this)}}}]),this.row.tr.addEvent("click",function(){this.activity.selected()}.bind(this))},copyActivity:function(){this.process.copyActivity(this.activity)},deleteActivity:function(t){this.process.deleteActivity(t,this.activity)},listSelected:function(){this.process.currentListSelected&&this.process.currentListSelected.listUnSelected(),this.row.tr.setStyles(this.process.css.list.listRowSelected),this.process.currentListSelected=this},listUnSelected:function(){this.process.currentListSelected=null,this.row.tr.setStyles(this.process.css.list.listRow)}}),MWF.xApplication.process.ProcessDesigner.Activity.Property=new Class({Implements:[Options,Events],Extends:MWF.APPPD.Property,initialize:function(t,s){this.setOptions(s),this.activity=t,this.process=t.process,this.paper=this.activity.process.paper,this.data=t.data,this.htmlPath="../x_component_process_ProcessDesigner/$Process/"+this.activity.type+".html"},setValue:function(t,s){this.data[t]=s,"name"==t&&(s||(this.data[t]=MWF.APPPD.LP.unnamed),this.activity.redraw())}});