MWF.xApplication.cms.FormDesigner.widget=MWF.xApplication.cms.FormDesigner.widget||{},MWF.xDesktop.requireApp("process.FormDesigner","widget.ValidationEditor",null,!1),MWF.xApplication.cms.FormDesigner.widget.ValidationEditor=new Class({Extends:MWF.xApplication.process.FormDesigner.widget.ValidationEditor,loadStatus:function(t){var e="<table width='100%' border='0' cellpadding='0' cellspacing='0'><tr><td width='140px'><input type='radio' value='all' checked />"+this.designer.lp.validation.anytime+"<input type='radio' value='publish' />"+this.designer.lp.validation.publish+"</td></tr></table>";t[0].set("html",e);var i=t[0].getElements("input"),a=(new MWF.widget.UUID).toString();i[0].set("name","condition"+a),i[1].set("name","condition"+a),this.statusRadioNodes=i},getData:function(){var t=this.getStatusValue(),e=this.valueTypeSelectNode.options[this.valueTypeSelectNode.selectedIndex].value,i=this.operateorSelectNode.options[this.operateorSelectNode.selectedIndex].value,a=this.valueInputNode.get("value"),o=this.promptInputNode.get("value");return a==this.designer.lp.validation.valueInput&&(a=""),{status:t,valueType:e,operateor:i,value:a,prompt:o}},addValidation:function(){this.hideErrorNode();var t=this.getData();if("isnull"!=t.operateor&&"notnull"!=t.operateor&&(!t.value||t.value==this.designer.lp.validation.valueInput))return this.showErrorNode(this.designer.lp.validation.inputValue),!1;if(!t.prompt)return this.showErrorNode(this.designer.lp.validation.inputPrompt),!1;var e=new MWF.xApplication.cms.FormDesigner.widget.ValidationEditor.Item(t,this);this.items.push(e),e.selected(),this.fireEvent("change")},modifyValidation:function(){if(this.currentItem){this.hideErrorNode();var t=this.getData();if("isnull"!=t.operateor&&"notnull"!=t.operateor&&(!t.value||t.value==this.designer.lp.validation.valueInput))return this.showErrorNode(this.designer.lp.validation.inputValue),!1;if(!t.prompt)return this.showErrorNode(this.designer.lp.validation.inputPrompt),!1;this.currentItem.reload(t),this.currentItem.unSelected(),this.disabledModify(),this.fireEvent("change")}},loadListNode:function(t){t&&t.length&&t.each(function(t){var e=new MWF.xApplication.cms.FormDesigner.widget.ValidationEditor.Item(t,this);this.items.push(e)}.bind(this))},setData:function(t){if(t.status){for(var e=0;e<this.statusRadioNodes.length;e++)if(t.status==this.statusRadioNodes[e].get("value")){this.statusRadioNodes[e].set("checked",!0);break}}else this.statusRadioNodes[0].set("checked",!0);for(e=0;e<this.valueTypeSelectNode.options.length;e++)if(t.valueType==this.valueTypeSelectNode.options[e].get("value")){this.valueTypeSelectNode.options[e].set("selected",!0);break}for(e=0;e<this.operateorSelectNode.options.length;e++)if(t.operateor==this.operateorSelectNode.options[e].get("value")){this.operateorSelectNode.options[e].set("selected",!0);break}t.value&&this.valueInputNode.set("value",t.value),t.prompt&&this.promptInputNode.set("value",t.prompt)}}),MWF.xApplication.cms.FormDesigner.widget.ValidationEditor.Item=new Class({Extends:MWF.xApplication.process.FormDesigner.widget.ValidationEditor.Item,getText:function(){var t="";return t="all"==this.data.status?this.lp.validation.anytime+" ":this.lp.validation.publish,t+=this.lp.validation[this.data.valueType]+" ",t+=this.lp.validation[this.data.operateor]+" ",t+=' "'+this.data.value+'" ',t+=this.lp.validation.prompt+': "'+this.data.prompt+'"'}});