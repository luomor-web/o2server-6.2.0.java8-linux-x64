MWF.xDesktop.requireApp("process.FormDesigner","Property",null,!1),MWF.xApplication.cms.FormDesigner.Property=MWF.CMSFCProperty=new Class({options:{appType:"cms"},Extends:MWF.FCProperty,loadScriptEditor:function(t,e){t.each(function(t){var i=t.get("title"),n=t.get("name"),s=this.data[n];MWF.require("MWF.widget.ScriptArea",function(){var o=new MWF.widget.ScriptArea(t,{title:i,maxObj:this.designer.formContentNode,onChange:function(){this.data[n]=o.toJson()}.bind(this),onSave:function(){this.designer.saveForm()}.bind(this),style:e||"default",helpStyle:"cms"});o.load(s)}.bind(this))}.bind(this))},getViewList:function(t,e){!this.views||e?this.form.designer.actions.listQueryView(this.form.designer.application.id,function(e){this.views=e.data,t&&t()}.bind(this)):t&&t()},loadActionArea:function(){this.propertyContent.getElements(".MWFMultiActionArea").each(function(t){var e=t.get("name"),i=this.data[e];MWF.xDesktop.requireApp("process.FormDesigner","widget.ActionsEditor",function(){var n=new MWF.xApplication.process.FormDesigner.widget.ActionsEditor(t,this.designer,this.data,{maxObj:this.propertyNode.parentElement.parentElement.parentElement,isSystemTool:!0,onChange:function(){this.data[e]=n.data,this.changeData(e)}.bind(this)});n.load(i)}.bind(this))}.bind(this)),this.propertyContent.getElements(".MWFActionArea").each(function(t){var e=t.get("name"),i=this.data[e];MWF.xDesktop.requireApp("cms.FormDesigner","widget.ActionsEditor",function(){var n=new MWF.xApplication.cms.FormDesigner.widget.ActionsEditor(t,this.designer,this.data,{maxObj:this.propertyNode.parentElement.parentElement.parentElement,onChange:function(){this.data[e]=n.data,this.changeData(e)}.bind(this)});n.load(i)}.bind(this))}.bind(this)),this.propertyContent.getElements(".MWFDefaultActionArea").each(function(t){var e=t.get("name"),i=this.data[e]||this.module.defaultToolBarsData;MWF.xDesktop.requireApp("cms.FormDesigner","widget.ActionsEditor",function(){var n=new MWF.xApplication.cms.FormDesigner.widget.ActionsEditor(t,this.designer,this.data,{maxObj:this.propertyNode.parentElement.parentElement.parentElement,isSystemTool:!0,noCreate:!0,noDelete:!1,noCode:!0,noReadShow:!0,noEditShow:!0,onChange:function(){this.data[e]=n.data,this.changeData(e)}.bind(this)});n.load(i)}.bind(this))}.bind(this))},loadEventsEditor:function(){var t=this.propertyContent.getElement(".MWFEventsArea");if(t){var e=t.get("name"),i=this.data[e];MWF.xDesktop.requireApp("cms.FormDesigner","widget.EventsEditor",function(){new MWF.xApplication.cms.FormDesigner.widget.EventsEditor(t,this.designer,{maxObj:this.designer.formContentNode}).load(i)}.bind(this))}},loadValidation:function(){var t=this.propertyContent.getElements(".MWFValidation");t.length&&t.each(function(t){var e=t.get("name");MWF.xDesktop.requireApp("cms.FormDesigner","widget.ValidationEditor",function(){var i=new MWF.xApplication.cms.FormDesigner.widget.ValidationEditor(t,this.designer,{onChange:function(){var t=i.getValidationData();this.data[e]=t}.bind(this)});i.load(this.data[e])}.bind(this))}.bind(this))}}),MWF.xApplication.cms.FormDesigner.PropertyMulti=new Class({Extends:MWF.xApplication.cms.FormDesigner.Property,Implements:[Options,Events],initialize:function(t,e,i,n,s){this.setOptions(s),this.modules=e,this.form=t,this.data={},this.htmlPath=this.options.path,this.designer=n,this.maplists={},this.propertyNode=i},load:function(){this.fireEvent("queryLoad")&&MWF.getRequestText(this.htmlPath,function(t,e){this.htmlString=t,MWF.require("MWF.widget.JsonTemplate",function(){this.fireEvent("postLoad")}.bind(this))}.bind(this))},show:function(){this.propertyContent?this.propertyContent.setStyle("display","block"):this.htmlString&&(this.JsonTemplate=new MWF.widget.JsonTemplate({},this.htmlString),this.propertyContent=new Element("div",{styles:{overflow:"hidden"}}).inject(this.propertyNode),this.propertyContent.set("html",this.JsonTemplate.load()),this.setEditNodeEvent(),this.setEditNodeStyles(this.propertyContent),this.loadPropertyTab(),this.loadMaplist(),this.loadScriptArea(),this.loadTreeData(),this.loadArrayList())},hide:function(){this.propertyContent&&this.propertyContent.destroy()},changeStyle:function(t){this.modules.each(function(e){e.setPropertiesOrStyles(t)}.bind(this))},changeData:function(t,e,i){this.modules.each(function(n){n._setEditStyle(t,e,i)}.bind(this))},changeJsonDate:function(t,e){this.modules.each(function(i){i.json[t]=e}.bind(this))}});