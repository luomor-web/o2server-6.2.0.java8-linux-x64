MWF.xApplication.process.FormDesigner.Module=MWF.xApplication.process.FormDesigner.Module||{},MWF.xDesktop.requireApp("process.FormDesigner","Module.$Element",null,!1),MWF.xApplication.process.FormDesigner.Module.Documenteditor=MWF.FCDocumenteditor=new Class({Extends:MWF.FC$Element,Implements:[Options,Events],options:{style:"default",propertyPath:"../x_component_process_FormDesigner/Module/Documenteditor/documenteditor.html"},initialize:function(e,t){this.setOptions(t),this.path="../x_component_process_FormDesigner/Module/Documenteditor/",this.cssPath="../x_component_process_FormDesigner/Module/Documenteditor/"+this.options.style+"/css.wcss",this._loadCss(),this.moduleType="element",this.moduleName="documenteditor",this.form=e,this.container=null,this.containerNode=null},_createMoveNode:function(){this.moveNode=new Element("div",{MWFType:"documenteditor",id:this.json.id,styles:this.css.moduleNodeMove,events:{selectstart:function(){return!1}}}).inject(this.form.container)},_createNode:function(){this.node=this.moveNode.clone(!0,!0),this.node.setStyles(this.css.moduleNode),this.node.set("id",this.json.id),this.node.addEvent("selectstart",(function(e){e.preventDefault()}))},_setEditStyle_custom:function(e,t,o){"documentTempleteType"==e&&this.json.documentTempleteType!=o&&this._resetContent(),"documentTempleteUrl"==e&&this.json.documentTempleteUrl!=o&&this._resetContent(),"documentTempleteName"==e&&this.json.documentTempleteName!=o&&this._resetContent()},_resetContent:function(){this.json.documentTempleteType||(this.json.documentTempleteType="sys"),this.json.documentTempleteName||(this.json.documentTempleteName="standard"),this.node.empty();var e=new Element("div.doc_layout_page",{styles:this.css.doc_page}).inject(this.node),t=new Element("div.doc_layout_page_content",{styles:this.css.doc_layout_page_content}).inject(e);"cus"==this.json.documentTempleteType&&this.json.documentTempleteUrl?t.loadHtml(o2.filterUrl(this.json.documentTempleteUrl),function(){}.bind(this)):o2.getJSON(o2.filterUrl("../x_component_process_FormDesigner/Module/Documenteditor/templete/templete.json"),function(e){var o=e[this.json.documentTempleteName];o&&t.loadHtml(o2.filterUrl("../x_component_process_FormDesigner/Module/Documenteditor/templete/"+o.file),function(){}.bind(this))}.bind(this))},_initModule:function(){this._resetContent();var e=this.form.dataTemplate.Documenteditor;if(!e){var t=o2.filterUrl("../x_component_process_FormDesigner/Module/Documenteditor/template.json");e=MWF.getJSON(t,null,!1)}e&&(this.json.defaultValue=Object.merge(e.defaultValue,this.json.defaultValue)),this._setNodeProperty(),this.form.isSubform||this._createIconAction(),this._setNodeEvent()},_preprocessingModuleData:function(){this.node.clearStyles(),this.json.recoveryStyles=Object.clone(this.json.styles),this.json.recoveryStyles&&Object.each(this.json.recoveryStyles,function(e,t){-1!=e.indexOf("x_processplatform_assemble_surface")||-1!=e.indexOf("x_portal_assemble_surface")||(this.node.setStyle(t,e),delete this.json.styles[t])}.bind(this)),this.node.empty(),this.json.preprocessing="y"},_recoveryModuleData:function(){this.json.recoveryStyles&&(this.json.styles=this.json.recoveryStyles),this.json.recoveryStyles=null,this.node.empty(),this._resetContent()}});