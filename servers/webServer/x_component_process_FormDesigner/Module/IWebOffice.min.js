MWF.xApplication.process.FormDesigner.Module=MWF.xApplication.process.FormDesigner.Module||{},MWF.xDesktop.requireApp("process.FormDesigner","Module.$Element",null,!1),MWF.xApplication.process.FormDesigner.Module.IWebOffice=MWF.FCIWebOffice=new Class({Extends:MWF.FC$Element,Implements:[Options,Events],options:{style:"default",propertyPath:"../x_component_process_FormDesigner/Module/IWebOffice/office.html"},initialize:function(e,t){this.setOptions(t),this.path="../x_component_process_FormDesigner/Module/IWebOffice/",this.cssPath="../x_component_process_FormDesigner/Module/IWebOffice/"+this.options.style+"/css.wcss",this._loadCss(),this.moduleType="element",this.moduleName="iWebOffice",this.form=e,this.container=null,this.containerNode=null},_createMoveNode:function(){this.moveNode=new Element("div",{MWFType:"iWebOffice",id:this.json.id,styles:this.css.moduleNodeMove,events:{selectstart:function(){return!1}}}).inject(this.form.container)},_createNode:function(){this.node=this.moveNode.clone(!0,!0),this.node.setStyles(this.css.moduleNode),this.node.set("id",this.json.id),this.node.addEvent("selectstart",(function(){return!1})),this.iconNode=new Element("div",{styles:this.css.iconNode}).inject(this.node);new Element("div",{styles:this.css.iconNodeIcon}).inject(this.iconNode),new Element("div",{styles:this.css.iconNodeText,text:"IWebOffice"}).inject(this.iconNode);this.setIcon()},_loadNodeStyles:function(){this.iconNode=this.node.getElement("div").setStyles(this.css.iconNode),this.iconNode.getFirst("div").setStyles(this.css.iconNodeIcon),this.iconNode.getLast("div").setStyles(this.css.iconNodeText),this.setIcon()},setIconNode:function(e,t,s,o){if(this.iconNode){this.iconNode.setStyle("width",o);var i=this.iconNode.getFirst(),n=this.iconNode.getLast();i.setStyle("background-image","url("+this.path+this.options.style+"/icon/"+e+".png)"),n.set("text",t),n.setStyles({color:s,width:o-34})}},setIcon:function(){"word"==this.json.officeType&&this.setIconNode("word","Word","#2b5797",90),"excel"==this.json.officeType&&this.setIconNode("excel","Excel","#1e7145",86),"ppt"==this.json.officeType&&this.setIconNode("ppt","PowerPoint","#d04525",130),"other"==this.json.officeType&&this.setIconNode("office","Office","#f36523",96)},_setEditStyle_custom:function(e){"officeType"==e&&this.setIcon()}});