MWF.xApplication.process.FormDesigner.widget.FiledConfigurator=new Class({Implements:[Options,Events],Extends:MWF.widget.Common,options:{style:"default"},initialize:function(t,e,i,n){this.setOptions(i),this.node=$(t),this.app=e,this.data=n||[],this.path="../x_component_process_FormDesigner/widget/$FiledConfigurator/",this.cssPath="../x_component_process_FormDesigner/widget/$FiledConfigurator/"+this.options.style+"/css.wcss",this._loadCss()},load:function(){this.items=[],this.table=new Element("table").inject(this.node);var t=new Element("tr").inject(this.table);new Element("th",{text:this.app.lp.filedConfigurator.sequence,width:"10%"}).inject(t),new Element("th",{text:this.app.lp.filedConfigurator.fieldTitle,width:"35%"}).inject(t),new Element("th",{text:this.app.lp.filedConfigurator.fieldId,width:"35%"}).inject(t);new Element("th",{text:this.app.lp.filedConfigurator.action,width:"20%"}).inject(t);this.addNewItemAction=new Element("div",{styles:this.css.addNewItemAction,text:"+"}).inject(this.node),this.addNewItemAction.addEvent("click",function(){this.addItem(),this.addNewItemAction.hide()}.bind(this)),this.data.length>0&&this.addNewItemAction.hide(),Array.each(this.data,function(t,e){var i=new MWF.xApplication.process.FormDesigner.widget.FiledConfigurator.Item(this);i.load(t,e),this.items.push(i)}.bind(this))},getData:function(){return this.data},addItem:function(){var t=new MWF.xApplication.process.FormDesigner.widget.FiledConfigurator.Item(this);t.load("",this.items.length),this.items.push(t),this.fireEvent("change")},insertItem:function(t){var e=t.index+1;this.data.splice(e,0,{field:"",title:""}),this.node.empty(),this.load(),this.fireEvent("change")},deleteItem:function(t){this.items.erase(t),this.data[t.index]&&this.data.splice(t.index,1),t.tr&&t.tr.destroy(),this.setItemsSequence(),0===this.data.length&&this.addNewItemAction&&this.addNewItemAction.setStyle("display","block"),this.fireEvent("change")},upItem:function(t){if(0!==t.index){var e=this.data[t.index-1];this.data[t.index-1]=this.data[t.index],this.data[t.index]=e,this.node.empty(),this.load(),this.fireEvent("change")}},setItemsSequence:function(){this.items.each((function(t,e){t.index=e,t.sequenceNode.set("text",e+1)}))}}),MWF.xApplication.process.FormDesigner.widget.FiledConfigurator.Item=new Class({initialize:function(t){this.configurator=t},load:function(t,e){this.index=e,t?this.data=t:(this.data={field:"",title:""},this.configurator.data.push(this.data)),this.create()},create:function(){var t,e=this.configurator.app.lp.filedConfigurator;this.tr=new Element("tr").inject(this.configurator.table),this.sequenceNode=new Element("td",{text:this.index+1,styles:this.configurator.css.sequenceNode}).inject(this.tr),t=new Element("td").inject(this.tr),this.titleInput=new Element("input",{value:this.data.title,styles:this.configurator.css.inputNode,events:{blur:function(){this.data.title=this.titleInput.get("value"),this.configurator.fireEvent("change")}.bind(this)}}).inject(t),t=new Element("td").inject(this.tr),this.fieldInput=new Element("input",{value:this.data.field,styles:this.configurator.css.inputNode,events:{blur:function(){this.data.field=this.fieldInput.get("value"),this.configurator.fireEvent("change")}.bind(this)}}).inject(t),t=new Element("td").inject(this.tr),this.upAction=new Element("div",{text:"â†‘",title:e.moveup,styles:this.configurator.css.addAction,events:{click:function(t){this.up(t)}.bind(this)}}).inject(t),this.delectAction=new Element("div",{text:"-",title:e.deleteRow,styles:this.configurator.css.delectAction,events:{click:function(t){this.delect(t)}.bind(this)}}).inject(t),this.addAction=new Element("div",{text:"+",title:e.insertRow,styles:this.configurator.css.addAction,events:{click:function(t){this.add(t)}.bind(this)}}).inject(t)},add:function(){this.configurator.insertItem(this)},delect:function(){this.configurator.deleteItem(this)},up:function(){this.configurator.upItem(this)}});